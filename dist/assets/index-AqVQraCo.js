var QP=Object.defineProperty;var XP=(t,e,n)=>e in t?QP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Y=(t,e,n)=>XP(t,typeof e!="symbol"?e+"":e,n);function JP(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ZP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vT={exports:{}},Np={},_T={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xd=Symbol.for("react.element"),e2=Symbol.for("react.portal"),t2=Symbol.for("react.fragment"),n2=Symbol.for("react.strict_mode"),r2=Symbol.for("react.profiler"),s2=Symbol.for("react.provider"),i2=Symbol.for("react.context"),o2=Symbol.for("react.forward_ref"),a2=Symbol.for("react.suspense"),l2=Symbol.for("react.memo"),c2=Symbol.for("react.lazy"),h0=Symbol.iterator;function u2(t){return t===null||typeof t!="object"?null:(t=h0&&t[h0]||t["@@iterator"],typeof t=="function"?t:null)}var xT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wT=Object.assign,bT={};function uc(t,e,n){this.props=t,this.context=e,this.refs=bT,this.updater=n||xT}uc.prototype.isReactComponent={};uc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};uc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ET(){}ET.prototype=uc.prototype;function Hv(t,e,n){this.props=t,this.context=e,this.refs=bT,this.updater=n||xT}var qv=Hv.prototype=new ET;qv.constructor=Hv;wT(qv,uc.prototype);qv.isPureReactComponent=!0;var f0=Array.isArray,kT=Object.prototype.hasOwnProperty,Gv={current:null},TT={key:!0,ref:!0,__self:!0,__source:!0};function ST(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)kT.call(e,r)&&!TT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:xd,type:t,key:i,ref:o,props:s,_owner:Gv.current}}function d2(t,e){return{$$typeof:xd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Kv(t){return typeof t=="object"&&t!==null&&t.$$typeof===xd}function h2(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var p0=/\/+/g;function zm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?h2(""+t.key):e.toString(36)}function Yh(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case xd:case e2:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+zm(o,0):r,f0(s)?(n="",t!=null&&(n=t.replace(p0,"$&/")+"/"),Yh(s,e,n,"",function(c){return c})):s!=null&&(Kv(s)&&(s=d2(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(p0,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",f0(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+zm(i,a);o+=Yh(i,e,n,l,s)}else if(l=u2(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+zm(i,a++),o+=Yh(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function th(t,e,n){if(t==null)return t;var r=[],s=0;return Yh(t,r,"","",function(i){return e.call(n,i,s++)}),r}function f2(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var vr={current:null},Qh={transition:null},p2={ReactCurrentDispatcher:vr,ReactCurrentBatchConfig:Qh,ReactCurrentOwner:Gv};function IT(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:th,forEach:function(t,e,n){th(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return th(t,function(){e++}),e},toArray:function(t){return th(t,function(e){return e})||[]},only:function(t){if(!Kv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$e.Component=uc;$e.Fragment=t2;$e.Profiler=r2;$e.PureComponent=Hv;$e.StrictMode=n2;$e.Suspense=a2;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p2;$e.act=IT;$e.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=wT({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Gv.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)kT.call(e,l)&&!TT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:xd,type:t.type,key:s,ref:i,props:r,_owner:o}};$e.createContext=function(t){return t={$$typeof:i2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:s2,_context:t},t.Consumer=t};$e.createElement=ST;$e.createFactory=function(t){var e=ST.bind(null,t);return e.type=t,e};$e.createRef=function(){return{current:null}};$e.forwardRef=function(t){return{$$typeof:o2,render:t}};$e.isValidElement=Kv;$e.lazy=function(t){return{$$typeof:c2,_payload:{_status:-1,_result:t},_init:f2}};$e.memo=function(t,e){return{$$typeof:l2,type:t,compare:e===void 0?null:e}};$e.startTransition=function(t){var e=Qh.transition;Qh.transition={};try{t()}finally{Qh.transition=e}};$e.unstable_act=IT;$e.useCallback=function(t,e){return vr.current.useCallback(t,e)};$e.useContext=function(t){return vr.current.useContext(t)};$e.useDebugValue=function(){};$e.useDeferredValue=function(t){return vr.current.useDeferredValue(t)};$e.useEffect=function(t,e){return vr.current.useEffect(t,e)};$e.useId=function(){return vr.current.useId()};$e.useImperativeHandle=function(t,e,n){return vr.current.useImperativeHandle(t,e,n)};$e.useInsertionEffect=function(t,e){return vr.current.useInsertionEffect(t,e)};$e.useLayoutEffect=function(t,e){return vr.current.useLayoutEffect(t,e)};$e.useMemo=function(t,e){return vr.current.useMemo(t,e)};$e.useReducer=function(t,e,n){return vr.current.useReducer(t,e,n)};$e.useRef=function(t){return vr.current.useRef(t)};$e.useState=function(t){return vr.current.useState(t)};$e.useSyncExternalStore=function(t,e,n){return vr.current.useSyncExternalStore(t,e,n)};$e.useTransition=function(){return vr.current.useTransition()};$e.version="18.3.1";_T.exports=$e;var T=_T.exports;const Rn=ZP(T),m2=JP({__proto__:null,default:Rn},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g2=T,y2=Symbol.for("react.element"),v2=Symbol.for("react.fragment"),_2=Object.prototype.hasOwnProperty,x2=g2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w2={key:!0,ref:!0,__self:!0,__source:!0};function CT(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_2.call(e,r)&&!w2.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:y2,type:t,key:i,ref:o,props:s,_owner:x2.current}}Np.Fragment=v2;Np.jsx=CT;Np.jsxs=CT;vT.exports=Np;var u=vT.exports,ty={},AT={exports:{}},ns={},RT={exports:{}},NT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,G){var re=V.length;V.push(G);e:for(;0<re;){var _e=re-1>>>1,ke=V[_e];if(0<s(ke,G))V[_e]=G,V[re]=ke,re=_e;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var G=V[0],re=V.pop();if(re!==G){V[0]=re;e:for(var _e=0,ke=V.length,Ie=ke>>>1;_e<Ie;){var Oe=2*(_e+1)-1,Dt=V[Oe],ht=Oe+1,wt=V[ht];if(0>s(Dt,re))ht<ke&&0>s(wt,Dt)?(V[_e]=wt,V[ht]=re,_e=ht):(V[_e]=Dt,V[Oe]=re,_e=Oe);else if(ht<ke&&0>s(wt,re))V[_e]=wt,V[ht]=re,_e=ht;else break e}}return G}function s(V,G){var re=V.sortIndex-G.sortIndex;return re!==0?re:V.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,f=null,p=3,m=!1,x=!1,w=!1,y=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(V){for(var G=n(c);G!==null;){if(G.callback===null)r(c);else if(G.startTime<=V)r(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=n(c)}}function A(V){if(w=!1,k(V),!x)if(n(l)!==null)x=!0,F(D);else{var G=n(c);G!==null&&W(A,G.startTime-V)}}function D(V,G){x=!1,w&&(w=!1,_(E),E=-1),m=!0;var re=p;try{for(k(G),f=n(l);f!==null&&(!(f.expirationTime>G)||V&&!N());){var _e=f.callback;if(typeof _e=="function"){f.callback=null,p=f.priorityLevel;var ke=_e(f.expirationTime<=G);G=t.unstable_now(),typeof ke=="function"?f.callback=ke:f===n(l)&&r(l),k(G)}else r(l);f=n(l)}if(f!==null)var Ie=!0;else{var Oe=n(c);Oe!==null&&W(A,Oe.startTime-G),Ie=!1}return Ie}finally{f=null,p=re,m=!1}}var O=!1,I=null,E=-1,S=5,C=-1;function N(){return!(t.unstable_now()-C<S)}function j(){if(I!==null){var V=t.unstable_now();C=V;var G=!0;try{G=I(!0,V)}finally{G?P():(O=!1,I=null)}}else O=!1}var P;if(typeof v=="function")P=function(){v(j)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,ae=ne.port2;ne.port1.onmessage=j,P=function(){ae.postMessage(null)}}else P=function(){y(j,0)};function F(V){I=V,O||(O=!0,P())}function W(V,G){E=y(function(){V(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){x||m||(x=!0,F(D))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var re=p;p=G;try{return V()}finally{p=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,G){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var re=p;p=V;try{return G()}finally{p=re}},t.unstable_scheduleCallback=function(V,G,re){var _e=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?_e+re:_e):re=_e,V){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=re+ke,V={id:d++,callback:G,priorityLevel:V,startTime:re,expirationTime:ke,sortIndex:-1},re>_e?(V.sortIndex=re,e(c,V),n(l)===null&&V===n(c)&&(w?(_(E),E=-1):w=!0,W(A,re-_e))):(V.sortIndex=ke,e(l,V),x||m||(x=!0,F(D))),V},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(V){var G=p;return function(){var re=p;p=G;try{return V.apply(this,arguments)}finally{p=re}}}})(NT);RT.exports=NT;var b2=RT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E2=T,Zr=b2;function te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PT=new Set,Fu={};function $a(t,e){Bl(t,e),Bl(t+"Capture",e)}function Bl(t,e){for(Fu[t]=e,t=0;t<e.length;t++)PT.add(e[t])}var Di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ny=Object.prototype.hasOwnProperty,k2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m0={},g0={};function T2(t){return ny.call(g0,t)?!0:ny.call(m0,t)?!1:k2.test(t)?g0[t]=!0:(m0[t]=!0,!1)}function S2(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function I2(t,e,n,r){if(e===null||typeof e>"u"||S2(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function _r(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wn[t]=new _r(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wn[e]=new _r(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wn[t]=new _r(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wn[t]=new _r(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wn[t]=new _r(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wn[t]=new _r(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wn[t]=new _r(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wn[t]=new _r(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wn[t]=new _r(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yv=/[\-:]([a-z])/g;function Qv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yv,Qv);Wn[e]=new _r(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yv,Qv);Wn[e]=new _r(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yv,Qv);Wn[e]=new _r(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wn[t]=new _r(t,1,!1,t.toLowerCase(),null,!1,!1)});Wn.xlinkHref=new _r("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wn[t]=new _r(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xv(t,e,n,r){var s=Wn.hasOwnProperty(e)?Wn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(I2(e,n,s,r)&&(n=null),r||s===null?T2(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var $i=E2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nh=Symbol.for("react.element"),fl=Symbol.for("react.portal"),pl=Symbol.for("react.fragment"),Jv=Symbol.for("react.strict_mode"),ry=Symbol.for("react.profiler"),jT=Symbol.for("react.provider"),DT=Symbol.for("react.context"),Zv=Symbol.for("react.forward_ref"),sy=Symbol.for("react.suspense"),iy=Symbol.for("react.suspense_list"),e_=Symbol.for("react.memo"),Ji=Symbol.for("react.lazy"),MT=Symbol.for("react.offscreen"),y0=Symbol.iterator;function Nc(t){return t===null||typeof t!="object"?null:(t=y0&&t[y0]||t["@@iterator"],typeof t=="function"?t:null)}var Gt=Object.assign,$m;function Qc(t){if($m===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$m=e&&e[1]||""}return`
`+$m+t}var Wm=!1;function Hm(t,e){if(!t||Wm)return"";Wm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Wm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Qc(t):""}function C2(t){switch(t.tag){case 5:return Qc(t.type);case 16:return Qc("Lazy");case 13:return Qc("Suspense");case 19:return Qc("SuspenseList");case 0:case 2:case 15:return t=Hm(t.type,!1),t;case 11:return t=Hm(t.type.render,!1),t;case 1:return t=Hm(t.type,!0),t;default:return""}}function oy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pl:return"Fragment";case fl:return"Portal";case ry:return"Profiler";case Jv:return"StrictMode";case sy:return"Suspense";case iy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case DT:return(t.displayName||"Context")+".Consumer";case jT:return(t._context.displayName||"Context")+".Provider";case Zv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case e_:return e=t.displayName||null,e!==null?e:oy(t.type)||"Memo";case Ji:e=t._payload,t=t._init;try{return oy(t(e))}catch{}}return null}function A2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oy(e);case 8:return e===Jv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Po(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function OT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function R2(t){var e=OT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rh(t){t._valueTracker||(t._valueTracker=R2(t))}function LT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=OT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ef(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ay(t,e){var n=e.checked;return Gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function v0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Po(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function FT(t,e){e=e.checked,e!=null&&Xv(t,"checked",e,!1)}function ly(t,e){FT(t,e);var n=Po(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cy(t,e.type,n):e.hasOwnProperty("defaultValue")&&cy(t,e.type,Po(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function cy(t,e,n){(e!=="number"||Ef(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Xc=Array.isArray;function Sl(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Po(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function uy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(te(91));return Gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function x0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(te(92));if(Xc(n)){if(1<n.length)throw Error(te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Po(n)}}function VT(t,e){var n=Po(e.value),r=Po(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function w0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function UT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?UT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sh,BT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sh=sh||document.createElement("div"),sh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var du={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N2=["Webkit","ms","Moz","O"];Object.keys(du).forEach(function(t){N2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),du[e]=du[t]})});function zT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||du.hasOwnProperty(t)&&du[t]?(""+e).trim():e+"px"}function $T(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=zT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var P2=Gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hy(t,e){if(e){if(P2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(te(62))}}function fy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var py=null;function t_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var my=null,Il=null,Cl=null;function b0(t){if(t=Ed(t)){if(typeof my!="function")throw Error(te(280));var e=t.stateNode;e&&(e=Op(e),my(t.stateNode,t.type,e))}}function WT(t){Il?Cl?Cl.push(t):Cl=[t]:Il=t}function HT(){if(Il){var t=Il,e=Cl;if(Cl=Il=null,b0(t),e)for(t=0;t<e.length;t++)b0(e[t])}}function qT(t,e){return t(e)}function GT(){}var qm=!1;function KT(t,e,n){if(qm)return t(e,n);qm=!0;try{return qT(t,e,n)}finally{qm=!1,(Il!==null||Cl!==null)&&(GT(),HT())}}function Uu(t,e){var n=t.stateNode;if(n===null)return null;var r=Op(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(te(231,e,typeof n));return n}var gy=!1;if(Di)try{var Pc={};Object.defineProperty(Pc,"passive",{get:function(){gy=!0}}),window.addEventListener("test",Pc,Pc),window.removeEventListener("test",Pc,Pc)}catch{gy=!1}function j2(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var hu=!1,kf=null,Tf=!1,yy=null,D2={onError:function(t){hu=!0,kf=t}};function M2(t,e,n,r,s,i,o,a,l){hu=!1,kf=null,j2.apply(D2,arguments)}function O2(t,e,n,r,s,i,o,a,l){if(M2.apply(this,arguments),hu){if(hu){var c=kf;hu=!1,kf=null}else throw Error(te(198));Tf||(Tf=!0,yy=c)}}function Wa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function YT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function E0(t){if(Wa(t)!==t)throw Error(te(188))}function L2(t){var e=t.alternate;if(!e){if(e=Wa(t),e===null)throw Error(te(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return E0(s),t;if(i===r)return E0(s),e;i=i.sibling}throw Error(te(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?t:e}function QT(t){return t=L2(t),t!==null?XT(t):null}function XT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=XT(t);if(e!==null)return e;t=t.sibling}return null}var JT=Zr.unstable_scheduleCallback,k0=Zr.unstable_cancelCallback,F2=Zr.unstable_shouldYield,V2=Zr.unstable_requestPaint,sn=Zr.unstable_now,U2=Zr.unstable_getCurrentPriorityLevel,n_=Zr.unstable_ImmediatePriority,ZT=Zr.unstable_UserBlockingPriority,Sf=Zr.unstable_NormalPriority,B2=Zr.unstable_LowPriority,eS=Zr.unstable_IdlePriority,Pp=null,ei=null;function z2(t){if(ei&&typeof ei.onCommitFiberRoot=="function")try{ei.onCommitFiberRoot(Pp,t,void 0,(t.current.flags&128)===128)}catch{}}var Cs=Math.clz32?Math.clz32:H2,$2=Math.log,W2=Math.LN2;function H2(t){return t>>>=0,t===0?32:31-($2(t)/W2|0)|0}var ih=64,oh=4194304;function Jc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function If(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Jc(a):(i&=o,i!==0&&(r=Jc(i)))}else o=n&~s,o!==0?r=Jc(o):i!==0&&(r=Jc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Cs(e),s=1<<n,r|=t[n],e&=~s;return r}function q2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function G2(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Cs(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=q2(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function vy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tS(){var t=ih;return ih<<=1,!(ih&4194240)&&(ih=64),t}function Gm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Cs(e),t[e]=n}function K2(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Cs(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function r_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Cs(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var mt=0;function nS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var rS,s_,sS,iS,oS,_y=!1,ah=[],yo=null,vo=null,_o=null,Bu=new Map,zu=new Map,eo=[],Y2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function T0(t,e){switch(t){case"focusin":case"focusout":yo=null;break;case"dragenter":case"dragleave":vo=null;break;case"mouseover":case"mouseout":_o=null;break;case"pointerover":case"pointerout":Bu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zu.delete(e.pointerId)}}function jc(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Ed(e),e!==null&&s_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Q2(t,e,n,r,s){switch(e){case"focusin":return yo=jc(yo,t,e,n,r,s),!0;case"dragenter":return vo=jc(vo,t,e,n,r,s),!0;case"mouseover":return _o=jc(_o,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Bu.set(i,jc(Bu.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,zu.set(i,jc(zu.get(i)||null,t,e,n,r,s)),!0}return!1}function aS(t){var e=pa(t.target);if(e!==null){var n=Wa(e);if(n!==null){if(e=n.tag,e===13){if(e=YT(n),e!==null){t.blockedOn=e,oS(t.priority,function(){sS(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=xy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);py=r,n.target.dispatchEvent(r),py=null}else return e=Ed(n),e!==null&&s_(e),t.blockedOn=n,!1;e.shift()}return!0}function S0(t,e,n){Xh(t)&&n.delete(e)}function X2(){_y=!1,yo!==null&&Xh(yo)&&(yo=null),vo!==null&&Xh(vo)&&(vo=null),_o!==null&&Xh(_o)&&(_o=null),Bu.forEach(S0),zu.forEach(S0)}function Dc(t,e){t.blockedOn===e&&(t.blockedOn=null,_y||(_y=!0,Zr.unstable_scheduleCallback(Zr.unstable_NormalPriority,X2)))}function $u(t){function e(s){return Dc(s,t)}if(0<ah.length){Dc(ah[0],t);for(var n=1;n<ah.length;n++){var r=ah[n];r.blockedOn===t&&(r.blockedOn=null)}}for(yo!==null&&Dc(yo,t),vo!==null&&Dc(vo,t),_o!==null&&Dc(_o,t),Bu.forEach(e),zu.forEach(e),n=0;n<eo.length;n++)r=eo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<eo.length&&(n=eo[0],n.blockedOn===null);)aS(n),n.blockedOn===null&&eo.shift()}var Al=$i.ReactCurrentBatchConfig,Cf=!0;function J2(t,e,n,r){var s=mt,i=Al.transition;Al.transition=null;try{mt=1,i_(t,e,n,r)}finally{mt=s,Al.transition=i}}function Z2(t,e,n,r){var s=mt,i=Al.transition;Al.transition=null;try{mt=4,i_(t,e,n,r)}finally{mt=s,Al.transition=i}}function i_(t,e,n,r){if(Cf){var s=xy(t,e,n,r);if(s===null)rg(t,e,r,Af,n),T0(t,r);else if(Q2(s,t,e,n,r))r.stopPropagation();else if(T0(t,r),e&4&&-1<Y2.indexOf(t)){for(;s!==null;){var i=Ed(s);if(i!==null&&rS(i),i=xy(t,e,n,r),i===null&&rg(t,e,r,Af,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else rg(t,e,r,null,n)}}var Af=null;function xy(t,e,n,r){if(Af=null,t=t_(r),t=pa(t),t!==null)if(e=Wa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=YT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Af=t,null}function lS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(U2()){case n_:return 1;case ZT:return 4;case Sf:case B2:return 16;case eS:return 536870912;default:return 16}default:return 16}}var lo=null,o_=null,Jh=null;function cS(){if(Jh)return Jh;var t,e=o_,n=e.length,r,s="value"in lo?lo.value:lo.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Jh=s.slice(t,1<r?1-r:void 0)}function Zh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lh(){return!0}function I0(){return!1}function rs(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?lh:I0,this.isPropagationStopped=I0,this}return Gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lh)},persist:function(){},isPersistent:lh}),e}var dc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},a_=rs(dc),bd=Gt({},dc,{view:0,detail:0}),ej=rs(bd),Km,Ym,Mc,jp=Gt({},bd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:l_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mc&&(Mc&&t.type==="mousemove"?(Km=t.screenX-Mc.screenX,Ym=t.screenY-Mc.screenY):Ym=Km=0,Mc=t),Km)},movementY:function(t){return"movementY"in t?t.movementY:Ym}}),C0=rs(jp),tj=Gt({},jp,{dataTransfer:0}),nj=rs(tj),rj=Gt({},bd,{relatedTarget:0}),Qm=rs(rj),sj=Gt({},dc,{animationName:0,elapsedTime:0,pseudoElement:0}),ij=rs(sj),oj=Gt({},dc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aj=rs(oj),lj=Gt({},dc,{data:0}),A0=rs(lj),cj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dj[t])?!!e[t]:!1}function l_(){return hj}var fj=Gt({},bd,{key:function(t){if(t.key){var e=cj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?uj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:l_,charCode:function(t){return t.type==="keypress"?Zh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pj=rs(fj),mj=Gt({},jp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R0=rs(mj),gj=Gt({},bd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:l_}),yj=rs(gj),vj=Gt({},dc,{propertyName:0,elapsedTime:0,pseudoElement:0}),_j=rs(vj),xj=Gt({},jp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wj=rs(xj),bj=[9,13,27,32],c_=Di&&"CompositionEvent"in window,fu=null;Di&&"documentMode"in document&&(fu=document.documentMode);var Ej=Di&&"TextEvent"in window&&!fu,uS=Di&&(!c_||fu&&8<fu&&11>=fu),N0=" ",P0=!1;function dS(t,e){switch(t){case"keyup":return bj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ml=!1;function kj(t,e){switch(t){case"compositionend":return hS(e);case"keypress":return e.which!==32?null:(P0=!0,N0);case"textInput":return t=e.data,t===N0&&P0?null:t;default:return null}}function Tj(t,e){if(ml)return t==="compositionend"||!c_&&dS(t,e)?(t=cS(),Jh=o_=lo=null,ml=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uS&&e.locale!=="ko"?null:e.data;default:return null}}var Sj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Sj[t.type]:e==="textarea"}function fS(t,e,n,r){WT(r),e=Rf(e,"onChange"),0<e.length&&(n=new a_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pu=null,Wu=null;function Ij(t){kS(t,0)}function Dp(t){var e=vl(t);if(LT(e))return t}function Cj(t,e){if(t==="change")return e}var pS=!1;if(Di){var Xm;if(Di){var Jm="oninput"in document;if(!Jm){var D0=document.createElement("div");D0.setAttribute("oninput","return;"),Jm=typeof D0.oninput=="function"}Xm=Jm}else Xm=!1;pS=Xm&&(!document.documentMode||9<document.documentMode)}function M0(){pu&&(pu.detachEvent("onpropertychange",mS),Wu=pu=null)}function mS(t){if(t.propertyName==="value"&&Dp(Wu)){var e=[];fS(e,Wu,t,t_(t)),KT(Ij,e)}}function Aj(t,e,n){t==="focusin"?(M0(),pu=e,Wu=n,pu.attachEvent("onpropertychange",mS)):t==="focusout"&&M0()}function Rj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dp(Wu)}function Nj(t,e){if(t==="click")return Dp(e)}function Pj(t,e){if(t==="input"||t==="change")return Dp(e)}function jj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ns=typeof Object.is=="function"?Object.is:jj;function Hu(t,e){if(Ns(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ny.call(e,s)||!Ns(t[s],e[s]))return!1}return!0}function O0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function L0(t,e){var n=O0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=O0(n)}}function gS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function yS(){for(var t=window,e=Ef();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ef(t.document)}return e}function u_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Dj(t){var e=yS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&gS(n.ownerDocument.documentElement,n)){if(r!==null&&u_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=L0(n,i);var o=L0(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Mj=Di&&"documentMode"in document&&11>=document.documentMode,gl=null,wy=null,mu=null,by=!1;function F0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;by||gl==null||gl!==Ef(r)||(r=gl,"selectionStart"in r&&u_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mu&&Hu(mu,r)||(mu=r,r=Rf(wy,"onSelect"),0<r.length&&(e=new a_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gl)))}function ch(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var yl={animationend:ch("Animation","AnimationEnd"),animationiteration:ch("Animation","AnimationIteration"),animationstart:ch("Animation","AnimationStart"),transitionend:ch("Transition","TransitionEnd")},Zm={},vS={};Di&&(vS=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function Mp(t){if(Zm[t])return Zm[t];if(!yl[t])return t;var e=yl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in vS)return Zm[t]=e[n];return t}var _S=Mp("animationend"),xS=Mp("animationiteration"),wS=Mp("animationstart"),bS=Mp("transitionend"),ES=new Map,V0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wo(t,e){ES.set(t,e),$a(e,[t])}for(var eg=0;eg<V0.length;eg++){var tg=V0[eg],Oj=tg.toLowerCase(),Lj=tg[0].toUpperCase()+tg.slice(1);Wo(Oj,"on"+Lj)}Wo(_S,"onAnimationEnd");Wo(xS,"onAnimationIteration");Wo(wS,"onAnimationStart");Wo("dblclick","onDoubleClick");Wo("focusin","onFocus");Wo("focusout","onBlur");Wo(bS,"onTransitionEnd");Bl("onMouseEnter",["mouseout","mouseover"]);Bl("onMouseLeave",["mouseout","mouseover"]);Bl("onPointerEnter",["pointerout","pointerover"]);Bl("onPointerLeave",["pointerout","pointerover"]);$a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$a("onBeforeInput",["compositionend","keypress","textInput","paste"]);$a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zc));function U0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,O2(r,e,void 0,t),t.currentTarget=null}function kS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;U0(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;U0(s,a,c),i=l}}}if(Tf)throw t=yy,Tf=!1,yy=null,t}function Rt(t,e){var n=e[Iy];n===void 0&&(n=e[Iy]=new Set);var r=t+"__bubble";n.has(r)||(TS(e,t,2,!1),n.add(r))}function ng(t,e,n){var r=0;e&&(r|=4),TS(n,t,r,e)}var uh="_reactListening"+Math.random().toString(36).slice(2);function qu(t){if(!t[uh]){t[uh]=!0,PT.forEach(function(n){n!=="selectionchange"&&(Fj.has(n)||ng(n,!1,t),ng(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uh]||(e[uh]=!0,ng("selectionchange",!1,e))}}function TS(t,e,n,r){switch(lS(e)){case 1:var s=J2;break;case 4:s=Z2;break;default:s=i_}n=s.bind(null,e,n,t),s=void 0,!gy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function rg(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=pa(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}KT(function(){var c=i,d=t_(n),f=[];e:{var p=ES.get(t);if(p!==void 0){var m=a_,x=t;switch(t){case"keypress":if(Zh(n)===0)break e;case"keydown":case"keyup":m=pj;break;case"focusin":x="focus",m=Qm;break;case"focusout":x="blur",m=Qm;break;case"beforeblur":case"afterblur":m=Qm;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=C0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=nj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=yj;break;case _S:case xS:case wS:m=ij;break;case bS:m=_j;break;case"scroll":m=ej;break;case"wheel":m=wj;break;case"copy":case"cut":case"paste":m=aj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=R0}var w=(e&4)!==0,y=!w&&t==="scroll",_=w?p!==null?p+"Capture":null:p;w=[];for(var v=c,k;v!==null;){k=v;var A=k.stateNode;if(k.tag===5&&A!==null&&(k=A,_!==null&&(A=Uu(v,_),A!=null&&w.push(Gu(v,A,k)))),y)break;v=v.return}0<w.length&&(p=new m(p,x,null,n,d),f.push({event:p,listeners:w}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&n!==py&&(x=n.relatedTarget||n.fromElement)&&(pa(x)||x[Mi]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(x=n.relatedTarget||n.toElement,m=c,x=x?pa(x):null,x!==null&&(y=Wa(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=c),m!==x)){if(w=C0,A="onMouseLeave",_="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(w=R0,A="onPointerLeave",_="onPointerEnter",v="pointer"),y=m==null?p:vl(m),k=x==null?p:vl(x),p=new w(A,v+"leave",m,n,d),p.target=y,p.relatedTarget=k,A=null,pa(d)===c&&(w=new w(_,v+"enter",x,n,d),w.target=k,w.relatedTarget=y,A=w),y=A,m&&x)t:{for(w=m,_=x,v=0,k=w;k;k=sl(k))v++;for(k=0,A=_;A;A=sl(A))k++;for(;0<v-k;)w=sl(w),v--;for(;0<k-v;)_=sl(_),k--;for(;v--;){if(w===_||_!==null&&w===_.alternate)break t;w=sl(w),_=sl(_)}w=null}else w=null;m!==null&&B0(f,p,m,w,!1),x!==null&&y!==null&&B0(f,y,x,w,!0)}}e:{if(p=c?vl(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var D=Cj;else if(j0(p))if(pS)D=Pj;else{D=Rj;var O=Aj}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=Nj);if(D&&(D=D(t,c))){fS(f,D,n,d);break e}O&&O(t,p,c),t==="focusout"&&(O=p._wrapperState)&&O.controlled&&p.type==="number"&&cy(p,"number",p.value)}switch(O=c?vl(c):window,t){case"focusin":(j0(O)||O.contentEditable==="true")&&(gl=O,wy=c,mu=null);break;case"focusout":mu=wy=gl=null;break;case"mousedown":by=!0;break;case"contextmenu":case"mouseup":case"dragend":by=!1,F0(f,n,d);break;case"selectionchange":if(Mj)break;case"keydown":case"keyup":F0(f,n,d)}var I;if(c_)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ml?dS(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(uS&&n.locale!=="ko"&&(ml||E!=="onCompositionStart"?E==="onCompositionEnd"&&ml&&(I=cS()):(lo=d,o_="value"in lo?lo.value:lo.textContent,ml=!0)),O=Rf(c,E),0<O.length&&(E=new A0(E,t,null,n,d),f.push({event:E,listeners:O}),I?E.data=I:(I=hS(n),I!==null&&(E.data=I)))),(I=Ej?kj(t,n):Tj(t,n))&&(c=Rf(c,"onBeforeInput"),0<c.length&&(d=new A0("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:c}),d.data=I))}kS(f,e)})}function Gu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Rf(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Uu(t,n),i!=null&&r.unshift(Gu(t,i,s)),i=Uu(t,e),i!=null&&r.push(Gu(t,i,s))),t=t.return}return r}function sl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function B0(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=Uu(n,i),l!=null&&o.unshift(Gu(n,l,a))):s||(l=Uu(n,i),l!=null&&o.push(Gu(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Vj=/\r\n?/g,Uj=/\u0000|\uFFFD/g;function z0(t){return(typeof t=="string"?t:""+t).replace(Vj,`
`).replace(Uj,"")}function dh(t,e,n){if(e=z0(e),z0(t)!==e&&n)throw Error(te(425))}function Nf(){}var Ey=null,ky=null;function Ty(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sy=typeof setTimeout=="function"?setTimeout:void 0,Bj=typeof clearTimeout=="function"?clearTimeout:void 0,$0=typeof Promise=="function"?Promise:void 0,zj=typeof queueMicrotask=="function"?queueMicrotask:typeof $0<"u"?function(t){return $0.resolve(null).then(t).catch($j)}:Sy;function $j(t){setTimeout(function(){throw t})}function sg(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),$u(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);$u(e)}function xo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function W0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var hc=Math.random().toString(36).slice(2),Ys="__reactFiber$"+hc,Ku="__reactProps$"+hc,Mi="__reactContainer$"+hc,Iy="__reactEvents$"+hc,Wj="__reactListeners$"+hc,Hj="__reactHandles$"+hc;function pa(t){var e=t[Ys];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Mi]||n[Ys]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=W0(t);t!==null;){if(n=t[Ys])return n;t=W0(t)}return e}t=n,n=t.parentNode}return null}function Ed(t){return t=t[Ys]||t[Mi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(te(33))}function Op(t){return t[Ku]||null}var Cy=[],_l=-1;function Ho(t){return{current:t}}function jt(t){0>_l||(t.current=Cy[_l],Cy[_l]=null,_l--)}function It(t,e){_l++,Cy[_l]=t.current,t.current=e}var jo={},ar=Ho(jo),Or=Ho(!1),Ra=jo;function zl(t,e){var n=t.type.contextTypes;if(!n)return jo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Lr(t){return t=t.childContextTypes,t!=null}function Pf(){jt(Or),jt(ar)}function H0(t,e,n){if(ar.current!==jo)throw Error(te(168));It(ar,e),It(Or,n)}function SS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(te(108,A2(t)||"Unknown",s));return Gt({},n,r)}function jf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||jo,Ra=ar.current,It(ar,t),It(Or,Or.current),!0}function q0(t,e,n){var r=t.stateNode;if(!r)throw Error(te(169));n?(t=SS(t,e,Ra),r.__reactInternalMemoizedMergedChildContext=t,jt(Or),jt(ar),It(ar,t)):jt(Or),It(Or,n)}var Si=null,Lp=!1,ig=!1;function IS(t){Si===null?Si=[t]:Si.push(t)}function qj(t){Lp=!0,IS(t)}function qo(){if(!ig&&Si!==null){ig=!0;var t=0,e=mt;try{var n=Si;for(mt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Si=null,Lp=!1}catch(s){throw Si!==null&&(Si=Si.slice(t+1)),JT(n_,qo),s}finally{mt=e,ig=!1}}return null}var xl=[],wl=0,Df=null,Mf=0,as=[],ls=0,Na=null,Ci=1,Ai="";function aa(t,e){xl[wl++]=Mf,xl[wl++]=Df,Df=t,Mf=e}function CS(t,e,n){as[ls++]=Ci,as[ls++]=Ai,as[ls++]=Na,Na=t;var r=Ci;t=Ai;var s=32-Cs(r)-1;r&=~(1<<s),n+=1;var i=32-Cs(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Ci=1<<32-Cs(e)+s|n<<s|r,Ai=i+t}else Ci=1<<i|n<<s|r,Ai=t}function d_(t){t.return!==null&&(aa(t,1),CS(t,1,0))}function h_(t){for(;t===Df;)Df=xl[--wl],xl[wl]=null,Mf=xl[--wl],xl[wl]=null;for(;t===Na;)Na=as[--ls],as[ls]=null,Ai=as[--ls],as[ls]=null,Ci=as[--ls],as[ls]=null}var Xr=null,Kr=null,Ut=!1,Ss=null;function AS(t,e){var n=cs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function G0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Xr=t,Kr=xo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Xr=t,Kr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Na!==null?{id:Ci,overflow:Ai}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Xr=t,Kr=null,!0):!1;default:return!1}}function Ay(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ry(t){if(Ut){var e=Kr;if(e){var n=e;if(!G0(t,e)){if(Ay(t))throw Error(te(418));e=xo(n.nextSibling);var r=Xr;e&&G0(t,e)?AS(r,n):(t.flags=t.flags&-4097|2,Ut=!1,Xr=t)}}else{if(Ay(t))throw Error(te(418));t.flags=t.flags&-4097|2,Ut=!1,Xr=t}}}function K0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Xr=t}function hh(t){if(t!==Xr)return!1;if(!Ut)return K0(t),Ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ty(t.type,t.memoizedProps)),e&&(e=Kr)){if(Ay(t))throw RS(),Error(te(418));for(;e;)AS(t,e),e=xo(e.nextSibling)}if(K0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kr=xo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kr=null}}else Kr=Xr?xo(t.stateNode.nextSibling):null;return!0}function RS(){for(var t=Kr;t;)t=xo(t.nextSibling)}function $l(){Kr=Xr=null,Ut=!1}function f_(t){Ss===null?Ss=[t]:Ss.push(t)}var Gj=$i.ReactCurrentBatchConfig;function Oc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,t))}return t}function fh(t,e){throw t=Object.prototype.toString.call(e),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Y0(t){var e=t._init;return e(t._payload)}function NS(t){function e(_,v){if(t){var k=_.deletions;k===null?(_.deletions=[v],_.flags|=16):k.push(v)}}function n(_,v){if(!t)return null;for(;v!==null;)e(_,v),v=v.sibling;return null}function r(_,v){for(_=new Map;v!==null;)v.key!==null?_.set(v.key,v):_.set(v.index,v),v=v.sibling;return _}function s(_,v){return _=ko(_,v),_.index=0,_.sibling=null,_}function i(_,v,k){return _.index=k,t?(k=_.alternate,k!==null?(k=k.index,k<v?(_.flags|=2,v):k):(_.flags|=2,v)):(_.flags|=1048576,v)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,v,k,A){return v===null||v.tag!==6?(v=hg(k,_.mode,A),v.return=_,v):(v=s(v,k),v.return=_,v)}function l(_,v,k,A){var D=k.type;return D===pl?d(_,v,k.props.children,A,k.key):v!==null&&(v.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Ji&&Y0(D)===v.type)?(A=s(v,k.props),A.ref=Oc(_,v,k),A.return=_,A):(A=af(k.type,k.key,k.props,null,_.mode,A),A.ref=Oc(_,v,k),A.return=_,A)}function c(_,v,k,A){return v===null||v.tag!==4||v.stateNode.containerInfo!==k.containerInfo||v.stateNode.implementation!==k.implementation?(v=fg(k,_.mode,A),v.return=_,v):(v=s(v,k.children||[]),v.return=_,v)}function d(_,v,k,A,D){return v===null||v.tag!==7?(v=ka(k,_.mode,A,D),v.return=_,v):(v=s(v,k),v.return=_,v)}function f(_,v,k){if(typeof v=="string"&&v!==""||typeof v=="number")return v=hg(""+v,_.mode,k),v.return=_,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case nh:return k=af(v.type,v.key,v.props,null,_.mode,k),k.ref=Oc(_,null,v),k.return=_,k;case fl:return v=fg(v,_.mode,k),v.return=_,v;case Ji:var A=v._init;return f(_,A(v._payload),k)}if(Xc(v)||Nc(v))return v=ka(v,_.mode,k,null),v.return=_,v;fh(_,v)}return null}function p(_,v,k,A){var D=v!==null?v.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return D!==null?null:a(_,v,""+k,A);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case nh:return k.key===D?l(_,v,k,A):null;case fl:return k.key===D?c(_,v,k,A):null;case Ji:return D=k._init,p(_,v,D(k._payload),A)}if(Xc(k)||Nc(k))return D!==null?null:d(_,v,k,A,null);fh(_,k)}return null}function m(_,v,k,A,D){if(typeof A=="string"&&A!==""||typeof A=="number")return _=_.get(k)||null,a(v,_,""+A,D);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case nh:return _=_.get(A.key===null?k:A.key)||null,l(v,_,A,D);case fl:return _=_.get(A.key===null?k:A.key)||null,c(v,_,A,D);case Ji:var O=A._init;return m(_,v,k,O(A._payload),D)}if(Xc(A)||Nc(A))return _=_.get(k)||null,d(v,_,A,D,null);fh(v,A)}return null}function x(_,v,k,A){for(var D=null,O=null,I=v,E=v=0,S=null;I!==null&&E<k.length;E++){I.index>E?(S=I,I=null):S=I.sibling;var C=p(_,I,k[E],A);if(C===null){I===null&&(I=S);break}t&&I&&C.alternate===null&&e(_,I),v=i(C,v,E),O===null?D=C:O.sibling=C,O=C,I=S}if(E===k.length)return n(_,I),Ut&&aa(_,E),D;if(I===null){for(;E<k.length;E++)I=f(_,k[E],A),I!==null&&(v=i(I,v,E),O===null?D=I:O.sibling=I,O=I);return Ut&&aa(_,E),D}for(I=r(_,I);E<k.length;E++)S=m(I,_,E,k[E],A),S!==null&&(t&&S.alternate!==null&&I.delete(S.key===null?E:S.key),v=i(S,v,E),O===null?D=S:O.sibling=S,O=S);return t&&I.forEach(function(N){return e(_,N)}),Ut&&aa(_,E),D}function w(_,v,k,A){var D=Nc(k);if(typeof D!="function")throw Error(te(150));if(k=D.call(k),k==null)throw Error(te(151));for(var O=D=null,I=v,E=v=0,S=null,C=k.next();I!==null&&!C.done;E++,C=k.next()){I.index>E?(S=I,I=null):S=I.sibling;var N=p(_,I,C.value,A);if(N===null){I===null&&(I=S);break}t&&I&&N.alternate===null&&e(_,I),v=i(N,v,E),O===null?D=N:O.sibling=N,O=N,I=S}if(C.done)return n(_,I),Ut&&aa(_,E),D;if(I===null){for(;!C.done;E++,C=k.next())C=f(_,C.value,A),C!==null&&(v=i(C,v,E),O===null?D=C:O.sibling=C,O=C);return Ut&&aa(_,E),D}for(I=r(_,I);!C.done;E++,C=k.next())C=m(I,_,E,C.value,A),C!==null&&(t&&C.alternate!==null&&I.delete(C.key===null?E:C.key),v=i(C,v,E),O===null?D=C:O.sibling=C,O=C);return t&&I.forEach(function(j){return e(_,j)}),Ut&&aa(_,E),D}function y(_,v,k,A){if(typeof k=="object"&&k!==null&&k.type===pl&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case nh:e:{for(var D=k.key,O=v;O!==null;){if(O.key===D){if(D=k.type,D===pl){if(O.tag===7){n(_,O.sibling),v=s(O,k.props.children),v.return=_,_=v;break e}}else if(O.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Ji&&Y0(D)===O.type){n(_,O.sibling),v=s(O,k.props),v.ref=Oc(_,O,k),v.return=_,_=v;break e}n(_,O);break}else e(_,O);O=O.sibling}k.type===pl?(v=ka(k.props.children,_.mode,A,k.key),v.return=_,_=v):(A=af(k.type,k.key,k.props,null,_.mode,A),A.ref=Oc(_,v,k),A.return=_,_=A)}return o(_);case fl:e:{for(O=k.key;v!==null;){if(v.key===O)if(v.tag===4&&v.stateNode.containerInfo===k.containerInfo&&v.stateNode.implementation===k.implementation){n(_,v.sibling),v=s(v,k.children||[]),v.return=_,_=v;break e}else{n(_,v);break}else e(_,v);v=v.sibling}v=fg(k,_.mode,A),v.return=_,_=v}return o(_);case Ji:return O=k._init,y(_,v,O(k._payload),A)}if(Xc(k))return x(_,v,k,A);if(Nc(k))return w(_,v,k,A);fh(_,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,v!==null&&v.tag===6?(n(_,v.sibling),v=s(v,k),v.return=_,_=v):(n(_,v),v=hg(k,_.mode,A),v.return=_,_=v),o(_)):n(_,v)}return y}var Wl=NS(!0),PS=NS(!1),Of=Ho(null),Lf=null,bl=null,p_=null;function m_(){p_=bl=Lf=null}function g_(t){var e=Of.current;jt(Of),t._currentValue=e}function Ny(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Rl(t,e){Lf=t,p_=bl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(jr=!0),t.firstContext=null)}function ds(t){var e=t._currentValue;if(p_!==t)if(t={context:t,memoizedValue:e,next:null},bl===null){if(Lf===null)throw Error(te(308));bl=t,Lf.dependencies={lanes:0,firstContext:t}}else bl=bl.next=t;return e}var ma=null;function y_(t){ma===null?ma=[t]:ma.push(t)}function jS(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,y_(e)):(n.next=s.next,s.next=n),e.interleaved=n,Oi(t,r)}function Oi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zi=!1;function v_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Pi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Oi(t,n)}return s=r.interleaved,s===null?(e.next=e,y_(r)):(e.next=s.next,s.next=e),r.interleaved=e,Oi(t,n)}function ef(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,r_(t,n)}}function Q0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ff(t,e,n,r){var s=t.updateQueue;Zi=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;o=0,d=c=l=null,a=i;do{var p=a.lane,m=a.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=t,w=a;switch(p=e,m=n,w.tag){case 1:if(x=w.payload,typeof x=="function"){f=x.call(m,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,p=typeof x=="function"?x.call(m,f,p):x,p==null)break e;f=Gt({},f,p);break e;case 2:Zi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=m,l=f):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(l=f),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ja|=o,t.lanes=o,t.memoizedState=f}}function X0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(te(191,s));s.call(r)}}}var kd={},ti=Ho(kd),Yu=Ho(kd),Qu=Ho(kd);function ga(t){if(t===kd)throw Error(te(174));return t}function __(t,e){switch(It(Qu,e),It(Yu,t),It(ti,kd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dy(e,t)}jt(ti),It(ti,e)}function Hl(){jt(ti),jt(Yu),jt(Qu)}function MS(t){ga(Qu.current);var e=ga(ti.current),n=dy(e,t.type);e!==n&&(It(Yu,t),It(ti,n))}function x_(t){Yu.current===t&&(jt(ti),jt(Yu))}var Wt=Ho(0);function Vf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var og=[];function w_(){for(var t=0;t<og.length;t++)og[t]._workInProgressVersionPrimary=null;og.length=0}var tf=$i.ReactCurrentDispatcher,ag=$i.ReactCurrentBatchConfig,Pa=0,qt=null,bn=null,An=null,Uf=!1,gu=!1,Xu=0,Kj=0;function Yn(){throw Error(te(321))}function b_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ns(t[n],e[n]))return!1;return!0}function E_(t,e,n,r,s,i){if(Pa=i,qt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,tf.current=t===null||t.memoizedState===null?Jj:Zj,t=n(r,s),gu){i=0;do{if(gu=!1,Xu=0,25<=i)throw Error(te(301));i+=1,An=bn=null,e.updateQueue=null,tf.current=eD,t=n(r,s)}while(gu)}if(tf.current=Bf,e=bn!==null&&bn.next!==null,Pa=0,An=bn=qt=null,Uf=!1,e)throw Error(te(300));return t}function k_(){var t=Xu!==0;return Xu=0,t}function qs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return An===null?qt.memoizedState=An=t:An=An.next=t,An}function hs(){if(bn===null){var t=qt.alternate;t=t!==null?t.memoizedState:null}else t=bn.next;var e=An===null?qt.memoizedState:An.next;if(e!==null)An=e,bn=t;else{if(t===null)throw Error(te(310));bn=t,t={memoizedState:bn.memoizedState,baseState:bn.baseState,baseQueue:bn.baseQueue,queue:bn.queue,next:null},An===null?qt.memoizedState=An=t:An=An.next=t}return An}function Ju(t,e){return typeof e=="function"?e(t):e}function lg(t){var e=hs(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=bn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var d=c.lane;if((Pa&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,qt.lanes|=d,ja|=d}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Ns(r,e.memoizedState)||(jr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,qt.lanes|=i,ja|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cg(t){var e=hs(),n=e.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ns(i,e.memoizedState)||(jr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function OS(){}function LS(t,e){var n=qt,r=hs(),s=e(),i=!Ns(r.memoizedState,s);if(i&&(r.memoizedState=s,jr=!0),r=r.queue,T_(US.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||An!==null&&An.memoizedState.tag&1){if(n.flags|=2048,Zu(9,VS.bind(null,n,r,s,e),void 0,null),Nn===null)throw Error(te(349));Pa&30||FS(n,e,s)}return s}function FS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=qt.updateQueue,e===null?(e={lastEffect:null,stores:null},qt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function VS(t,e,n,r){e.value=n,e.getSnapshot=r,BS(e)&&zS(t)}function US(t,e,n){return n(function(){BS(e)&&zS(t)})}function BS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ns(t,n)}catch{return!0}}function zS(t){var e=Oi(t,1);e!==null&&As(e,t,1,-1)}function J0(t){var e=qs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ju,lastRenderedState:t},e.queue=t,t=t.dispatch=Xj.bind(null,qt,t),[e.memoizedState,t]}function Zu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=qt.updateQueue,e===null?(e={lastEffect:null,stores:null},qt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function $S(){return hs().memoizedState}function nf(t,e,n,r){var s=qs();qt.flags|=t,s.memoizedState=Zu(1|e,n,void 0,r===void 0?null:r)}function Fp(t,e,n,r){var s=hs();r=r===void 0?null:r;var i=void 0;if(bn!==null){var o=bn.memoizedState;if(i=o.destroy,r!==null&&b_(r,o.deps)){s.memoizedState=Zu(e,n,i,r);return}}qt.flags|=t,s.memoizedState=Zu(1|e,n,i,r)}function Z0(t,e){return nf(8390656,8,t,e)}function T_(t,e){return Fp(2048,8,t,e)}function WS(t,e){return Fp(4,2,t,e)}function HS(t,e){return Fp(4,4,t,e)}function qS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function GS(t,e,n){return n=n!=null?n.concat([t]):null,Fp(4,4,qS.bind(null,e,t),n)}function S_(){}function KS(t,e){var n=hs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&b_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function YS(t,e){var n=hs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&b_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function QS(t,e,n){return Pa&21?(Ns(n,e)||(n=tS(),qt.lanes|=n,ja|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,jr=!0),t.memoizedState=n)}function Yj(t,e){var n=mt;mt=n!==0&&4>n?n:4,t(!0);var r=ag.transition;ag.transition={};try{t(!1),e()}finally{mt=n,ag.transition=r}}function XS(){return hs().memoizedState}function Qj(t,e,n){var r=Eo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},JS(t))ZS(e,n);else if(n=jS(t,e,n,r),n!==null){var s=gr();As(n,t,r,s),eI(n,e,r)}}function Xj(t,e,n){var r=Eo(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(JS(t))ZS(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ns(a,o)){var l=e.interleaved;l===null?(s.next=s,y_(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=jS(t,e,s,r),n!==null&&(s=gr(),As(n,t,r,s),eI(n,e,r))}}function JS(t){var e=t.alternate;return t===qt||e!==null&&e===qt}function ZS(t,e){gu=Uf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,r_(t,n)}}var Bf={readContext:ds,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useInsertionEffect:Yn,useLayoutEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useMutableSource:Yn,useSyncExternalStore:Yn,useId:Yn,unstable_isNewReconciler:!1},Jj={readContext:ds,useCallback:function(t,e){return qs().memoizedState=[t,e===void 0?null:e],t},useContext:ds,useEffect:Z0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,nf(4194308,4,qS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return nf(4194308,4,t,e)},useInsertionEffect:function(t,e){return nf(4,2,t,e)},useMemo:function(t,e){var n=qs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=qs();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Qj.bind(null,qt,t),[r.memoizedState,t]},useRef:function(t){var e=qs();return t={current:t},e.memoizedState=t},useState:J0,useDebugValue:S_,useDeferredValue:function(t){return qs().memoizedState=t},useTransition:function(){var t=J0(!1),e=t[0];return t=Yj.bind(null,t[1]),qs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=qt,s=qs();if(Ut){if(n===void 0)throw Error(te(407));n=n()}else{if(n=e(),Nn===null)throw Error(te(349));Pa&30||FS(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Z0(US.bind(null,r,i,t),[t]),r.flags|=2048,Zu(9,VS.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=qs(),e=Nn.identifierPrefix;if(Ut){var n=Ai,r=Ci;n=(r&~(1<<32-Cs(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Xu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Kj++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Zj={readContext:ds,useCallback:KS,useContext:ds,useEffect:T_,useImperativeHandle:GS,useInsertionEffect:WS,useLayoutEffect:HS,useMemo:YS,useReducer:lg,useRef:$S,useState:function(){return lg(Ju)},useDebugValue:S_,useDeferredValue:function(t){var e=hs();return QS(e,bn.memoizedState,t)},useTransition:function(){var t=lg(Ju)[0],e=hs().memoizedState;return[t,e]},useMutableSource:OS,useSyncExternalStore:LS,useId:XS,unstable_isNewReconciler:!1},eD={readContext:ds,useCallback:KS,useContext:ds,useEffect:T_,useImperativeHandle:GS,useInsertionEffect:WS,useLayoutEffect:HS,useMemo:YS,useReducer:cg,useRef:$S,useState:function(){return cg(Ju)},useDebugValue:S_,useDeferredValue:function(t){var e=hs();return bn===null?e.memoizedState=t:QS(e,bn.memoizedState,t)},useTransition:function(){var t=cg(Ju)[0],e=hs().memoizedState;return[t,e]},useMutableSource:OS,useSyncExternalStore:LS,useId:XS,unstable_isNewReconciler:!1};function Es(t,e){if(t&&t.defaultProps){e=Gt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Py(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Gt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Vp={isMounted:function(t){return(t=t._reactInternals)?Wa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=gr(),s=Eo(t),i=Pi(r,s);i.payload=e,n!=null&&(i.callback=n),e=wo(t,i,s),e!==null&&(As(e,t,s,r),ef(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=gr(),s=Eo(t),i=Pi(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=wo(t,i,s),e!==null&&(As(e,t,s,r),ef(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=gr(),r=Eo(t),s=Pi(n,r);s.tag=2,e!=null&&(s.callback=e),e=wo(t,s,r),e!==null&&(As(e,t,r,n),ef(e,t,r))}};function eb(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Hu(n,r)||!Hu(s,i):!0}function tI(t,e,n){var r=!1,s=jo,i=e.contextType;return typeof i=="object"&&i!==null?i=ds(i):(s=Lr(e)?Ra:ar.current,r=e.contextTypes,i=(r=r!=null)?zl(t,s):jo),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Vp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function tb(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Vp.enqueueReplaceState(e,e.state,null)}function jy(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},v_(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ds(i):(i=Lr(e)?Ra:ar.current,s.context=zl(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Py(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Vp.enqueueReplaceState(s,s.state,null),Ff(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ql(t,e){try{var n="",r=e;do n+=C2(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function ug(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dy(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tD=typeof WeakMap=="function"?WeakMap:Map;function nI(t,e,n){n=Pi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$f||($f=!0,Wy=r),Dy(t,e)},n}function rI(t,e,n){n=Pi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Dy(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Dy(t,e),typeof r!="function"&&(bo===null?bo=new Set([this]):bo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function nb(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new tD;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=mD.bind(null,t,e,n),e.then(t,t))}function rb(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sb(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Pi(-1,1),e.tag=2,wo(n,e,1))),n.lanes|=1),t)}var nD=$i.ReactCurrentOwner,jr=!1;function hr(t,e,n,r){e.child=t===null?PS(e,null,n,r):Wl(e,t.child,n,r)}function ib(t,e,n,r,s){n=n.render;var i=e.ref;return Rl(e,s),r=E_(t,e,n,r,i,s),n=k_(),t!==null&&!jr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Li(t,e,s)):(Ut&&n&&d_(e),e.flags|=1,hr(t,e,r,s),e.child)}function ob(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!D_(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,sI(t,e,i,r,s)):(t=af(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Hu,n(o,r)&&t.ref===e.ref)return Li(t,e,s)}return e.flags|=1,t=ko(i,r),t.ref=e.ref,t.return=e,e.child=t}function sI(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Hu(i,r)&&t.ref===e.ref)if(jr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(jr=!0);else return e.lanes=t.lanes,Li(t,e,s)}return My(t,e,n,r,s)}function iI(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(kl,qr),qr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,It(kl,qr),qr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,It(kl,qr),qr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,It(kl,qr),qr|=r;return hr(t,e,s,n),e.child}function oI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function My(t,e,n,r,s){var i=Lr(n)?Ra:ar.current;return i=zl(e,i),Rl(e,s),n=E_(t,e,n,r,i,s),r=k_(),t!==null&&!jr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Li(t,e,s)):(Ut&&r&&d_(e),e.flags|=1,hr(t,e,n,s),e.child)}function ab(t,e,n,r,s){if(Lr(n)){var i=!0;jf(e)}else i=!1;if(Rl(e,s),e.stateNode===null)rf(t,e),tI(e,n,r),jy(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=ds(c):(c=Lr(n)?Ra:ar.current,c=zl(e,c));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&tb(e,o,r,c),Zi=!1;var p=e.memoizedState;o.state=p,Ff(e,r,o,s),l=e.memoizedState,a!==r||p!==l||Or.current||Zi?(typeof d=="function"&&(Py(e,n,d,r),l=e.memoizedState),(a=Zi||eb(e,n,a,r,p,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,DS(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Es(e.type,a),o.props=c,f=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=ds(l):(l=Lr(n)?Ra:ar.current,l=zl(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&tb(e,o,r,l),Zi=!1,p=e.memoizedState,o.state=p,Ff(e,r,o,s);var x=e.memoizedState;a!==f||p!==x||Or.current||Zi?(typeof m=="function"&&(Py(e,n,m,r),x=e.memoizedState),(c=Zi||eb(e,n,c,r,p,x,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Oy(t,e,n,r,i,s)}function Oy(t,e,n,r,s,i){oI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&q0(e,n,!1),Li(t,e,i);r=e.stateNode,nD.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Wl(e,t.child,null,i),e.child=Wl(e,null,a,i)):hr(t,e,a,i),e.memoizedState=r.state,s&&q0(e,n,!0),e.child}function aI(t){var e=t.stateNode;e.pendingContext?H0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H0(t,e.context,!1),__(t,e.containerInfo)}function lb(t,e,n,r,s){return $l(),f_(s),e.flags|=256,hr(t,e,n,r),e.child}var Ly={dehydrated:null,treeContext:null,retryLane:0};function Fy(t){return{baseLanes:t,cachePool:null,transitions:null}}function lI(t,e,n){var r=e.pendingProps,s=Wt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),It(Wt,s&1),t===null)return Ry(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=zp(o,r,0,null),t=ka(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Fy(n),e.memoizedState=Ly,t):I_(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return rD(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ko(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ko(a,i):(i=ka(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Fy(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Ly,r}return i=t.child,t=i.sibling,r=ko(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function I_(t,e){return e=zp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ph(t,e,n,r){return r!==null&&f_(r),Wl(e,t.child,null,n),t=I_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rD(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=ug(Error(te(422))),ph(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=zp({mode:"visible",children:r.children},s,0,null),i=ka(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Wl(e,t.child,null,o),e.child.memoizedState=Fy(o),e.memoizedState=Ly,i);if(!(e.mode&1))return ph(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(te(419)),r=ug(i,r,void 0),ph(t,e,o,r)}if(a=(o&t.childLanes)!==0,jr||a){if(r=Nn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Oi(t,s),As(r,t,s,-1))}return j_(),r=ug(Error(te(421))),ph(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=gD.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Kr=xo(s.nextSibling),Xr=e,Ut=!0,Ss=null,t!==null&&(as[ls++]=Ci,as[ls++]=Ai,as[ls++]=Na,Ci=t.id,Ai=t.overflow,Na=e),e=I_(e,r.children),e.flags|=4096,e)}function cb(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ny(t.return,e,n)}function dg(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function cI(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(hr(t,e,r.children,n),r=Wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&cb(t,n,e);else if(t.tag===19)cb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(It(Wt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Vf(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),dg(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Vf(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}dg(e,!0,n,null,i);break;case"together":dg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function rf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Li(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ja|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(te(153));if(e.child!==null){for(t=e.child,n=ko(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ko(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function sD(t,e,n){switch(e.tag){case 3:aI(e),$l();break;case 5:MS(e);break;case 1:Lr(e.type)&&jf(e);break;case 4:__(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;It(Of,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(It(Wt,Wt.current&1),e.flags|=128,null):n&e.child.childLanes?lI(t,e,n):(It(Wt,Wt.current&1),t=Li(t,e,n),t!==null?t.sibling:null);It(Wt,Wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return cI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),It(Wt,Wt.current),r)break;return null;case 22:case 23:return e.lanes=0,iI(t,e,n)}return Li(t,e,n)}var uI,Vy,dI,hI;uI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vy=function(){};dI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ga(ti.current);var i=null;switch(n){case"input":s=ay(t,s),r=ay(t,r),i=[];break;case"select":s=Gt({},s,{value:void 0}),r=Gt({},r,{value:void 0}),i=[];break;case"textarea":s=uy(t,s),r=uy(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Nf)}hy(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fu.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Fu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Rt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};hI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Lc(t,e){if(!Ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function iD(t,e,n){var r=e.pendingProps;switch(h_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(e),null;case 1:return Lr(e.type)&&Pf(),Qn(e),null;case 3:return r=e.stateNode,Hl(),jt(Or),jt(ar),w_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ss!==null&&(Gy(Ss),Ss=null))),Vy(t,e),Qn(e),null;case 5:x_(e);var s=ga(Qu.current);if(n=e.type,t!==null&&e.stateNode!=null)dI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(te(166));return Qn(e),null}if(t=ga(ti.current),hh(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ys]=e,r[Ku]=i,t=(e.mode&1)!==0,n){case"dialog":Rt("cancel",r),Rt("close",r);break;case"iframe":case"object":case"embed":Rt("load",r);break;case"video":case"audio":for(s=0;s<Zc.length;s++)Rt(Zc[s],r);break;case"source":Rt("error",r);break;case"img":case"image":case"link":Rt("error",r),Rt("load",r);break;case"details":Rt("toggle",r);break;case"input":v0(r,i),Rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Rt("invalid",r);break;case"textarea":x0(r,i),Rt("invalid",r)}hy(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&dh(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&dh(r.textContent,a,t),s=["children",""+a]):Fu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Rt("scroll",r)}switch(n){case"input":rh(r),_0(r,i,!0);break;case"textarea":rh(r),w0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Nf)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=UT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ys]=e,t[Ku]=r,uI(t,e,!1,!1),e.stateNode=t;e:{switch(o=fy(n,r),n){case"dialog":Rt("cancel",t),Rt("close",t),s=r;break;case"iframe":case"object":case"embed":Rt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Zc.length;s++)Rt(Zc[s],t);s=r;break;case"source":Rt("error",t),s=r;break;case"img":case"image":case"link":Rt("error",t),Rt("load",t),s=r;break;case"details":Rt("toggle",t),s=r;break;case"input":v0(t,r),s=ay(t,r),Rt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Gt({},r,{value:void 0}),Rt("invalid",t);break;case"textarea":x0(t,r),s=uy(t,r),Rt("invalid",t);break;default:s=r}hy(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?$T(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&BT(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Vu(t,l):typeof l=="number"&&Vu(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Rt("scroll",t):l!=null&&Xv(t,i,l,o))}switch(n){case"input":rh(t),_0(t,r,!1);break;case"textarea":rh(t),w0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Po(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Sl(t,!!r.multiple,i,!1):r.defaultValue!=null&&Sl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Nf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qn(e),null;case 6:if(t&&e.stateNode!=null)hI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(te(166));if(n=ga(Qu.current),ga(ti.current),hh(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ys]=e,(i=r.nodeValue!==n)&&(t=Xr,t!==null))switch(t.tag){case 3:dh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dh(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ys]=e,e.stateNode=r}return Qn(e),null;case 13:if(jt(Wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ut&&Kr!==null&&e.mode&1&&!(e.flags&128))RS(),$l(),e.flags|=98560,i=!1;else if(i=hh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(te(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(te(317));i[Ys]=e}else $l(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qn(e),i=!1}else Ss!==null&&(Gy(Ss),Ss=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Wt.current&1?kn===0&&(kn=3):j_())),e.updateQueue!==null&&(e.flags|=4),Qn(e),null);case 4:return Hl(),Vy(t,e),t===null&&qu(e.stateNode.containerInfo),Qn(e),null;case 10:return g_(e.type._context),Qn(e),null;case 17:return Lr(e.type)&&Pf(),Qn(e),null;case 19:if(jt(Wt),i=e.memoizedState,i===null)return Qn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Lc(i,!1);else{if(kn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Vf(t),o!==null){for(e.flags|=128,Lc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return It(Wt,Wt.current&1|2),e.child}t=t.sibling}i.tail!==null&&sn()>Gl&&(e.flags|=128,r=!0,Lc(i,!1),e.lanes=4194304)}else{if(!r)if(t=Vf(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Lc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ut)return Qn(e),null}else 2*sn()-i.renderingStartTime>Gl&&n!==1073741824&&(e.flags|=128,r=!0,Lc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=sn(),e.sibling=null,n=Wt.current,It(Wt,r?n&1|2:n&1),e):(Qn(e),null);case 22:case 23:return P_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?qr&1073741824&&(Qn(e),e.subtreeFlags&6&&(e.flags|=8192)):Qn(e),null;case 24:return null;case 25:return null}throw Error(te(156,e.tag))}function oD(t,e){switch(h_(e),e.tag){case 1:return Lr(e.type)&&Pf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Hl(),jt(Or),jt(ar),w_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return x_(e),null;case 13:if(jt(Wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(te(340));$l()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return jt(Wt),null;case 4:return Hl(),null;case 10:return g_(e.type._context),null;case 22:case 23:return P_(),null;case 24:return null;default:return null}}var mh=!1,er=!1,aD=typeof WeakSet=="function"?WeakSet:Set,me=null;function El(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xt(t,e,r)}else n.current=null}function Uy(t,e,n){try{n()}catch(r){Xt(t,e,r)}}var ub=!1;function lD(t,e){if(Ey=Cf,t=yS(),u_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,f=t,p=null;t:for(;;){for(var m;f!==n||s!==0&&f.nodeType!==3||(a=o+s),f!==i||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===t)break t;if(p===n&&++c===s&&(a=o),p===i&&++d===r&&(l=o),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ky={focusedElem:t,selectionRange:n},Cf=!1,me=e;me!==null;)if(e=me,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,me=t;else for(;me!==null;){e=me;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,y=x.memoizedState,_=e.stateNode,v=_.getSnapshotBeforeUpdate(e.elementType===e.type?w:Es(e.type,w),y);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(A){Xt(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}return x=ub,ub=!1,x}function yu(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Uy(e,n,i)}s=s.next}while(s!==r)}}function Up(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function By(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function fI(t){var e=t.alternate;e!==null&&(t.alternate=null,fI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ys],delete e[Ku],delete e[Iy],delete e[Wj],delete e[Hj])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function pI(t){return t.tag===5||t.tag===3||t.tag===4}function db(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||pI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zy(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Nf));else if(r!==4&&(t=t.child,t!==null))for(zy(t,e,n),t=t.sibling;t!==null;)zy(t,e,n),t=t.sibling}function $y(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($y(t,e,n),t=t.sibling;t!==null;)$y(t,e,n),t=t.sibling}var Ln=null,ks=!1;function Ki(t,e,n){for(n=n.child;n!==null;)mI(t,e,n),n=n.sibling}function mI(t,e,n){if(ei&&typeof ei.onCommitFiberUnmount=="function")try{ei.onCommitFiberUnmount(Pp,n)}catch{}switch(n.tag){case 5:er||El(n,e);case 6:var r=Ln,s=ks;Ln=null,Ki(t,e,n),Ln=r,ks=s,Ln!==null&&(ks?(t=Ln,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ln.removeChild(n.stateNode));break;case 18:Ln!==null&&(ks?(t=Ln,n=n.stateNode,t.nodeType===8?sg(t.parentNode,n):t.nodeType===1&&sg(t,n),$u(t)):sg(Ln,n.stateNode));break;case 4:r=Ln,s=ks,Ln=n.stateNode.containerInfo,ks=!0,Ki(t,e,n),Ln=r,ks=s;break;case 0:case 11:case 14:case 15:if(!er&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Uy(n,e,o),s=s.next}while(s!==r)}Ki(t,e,n);break;case 1:if(!er&&(El(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Xt(n,e,a)}Ki(t,e,n);break;case 21:Ki(t,e,n);break;case 22:n.mode&1?(er=(r=er)||n.memoizedState!==null,Ki(t,e,n),er=r):Ki(t,e,n);break;default:Ki(t,e,n)}}function hb(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new aD),e.forEach(function(r){var s=yD.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function bs(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ln=a.stateNode,ks=!1;break e;case 3:Ln=a.stateNode.containerInfo,ks=!0;break e;case 4:Ln=a.stateNode.containerInfo,ks=!0;break e}a=a.return}if(Ln===null)throw Error(te(160));mI(i,o,s),Ln=null,ks=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Xt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gI(e,t),e=e.sibling}function gI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bs(e,t),zs(t),r&4){try{yu(3,t,t.return),Up(3,t)}catch(w){Xt(t,t.return,w)}try{yu(5,t,t.return)}catch(w){Xt(t,t.return,w)}}break;case 1:bs(e,t),zs(t),r&512&&n!==null&&El(n,n.return);break;case 5:if(bs(e,t),zs(t),r&512&&n!==null&&El(n,n.return),t.flags&32){var s=t.stateNode;try{Vu(s,"")}catch(w){Xt(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&FT(s,i),fy(a,o);var c=fy(a,i);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?$T(s,f):d==="dangerouslySetInnerHTML"?BT(s,f):d==="children"?Vu(s,f):Xv(s,d,f,c)}switch(a){case"input":ly(s,i);break;case"textarea":VT(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Sl(s,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?Sl(s,!!i.multiple,i.defaultValue,!0):Sl(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ku]=i}catch(w){Xt(t,t.return,w)}}break;case 6:if(bs(e,t),zs(t),r&4){if(t.stateNode===null)throw Error(te(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){Xt(t,t.return,w)}}break;case 3:if(bs(e,t),zs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$u(e.containerInfo)}catch(w){Xt(t,t.return,w)}break;case 4:bs(e,t),zs(t);break;case 13:bs(e,t),zs(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(R_=sn())),r&4&&hb(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(er=(c=er)||d,bs(e,t),er=c):bs(e,t),zs(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(me=t,d=t.child;d!==null;){for(f=me=d;me!==null;){switch(p=me,m=p.child,p.tag){case 0:case 11:case 14:case 15:yu(4,p,p.return);break;case 1:El(p,p.return);var x=p.stateNode;if(typeof x.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(w){Xt(r,n,w)}}break;case 5:El(p,p.return);break;case 22:if(p.memoizedState!==null){pb(f);continue}}m!==null?(m.return=p,me=m):pb(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=zT("display",o))}catch(w){Xt(t,t.return,w)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(w){Xt(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:bs(e,t),zs(t),r&4&&hb(t);break;case 21:break;default:bs(e,t),zs(t)}}function zs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(pI(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Vu(s,""),r.flags&=-33);var i=db(t);$y(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=db(t);zy(t,a,o);break;default:throw Error(te(161))}}catch(l){Xt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function cD(t,e,n){me=t,yI(t)}function yI(t,e,n){for(var r=(t.mode&1)!==0;me!==null;){var s=me,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||mh;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||er;a=mh;var c=er;if(mh=o,(er=l)&&!c)for(me=s;me!==null;)o=me,l=o.child,o.tag===22&&o.memoizedState!==null?mb(s):l!==null?(l.return=o,me=l):mb(s);for(;i!==null;)me=i,yI(i),i=i.sibling;me=s,mh=a,er=c}fb(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,me=i):fb(t)}}function fb(t){for(;me!==null;){var e=me;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:er||Up(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!er)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Es(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&X0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}X0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&$u(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}er||e.flags&512&&By(e)}catch(p){Xt(e,e.return,p)}}if(e===t){me=null;break}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}}function pb(t){for(;me!==null;){var e=me;if(e===t){me=null;break}var n=e.sibling;if(n!==null){n.return=e.return,me=n;break}me=e.return}}function mb(t){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Up(4,e)}catch(l){Xt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Xt(e,s,l)}}var i=e.return;try{By(e)}catch(l){Xt(e,i,l)}break;case 5:var o=e.return;try{By(e)}catch(l){Xt(e,o,l)}}}catch(l){Xt(e,e.return,l)}if(e===t){me=null;break}var a=e.sibling;if(a!==null){a.return=e.return,me=a;break}me=e.return}}var uD=Math.ceil,zf=$i.ReactCurrentDispatcher,C_=$i.ReactCurrentOwner,us=$i.ReactCurrentBatchConfig,Xe=0,Nn=null,gn=null,Bn=0,qr=0,kl=Ho(0),kn=0,ed=null,ja=0,Bp=0,A_=0,vu=null,Rr=null,R_=0,Gl=1/0,ki=null,$f=!1,Wy=null,bo=null,gh=!1,co=null,Wf=0,_u=0,Hy=null,sf=-1,of=0;function gr(){return Xe&6?sn():sf!==-1?sf:sf=sn()}function Eo(t){return t.mode&1?Xe&2&&Bn!==0?Bn&-Bn:Gj.transition!==null?(of===0&&(of=tS()),of):(t=mt,t!==0||(t=window.event,t=t===void 0?16:lS(t.type)),t):1}function As(t,e,n,r){if(50<_u)throw _u=0,Hy=null,Error(te(185));wd(t,n,r),(!(Xe&2)||t!==Nn)&&(t===Nn&&(!(Xe&2)&&(Bp|=n),kn===4&&to(t,Bn)),Fr(t,r),n===1&&Xe===0&&!(e.mode&1)&&(Gl=sn()+500,Lp&&qo()))}function Fr(t,e){var n=t.callbackNode;G2(t,e);var r=If(t,t===Nn?Bn:0);if(r===0)n!==null&&k0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&k0(n),e===1)t.tag===0?qj(gb.bind(null,t)):IS(gb.bind(null,t)),zj(function(){!(Xe&6)&&qo()}),n=null;else{switch(nS(r)){case 1:n=n_;break;case 4:n=ZT;break;case 16:n=Sf;break;case 536870912:n=eS;break;default:n=Sf}n=TI(n,vI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function vI(t,e){if(sf=-1,of=0,Xe&6)throw Error(te(327));var n=t.callbackNode;if(Nl()&&t.callbackNode!==n)return null;var r=If(t,t===Nn?Bn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hf(t,r);else{e=r;var s=Xe;Xe|=2;var i=xI();(Nn!==t||Bn!==e)&&(ki=null,Gl=sn()+500,Ea(t,e));do try{fD();break}catch(a){_I(t,a)}while(!0);m_(),zf.current=i,Xe=s,gn!==null?e=0:(Nn=null,Bn=0,e=kn)}if(e!==0){if(e===2&&(s=vy(t),s!==0&&(r=s,e=qy(t,s))),e===1)throw n=ed,Ea(t,0),to(t,r),Fr(t,sn()),n;if(e===6)to(t,r);else{if(s=t.current.alternate,!(r&30)&&!dD(s)&&(e=Hf(t,r),e===2&&(i=vy(t),i!==0&&(r=i,e=qy(t,i))),e===1))throw n=ed,Ea(t,0),to(t,r),Fr(t,sn()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(te(345));case 2:la(t,Rr,ki);break;case 3:if(to(t,r),(r&130023424)===r&&(e=R_+500-sn(),10<e)){if(If(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){gr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Sy(la.bind(null,t,Rr,ki),e);break}la(t,Rr,ki);break;case 4:if(to(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Cs(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=sn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uD(r/1960))-r,10<r){t.timeoutHandle=Sy(la.bind(null,t,Rr,ki),r);break}la(t,Rr,ki);break;case 5:la(t,Rr,ki);break;default:throw Error(te(329))}}}return Fr(t,sn()),t.callbackNode===n?vI.bind(null,t):null}function qy(t,e){var n=vu;return t.current.memoizedState.isDehydrated&&(Ea(t,e).flags|=256),t=Hf(t,e),t!==2&&(e=Rr,Rr=n,e!==null&&Gy(e)),t}function Gy(t){Rr===null?Rr=t:Rr.push.apply(Rr,t)}function dD(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ns(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function to(t,e){for(e&=~A_,e&=~Bp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Cs(e),r=1<<n;t[n]=-1,e&=~r}}function gb(t){if(Xe&6)throw Error(te(327));Nl();var e=If(t,0);if(!(e&1))return Fr(t,sn()),null;var n=Hf(t,e);if(t.tag!==0&&n===2){var r=vy(t);r!==0&&(e=r,n=qy(t,r))}if(n===1)throw n=ed,Ea(t,0),to(t,e),Fr(t,sn()),n;if(n===6)throw Error(te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,la(t,Rr,ki),Fr(t,sn()),null}function N_(t,e){var n=Xe;Xe|=1;try{return t(e)}finally{Xe=n,Xe===0&&(Gl=sn()+500,Lp&&qo())}}function Da(t){co!==null&&co.tag===0&&!(Xe&6)&&Nl();var e=Xe;Xe|=1;var n=us.transition,r=mt;try{if(us.transition=null,mt=1,t)return t()}finally{mt=r,us.transition=n,Xe=e,!(Xe&6)&&qo()}}function P_(){qr=kl.current,jt(kl)}function Ea(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Bj(n)),gn!==null)for(n=gn.return;n!==null;){var r=n;switch(h_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pf();break;case 3:Hl(),jt(Or),jt(ar),w_();break;case 5:x_(r);break;case 4:Hl();break;case 13:jt(Wt);break;case 19:jt(Wt);break;case 10:g_(r.type._context);break;case 22:case 23:P_()}n=n.return}if(Nn=t,gn=t=ko(t.current,null),Bn=qr=e,kn=0,ed=null,A_=Bp=ja=0,Rr=vu=null,ma!==null){for(e=0;e<ma.length;e++)if(n=ma[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ma=null}return t}function _I(t,e){do{var n=gn;try{if(m_(),tf.current=Bf,Uf){for(var r=qt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Uf=!1}if(Pa=0,An=bn=qt=null,gu=!1,Xu=0,C_.current=null,n===null||n.return===null){kn=1,ed=e,gn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=Bn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=rb(o);if(m!==null){m.flags&=-257,sb(m,o,a,i,e),m.mode&1&&nb(i,c,e),e=m,l=c;var x=e.updateQueue;if(x===null){var w=new Set;w.add(l),e.updateQueue=w}else x.add(l);break e}else{if(!(e&1)){nb(i,c,e),j_();break e}l=Error(te(426))}}else if(Ut&&a.mode&1){var y=rb(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),sb(y,o,a,i,e),f_(ql(l,a));break e}}i=l=ql(l,a),kn!==4&&(kn=2),vu===null?vu=[i]:vu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=nI(i,l,e);Q0(i,_);break e;case 1:a=l;var v=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(bo===null||!bo.has(k)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=rI(i,a,e);Q0(i,A);break e}}i=i.return}while(i!==null)}bI(n)}catch(D){e=D,gn===n&&n!==null&&(gn=n=n.return);continue}break}while(!0)}function xI(){var t=zf.current;return zf.current=Bf,t===null?Bf:t}function j_(){(kn===0||kn===3||kn===2)&&(kn=4),Nn===null||!(ja&268435455)&&!(Bp&268435455)||to(Nn,Bn)}function Hf(t,e){var n=Xe;Xe|=2;var r=xI();(Nn!==t||Bn!==e)&&(ki=null,Ea(t,e));do try{hD();break}catch(s){_I(t,s)}while(!0);if(m_(),Xe=n,zf.current=r,gn!==null)throw Error(te(261));return Nn=null,Bn=0,kn}function hD(){for(;gn!==null;)wI(gn)}function fD(){for(;gn!==null&&!F2();)wI(gn)}function wI(t){var e=kI(t.alternate,t,qr);t.memoizedProps=t.pendingProps,e===null?bI(t):gn=e,C_.current=null}function bI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=oD(n,e),n!==null){n.flags&=32767,gn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{kn=6,gn=null;return}}else if(n=iD(n,e,qr),n!==null){gn=n;return}if(e=e.sibling,e!==null){gn=e;return}gn=e=t}while(e!==null);kn===0&&(kn=5)}function la(t,e,n){var r=mt,s=us.transition;try{us.transition=null,mt=1,pD(t,e,n,r)}finally{us.transition=s,mt=r}return null}function pD(t,e,n,r){do Nl();while(co!==null);if(Xe&6)throw Error(te(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(te(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(K2(t,i),t===Nn&&(gn=Nn=null,Bn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gh||(gh=!0,TI(Sf,function(){return Nl(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=us.transition,us.transition=null;var o=mt;mt=1;var a=Xe;Xe|=4,C_.current=null,lD(t,n),gI(n,t),Dj(ky),Cf=!!Ey,ky=Ey=null,t.current=n,cD(n),V2(),Xe=a,mt=o,us.transition=i}else t.current=n;if(gh&&(gh=!1,co=t,Wf=s),i=t.pendingLanes,i===0&&(bo=null),z2(n.stateNode),Fr(t,sn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if($f)throw $f=!1,t=Wy,Wy=null,t;return Wf&1&&t.tag!==0&&Nl(),i=t.pendingLanes,i&1?t===Hy?_u++:(_u=0,Hy=t):_u=0,qo(),null}function Nl(){if(co!==null){var t=nS(Wf),e=us.transition,n=mt;try{if(us.transition=null,mt=16>t?16:t,co===null)var r=!1;else{if(t=co,co=null,Wf=0,Xe&6)throw Error(te(331));var s=Xe;for(Xe|=4,me=t.current;me!==null;){var i=me,o=i.child;if(me.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(me=c;me!==null;){var d=me;switch(d.tag){case 0:case 11:case 15:yu(8,d,i)}var f=d.child;if(f!==null)f.return=d,me=f;else for(;me!==null;){d=me;var p=d.sibling,m=d.return;if(fI(d),d===c){me=null;break}if(p!==null){p.return=m,me=p;break}me=m}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var y=w.sibling;w.sibling=null,w=y}while(w!==null)}}me=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,me=o;else e:for(;me!==null;){if(i=me,i.flags&2048)switch(i.tag){case 0:case 11:case 15:yu(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,me=_;break e}me=i.return}}var v=t.current;for(me=v;me!==null;){o=me;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,me=k;else e:for(o=v;me!==null;){if(a=me,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Up(9,a)}}catch(D){Xt(a,a.return,D)}if(a===o){me=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,me=A;break e}me=a.return}}if(Xe=s,qo(),ei&&typeof ei.onPostCommitFiberRoot=="function")try{ei.onPostCommitFiberRoot(Pp,t)}catch{}r=!0}return r}finally{mt=n,us.transition=e}}return!1}function yb(t,e,n){e=ql(n,e),e=nI(t,e,1),t=wo(t,e,1),e=gr(),t!==null&&(wd(t,1,e),Fr(t,e))}function Xt(t,e,n){if(t.tag===3)yb(t,t,n);else for(;e!==null;){if(e.tag===3){yb(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(bo===null||!bo.has(r))){t=ql(n,t),t=rI(e,t,1),e=wo(e,t,1),t=gr(),e!==null&&(wd(e,1,t),Fr(e,t));break}}e=e.return}}function mD(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=gr(),t.pingedLanes|=t.suspendedLanes&n,Nn===t&&(Bn&n)===n&&(kn===4||kn===3&&(Bn&130023424)===Bn&&500>sn()-R_?Ea(t,0):A_|=n),Fr(t,e)}function EI(t,e){e===0&&(t.mode&1?(e=oh,oh<<=1,!(oh&130023424)&&(oh=4194304)):e=1);var n=gr();t=Oi(t,e),t!==null&&(wd(t,e,n),Fr(t,n))}function gD(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),EI(t,n)}function yD(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(e),EI(t,n)}var kI;kI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Or.current)jr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return jr=!1,sD(t,e,n);jr=!!(t.flags&131072)}else jr=!1,Ut&&e.flags&1048576&&CS(e,Mf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;rf(t,e),t=e.pendingProps;var s=zl(e,ar.current);Rl(e,n),s=E_(null,e,r,t,s,n);var i=k_();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Lr(r)?(i=!0,jf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,v_(e),s.updater=Vp,e.stateNode=s,s._reactInternals=e,jy(e,r,t,n),e=Oy(null,e,r,!0,i,n)):(e.tag=0,Ut&&i&&d_(e),hr(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(rf(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=_D(r),t=Es(r,t),s){case 0:e=My(null,e,r,t,n);break e;case 1:e=ab(null,e,r,t,n);break e;case 11:e=ib(null,e,r,t,n);break e;case 14:e=ob(null,e,r,Es(r.type,t),n);break e}throw Error(te(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),My(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),ab(t,e,r,s,n);case 3:e:{if(aI(e),t===null)throw Error(te(387));r=e.pendingProps,i=e.memoizedState,s=i.element,DS(t,e),Ff(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ql(Error(te(423)),e),e=lb(t,e,r,n,s);break e}else if(r!==s){s=ql(Error(te(424)),e),e=lb(t,e,r,n,s);break e}else for(Kr=xo(e.stateNode.containerInfo.firstChild),Xr=e,Ut=!0,Ss=null,n=PS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($l(),r===s){e=Li(t,e,n);break e}hr(t,e,r,n)}e=e.child}return e;case 5:return MS(e),t===null&&Ry(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Ty(r,s)?o=null:i!==null&&Ty(r,i)&&(e.flags|=32),oI(t,e),hr(t,e,o,n),e.child;case 6:return t===null&&Ry(e),null;case 13:return lI(t,e,n);case 4:return __(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Wl(e,null,r,n):hr(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),ib(t,e,r,s,n);case 7:return hr(t,e,e.pendingProps,n),e.child;case 8:return hr(t,e,e.pendingProps.children,n),e.child;case 12:return hr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,It(Of,r._currentValue),r._currentValue=o,i!==null)if(Ns(i.value,o)){if(i.children===s.children&&!Or.current){e=Li(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Pi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Ny(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(te(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Ny(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}hr(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Rl(e,n),s=ds(s),r=r(s),e.flags|=1,hr(t,e,r,n),e.child;case 14:return r=e.type,s=Es(r,e.pendingProps),s=Es(r.type,s),ob(t,e,r,s,n);case 15:return sI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),rf(t,e),e.tag=1,Lr(r)?(t=!0,jf(e)):t=!1,Rl(e,n),tI(e,r,s),jy(e,r,s,n),Oy(null,e,r,!0,t,n);case 19:return cI(t,e,n);case 22:return iI(t,e,n)}throw Error(te(156,e.tag))};function TI(t,e){return JT(t,e)}function vD(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(t,e,n,r){return new vD(t,e,n,r)}function D_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _D(t){if(typeof t=="function")return D_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zv)return 11;if(t===e_)return 14}return 2}function ko(t,e){var n=t.alternate;return n===null?(n=cs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function af(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")D_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case pl:return ka(n.children,s,i,e);case Jv:o=8,s|=8;break;case ry:return t=cs(12,n,e,s|2),t.elementType=ry,t.lanes=i,t;case sy:return t=cs(13,n,e,s),t.elementType=sy,t.lanes=i,t;case iy:return t=cs(19,n,e,s),t.elementType=iy,t.lanes=i,t;case MT:return zp(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case jT:o=10;break e;case DT:o=9;break e;case Zv:o=11;break e;case e_:o=14;break e;case Ji:o=16,r=null;break e}throw Error(te(130,t==null?t:typeof t,""))}return e=cs(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ka(t,e,n,r){return t=cs(7,t,r,e),t.lanes=n,t}function zp(t,e,n,r){return t=cs(22,t,r,e),t.elementType=MT,t.lanes=n,t.stateNode={isHidden:!1},t}function hg(t,e,n){return t=cs(6,t,null,e),t.lanes=n,t}function fg(t,e,n){return e=cs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xD(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gm(0),this.expirationTimes=Gm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gm(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function M_(t,e,n,r,s,i,o,a,l){return t=new xD(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},v_(i),t}function wD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function SI(t){if(!t)return jo;t=t._reactInternals;e:{if(Wa(t)!==t||t.tag!==1)throw Error(te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Lr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(te(171))}if(t.tag===1){var n=t.type;if(Lr(n))return SS(t,n,e)}return e}function II(t,e,n,r,s,i,o,a,l){return t=M_(n,r,!0,t,s,i,o,a,l),t.context=SI(null),n=t.current,r=gr(),s=Eo(n),i=Pi(r,s),i.callback=e??null,wo(n,i,s),t.current.lanes=s,wd(t,s,r),Fr(t,r),t}function $p(t,e,n,r){var s=e.current,i=gr(),o=Eo(s);return n=SI(n),e.context===null?e.context=n:e.pendingContext=n,e=Pi(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=wo(s,e,o),t!==null&&(As(t,s,o,i),ef(t,s,o)),o}function qf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function vb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function O_(t,e){vb(t,e),(t=t.alternate)&&vb(t,e)}function bD(){return null}var CI=typeof reportError=="function"?reportError:function(t){console.error(t)};function L_(t){this._internalRoot=t}Wp.prototype.render=L_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(te(409));$p(t,e,null,null)};Wp.prototype.unmount=L_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Da(function(){$p(null,t,null,null)}),e[Mi]=null}};function Wp(t){this._internalRoot=t}Wp.prototype.unstable_scheduleHydration=function(t){if(t){var e=iS();t={blockedOn:null,target:t,priority:e};for(var n=0;n<eo.length&&e!==0&&e<eo[n].priority;n++);eo.splice(n,0,t),n===0&&aS(t)}};function F_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _b(){}function ED(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=qf(o);i.call(c)}}var o=II(e,r,t,0,null,!1,!1,"",_b);return t._reactRootContainer=o,t[Mi]=o.current,qu(t.nodeType===8?t.parentNode:t),Da(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=qf(l);a.call(c)}}var l=M_(t,0,!1,null,null,!1,!1,"",_b);return t._reactRootContainer=l,t[Mi]=l.current,qu(t.nodeType===8?t.parentNode:t),Da(function(){$p(e,l,n,r)}),l}function qp(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=qf(o);a.call(l)}}$p(e,o,t,s)}else o=ED(n,e,t,s,r);return qf(o)}rS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Jc(e.pendingLanes);n!==0&&(r_(e,n|1),Fr(e,sn()),!(Xe&6)&&(Gl=sn()+500,qo()))}break;case 13:Da(function(){var r=Oi(t,1);if(r!==null){var s=gr();As(r,t,1,s)}}),O_(t,1)}};s_=function(t){if(t.tag===13){var e=Oi(t,134217728);if(e!==null){var n=gr();As(e,t,134217728,n)}O_(t,134217728)}};sS=function(t){if(t.tag===13){var e=Eo(t),n=Oi(t,e);if(n!==null){var r=gr();As(n,t,e,r)}O_(t,e)}};iS=function(){return mt};oS=function(t,e){var n=mt;try{return mt=t,e()}finally{mt=n}};my=function(t,e,n){switch(e){case"input":if(ly(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Op(r);if(!s)throw Error(te(90));LT(r),ly(r,s)}}}break;case"textarea":VT(t,n);break;case"select":e=n.value,e!=null&&Sl(t,!!n.multiple,e,!1)}};qT=N_;GT=Da;var kD={usingClientEntryPoint:!1,Events:[Ed,vl,Op,WT,HT,N_]},Fc={findFiberByHostInstance:pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TD={bundleType:Fc.bundleType,version:Fc.version,rendererPackageName:Fc.rendererPackageName,rendererConfig:Fc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$i.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QT(t),t===null?null:t.stateNode},findFiberByHostInstance:Fc.findFiberByHostInstance||bD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{Pp=yh.inject(TD),ei=yh}catch{}}ns.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kD;ns.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!F_(e))throw Error(te(200));return wD(t,e,null,n)};ns.createRoot=function(t,e){if(!F_(t))throw Error(te(299));var n=!1,r="",s=CI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=M_(t,1,!1,null,null,n,!1,r,s),t[Mi]=e.current,qu(t.nodeType===8?t.parentNode:t),new L_(e)};ns.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(te(188)):(t=Object.keys(t).join(","),Error(te(268,t)));return t=QT(e),t=t===null?null:t.stateNode,t};ns.flushSync=function(t){return Da(t)};ns.hydrate=function(t,e,n){if(!Hp(e))throw Error(te(200));return qp(null,t,e,!0,n)};ns.hydrateRoot=function(t,e,n){if(!F_(t))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=CI;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=II(e,null,t,1,n??null,s,!1,i,o),t[Mi]=e.current,qu(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Wp(e)};ns.render=function(t,e,n){if(!Hp(e))throw Error(te(200));return qp(null,t,e,!1,n)};ns.unmountComponentAtNode=function(t){if(!Hp(t))throw Error(te(40));return t._reactRootContainer?(Da(function(){qp(null,null,t,!1,function(){t._reactRootContainer=null,t[Mi]=null})}),!0):!1};ns.unstable_batchedUpdates=N_;ns.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hp(n))throw Error(te(200));if(t==null||t._reactInternals===void 0)throw Error(te(38));return qp(t,e,n,!1,r)};ns.version="18.3.1-next-f1338f8080-20240426";function AI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(AI)}catch(t){console.error(t)}}AI(),AT.exports=ns;var SD=AT.exports,xb=SD;ty.createRoot=xb.createRoot,ty.hydrateRoot=xb.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function td(){return td=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},td.apply(this,arguments)}var uo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(uo||(uo={}));const wb="popstate";function ID(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Ky("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Gf(s)}return AD(e,n,null,t)}function ln(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function RI(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CD(){return Math.random().toString(36).substr(2,8)}function bb(t,e){return{usr:t.state,key:t.key,idx:e}}function Ky(t,e,n,r){return n===void 0&&(n=null),td({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?fc(e):e,{state:n,key:e&&e.key||r||CD()})}function Gf(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function fc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function AD(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=uo.Pop,l=null,c=d();c==null&&(c=0,o.replaceState(td({},o.state,{idx:c}),""));function d(){return(o.state||{idx:null}).idx}function f(){a=uo.Pop;let y=d(),_=y==null?null:y-c;c=y,l&&l({action:a,location:w.location,delta:_})}function p(y,_){a=uo.Push;let v=Ky(w.location,y,_);c=d()+1;let k=bb(v,c),A=w.createHref(v);try{o.pushState(k,"",A)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(A)}i&&l&&l({action:a,location:w.location,delta:1})}function m(y,_){a=uo.Replace;let v=Ky(w.location,y,_);c=d();let k=bb(v,c),A=w.createHref(v);o.replaceState(k,"",A),i&&l&&l({action:a,location:w.location,delta:0})}function x(y){let _=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof y=="string"?y:Gf(y);return v=v.replace(/ $/,"%20"),ln(_,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,_)}let w={get action(){return a},get location(){return t(s,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(wb,f),l=y,()=>{s.removeEventListener(wb,f),l=null}},createHref(y){return e(s,y)},createURL:x,encodeLocation(y){let _=x(y);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:p,replace:m,go(y){return o.go(y)}};return w}var Eb;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Eb||(Eb={}));function RD(t,e,n){return n===void 0&&(n="/"),ND(t,e,n)}function ND(t,e,n,r){let s=typeof e=="string"?fc(e):e,i=V_(s.pathname||"/",n);if(i==null)return null;let o=NI(t);PD(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=WD(i);a=BD(o[l],c)}return a}function NI(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(ln(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=To([r,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(ln(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),NI(i.children,e,d,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:VD(c,i.index),routesMeta:d})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of PI(i.path))s(i,o,l)}),e}function PI(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=PI(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function PD(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:UD(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const jD=/^:[\w-]+$/,DD=3,MD=2,OD=1,LD=10,FD=-2,kb=t=>t==="*";function VD(t,e){let n=t.split("/"),r=n.length;return n.some(kb)&&(r+=FD),e&&(r+=MD),n.filter(s=>!kb(s)).reduce((s,i)=>s+(jD.test(i)?DD:i===""?OD:LD),r)}function UD(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function BD(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",f=zD({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},d),p=l.route;if(!f)return null;Object.assign(s,f.params),o.push({params:s,pathname:To([i,f.pathname]),pathnameBase:KD(To([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=To([i,f.pathnameBase]))}return o}function zD(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=$D(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,d,f)=>{let{paramName:p,isOptional:m}=d;if(p==="*"){let w=a[f]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const x=a[f];return m&&!x?c[p]=void 0:c[p]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function $D(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),RI(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function WD(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return RI(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function V_(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function HD(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?fc(t):t;return{pathname:n?n.startsWith("/")?n:qD(n,e):e,search:YD(r),hash:QD(s)}}function qD(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function pg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function GD(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function U_(t,e){let n=GD(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function B_(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=fc(t):(s=td({},t),ln(!s.pathname||!s.pathname.includes("?"),pg("?","pathname","search",s)),ln(!s.pathname||!s.pathname.includes("#"),pg("#","pathname","hash",s)),ln(!s.search||!s.search.includes("#"),pg("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}a=f>=0?e[f]:"/"}let l=HD(s,a),c=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||d)&&(l.pathname+="/"),l}const To=t=>t.join("/").replace(/\/\/+/g,"/"),KD=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YD=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,QD=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XD(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const jI=["post","put","patch","delete"];new Set(jI);const JD=["get",...jI];new Set(JD);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nd(){return nd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nd.apply(this,arguments)}const z_=T.createContext(null),ZD=T.createContext(null),Go=T.createContext(null),Gp=T.createContext(null),Wi=T.createContext({outlet:null,matches:[],isDataRoute:!1}),DI=T.createContext(null);function eM(t,e){let{relative:n}=e===void 0?{}:e;pc()||ln(!1);let{basename:r,navigator:s}=T.useContext(Go),{hash:i,pathname:o,search:a}=LI(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:To([r,o])),s.createHref({pathname:l,search:a,hash:i})}function pc(){return T.useContext(Gp)!=null}function gs(){return pc()||ln(!1),T.useContext(Gp).location}function MI(t){T.useContext(Go).static||T.useLayoutEffect(t)}function hi(){let{isDataRoute:t}=T.useContext(Wi);return t?fM():tM()}function tM(){pc()||ln(!1);let t=T.useContext(z_),{basename:e,future:n,navigator:r}=T.useContext(Go),{matches:s}=T.useContext(Wi),{pathname:i}=gs(),o=JSON.stringify(U_(s,n.v7_relativeSplatPath)),a=T.useRef(!1);return MI(()=>{a.current=!0}),T.useCallback(function(c,d){if(d===void 0&&(d={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let f=B_(c,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:To([e,f.pathname])),(d.replace?r.replace:r.push)(f,d.state,d)},[e,r,o,i,t])}function OI(){let{matches:t}=T.useContext(Wi),e=t[t.length-1];return e?e.params:{}}function LI(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=T.useContext(Go),{matches:s}=T.useContext(Wi),{pathname:i}=gs(),o=JSON.stringify(U_(s,r.v7_relativeSplatPath));return T.useMemo(()=>B_(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function nM(t,e){return rM(t,e)}function rM(t,e,n,r){pc()||ln(!1);let{navigator:s}=T.useContext(Go),{matches:i}=T.useContext(Wi),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=gs(),d;if(e){var f;let y=typeof e=="string"?fc(e):e;l==="/"||(f=y.pathname)!=null&&f.startsWith(l)||ln(!1),d=y}else d=c;let p=d.pathname||"/",m=p;if(l!=="/"){let y=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let x=RD(t,{pathname:m}),w=lM(x&&x.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:To([l,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:To([l,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,r);return e&&w?T.createElement(Gp.Provider,{value:{location:nd({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:uo.Pop}},w):w}function sM(){let t=hM(),e=XD(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),n?T.createElement("pre",{style:s},n):null,null)}const iM=T.createElement(sM,null);class oM extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?T.createElement(Wi.Provider,{value:this.props.routeContext},T.createElement(DI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aM(t){let{routeContext:e,match:n,children:r}=t,s=T.useContext(z_);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),T.createElement(Wi.Provider,{value:e},r)}function lM(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let d=o.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);d>=0||ln(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=d),f.route.id){let{loaderData:p,errors:m}=n,x=f.route.loader&&p[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||x){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((d,f,p)=>{let m,x=!1,w=null,y=null;n&&(m=a&&f.route.id?a[f.route.id]:void 0,w=f.route.errorElement||iM,l&&(c<0&&p===0?(pM("route-fallback"),x=!0,y=null):c===p&&(x=!0,y=f.route.hydrateFallbackElement||null)));let _=e.concat(o.slice(0,p+1)),v=()=>{let k;return m?k=w:x?k=y:f.route.Component?k=T.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=d,T.createElement(aM,{match:f,routeContext:{outlet:d,matches:_,isDataRoute:n!=null},children:k})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?T.createElement(oM,{location:n.location,revalidation:n.revalidation,component:w,error:m,children:v(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):v()},null)}var FI=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(FI||{}),VI=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(VI||{});function cM(t){let e=T.useContext(z_);return e||ln(!1),e}function uM(t){let e=T.useContext(ZD);return e||ln(!1),e}function dM(t){let e=T.useContext(Wi);return e||ln(!1),e}function UI(t){let e=dM(),n=e.matches[e.matches.length-1];return n.route.id||ln(!1),n.route.id}function hM(){var t;let e=T.useContext(DI),n=uM(),r=UI();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function fM(){let{router:t}=cM(FI.UseNavigateStable),e=UI(VI.UseNavigateStable),n=T.useRef(!1);return MI(()=>{n.current=!0}),T.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,nd({fromRouteId:e},i)))},[t,e])}const Tb={};function pM(t,e,n){Tb[t]||(Tb[t]=!0)}function mM(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function at(t){let{to:e,replace:n,state:r,relative:s}=t;pc()||ln(!1);let{future:i,static:o}=T.useContext(Go),{matches:a}=T.useContext(Wi),{pathname:l}=gs(),c=hi(),d=B_(e,U_(a,i.v7_relativeSplatPath),l,s==="path"),f=JSON.stringify(d);return T.useEffect(()=>c(JSON.parse(f),{replace:n,state:r,relative:s}),[c,f,s,n,r]),null}function lt(t){ln(!1)}function gM(t){let{basename:e="/",children:n=null,location:r,navigationType:s=uo.Pop,navigator:i,static:o=!1,future:a}=t;pc()&&ln(!1);let l=e.replace(/^\/*/,"/"),c=T.useMemo(()=>({basename:l,navigator:i,static:o,future:nd({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=fc(r));let{pathname:d="/",search:f="",hash:p="",state:m=null,key:x="default"}=r,w=T.useMemo(()=>{let y=V_(d,l);return y==null?null:{location:{pathname:y,search:f,hash:p,state:m,key:x},navigationType:s}},[l,d,f,p,m,x,s]);return w==null?null:T.createElement(Go.Provider,{value:c},T.createElement(Gp.Provider,{children:n,value:w}))}function yM(t){let{children:e,location:n}=t;return nM(Yy(e),n)}new Promise(()=>{});function Yy(t,e){e===void 0&&(e=[]);let n=[];return T.Children.forEach(t,(r,s)=>{if(!T.isValidElement(r))return;let i=[...e,s];if(r.type===T.Fragment){n.push.apply(n,Yy(r.props.children,i));return}r.type!==lt&&ln(!1),!r.props.index||!r.props.children||ln(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Yy(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qy(){return Qy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qy.apply(this,arguments)}function vM(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function _M(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function xM(t,e){return t.button===0&&(!e||e==="_self")&&!_M(t)}const wM=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],bM="6";try{window.__reactRouterVersion=bM}catch{}const EM="startTransition",Sb=m2[EM];function kM(t){let{basename:e,children:n,future:r,window:s}=t,i=T.useRef();i.current==null&&(i.current=ID({window:s,v5Compat:!0}));let o=i.current,[a,l]=T.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},d=T.useCallback(f=>{c&&Sb?Sb(()=>l(f)):l(f)},[l,c]);return T.useLayoutEffect(()=>o.listen(d),[o,d]),T.useEffect(()=>mM(r),[r]),T.createElement(gM,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const TM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,So=T.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:d,viewTransition:f}=e,p=vM(e,wM),{basename:m}=T.useContext(Go),x,w=!1;if(typeof c=="string"&&SM.test(c)&&(x=c,TM))try{let k=new URL(window.location.href),A=c.startsWith("//")?new URL(k.protocol+c):new URL(c),D=V_(A.pathname,m);A.origin===k.origin&&D!=null?c=D+A.search+A.hash:w=!0}catch{}let y=eM(c,{relative:s}),_=IM(c,{replace:o,state:a,target:l,preventScrollReset:d,relative:s,viewTransition:f});function v(k){r&&r(k),k.defaultPrevented||_(k)}return T.createElement("a",Qy({},p,{href:x||y,onClick:w||i?r:v,ref:n,target:l}))});var Ib;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Ib||(Ib={}));var Cb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Cb||(Cb={}));function IM(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=hi(),c=gs(),d=LI(t,{relative:o});return T.useCallback(f=>{if(xM(f,n)){f.preventDefault();let p=r!==void 0?r:Gf(c)===Gf(d);l(t,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,d,r,s,n,t,i,o,a])}const CM=()=>{};var Ab={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},AM=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},zI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,d=i>>2,f=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(p=64)),r.push(n[d],n[f],n[p],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(BI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):AM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new RM;const p=i<<2|a>>4;if(r.push(p),c!==64){const m=a<<4&240|c>>2;if(r.push(m),f!==64){const x=c<<6&192|f;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class RM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const NM=function(t){const e=BI(t);return zI.encodeByteArray(e,!0)},Kf=function(t){return NM(t).replace(/\./g,"")},$I=function(t){try{return zI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM=()=>PM().__FIREBASE_DEFAULTS__,DM=()=>{if(typeof process>"u"||typeof Ab>"u")return;const t=Ab.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MM=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&$I(t[1]);return e&&JSON.parse(e)},Kp=()=>{try{return CM()||jM()||DM()||MM()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},WI=t=>{var e,n;return(n=(e=Kp())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},$_=t=>{const e=WI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},HI=()=>{var t;return(t=Kp())===null||t===void 0?void 0:t.config},qI=t=>{var e;return(e=Kp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(t){return t.endsWith(".cloudworkstations.dev")}async function Yp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Kf(JSON.stringify(n)),Kf(JSON.stringify(o)),""].join(".")}const xu={};function LM(){const t={prod:[],emulator:[]};for(const e of Object.keys(xu))xu[e]?t.emulator.push(e):t.prod.push(e);return t}function FM(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Rb=!1;function Yo(t,e){if(typeof window>"u"||typeof document>"u"||!Ko(window.location.host)||xu[t]===e||xu[t]||Rb)return;xu[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",i=LM().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Rb=!0,o()},p}function d(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function f(){const p=FM(r),m=n("text"),x=document.getElementById(m)||document.createElement("span"),w=n("learnmore"),y=document.getElementById(w)||document.createElement("a"),_=n("preprendIcon"),v=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const k=p.element;a(k),d(y,w);const A=c();l(v,_),k.append(v,x,y,A),document.body.appendChild(k)}i?(x.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function VM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lr())}function UM(){var t;const e=(t=Kp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function zM(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function $M(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WM(){const t=lr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function HM(){return!UM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KI(){try{return typeof indexedDB=="object"}catch{return!1}}function YI(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function qM(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM="FirebaseError";class ys extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=GM,Object.setPrototypeOf(this,ys.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ha.prototype.create)}}class Ha{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?KM(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ys(s,a,r)}}function KM(t,e){return t.replace(YM,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const YM=/\{\$([^}]+)}/g;function QM(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Do(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Nb(i)&&Nb(o)){if(!Do(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Nb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function eu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function tu(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function XM(t,e){const n=new JM(t,e);return n.subscribe.bind(n)}class JM{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");ZM(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=mg),s.error===void 0&&(s.error=mg),s.complete===void 0&&(s.complete=mg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZM(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function mg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t){return t&&t._delegate?t._delegate:t}class es{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new OM;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nO(e))try{this.getOrInitializeService({instanceIdentifier:ca})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ca){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ca){return this.instances.has(e)}getOptions(e=ca){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:tO(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ca){return this.component?this.component.multipleInstances?e:ca:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tO(t){return t===ca?void 0:t}function nO(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new eO(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var We;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(We||(We={}));const sO={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},iO=We.INFO,oO={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},aO=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=oO[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class W_{constructor(e){this.name=e,this._logLevel=iO,this._logHandler=aO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sO[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const lO=(t,e)=>e.some(n=>t instanceof n);let Pb,jb;function cO(){return Pb||(Pb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uO(){return jb||(jb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const QI=new WeakMap,Xy=new WeakMap,XI=new WeakMap,gg=new WeakMap,H_=new WeakMap;function dO(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ji(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&QI.set(n,t)}).catch(()=>{}),H_.set(e,t),e}function hO(t){if(Xy.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Xy.set(t,e)}let Jy={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xy.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fO(t){Jy=t(Jy)}function pO(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(yg(this),e,...n);return XI.set(r,e.sort?e.sort():[e]),ji(r)}:uO().includes(t)?function(...e){return t.apply(yg(this),e),ji(QI.get(this))}:function(...e){return ji(t.apply(yg(this),e))}}function mO(t){return typeof t=="function"?pO(t):(t instanceof IDBTransaction&&hO(t),lO(t,cO())?new Proxy(t,Jy):t)}function ji(t){if(t instanceof IDBRequest)return dO(t);if(gg.has(t))return gg.get(t);const e=mO(t);return e!==t&&(gg.set(t,e),H_.set(e,t)),e}const yg=t=>H_.get(t);function Qp(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ji(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ji(o.result),l.oldVersion,l.newVersion,ji(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function vg(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),ji(n).then(()=>{})}const gO=["get","getKey","getAll","getAllKeys","count"],yO=["put","add","delete","clear"],_g=new Map;function Db(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_g.get(e))return _g.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=yO.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||gO.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return _g.set(e,i),i}fO(t=>({...t,get:(e,n,r)=>Db(e,n)||t.get(e,n,r),has:(e,n)=>!!Db(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(_O(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function _O(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zy="@firebase/app",Mb="0.12.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi=new W_("@firebase/app"),xO="@firebase/app-compat",wO="@firebase/analytics-compat",bO="@firebase/analytics",EO="@firebase/app-check-compat",kO="@firebase/app-check",TO="@firebase/auth",SO="@firebase/auth-compat",IO="@firebase/database",CO="@firebase/data-connect",AO="@firebase/database-compat",RO="@firebase/functions",NO="@firebase/functions-compat",PO="@firebase/installations",jO="@firebase/installations-compat",DO="@firebase/messaging",MO="@firebase/messaging-compat",OO="@firebase/performance",LO="@firebase/performance-compat",FO="@firebase/remote-config",VO="@firebase/remote-config-compat",UO="@firebase/storage",BO="@firebase/storage-compat",zO="@firebase/firestore",$O="@firebase/vertexai",WO="@firebase/firestore-compat",HO="firebase",qO="11.7.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev="[DEFAULT]",GO={[Zy]:"fire-core",[xO]:"fire-core-compat",[bO]:"fire-analytics",[wO]:"fire-analytics-compat",[kO]:"fire-app-check",[EO]:"fire-app-check-compat",[TO]:"fire-auth",[SO]:"fire-auth-compat",[IO]:"fire-rtdb",[CO]:"fire-data-connect",[AO]:"fire-rtdb-compat",[RO]:"fire-fn",[NO]:"fire-fn-compat",[PO]:"fire-iid",[jO]:"fire-iid-compat",[DO]:"fire-fcm",[MO]:"fire-fcm-compat",[OO]:"fire-perf",[LO]:"fire-perf-compat",[FO]:"fire-rc",[VO]:"fire-rc-compat",[UO]:"fire-gcs",[BO]:"fire-gcs-compat",[zO]:"fire-fst",[WO]:"fire-fst-compat",[$O]:"fire-vertex","fire-js":"fire-js",[HO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf=new Map,KO=new Map,tv=new Map;function Ob(t,e){try{t.container.addComponent(e)}catch(n){Fi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fs(t){const e=t.name;if(tv.has(e))return Fi.debug(`There were multiple attempts to register component ${e}.`),!1;tv.set(e,t);for(const n of Yf.values())Ob(n,t);for(const n of KO.values())Ob(n,t);return!0}function Qo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function nr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Io=new Ha("app","Firebase",YO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Io.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=qO;function JI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ev,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Io.create("bad-app-name",{appName:String(s)});if(n||(n=HI()),!n)throw Io.create("no-options");const i=Yf.get(s);if(i){if(Do(n,i.options)&&Do(r,i.config))return i;throw Io.create("duplicate-app",{appName:s})}const o=new rO(s);for(const l of tv.values())o.addComponent(l);const a=new QO(n,r,o);return Yf.set(s,a),a}function Td(t=ev){const e=Yf.get(t);if(!e&&t===ev&&HI())return JI();if(!e)throw Io.create("no-app",{appName:t});return e}function sr(t,e,n){var r;let s=(r=GO[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fi.warn(a.join(" "));return}fs(new es(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO="firebase-heartbeat-database",JO=1,rd="firebase-heartbeat-store";let xg=null;function ZI(){return xg||(xg=Qp(XO,JO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(rd)}catch(n){console.warn(n)}}}}).catch(t=>{throw Io.create("idb-open",{originalErrorMessage:t.message})})),xg}async function ZO(t){try{const n=(await ZI()).transaction(rd),r=await n.objectStore(rd).get(eC(t));return await n.done,r}catch(e){if(e instanceof ys)Fi.warn(e.message);else{const n=Io.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fi.warn(n.message)}}}async function Lb(t,e){try{const r=(await ZI()).transaction(rd,"readwrite");await r.objectStore(rd).put(e,eC(t)),await r.done}catch(n){if(n instanceof ys)Fi.warn(n.message);else{const r=Io.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Fi.warn(r.message)}}}function eC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL=1024,tL=30;class nL{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new sL(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Fb();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>tL){const o=iL(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Fi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Fb(),{heartbeatsToSend:r,unsentEntries:s}=rL(this._heartbeatsCache.heartbeats),i=Kf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Fi.warn(n),""}}}function Fb(){return new Date().toISOString().substring(0,10)}function rL(t,e=eL){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Vb(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Vb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class sL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KI()?YI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ZO(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Lb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Lb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Vb(t){return Kf(JSON.stringify({version:2,heartbeats:t})).length}function iL(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oL(t){fs(new es("platform-logger",e=>new vO(e),"PRIVATE")),fs(new es("heartbeat",e=>new nL(e),"PRIVATE")),sr(Zy,Mb,t),sr(Zy,Mb,"esm2017"),sr("fire-js","")}oL("");function q_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function tC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aL=tC,nC=new Ha("auth","Firebase",tC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=new W_("@firebase/auth");function lL(t,...e){Qf.logLevel<=We.WARN&&Qf.warn(`Auth (${qa}): ${t}`,...e)}function lf(t,...e){Qf.logLevel<=We.ERROR&&Qf.error(`Auth (${qa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(t,...e){throw G_(t,...e)}function Jr(t,...e){return G_(t,...e)}function rC(t,e,n){const r=Object.assign(Object.assign({},aL()),{[e]:n});return new Ha("auth","Firebase",r).create(e,{appName:t.name})}function Rs(t){return rC(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function G_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return nC.create(t,...e)}function ce(t,e,...n){if(!t)throw G_(e,...n)}function Js(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lf(e),new Error(e)}function Vi(t,e){t||Js(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function sC(){return Ub()==="http:"||Ub()==="https:"}function Ub(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sC()||zM()||"connection"in navigator)?navigator.onLine:!0}function uL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,n){this.shortDelay=e,this.longDelay=n,Vi(n>e,"Short delay should be less than long delay!"),this.isMobile=VM()||$M()}get(){return cL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(t,e){Vi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Js("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Js("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Js("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fL=new Sd(3e4,6e4);function Pn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function jn(t,e,n,r,s={}){return oC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=mc(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return BM()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&Ko(t.emulatorConfig.host)&&(c.credentials="include"),iC.fetch()(await aC(t,t.config.apiHost,n,a),c)})}async function oC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},dL),e);try{const s=new mL(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw nu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw nu(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw nu(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw nu(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw rC(t,d,c);ts(t,d)}}catch(s){if(s instanceof ys)throw s;ts(t,"network-request-failed",{message:String(s)})}}async function Xo(t,e,n,r,s={}){const i=await jn(t,e,n,r,s);return"mfaPendingCredential"in i&&ts(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function aC(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?K_(t.config,s):`${t.config.apiScheme}://${s}`;return hL.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function pL(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class mL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Jr(this.auth,"network-request-failed")),fL.get())})}}function nu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Jr(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(t){return t!==void 0&&t.getResponse!==void 0}function zb(t){return t!==void 0&&t.enterprise!==void 0}class lC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return pL(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gL(t){return(await jn(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function cC(t,e){return jn(t,"GET","/v2/recaptchaConfig",Pn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yL(t,e){return jn(t,"POST","/v1/accounts:delete",e)}async function Xf(t,e){return jn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function uC(t,e=!1){const n=Fe(t),r=await n.getIdToken(e),s=Y_(r);ce(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:wu(wg(s.auth_time)),issuedAtTime:wu(wg(s.iat)),expirationTime:wu(wg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function wg(t){return Number(t)*1e3}function Y_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return lf("JWT malformed, contained fewer than 3 sections"),null;try{const s=$I(n);return s?JSON.parse(s):(lf("Failed to decode base64 JWT payload"),null)}catch(s){return lf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function $b(t){const e=Y_(t);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ui(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ys&&vL(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function vL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wu(this.lastLoginAt),this.creationTime=wu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jf(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Ui(t,Xf(n,{idToken:r}));ce(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?dC(i.providerUserInfo):[],a=wL(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new rv(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function xL(t){const e=Fe(t);await Jf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function wL(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function dC(t){return t.map(e=>{var{providerId:n}=e,r=q_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bL(t,e){const n=await oC(t,{},async()=>{const r=mc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await aC(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",iC.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function EL(t,e){return jn(t,"POST","/v2/accounts:revokeToken",Pn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$b(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const n=$b(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await bL(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Pl;return r&&(ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ce(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ce(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pl,this.toJSON())}_performRefresh(){return Js("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t,e){ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Is{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=q_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _L(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new rv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Ui(this,this.stsTokenManager.getToken(this.auth,e));return ce(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return uC(this,e)}reload(){return xL(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Is(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Jf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nr(this.auth.app))return Promise.reject(Rs(this.auth));const e=await this.getIdToken();return await Ui(this,yL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,l,c,d;const f=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,x=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,_=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:k,emailVerified:A,isAnonymous:D,providerData:O,stsTokenManager:I}=n;ce(k&&I,e,"internal-error");const E=Pl.fromJSON(this.name,I);ce(typeof k=="string",e,"internal-error"),Yi(f,e.name),Yi(p,e.name),ce(typeof A=="boolean",e,"internal-error"),ce(typeof D=="boolean",e,"internal-error"),Yi(m,e.name),Yi(x,e.name),Yi(w,e.name),Yi(y,e.name),Yi(_,e.name),Yi(v,e.name);const S=new Is({uid:k,auth:e,email:p,emailVerified:A,displayName:f,isAnonymous:D,photoURL:x,phoneNumber:m,tenantId:w,stsTokenManager:E,createdAt:_,lastLoginAt:v});return O&&Array.isArray(O)&&(S.providerData=O.map(C=>Object.assign({},C))),y&&(S._redirectEventId=y),S}static async _fromIdTokenResponse(e,n,r=!1){const s=new Pl;s.updateFromServerResponse(n);const i=new Is({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Jf(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ce(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?dC(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Pl;a.updateFromIdToken(r);const l=new Is({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new rv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=new Map;function Ri(t){Vi(t instanceof Function,"Expected a class definition");let e=Wb.get(t);return e?(Vi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Wb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}hC.type="NONE";const Hb=hC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t,e,n){return`firebase:${t}:${e}:${n}`}class jl{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=cf(this.userKey,s.apiKey,i),this.fullPersistenceKey=cf("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Xf(this.auth,{idToken:e}).catch(()=>{});return n?Is._fromGetAccountInfoResponse(this.auth,n,e):null}return Is._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new jl(Ri(Hb),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ri(Hb);const o=cf(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){let f;if(typeof d=="string"){const p=await Xf(e,{idToken:d}).catch(()=>{});if(!p)break;f=await Is._fromGetAccountInfoResponse(e,p,d)}else f=Is._fromJSON(e,d);c!==i&&(a=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new jl(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new jl(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vC(e))return"Blackberry";if(_C(e))return"Webos";if(pC(e))return"Safari";if((e.includes("chrome/")||mC(e))&&!e.includes("edge/"))return"Chrome";if(yC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function fC(t=lr()){return/firefox\//i.test(t)}function pC(t=lr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mC(t=lr()){return/crios\//i.test(t)}function gC(t=lr()){return/iemobile/i.test(t)}function yC(t=lr()){return/android/i.test(t)}function vC(t=lr()){return/blackberry/i.test(t)}function _C(t=lr()){return/webos/i.test(t)}function Q_(t=lr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function kL(t=lr()){var e;return Q_(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function TL(){return WM()&&document.documentMode===10}function xC(t=lr()){return Q_(t)||yC(t)||_C(t)||vC(t)||/windows phone/i.test(t)||gC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(t,e=[]){let n;switch(t){case"Browser":n=qb(lr());break;case"Worker":n=`${qb(lr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${qa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IL(t,e={}){return jn(t,"GET","/v2/passwordPolicy",Pn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CL=6;class AL{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:CL,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gb(this),this.idTokenSubscription=new Gb(this),this.beforeStateQueue=new SL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ri(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await jl.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Xf(this,{idToken:e}),r=await Is._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(nr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Jf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=uL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nr(this.app))return Promise.reject(Rs(this));const n=e?Fe(e):null;return n&&ce(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nr(this.app)?Promise.reject(Rs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nr(this.app)?Promise.reject(Rs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ri(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await IL(this),n=new AL(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ha("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await EL(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ri(e)||this._popupRedirectResolver;ce(n,this,"argument-error"),this.redirectPersistenceManager=await jl.create(this,[Ri(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&lL(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function vs(t){return Fe(t)}class Gb{constructor(e){this.auth=e,this.observer=null,this.addObserver=XM(n=>this.observer=n)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Id={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NL(t){Id=t}function X_(t){return Id.loadJS(t)}function PL(){return Id.recaptchaV2Script}function jL(){return Id.recaptchaEnterpriseScript}function DL(){return Id.gapiScript}function bC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=500,OL=6e4,vh=1e12;class LL{constructor(e){this.auth=e,this.counter=vh,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new UL(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||vh;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||vh;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||vh;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class FL{constructor(){this.enterprise=new VL}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class VL{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class UL{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ce(s,"argument-error",{appName:n}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=BL(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},OL)},ML))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function BL(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}const zL="recaptcha-enterprise",bu="NO_RECAPTCHA";class EC{constructor(e){this.type=zL,this.auth=vs(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{cC(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new lC(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;zb(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(bu)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new FL().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&zb(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=jL();l.length!==0&&(l+=a),X_(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Vc(t,e,n,r=!1,s=!1){const i=new EC(t);let o;if(s)o=bu;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Dl(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Vc(t,e,n,n==="getOobCode");return r(t,a)}else return r(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Vc(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(a)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await Vc(t,e,n);return r(t,a).catch(async l=>{var c;if(((c=t._getRecaptchaConfig())===null||c===void 0?void 0:c.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await Vc(t,e,n,!1,!0);return r(t,d)}return Promise.reject(l)})}else{const a=await Vc(t,e,n,!1,!0);return r(t,a)}else return Promise.reject(s+" provider is not supported.")}async function $L(t){const e=vs(t),n=await cC(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new lC(n);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new EC(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WL(t,e){const n=Qo(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Do(i,e??{}))return s;ts(s,"already-initialized")}return n.initialize({options:e})}function HL(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ri);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function qL(t,e,n){const r=vs(t);ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=kC(e),{host:o,port:a}=GL(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},d=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ce(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ce(Do(c,r.config.emulator)&&Do(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Ko(o)?(Yo("Auth",!0),Yp(`${i}//${o}${l}`)):KL()}function kC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function GL(t){const e=kC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Kb(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Kb(o)}}}function Kb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function KL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Js("not implemented")}_getIdTokenResponse(e){return Js("not implemented")}_linkToIdToken(e,n){return Js("not implemented")}_getReauthenticationResolver(e){return Js("not implemented")}}async function YL(t,e){return jn(t,"POST","/v1/accounts:update",e)}async function QL(t,e){return jn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XL(t,e){return Xo(t,"POST","/v1/accounts:signInWithPassword",Pn(t,e))}async function JL(t,e){return jn(t,"POST","/v1/accounts:sendOobCode",Pn(t,e))}async function ZL(t,e){return JL(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eF(t,e){return Xo(t,"POST","/v1/accounts:signInWithEmailLink",Pn(t,e))}async function tF(t,e){return Xo(t,"POST","/v1/accounts:signInWithEmailLink",Pn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd extends Xp{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new sd(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new sd(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dl(e,n,"signInWithPassword",XL,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return eF(e,{email:this._email,oobCode:this._password});default:ts(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dl(e,r,"signUpPassword",QL,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return tF(e,{idToken:n,email:this._email,oobCode:this._password});default:ts(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(t,e){return Xo(t,"POST","/v1/accounts:signInWithIdp",Pn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nF="http://localhost";class Ma extends Xp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ma(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ts("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=q_(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ma(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ml(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ml(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ml(e,n)}buildRequest(){const e={requestUri:nF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=mc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yb(t,e){return jn(t,"POST","/v1/accounts:sendVerificationCode",Pn(t,e))}async function rF(t,e){return Xo(t,"POST","/v1/accounts:signInWithPhoneNumber",Pn(t,e))}async function sF(t,e){const n=await Xo(t,"POST","/v1/accounts:signInWithPhoneNumber",Pn(t,e));if(n.temporaryProof)throw nu(t,"account-exists-with-different-credential",n);return n}const iF={USER_NOT_FOUND:"user-not-found"};async function oF(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Xo(t,"POST","/v1/accounts:signInWithPhoneNumber",Pn(t,n),iF)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol extends Xp{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Ol({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Ol({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return rF(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return sF(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return oF(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:s}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!n&&!s&&!i?null:new Ol({verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lF(t){const e=eu(tu(t)).link,n=e?eu(tu(e)).deep_link_id:null,r=eu(tu(t)).deep_link_id;return(r?eu(tu(r)).link:null)||r||n||e||t}class J_{constructor(e){var n,r,s,i,o,a;const l=eu(tu(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,f=aF((s=l.mode)!==null&&s!==void 0?s:null);ce(c&&d&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=d,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.lang)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=lF(e);try{return new J_(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(){this.providerId=gc.PROVIDER_ID}static credential(e,n){return sd._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=J_.parseLink(n);return ce(r,"argument-error"),sd._fromEmailAndCode(e,r.code,r.tenantId)}}gc.PROVIDER_ID="password";gc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";gc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd extends TC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends Cd{constructor(){super("facebook.com")}static credential(e){return Ma._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return no.credential(e.oauthAccessToken)}catch{return null}}}no.FACEBOOK_SIGN_IN_METHOD="facebook.com";no.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro extends Cd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ma._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ro.credentialFromTaggedObject(e)}static credentialFromError(e){return ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ro.credential(n,r)}catch{return null}}}ro.GOOGLE_SIGN_IN_METHOD="google.com";ro.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so extends Cd{constructor(){super("github.com")}static credential(e){return Ma._fromParams({providerId:so.PROVIDER_ID,signInMethod:so.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return so.credentialFromTaggedObject(e)}static credentialFromError(e){return so.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return so.credential(e.oauthAccessToken)}catch{return null}}}so.GITHUB_SIGN_IN_METHOD="github.com";so.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io extends Cd{constructor(){super("twitter.com")}static credential(e,n){return Ma._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return io.credentialFromTaggedObject(e)}static credentialFromError(e){return io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return io.credential(n,r)}catch{return null}}}io.TWITTER_SIGN_IN_METHOD="twitter.com";io.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SC(t,e){return Xo(t,"POST","/v1/accounts:signUp",Pn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Is._fromIdTokenResponse(e,r,s),o=Qb(r);return new Ps({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Qb(r);return new Ps({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Qb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IC(t){var e;if(nr(t.app))return Promise.reject(Rs(t));const n=vs(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Ps({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await SC(n,{returnSecureToken:!0}),s=await Ps._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf extends ys{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Zf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Zf(e,n,r,s)}}function CC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Zf._fromErrorAndOperation(t,i,e,r):i})}async function cF(t,e,n=!1){const r=await Ui(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ps._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uF(t,e,n=!1){const{auth:r}=t;if(nr(r.app))return Promise.reject(Rs(r));const s="reauthenticate";try{const i=await Ui(t,CC(r,s,e,t),n);ce(i.idToken,r,"internal-error");const o=Y_(i.idToken);ce(o,r,"internal-error");const{sub:a}=o;return ce(t.uid===a,r,"user-mismatch"),Ps._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ts(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AC(t,e,n=!1){if(nr(t.app))return Promise.reject(Rs(t));const r="signIn",s=await CC(t,r,e),i=await Ps._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function dF(t,e){return AC(vs(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Z_._fromServerResponse(e,n):"totpInfo"in n?ex._fromServerResponse(e,n):ts(e,"internal-error")}}class Z_ extends Jp{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Z_(n)}}class ex extends Jp{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new ex(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RC(t){const e=vs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function tx(t,e,n){if(nr(t.app))return Promise.reject(Rs(t));const r=vs(t),o=await Dl(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SC,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&RC(t),l}),a=await Ps._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function hF(t,e,n){return nr(t.app)?Promise.reject(Rs(t)):dF(Fe(t),gc.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&RC(t),r})}async function Zp(t,e){const n=Fe(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:i}=await ZL(n.auth,s);i!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fF(t,e){return jn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pF(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Fe(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Ui(r,fF(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function mF(t,e){const n=Fe(t);return nr(n.auth.app)?Promise.reject(Rs(n.auth)):NC(n,e,null)}function gF(t,e){return NC(Fe(t),null,e)}async function NC(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await Ui(t,YL(r,i));await t._updateTokensIfNecessary(o,!0)}function PC(t,e,n,r){return Fe(t).onIdTokenChanged(e,n,r)}function yF(t,e,n){return Fe(t).beforeAuthStateChanged(e,n)}function vF(t,e,n,r){return Fe(t).onAuthStateChanged(e,n,r)}function jC(t){return Fe(t).signOut()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new ya("enroll",e,n)}static _fromMfaPendingCredential(e){return new ya("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return ya._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return ya._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=vs(e),s=n.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>Jp._fromServerResponse(r,a));ce(s.mfaPendingCredential,r,"internal-error");const o=ya._fromMfaPendingCredential(s.mfaPendingCredential);return new nx(o,i,async a=>{const l=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const c=Object.assign(Object.assign({},s),{idToken:l.idToken,refreshToken:l.refreshToken});switch(n.operationType){case"signIn":const d=await Ps._fromIdTokenResponse(r,n.operationType,c);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return ce(n.user,r,"internal-error"),Ps._forOperation(n.user,n.operationType,c);default:ts(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function _F(t,e){var n;const r=Fe(t),s=e;return ce(e.customData.operationType,r,"argument-error"),ce((n=s.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),nx._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(t,e){return jn(t,"POST","/v2/accounts/mfaEnrollment:start",Pn(t,e))}function xF(t,e){return jn(t,"POST","/v2/accounts/mfaEnrollment:finalize",Pn(t,e))}function wF(t,e){return jn(t,"POST","/v2/accounts/mfaEnrollment:withdraw",Pn(t,e))}class rx{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>Jp._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new rx(e)}async getSession(){return ya._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,s=await this.getSession(),i=await Ui(this.user,r._process(this.user.auth,s,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Ui(this.user,wF(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==n),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const bg=new WeakMap;function fa(t){const e=Fe(t);return bg.has(e)||bg.set(e,rx._fromUser(e)),bg.get(e)}const ep="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ep,"1"),this.storage.removeItem(ep),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF=1e3,EF=10;class MC extends DC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);TL()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,EF):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},bF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}MC.type="LOCAL";const kF=MC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC extends DC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}OC.type="SESSION";const LC=OC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new em(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await TF(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}em.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=sx("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function IF(t){pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function CF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function RF(){return ix()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC="firebaseLocalStorageDb",NF=1,tp="firebaseLocalStorage",VC="fbase_key";class Ad{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function tm(t,e){return t.transaction([tp],e?"readwrite":"readonly").objectStore(tp)}function PF(){const t=indexedDB.deleteDatabase(FC);return new Ad(t).toPromise()}function sv(){const t=indexedDB.open(FC,NF);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(tp,{keyPath:VC})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(tp)?e(r):(r.close(),await PF(),e(await sv()))})})}async function Jb(t,e,n){const r=tm(t,!0).put({[VC]:e,value:n});return new Ad(r).toPromise()}async function jF(t,e){const n=tm(t,!1).get(e),r=await new Ad(n).toPromise();return r===void 0?null:r.value}function Zb(t,e){const n=tm(t,!0).delete(e);return new Ad(n).toPromise()}const DF=800,MF=3;class UC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sv(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>MF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ix()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=em._getInstance(RF()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await CF(),!this.activeServiceWorker)return;this.sender=new SF(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sv();return await Jb(e,ep,"1"),await Zb(e,ep),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>jF(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Zb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=tm(s,!1).getAll();return new Ad(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}UC.type="LOCAL";const OF=UC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(t,e){return jn(t,"POST","/v2/accounts/mfaSignIn:start",Pn(t,e))}function LF(t,e){return jn(t,"POST","/v2/accounts/mfaSignIn:finalize",Pn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eg=bC("rcb"),FF=new Sd(3e4,6e4);class VF{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=pn().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return ce(UF(n),e,"argument-error"),this.shouldResolveImmediately(n)&&Bb(pn().grecaptcha)?Promise.resolve(pn().grecaptcha):new Promise((r,s)=>{const i=pn().setTimeout(()=>{s(Jr(e,"network-request-failed"))},FF.get());pn()[Eg]=()=>{pn().clearTimeout(i),delete pn()[Eg];const a=pn().grecaptcha;if(!a||!Bb(a)){s(Jr(e,"internal-error"));return}const l=a.render;a.render=(c,d)=>{const f=l(c,d);return this.counter++,f},this.hostLanguage=n,r(a)};const o=`${PL()}?${mc({onload:Eg,render:"explicit",hl:n})}`;X_(o).catch(()=>{clearTimeout(i),s(Jr(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=pn().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function UF(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class BF{async load(e){return new LL(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu="recaptcha",zF={theme:"light",type:"image"};class BC{constructor(e,n,r=Object.assign({},zF)){this.parameters=r,this.type=Eu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=vs(e),this.isInvisible=this.parameters.size==="invisible",ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof n=="string"?document.getElementById(n):n;ce(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new BF:new VF,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ce(!this.parameters.sitekey,this.auth,"argument-error"),ce(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=pn()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){ce(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ce(sC()&&!ix(),this.auth,"internal-error"),await $F(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await gL(this.auth);ce(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ce(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function $F(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}async function WF(t,e,n){var r;if(!t._getRecaptchaConfig())try{await $L(t)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const i=s.session;if("phoneNumber"in s){ce(i.type==="enroll",t,"internal-error");const o={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Dl(t,o,"mfaSmsEnrollment",async(d,f)=>{if(f.phoneEnrollmentInfo.captchaResponse===bu){ce((n==null?void 0:n.type)===Eu,d,"argument-error");const p=await kg(d,f,n);return Xb(d,p)}return Xb(d,f)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneSessionInfo.sessionInfo}else{ce(i.type==="signin",t,"internal-error");const o=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;ce(o,t,"missing-multi-factor-info");const a={mfaPendingCredential:i.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Dl(t,a,"mfaSmsSignIn",async(f,p)=>{if(p.phoneSignInInfo.captchaResponse===bu){ce((n==null?void 0:n.type)===Eu,f,"argument-error");const m=await kg(f,p,n);return e1(f,m)}return e1(f,p)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Dl(t,i,"sendVerificationCode",async(c,d)=>{if(d.captchaResponse===bu){ce((n==null?void 0:n.type)===Eu,c,"argument-error");const f=await kg(c,d,n);return Yb(c,f)}return Yb(c,d)},"PHONE_PROVIDER").catch(c=>Promise.reject(c))).sessionInfo}}finally{n==null||n._reset()}}async function kg(t,e,n){ce(n.type===Eu,t,"argument-error");const r=await n.verify();ce(typeof r=="string",t,"argument-error");const s=Object.assign({},e);if("phoneEnrollmentInfo"in s){const i=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,a=s.phoneEnrollmentInfo.clientType,l=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:i,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:l}}),s}else if("phoneSignInInfo"in s){const i=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,a=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:i,clientType:o,recaptchaVersion:a}}),s}else return Object.assign(s,{recaptchaToken:r}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.providerId=ni.PROVIDER_ID,this.auth=vs(e)}verifyPhoneNumber(e,n){return WF(this.auth,e,Fe(n))}static credential(e,n){return Ol._fromVerification(e,n)}static credentialFromResult(e){const n=e;return ni.credentialFromTaggedObject(n)}static credentialFromError(e){return ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Ol._fromTokenResponse(n,r):null}}ni.PROVIDER_ID="phone";ni.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(t,e){return e?Ri(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox extends Xp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ml(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ml(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ml(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function qF(t){return AC(t.auth,new ox(t),t.bypassAuthState)}function GF(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),uF(n,new ox(t),t.bypassAuthState)}async function KF(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),cF(n,new ox(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qF;case"linkViaPopup":case"linkViaRedirect":return KF;case"reauthViaPopup":case"reauthViaRedirect":return GF;default:ts(this.auth,"internal-error")}}resolve(e){Vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF=new Sd(2e3,1e4);class Tl extends zC{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Tl.currentPopupAction&&Tl.currentPopupAction.cancel(),Tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){Vi(this.filter.length===1,"Popup operations only handle one event");const e=sx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Jr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Jr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,YF.get())};e()}}Tl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QF="pendingRedirect",uf=new Map;class XF extends zC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=uf.get(this.auth._key());if(!e){try{const r=await JF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}uf.set(this.auth._key(),e)}return this.bypassAuthState||uf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JF(t,e){const n=tV(e),r=eV(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function ZF(t,e){uf.set(t._key(),e)}function eV(t){return Ri(t._redirectPersistence)}function tV(t){return cf(QF,t.config.apiKey,t.name)}async function nV(t,e,n=!1){if(nr(t.app))return Promise.reject(Rs(t));const r=vs(t),s=HF(r,e),o=await new XF(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=10*60*1e3;class sV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!iV(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!$C(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Jr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rV&&this.cachedEventUids.clear(),this.cachedEventUids.has(t1(e))}saveEventToCache(e){this.cachedEventUids.add(t1(e)),this.lastProcessedEventTime=Date.now()}}function t1(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function $C({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function iV(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $C(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oV(t,e={}){return jn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lV=/^https?/;async function cV(t){if(t.config.emulator)return;const{authorizedDomains:e}=await oV(t);for(const n of e)try{if(uV(n))return}catch{}ts(t,"unauthorized-domain")}function uV(t){const e=nv(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!lV.test(n))return!1;if(aV.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=new Sd(3e4,6e4);function n1(){const t=pn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function hV(t){return new Promise((e,n)=>{var r,s,i;function o(){n1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{n1(),n(Jr(t,"network-request-failed"))},timeout:dV.get()})}if(!((s=(r=pn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=pn().gapi)===null||i===void 0)&&i.load)o();else{const a=bC("iframefcb");return pn()[a]=()=>{gapi.load?o():n(Jr(t,"network-request-failed"))},X_(`${DL()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw df=null,e})}let df=null;function fV(t){return df=df||hV(t),df}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV=new Sd(5e3,15e3),mV="__/auth/iframe",gV="emulator/auth/iframe",yV={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vV=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _V(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?K_(e,gV):`https://${t.config.authDomain}/${mV}`,r={apiKey:e.apiKey,appName:t.name,v:qa},s=vV.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${mc(r).slice(1)}`}async function xV(t){const e=await fV(t),n=pn().gapi;return ce(n,t,"internal-error"),e.open({where:document.body,url:_V(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yV,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Jr(t,"network-request-failed"),a=pn().setTimeout(()=>{i(o)},pV.get());function l(){pn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bV=500,EV=600,kV="_blank",TV="http://localhost";class r1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SV(t,e,n,r=bV,s=EV){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},wV),{width:r.toString(),height:s.toString(),top:i,left:o}),c=lr().toLowerCase();n&&(a=mC(c)?kV:n),fC(c)&&(e=e||TV,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[m,x])=>`${p}${m}=${x},`,"");if(kL(c)&&a!=="_self")return IV(e||"",a),new r1(null);const f=window.open(e||"",a,d);ce(f,t,"popup-blocked");try{f.focus()}catch{}return new r1(f)}function IV(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV="__/auth/handler",AV="emulator/auth/handler",RV=encodeURIComponent("fac");async function s1(t,e,n,r,s,i){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:qa,eventId:s};if(e instanceof TC){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",QM(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof Cd){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${RV}=${encodeURIComponent(l)}`:"";return`${NV(t)}?${mc(a).slice(1)}${c}`}function NV({config:t}){return t.emulator?K_(t,AV):`https://${t.authDomain}/${CV}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tg="webStorageSupport";class PV{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=LC,this._completeRedirectFn=nV,this._overrideRedirectResult=ZF}async _openPopup(e,n,r,s){var i;Vi((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await s1(e,n,r,nv(),s);return SV(e,o,sx())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await s1(e,n,r,nv(),s);return IF(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Vi(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await xV(e),r=new sV(e);return n.register("authEvent",s=>(ce(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Tg,{type:Tg},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Tg];o!==void 0&&n(!!o),ts(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cV(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return xC()||pC()||Q_()}}const jV=PV;class DV{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Js("unexpected MultiFactorSessionType")}}}class ax extends DV{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ax(e)}_finalizeEnroll(e,n,r){return xF(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return LF(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class lx{constructor(){}static assertion(e){return ax._fromCredential(e)}}lx.FACTOR_ID="phone";var i1="@firebase/auth",o1="1.10.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function LV(t){fs(new es("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wC(t)},c=new RL(r,s,i,l);return HL(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),fs(new es("auth-internal",e=>{const n=vs(e.getProvider("auth").getImmediate());return(r=>new MV(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),sr(i1,o1,OV(t)),sr(i1,o1,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV=5*60,VV=qI("authIdTokenMaxAge")||FV;let a1=null;const UV=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>VV)return;const s=n==null?void 0:n.token;a1!==s&&(a1=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function BV(t=Td()){const e=Qo(t,"auth");if(e.isInitialized())return e.getImmediate();const n=WL(t,{popupRedirectResolver:jV,persistence:[OF,kF,LC]}),r=qI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=UV(i.toString());yF(n,o,()=>o(n.currentUser)),PC(n,a=>o(a))}}const s=WI("auth");return s?qL(n,`http://${s}`):Yo("Auth",!1),n}function zV(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}NL({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Jr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",zV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LV("Browser");var $V="firebase",WV="11.7.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sr($V,WV,"app");var l1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Co,WC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,E){function S(){}S.prototype=E.prototype,I.D=E.prototype,I.prototype=new S,I.prototype.constructor=I,I.C=function(C,N,j){for(var P=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)P[ne-2]=arguments[ne];return E.prototype[N].apply(C,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(I,E,S){S||(S=0);var C=Array(16);if(typeof E=="string")for(var N=0;16>N;++N)C[N]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(N=0;16>N;++N)C[N]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=I.g[0],S=I.g[1],N=I.g[2];var j=I.g[3],P=E+(j^S&(N^j))+C[0]+3614090360&4294967295;E=S+(P<<7&4294967295|P>>>25),P=j+(N^E&(S^N))+C[1]+3905402710&4294967295,j=E+(P<<12&4294967295|P>>>20),P=N+(S^j&(E^S))+C[2]+606105819&4294967295,N=j+(P<<17&4294967295|P>>>15),P=S+(E^N&(j^E))+C[3]+3250441966&4294967295,S=N+(P<<22&4294967295|P>>>10),P=E+(j^S&(N^j))+C[4]+4118548399&4294967295,E=S+(P<<7&4294967295|P>>>25),P=j+(N^E&(S^N))+C[5]+1200080426&4294967295,j=E+(P<<12&4294967295|P>>>20),P=N+(S^j&(E^S))+C[6]+2821735955&4294967295,N=j+(P<<17&4294967295|P>>>15),P=S+(E^N&(j^E))+C[7]+4249261313&4294967295,S=N+(P<<22&4294967295|P>>>10),P=E+(j^S&(N^j))+C[8]+1770035416&4294967295,E=S+(P<<7&4294967295|P>>>25),P=j+(N^E&(S^N))+C[9]+2336552879&4294967295,j=E+(P<<12&4294967295|P>>>20),P=N+(S^j&(E^S))+C[10]+4294925233&4294967295,N=j+(P<<17&4294967295|P>>>15),P=S+(E^N&(j^E))+C[11]+2304563134&4294967295,S=N+(P<<22&4294967295|P>>>10),P=E+(j^S&(N^j))+C[12]+1804603682&4294967295,E=S+(P<<7&4294967295|P>>>25),P=j+(N^E&(S^N))+C[13]+4254626195&4294967295,j=E+(P<<12&4294967295|P>>>20),P=N+(S^j&(E^S))+C[14]+2792965006&4294967295,N=j+(P<<17&4294967295|P>>>15),P=S+(E^N&(j^E))+C[15]+1236535329&4294967295,S=N+(P<<22&4294967295|P>>>10),P=E+(N^j&(S^N))+C[1]+4129170786&4294967295,E=S+(P<<5&4294967295|P>>>27),P=j+(S^N&(E^S))+C[6]+3225465664&4294967295,j=E+(P<<9&4294967295|P>>>23),P=N+(E^S&(j^E))+C[11]+643717713&4294967295,N=j+(P<<14&4294967295|P>>>18),P=S+(j^E&(N^j))+C[0]+3921069994&4294967295,S=N+(P<<20&4294967295|P>>>12),P=E+(N^j&(S^N))+C[5]+3593408605&4294967295,E=S+(P<<5&4294967295|P>>>27),P=j+(S^N&(E^S))+C[10]+38016083&4294967295,j=E+(P<<9&4294967295|P>>>23),P=N+(E^S&(j^E))+C[15]+3634488961&4294967295,N=j+(P<<14&4294967295|P>>>18),P=S+(j^E&(N^j))+C[4]+3889429448&4294967295,S=N+(P<<20&4294967295|P>>>12),P=E+(N^j&(S^N))+C[9]+568446438&4294967295,E=S+(P<<5&4294967295|P>>>27),P=j+(S^N&(E^S))+C[14]+3275163606&4294967295,j=E+(P<<9&4294967295|P>>>23),P=N+(E^S&(j^E))+C[3]+4107603335&4294967295,N=j+(P<<14&4294967295|P>>>18),P=S+(j^E&(N^j))+C[8]+1163531501&4294967295,S=N+(P<<20&4294967295|P>>>12),P=E+(N^j&(S^N))+C[13]+2850285829&4294967295,E=S+(P<<5&4294967295|P>>>27),P=j+(S^N&(E^S))+C[2]+4243563512&4294967295,j=E+(P<<9&4294967295|P>>>23),P=N+(E^S&(j^E))+C[7]+1735328473&4294967295,N=j+(P<<14&4294967295|P>>>18),P=S+(j^E&(N^j))+C[12]+2368359562&4294967295,S=N+(P<<20&4294967295|P>>>12),P=E+(S^N^j)+C[5]+4294588738&4294967295,E=S+(P<<4&4294967295|P>>>28),P=j+(E^S^N)+C[8]+2272392833&4294967295,j=E+(P<<11&4294967295|P>>>21),P=N+(j^E^S)+C[11]+1839030562&4294967295,N=j+(P<<16&4294967295|P>>>16),P=S+(N^j^E)+C[14]+4259657740&4294967295,S=N+(P<<23&4294967295|P>>>9),P=E+(S^N^j)+C[1]+2763975236&4294967295,E=S+(P<<4&4294967295|P>>>28),P=j+(E^S^N)+C[4]+1272893353&4294967295,j=E+(P<<11&4294967295|P>>>21),P=N+(j^E^S)+C[7]+4139469664&4294967295,N=j+(P<<16&4294967295|P>>>16),P=S+(N^j^E)+C[10]+3200236656&4294967295,S=N+(P<<23&4294967295|P>>>9),P=E+(S^N^j)+C[13]+681279174&4294967295,E=S+(P<<4&4294967295|P>>>28),P=j+(E^S^N)+C[0]+3936430074&4294967295,j=E+(P<<11&4294967295|P>>>21),P=N+(j^E^S)+C[3]+3572445317&4294967295,N=j+(P<<16&4294967295|P>>>16),P=S+(N^j^E)+C[6]+76029189&4294967295,S=N+(P<<23&4294967295|P>>>9),P=E+(S^N^j)+C[9]+3654602809&4294967295,E=S+(P<<4&4294967295|P>>>28),P=j+(E^S^N)+C[12]+3873151461&4294967295,j=E+(P<<11&4294967295|P>>>21),P=N+(j^E^S)+C[15]+530742520&4294967295,N=j+(P<<16&4294967295|P>>>16),P=S+(N^j^E)+C[2]+3299628645&4294967295,S=N+(P<<23&4294967295|P>>>9),P=E+(N^(S|~j))+C[0]+4096336452&4294967295,E=S+(P<<6&4294967295|P>>>26),P=j+(S^(E|~N))+C[7]+1126891415&4294967295,j=E+(P<<10&4294967295|P>>>22),P=N+(E^(j|~S))+C[14]+2878612391&4294967295,N=j+(P<<15&4294967295|P>>>17),P=S+(j^(N|~E))+C[5]+4237533241&4294967295,S=N+(P<<21&4294967295|P>>>11),P=E+(N^(S|~j))+C[12]+1700485571&4294967295,E=S+(P<<6&4294967295|P>>>26),P=j+(S^(E|~N))+C[3]+2399980690&4294967295,j=E+(P<<10&4294967295|P>>>22),P=N+(E^(j|~S))+C[10]+4293915773&4294967295,N=j+(P<<15&4294967295|P>>>17),P=S+(j^(N|~E))+C[1]+2240044497&4294967295,S=N+(P<<21&4294967295|P>>>11),P=E+(N^(S|~j))+C[8]+1873313359&4294967295,E=S+(P<<6&4294967295|P>>>26),P=j+(S^(E|~N))+C[15]+4264355552&4294967295,j=E+(P<<10&4294967295|P>>>22),P=N+(E^(j|~S))+C[6]+2734768916&4294967295,N=j+(P<<15&4294967295|P>>>17),P=S+(j^(N|~E))+C[13]+1309151649&4294967295,S=N+(P<<21&4294967295|P>>>11),P=E+(N^(S|~j))+C[4]+4149444226&4294967295,E=S+(P<<6&4294967295|P>>>26),P=j+(S^(E|~N))+C[11]+3174756917&4294967295,j=E+(P<<10&4294967295|P>>>22),P=N+(E^(j|~S))+C[2]+718787259&4294967295,N=j+(P<<15&4294967295|P>>>17),P=S+(j^(N|~E))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+E&4294967295,I.g[1]=I.g[1]+(N+(P<<21&4294967295|P>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+j&4294967295}r.prototype.u=function(I,E){E===void 0&&(E=I.length);for(var S=E-this.blockSize,C=this.B,N=this.h,j=0;j<E;){if(N==0)for(;j<=S;)s(this,I,j),j+=this.blockSize;if(typeof I=="string"){for(;j<E;)if(C[N++]=I.charCodeAt(j++),N==this.blockSize){s(this,C),N=0;break}}else for(;j<E;)if(C[N++]=I[j++],N==this.blockSize){s(this,C),N=0;break}}this.h=N,this.o+=E},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var E=1;E<I.length-8;++E)I[E]=0;var S=8*this.o;for(E=I.length-8;E<I.length;++E)I[E]=S&255,S/=256;for(this.u(I),I=Array(16),E=S=0;4>E;++E)for(var C=0;32>C;C+=8)I[S++]=this.g[E]>>>C&255;return I};function i(I,E){var S=a;return Object.prototype.hasOwnProperty.call(S,I)?S[I]:S[I]=E(I)}function o(I,E){this.h=E;for(var S=[],C=!0,N=I.length-1;0<=N;N--){var j=I[N]|0;C&&j==E||(S[N]=j,C=!1)}this.g=S}var a={};function l(I){return-128<=I&&128>I?i(I,function(E){return new o([E|0],0>E?-1:0)}):new o([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return y(c(-I));for(var E=[],S=1,C=0;I>=S;C++)E[C]=I/S|0,S*=4294967296;return new o(E,0)}function d(I,E){if(I.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(I.charAt(0)=="-")return y(d(I.substring(1),E));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(E,8)),C=f,N=0;N<I.length;N+=8){var j=Math.min(8,I.length-N),P=parseInt(I.substring(N,N+j),E);8>j?(j=c(Math.pow(E,j)),C=C.j(j).add(c(P))):(C=C.j(S),C=C.add(c(P)))}return C}var f=l(0),p=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(w(this))return-y(this).m();for(var I=0,E=1,S=0;S<this.g.length;S++){var C=this.i(S);I+=(0<=C?C:4294967296+C)*E,E*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(x(this))return"0";if(w(this))return"-"+y(this).toString(I);for(var E=c(Math.pow(I,6)),S=this,C="";;){var N=A(S,E).g;S=_(S,N.j(E));var j=((0<S.g.length?S.g[0]:S.h)>>>0).toString(I);if(S=N,x(S))return j+C;for(;6>j.length;)j="0"+j;C=j+C}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function x(I){if(I.h!=0)return!1;for(var E=0;E<I.g.length;E++)if(I.g[E]!=0)return!1;return!0}function w(I){return I.h==-1}t.l=function(I){return I=_(this,I),w(I)?-1:x(I)?0:1};function y(I){for(var E=I.g.length,S=[],C=0;C<E;C++)S[C]=~I.g[C];return new o(S,~I.h).add(p)}t.abs=function(){return w(this)?y(this):this},t.add=function(I){for(var E=Math.max(this.g.length,I.g.length),S=[],C=0,N=0;N<=E;N++){var j=C+(this.i(N)&65535)+(I.i(N)&65535),P=(j>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);C=P>>>16,j&=65535,P&=65535,S[N]=P<<16|j}return new o(S,S[S.length-1]&-2147483648?-1:0)};function _(I,E){return I.add(y(E))}t.j=function(I){if(x(this)||x(I))return f;if(w(this))return w(I)?y(this).j(y(I)):y(y(this).j(I));if(w(I))return y(this.j(y(I)));if(0>this.l(m)&&0>I.l(m))return c(this.m()*I.m());for(var E=this.g.length+I.g.length,S=[],C=0;C<2*E;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var N=0;N<I.g.length;N++){var j=this.i(C)>>>16,P=this.i(C)&65535,ne=I.i(N)>>>16,ae=I.i(N)&65535;S[2*C+2*N]+=P*ae,v(S,2*C+2*N),S[2*C+2*N+1]+=j*ae,v(S,2*C+2*N+1),S[2*C+2*N+1]+=P*ne,v(S,2*C+2*N+1),S[2*C+2*N+2]+=j*ne,v(S,2*C+2*N+2)}for(C=0;C<E;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=E;C<2*E;C++)S[C]=0;return new o(S,0)};function v(I,E){for(;(I[E]&65535)!=I[E];)I[E+1]+=I[E]>>>16,I[E]&=65535,E++}function k(I,E){this.g=I,this.h=E}function A(I,E){if(x(E))throw Error("division by zero");if(x(I))return new k(f,f);if(w(I))return E=A(y(I),E),new k(y(E.g),y(E.h));if(w(E))return E=A(I,y(E)),new k(y(E.g),E.h);if(30<I.g.length){if(w(I)||w(E))throw Error("slowDivide_ only works with positive integers.");for(var S=p,C=E;0>=C.l(I);)S=D(S),C=D(C);var N=O(S,1),j=O(C,1);for(C=O(C,2),S=O(S,2);!x(C);){var P=j.add(C);0>=P.l(I)&&(N=N.add(S),j=P),C=O(C,1),S=O(S,1)}return E=_(I,N.j(E)),new k(N,E)}for(N=f;0<=I.l(E);){for(S=Math.max(1,Math.floor(I.m()/E.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),j=c(S),P=j.j(E);w(P)||0<P.l(I);)S-=C,j=c(S),P=j.j(E);x(j)&&(j=p),N=N.add(j),I=_(I,P)}return new k(N,I)}t.A=function(I){return A(this,I).h},t.and=function(I){for(var E=Math.max(this.g.length,I.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)&I.i(C);return new o(S,this.h&I.h)},t.or=function(I){for(var E=Math.max(this.g.length,I.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)|I.i(C);return new o(S,this.h|I.h)},t.xor=function(I){for(var E=Math.max(this.g.length,I.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)^I.i(C);return new o(S,this.h^I.h)};function D(I){for(var E=I.g.length+1,S=[],C=0;C<E;C++)S[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(S,I.h)}function O(I,E){var S=E>>5;E%=32;for(var C=I.g.length-S,N=[],j=0;j<C;j++)N[j]=0<E?I.i(j+S)>>>E|I.i(j+S+1)<<32-E:I.i(j+S);return new o(N,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,WC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Co=o}).apply(typeof l1<"u"?l1:typeof self<"u"?self:typeof window<"u"?window:{});var _h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var HC,ru,qC,hf,iv,GC,KC,YC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,g,b){return h==Array.prototype||h==Object.prototype||(h[g]=b.value),h};function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof _h=="object"&&_h];for(var g=0;g<h.length;++g){var b=h[g];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=n(this);function s(h,g){if(g)e:{var b=r;h=h.split(".");for(var R=0;R<h.length-1;R++){var U=h[R];if(!(U in b))break e;b=b[U]}h=h[h.length-1],R=b[h],g=g(R),g!=R&&g!=null&&e(b,h,{configurable:!0,writable:!0,value:g})}}function i(h,g){h instanceof String&&(h+="");var b=0,R=!1,U={next:function(){if(!R&&b<h.length){var q=b++;return{value:g(q,h[q]),done:!1}}return R=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}s("Array.prototype.values",function(h){return h||function(){return i(this,function(g,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var g=typeof h;return g=g!="object"?g:h?Array.isArray(h)?"array":g:"null",g=="array"||g=="object"&&typeof h.length=="number"}function c(h){var g=typeof h;return g=="object"&&h!=null||g=="function"}function d(h,g,b){return h.call.apply(h.bind,arguments)}function f(h,g,b){if(!h)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,R),h.apply(g,U)}}return function(){return h.apply(g,arguments)}}function p(h,g,b){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function m(h,g){var b=Array.prototype.slice.call(arguments,1);return function(){var R=b.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function x(h,g){function b(){}b.prototype=g.prototype,h.aa=g.prototype,h.prototype=new b,h.prototype.constructor=h,h.Qb=function(R,U,q){for(var se=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)se[_t-2]=arguments[_t];return g.prototype[U].apply(R,se)}}function w(h){const g=h.length;if(0<g){const b=Array(g);for(let R=0;R<g;R++)b[R]=h[R];return b}return[]}function y(h,g){for(let b=1;b<arguments.length;b++){const R=arguments[b];if(l(R)){const U=h.length||0,q=R.length||0;h.length=U+q;for(let se=0;se<q;se++)h[U+se]=R[se]}else h.push(R)}}class _{constructor(g,b){this.i=g,this.j=b,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function v(h){return/^[\s\xa0]*$/.test(h)}function k(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function A(h){return A[" "](h),h}A[" "]=function(){};var D=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function O(h,g,b){for(const R in h)g.call(b,h[R],R,h)}function I(h,g){for(const b in h)g.call(void 0,h[b],b,h)}function E(h){const g={};for(const b in h)g[b]=h[b];return g}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(h,g){let b,R;for(let U=1;U<arguments.length;U++){R=arguments[U];for(b in R)h[b]=R[b];for(let q=0;q<S.length;q++)b=S[q],Object.prototype.hasOwnProperty.call(R,b)&&(h[b]=R[b])}}function N(h){var g=1;h=h.split(":");const b=[];for(;0<g&&h.length;)b.push(h.shift()),g--;return h.length&&b.push(h.join(":")),b}function j(h){a.setTimeout(()=>{throw h},0)}function P(){var h=G;let g=null;return h.g&&(g=h.g,h.g=h.g.next,h.g||(h.h=null),g.next=null),g}class ne{constructor(){this.h=this.g=null}add(g,b){const R=ae.get();R.set(g,b),this.h?this.h.next=R:this.g=R,this.h=R}}var ae=new _(()=>new F,h=>h.reset());class F{constructor(){this.next=this.g=this.h=null}set(g,b){this.h=g,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let W,V=!1,G=new ne,re=()=>{const h=a.Promise.resolve(void 0);W=()=>{h.then(_e)}};var _e=()=>{for(var h;h=P();){try{h.h.call(h.g)}catch(b){j(b)}var g=ae;g.j(h),100>g.h&&(g.h++,h.next=g.g,g.g=h)}V=!1};function ke(){this.s=this.s,this.C=this.C}ke.prototype.s=!1,ke.prototype.ma=function(){this.s||(this.s=!0,this.N())},ke.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(h,g){this.type=h,this.g=this.target=g,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var Oe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,g=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const b=()=>{};a.addEventListener("test",b,g),a.removeEventListener("test",b,g)}catch{}return h}();function Dt(h,g){if(Ie.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var b=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=g,g=h.relatedTarget){if(D){e:{try{A(g.nodeName);var U=!0;break e}catch{}U=!1}U||(g=null)}}else b=="mouseover"?g=h.fromElement:b=="mouseout"&&(g=h.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ht[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Dt.aa.h.call(this)}}x(Dt,Ie);var ht={2:"touch",3:"pen",4:"mouse"};Dt.prototype.h=function(){Dt.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var wt="closure_listenable_"+(1e6*Math.random()|0),Dn=0;function Os(h,g,b,R,U){this.listener=h,this.proxy=null,this.src=g,this.type=b,this.capture=!!R,this.ha=U,this.key=++Dn,this.da=this.fa=!1}function Mn(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ur(h){this.src=h,this.g={},this.h=0}Ur.prototype.add=function(h,g,b,R,U){var q=h.toString();h=this.g[q],h||(h=this.g[q]=[],this.h++);var se=xr(h,g,R,U);return-1<se?(g=h[se],b||(g.fa=!1)):(g=new Os(g,this.src,q,!!R,U),g.fa=b,h.push(g)),g};function _s(h,g){var b=g.type;if(b in h.g){var R=h.g[b],U=Array.prototype.indexOf.call(R,g,void 0),q;(q=0<=U)&&Array.prototype.splice.call(R,U,1),q&&(Mn(g),h.g[b].length==0&&(delete h.g[b],h.h--))}}function xr(h,g,b,R){for(var U=0;U<h.length;++U){var q=h[U];if(!q.da&&q.listener==g&&q.capture==!!b&&q.ha==R)return U}return-1}var cr="closure_lm_"+(1e6*Math.random()|0),dn={};function pi(h,g,b,R,U){if(Array.isArray(g)){for(var q=0;q<g.length;q++)pi(h,g[q],b,R,U);return null}return b=br(b),h&&h[wt]?h.K(g,b,c(R)?!!R.capture:!1,U):Ce(h,g,b,!1,R,U)}function Ce(h,g,b,R,U,q){if(!g)throw Error("Invalid event type");var se=c(U)?!!U.capture:!!U,_t=Ls(h);if(_t||(h[cr]=_t=new Ur(h)),b=_t.add(g,b,R,se,q),b.proxy)return b;if(R=mi(),b.proxy=R,R.src=h,R.listener=b,h.addEventListener)Oe||(U=se),U===void 0&&(U=!1),h.addEventListener(g.toString(),R,U);else if(h.attachEvent)h.attachEvent(vn(g.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return b}function mi(){function h(b){return g.call(h.src,h.listener,b)}const g=gi;return h}function ss(h,g,b,R,U){if(Array.isArray(g))for(var q=0;q<g.length;q++)ss(h,g[q],b,R,U);else R=c(R)?!!R.capture:!!R,b=br(b),h&&h[wt]?(h=h.i,g=String(g).toString(),g in h.g&&(q=h.g[g],b=xr(q,b,R,U),-1<b&&(Mn(q[b]),Array.prototype.splice.call(q,b,1),q.length==0&&(delete h.g[g],h.h--)))):h&&(h=Ls(h))&&(g=h.g[g.toString()],h=-1,g&&(h=xr(g,b,R,U)),(b=-1<h?g[h]:null)&&wr(b))}function wr(h){if(typeof h!="number"&&h&&!h.da){var g=h.src;if(g&&g[wt])_s(g.i,h);else{var b=h.type,R=h.proxy;g.removeEventListener?g.removeEventListener(b,R,h.capture):g.detachEvent?g.detachEvent(vn(b),R):g.addListener&&g.removeListener&&g.removeListener(R),(b=Ls(g))?(_s(b,h),b.h==0&&(b.src=null,g[cr]=null)):Mn(h)}}}function vn(h){return h in dn?dn[h]:dn[h]="on"+h}function gi(h,g){if(h.da)h=!0;else{g=new Dt(g,this);var b=h.listener,R=h.ha||h.src;h.fa&&wr(h),h=b.call(R,g)}return h}function Ls(h){return h=h[cr],h instanceof Ur?h:null}var Br="__closure_events_fn_"+(1e9*Math.random()>>>0);function br(h){return typeof h=="function"?h:(h[Br]||(h[Br]=function(g){return h.handleEvent(g)}),h[Br])}function bt(){ke.call(this),this.i=new Ur(this),this.M=this,this.F=null}x(bt,ke),bt.prototype[wt]=!0,bt.prototype.removeEventListener=function(h,g,b,R){ss(this,h,g,b,R)};function Mt(h,g){var b,R=h.F;if(R)for(b=[];R;R=R.F)b.push(R);if(h=h.M,R=g.type||g,typeof g=="string")g=new Ie(g,h);else if(g instanceof Ie)g.target=g.target||h;else{var U=g;g=new Ie(R,h),C(g,U)}if(U=!0,b)for(var q=b.length-1;0<=q;q--){var se=g.g=b[q];U=Er(se,R,!0,g)&&U}if(se=g.g=h,U=Er(se,R,!0,g)&&U,U=Er(se,R,!1,g)&&U,b)for(q=0;q<b.length;q++)se=g.g=b[q],U=Er(se,R,!1,g)&&U}bt.prototype.N=function(){if(bt.aa.N.call(this),this.i){var h=this.i,g;for(g in h.g){for(var b=h.g[g],R=0;R<b.length;R++)Mn(b[R]);delete h.g[g],h.h--}}this.F=null},bt.prototype.K=function(h,g,b,R){return this.i.add(String(h),g,!1,b,R)},bt.prototype.L=function(h,g,b,R){return this.i.add(String(h),g,!0,b,R)};function Er(h,g,b,R){if(g=h.i.g[String(g)],!g)return!0;g=g.concat();for(var U=!0,q=0;q<g.length;++q){var se=g[q];if(se&&!se.da&&se.capture==b){var _t=se.listener,On=se.ha||se.src;se.fa&&_s(h.i,se),U=_t.call(On,R)!==!1&&U}}return U&&!R.defaultPrevented}function B(h,g,b){if(typeof h=="function")b&&(h=p(h,b));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(h,g||0)}function ee(h){h.g=B(()=>{h.g=null,h.i&&(h.i=!1,ee(h))},h.l);const g=h.h;h.h=null,h.m.apply(null,g)}class ie extends ke{constructor(g,b){super(),this.m=g,this.l=b,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(h){ke.call(this),this.h=h,this.g={}}x(de,ke);var we=[];function Ve(h){O(h.g,function(g,b){this.g.hasOwnProperty(b)&&wr(g)},h),h.g={}}de.prototype.N=function(){de.aa.N.call(this),Ve(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ge=a.JSON.stringify,Ot=a.JSON.parse,_n=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function kr(){}kr.prototype.h=null;function Tr(h){return h.h||(h.h=h.i())}function xs(){}var rt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ur(){Ie.call(this,"d")}x(ur,Ie);function zr(){Ie.call(this,"c")}x(zr,Ie);var Sn={},M=null;function $(){return M=M||new bt}Sn.La="serverreachability";function L(h){Ie.call(this,Sn.La,h)}x(L,Ie);function K(h){const g=$();Mt(g,new L(g))}Sn.STAT_EVENT="statevent";function Q(h,g){Ie.call(this,Sn.STAT_EVENT,h),this.stat=g}x(Q,Ie);function z(h){const g=$();Mt(g,new Q(g,h))}Sn.Ma="timingevent";function ve(h,g){Ie.call(this,Sn.Ma,h),this.size=g}x(ve,Ie);function le(h,g){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},g)}function Re(){this.g=!0}Re.prototype.xa=function(){this.g=!1};function je(h,g,b,R,U,q){h.info(function(){if(h.g)if(q)for(var se="",_t=q.split("&"),On=0;On<_t.length;On++){var tt=_t[On].split("=");if(1<tt.length){var Gn=tt[0];tt=tt[1];var Kn=Gn.split("_");se=2<=Kn.length&&Kn[1]=="type"?se+(Gn+"="+tt+"&"):se+(Gn+"=redacted&")}}else se=null;else se=q;return"XMLHTTP REQ ("+R+") [attempt "+U+"]: "+g+`
`+b+`
`+se})}function Ke(h,g,b,R,U,q,se){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+U+"]: "+g+`
`+b+`
`+q+" "+se})}function st(h,g,b,R){h.info(function(){return"XMLHTTP TEXT ("+g+"): "+Bt(h,b)+(R?" "+R:"")})}function Ct(h,g){h.info(function(){return"TIMEOUT: "+g})}Re.prototype.info=function(){};function Bt(h,g){if(!h.g)return g;if(!g)return null;try{var b=JSON.parse(g);if(b){for(h=0;h<b.length;h++)if(Array.isArray(b[h])){var R=b[h];if(!(2>R.length)){var U=R[1];if(Array.isArray(U)&&!(1>U.length)){var q=U[0];if(q!="noop"&&q!="stop"&&q!="close")for(var se=1;se<U.length;se++)U[se]=""}}}}return ge(b)}catch{return g}}var Ye={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},et={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yt;function ft(){}x(ft,kr),ft.prototype.g=function(){return new XMLHttpRequest},ft.prototype.i=function(){return{}},yt=new ft;function it(h,g,b,R){this.j=h,this.i=g,this.l=b,this.R=R||1,this.U=new de(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qe}function qe(){this.i=null,this.g="",this.h=!1}var Lt={},hn={};function At(h,g,b){h.L=1,h.v=Tt(kt(g)),h.m=b,h.P=!0,In(h,null)}function In(h,g){h.F=Date.now(),Z(h),h.A=kt(h.v);var b=h.A,R=h.R;Array.isArray(R)||(R=[String(R)]),Ww(b.i,"t",R),h.C=0,b=h.j.J,h.h=new qe,h.g=l0(h.j,b?g:null,!h.m),0<h.O&&(h.M=new ie(p(h.Y,h,h.g),h.O)),g=h.U,b=h.g,R=h.ca;var U="readystatechange";Array.isArray(U)||(U&&(we[0]=U.toString()),U=we);for(var q=0;q<U.length;q++){var se=pi(b,U[q],R||g.handleEvent,!1,g.h||g);if(!se)break;g.g[se.key]=se}g=h.H?E(h.H):{},h.m?(h.u||(h.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,g)):(h.u="GET",h.g.ea(h.A,h.u,null,g)),K(),je(h.i,h.u,h.A,h.l,h.R,h.m)}it.prototype.ca=function(h){h=h.target;const g=this.M;g&&xi(h)==3?g.j():this.Y(h)},it.prototype.Y=function(h){try{if(h==this.g)e:{const Kn=xi(this.g);var g=this.g.Ba();const rl=this.g.Z();if(!(3>Kn)&&(Kn!=3||this.g&&(this.h.h||this.g.oa()||Xw(this.g)))){this.J||Kn!=4||g==7||(g==8||0>=rl?K(3):K(2)),fe(this);var b=this.g.Z();this.X=b;t:if(Fs(this)){var R=Xw(this.g);h="";var U=R.length,q=xi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){he(this),De(this);var se="";break t}this.h.i=new a.TextDecoder}for(g=0;g<U;g++)this.h.h=!0,h+=this.h.i.decode(R[g],{stream:!(q&&g==U-1)});R.length=0,this.h.g+=h,this.C=0,se=this.h.g}else se=this.g.oa();if(this.o=b==200,Ke(this.i,this.u,this.A,this.l,this.R,Kn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var _t,On=this.g;if((_t=On.g?On.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(_t)){var tt=_t;break t}}tt=null}if(b=tt)st(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gt(this,b);else{this.o=!1,this.s=3,z(12),he(this),De(this);break e}}if(this.P){b=!0;let ws;for(;!this.J&&this.C<se.length;)if(ws=Vs(this,se),ws==hn){Kn==4&&(this.s=4,z(14),b=!1),st(this.i,this.l,null,"[Incomplete Response]");break}else if(ws==Lt){this.s=4,z(15),st(this.i,this.l,se,"[Invalid Chunk]"),b=!1;break}else st(this.i,this.l,ws,null),gt(this,ws);if(Fs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Kn!=4||se.length!=0||this.h.h||(this.s=1,z(16),b=!1),this.o=this.o&&b,!b)st(this.i,this.l,se,"[Invalid Chunked Response]"),he(this),De(this);else if(0<se.length&&!this.W){this.W=!0;var Gn=this.j;Gn.g==this&&Gn.ba&&!Gn.M&&(Gn.j.info("Great, no buffering proxy detected. Bytes received: "+se.length),Um(Gn),Gn.M=!0,z(11))}}else st(this.i,this.l,se,null),gt(this,se);Kn==4&&he(this),this.o&&!this.J&&(Kn==4?s0(this.j,this):(this.o=!1,Z(this)))}else KP(this.g),b==400&&0<se.indexOf("Unknown SID")?(this.s=3,z(12)):(this.s=0,z(13)),he(this),De(this)}}}catch{}finally{}};function Fs(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Vs(h,g){var b=h.C,R=g.indexOf(`
`,b);return R==-1?hn:(b=Number(g.substring(b,R)),isNaN(b)?Lt:(R+=1,R+b>g.length?hn:(g=g.slice(R,R+b),h.C=R+b,g)))}it.prototype.cancel=function(){this.J=!0,he(this)};function Z(h){h.S=Date.now()+h.I,ye(h,h.I)}function ye(h,g){if(h.B!=null)throw Error("WatchDog timer not null");h.B=le(p(h.ba,h),g)}function fe(h){h.B&&(a.clearTimeout(h.B),h.B=null)}it.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Ct(this.i,this.A),this.L!=2&&(K(),z(17)),he(this),this.s=2,De(this)):ye(this,this.S-h)};function De(h){h.j.G==0||h.J||s0(h.j,h)}function he(h){fe(h);var g=h.M;g&&typeof g.ma=="function"&&g.ma(),h.M=null,Ve(h.U),h.g&&(g=h.g,h.g=null,g.abort(),g.ma())}function gt(h,g){try{var b=h.j;if(b.G!=0&&(b.g==h||ot(b.h,h))){if(!h.K&&ot(b.h,h)&&b.G==3){try{var R=b.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var U=R;if(U[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<h.F)Jd(b),Qd(b);else break e;Vm(b),z(18)}}else b.za=U[1],0<b.za-b.T&&37500>U[2]&&b.F&&b.v==0&&!b.C&&(b.C=le(p(b.Za,b),6e3));if(1>=zt(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else ra(b,11)}else if((h.K||b.g==h)&&Jd(b),!v(g))for(U=b.Da.g.parse(g),g=0;g<U.length;g++){let tt=U[g];if(b.T=tt[0],tt=tt[1],b.G==2)if(tt[0]=="c"){b.K=tt[1],b.ia=tt[2];const Gn=tt[3];Gn!=null&&(b.la=Gn,b.j.info("VER="+b.la));const Kn=tt[4];Kn!=null&&(b.Aa=Kn,b.j.info("SVER="+b.Aa));const rl=tt[5];rl!=null&&typeof rl=="number"&&0<rl&&(R=1.5*rl,b.L=R,b.j.info("backChannelRequestTimeoutMs_="+R)),R=b;const ws=h.g;if(ws){const eh=ws.g?ws.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(eh){var q=R.h;q.g||eh.indexOf("spdy")==-1&&eh.indexOf("quic")==-1&&eh.indexOf("h2")==-1||(q.j=q.l,q.g=new Set,q.h&&(Et(q,q.h),q.h=null))}if(R.D){const Bm=ws.g?ws.g.getResponseHeader("X-HTTP-Session-Id"):null;Bm&&(R.ya=Bm,xe(R.I,R.D,Bm))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-h.F,b.j.info("Handshake RTT: "+b.R+"ms")),R=b;var se=h;if(R.qa=a0(R,R.J?R.ia:null,R.W),se.K){xn(R.h,se);var _t=se,On=R.L;On&&(_t.I=On),_t.B&&(fe(_t),Z(_t)),R.g=se}else n0(R);0<b.i.length&&Xd(b)}else tt[0]!="stop"&&tt[0]!="close"||ra(b,7);else b.G==3&&(tt[0]=="stop"||tt[0]=="close"?tt[0]=="stop"?ra(b,7):Fm(b):tt[0]!="noop"&&b.l&&b.l.ta(tt),b.v=0)}}K(4)}catch{}}var $r=class{constructor(h,g){this.g=h,this.map=g}};function qn(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ue(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function zt(h){return h.h?1:h.g?h.g.size:0}function ot(h,g){return h.h?h.h==g:h.g?h.g.has(g):!1}function Et(h,g){h.g?h.g.add(g):h.h=g}function xn(h,g){h.h&&h.h==g?h.h=null:h.g&&h.g.has(g)&&h.g.delete(g)}qn.prototype.cancel=function(){if(this.i=wn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function wn(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let g=h.i;for(const b of h.g.values())g=g.concat(b.D);return g}return w(h.i)}function Sr(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var g=[],b=h.length,R=0;R<b;R++)g.push(h[R]);return g}g=[],b=0;for(R in h)g[b++]=h[R];return g}function yi(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var g=[];h=h.length;for(var b=0;b<h;b++)g.push(b);return g}g=[],b=0;for(const R in h)g[b++]=R;return g}}}function Us(h,g){if(h.forEach&&typeof h.forEach=="function")h.forEach(g,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,g,void 0);else for(var b=yi(h),R=Sr(h),U=R.length,q=0;q<U;q++)g.call(void 0,R[q],b&&b[q],h)}var vi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ta(h,g){if(h){h=h.split("&");for(var b=0;b<h.length;b++){var R=h[b].indexOf("="),U=null;if(0<=R){var q=h[b].substring(0,R);U=h[b].substring(R+1)}else q=h[b];g(q,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function vt(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof vt){this.h=h.h,_i(this,h.j),this.o=h.o,this.g=h.g,el(this,h.s),this.l=h.l;var g=h.i,b=new Sc;b.i=g.i,g.g&&(b.g=new Map(g.g),b.h=g.h),Te(this,b),this.m=h.m}else h&&(g=String(h).match(vi))?(this.h=!1,_i(this,g[1]||"",!0),this.o=$t(g[2]||""),this.g=$t(g[3]||"",!0),el(this,g[4]),this.l=$t(g[5]||"",!0),Te(this,g[6]||"",!0),this.m=$t(g[7]||"")):(this.h=!1,this.i=new Sc(null,this.h))}vt.prototype.toString=function(){var h=[],g=this.j;g&&h.push(is(g,na,!0),":");var b=this.g;return(b||g=="file")&&(h.push("//"),(g=this.o)&&h.push(is(g,na,!0),"@"),h.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&h.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&h.push("/"),h.push(is(b,b.charAt(0)=="/"?FP:Om,!0))),(b=this.i.toString())&&h.push("?",b),(b=this.m)&&h.push("#",is(b,UP)),h.join("")};function kt(h){return new vt(h)}function _i(h,g,b){h.j=b?$t(g,!0):g,h.j&&(h.j=h.j.replace(/:$/,""))}function el(h,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);h.s=g}else h.s=null}function Te(h,g,b){g instanceof Sc?(h.i=g,BP(h.i,h.h)):(b||(g=is(g,VP)),h.i=new Sc(g,h.h))}function xe(h,g,b){h.i.set(g,b)}function Tt(h){return xe(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function $t(h,g){return h?g?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function is(h,g,b){return typeof h=="string"?(h=encodeURI(h).replace(g,Bs),b&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Bs(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var na=/[#\/\?@]/g,Om=/[#\?:]/g,FP=/[#\?]/g,VP=/[#\?@]/g,UP=/#/g;function Sc(h,g){this.h=this.g=null,this.i=h||null,this.j=!!g}function qi(h){h.g||(h.g=new Map,h.h=0,h.i&&ta(h.i,function(g,b){h.add(decodeURIComponent(g.replace(/\+/g," ")),b)}))}t=Sc.prototype,t.add=function(h,g){qi(this),this.i=null,h=tl(this,h);var b=this.g.get(h);return b||this.g.set(h,b=[]),b.push(g),this.h+=1,this};function zw(h,g){qi(h),g=tl(h,g),h.g.has(g)&&(h.i=null,h.h-=h.g.get(g).length,h.g.delete(g))}function $w(h,g){return qi(h),g=tl(h,g),h.g.has(g)}t.forEach=function(h,g){qi(this),this.g.forEach(function(b,R){b.forEach(function(U){h.call(g,U,R,this)},this)},this)},t.na=function(){qi(this);const h=Array.from(this.g.values()),g=Array.from(this.g.keys()),b=[];for(let R=0;R<g.length;R++){const U=h[R];for(let q=0;q<U.length;q++)b.push(g[R])}return b},t.V=function(h){qi(this);let g=[];if(typeof h=="string")$w(this,h)&&(g=g.concat(this.g.get(tl(this,h))));else{h=Array.from(this.g.values());for(let b=0;b<h.length;b++)g=g.concat(h[b])}return g},t.set=function(h,g){return qi(this),this.i=null,h=tl(this,h),$w(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[g]),this.h+=1,this},t.get=function(h,g){return h?(h=this.V(h),0<h.length?String(h[0]):g):g};function Ww(h,g,b){zw(h,g),0<b.length&&(h.i=null,h.g.set(tl(h,g),w(b)),h.h+=b.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],g=Array.from(this.g.keys());for(var b=0;b<g.length;b++){var R=g[b];const q=encodeURIComponent(String(R)),se=this.V(R);for(R=0;R<se.length;R++){var U=q;se[R]!==""&&(U+="="+encodeURIComponent(String(se[R]))),h.push(U)}}return this.i=h.join("&")};function tl(h,g){return g=String(g),h.j&&(g=g.toLowerCase()),g}function BP(h,g){g&&!h.j&&(qi(h),h.i=null,h.g.forEach(function(b,R){var U=R.toLowerCase();R!=U&&(zw(this,R),Ww(this,U,b))},h)),h.j=g}function zP(h,g){const b=new Re;if(a.Image){const R=new Image;R.onload=m(Gi,b,"TestLoadImage: loaded",!0,g,R),R.onerror=m(Gi,b,"TestLoadImage: error",!1,g,R),R.onabort=m(Gi,b,"TestLoadImage: abort",!1,g,R),R.ontimeout=m(Gi,b,"TestLoadImage: timeout",!1,g,R),a.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else g(!1)}function $P(h,g){const b=new Re,R=new AbortController,U=setTimeout(()=>{R.abort(),Gi(b,"TestPingServer: timeout",!1,g)},1e4);fetch(h,{signal:R.signal}).then(q=>{clearTimeout(U),q.ok?Gi(b,"TestPingServer: ok",!0,g):Gi(b,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(U),Gi(b,"TestPingServer: error",!1,g)})}function Gi(h,g,b,R,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),R(b)}catch{}}function WP(){this.g=new _n}function HP(h,g,b){const R=b||"";try{Us(h,function(U,q){let se=U;c(U)&&(se=ge(U)),g.push(R+q+"="+encodeURIComponent(se))})}catch(U){throw g.push(R+"type="+encodeURIComponent("_badmap")),U}}function Gd(h){this.l=h.Ub||null,this.j=h.eb||!1}x(Gd,kr),Gd.prototype.g=function(){return new Kd(this.l,this.j)},Gd.prototype.i=function(h){return function(){return h}}({});function Kd(h,g){bt.call(this),this.D=h,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Kd,bt),t=Kd.prototype,t.open=function(h,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=g,this.readyState=1,Cc(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(g.body=h),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ic(this)),this.readyState=0},t.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Cc(this)),this.g&&(this.readyState=3,Cc(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hw(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hw(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}t.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var g=h.value?h.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!h.done}))&&(this.response=this.responseText+=g)}h.done?Ic(this):Cc(this),this.readyState==3&&Hw(this)}},t.Ra=function(h){this.g&&(this.response=this.responseText=h,Ic(this))},t.Qa=function(h){this.g&&(this.response=h,Ic(this))},t.ga=function(){this.g&&Ic(this)};function Ic(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Cc(h)}t.setRequestHeader=function(h,g){this.u.append(h,g)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],g=this.h.entries();for(var b=g.next();!b.done;)b=b.value,h.push(b[0]+": "+b[1]),b=g.next();return h.join(`\r
`)};function Cc(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Kd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function qw(h){let g="";return O(h,function(b,R){g+=R,g+=":",g+=b,g+=`\r
`}),g}function Lm(h,g,b){e:{for(R in b){var R=!1;break e}R=!0}R||(b=qw(b),typeof h=="string"?b!=null&&encodeURIComponent(String(b)):xe(h,g,b))}function Yt(h){bt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Yt,bt);var qP=/^https?$/i,GP=["POST","PUT"];t=Yt.prototype,t.Ha=function(h){this.J=h},t.ea=function(h,g,b,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);g=g?g.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yt.g(),this.v=this.o?Tr(this.o):Tr(yt),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(g,String(h),!0),this.B=!1}catch(q){Gw(this,q);return}if(h=b||"",b=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var U in R)b.set(U,R[U]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const q of R.keys())b.set(q,R.get(q));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(b.keys()).find(q=>q.toLowerCase()=="content-type"),U=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(GP,g,void 0))||R||U||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[q,se]of b)this.g.setRequestHeader(q,se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Qw(this),this.u=!0,this.g.send(h),this.u=!1}catch(q){Gw(this,q)}};function Gw(h,g){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=g,h.m=5,Kw(h),Yd(h)}function Kw(h){h.A||(h.A=!0,Mt(h,"complete"),Mt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Mt(this,"complete"),Mt(this,"abort"),Yd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yd(this,!0)),Yt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Yw(this):this.bb())},t.bb=function(){Yw(this)};function Yw(h){if(h.h&&typeof o<"u"&&(!h.v[1]||xi(h)!=4||h.Z()!=2)){if(h.u&&xi(h)==4)B(h.Ea,0,h);else if(Mt(h,"readystatechange"),xi(h)==4){h.h=!1;try{const se=h.Z();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var b;if(!(b=g)){var R;if(R=se===0){var U=String(h.D).match(vi)[1]||null;!U&&a.self&&a.self.location&&(U=a.self.location.protocol.slice(0,-1)),R=!qP.test(U?U.toLowerCase():"")}b=R}if(b)Mt(h,"complete"),Mt(h,"success");else{h.m=6;try{var q=2<xi(h)?h.g.statusText:""}catch{q=""}h.l=q+" ["+h.Z()+"]",Kw(h)}}finally{Yd(h)}}}}function Yd(h,g){if(h.g){Qw(h);const b=h.g,R=h.v[0]?()=>{}:null;h.g=null,h.v=null,g||Mt(h,"ready");try{b.onreadystatechange=R}catch{}}}function Qw(h){h.I&&(a.clearTimeout(h.I),h.I=null)}t.isActive=function(){return!!this.g};function xi(h){return h.g?h.g.readyState:0}t.Z=function(){try{return 2<xi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(h){if(this.g){var g=this.g.responseText;return h&&g.indexOf(h)==0&&(g=g.substring(h.length)),Ot(g)}};function Xw(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function KP(h){const g={};h=(h.g&&2<=xi(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(v(h[R]))continue;var b=N(h[R]);const U=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const q=g[U]||[];g[U]=q,q.push(b)}I(g,function(R){return R.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ac(h,g,b){return b&&b.internalChannelParams&&b.internalChannelParams[h]||g}function Jw(h){this.Aa=0,this.i=[],this.j=new Re,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ac("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ac("baseRetryDelayMs",5e3,h),this.cb=Ac("retryDelaySeedMs",1e4,h),this.Wa=Ac("forwardChannelMaxRetries",2,h),this.wa=Ac("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new qn(h&&h.concurrentRequestLimit),this.Da=new WP,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Jw.prototype,t.la=8,t.G=1,t.connect=function(h,g,b,R){z(0),this.W=h,this.H=g||{},b&&R!==void 0&&(this.H.OSID=b,this.H.OAID=R),this.F=this.X,this.I=a0(this,null,this.W),Xd(this)};function Fm(h){if(Zw(h),h.G==3){var g=h.U++,b=kt(h.I);if(xe(b,"SID",h.K),xe(b,"RID",g),xe(b,"TYPE","terminate"),Rc(h,b),g=new it(h,h.j,g),g.L=2,g.v=Tt(kt(b)),b=!1,a.navigator&&a.navigator.sendBeacon)try{b=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!b&&a.Image&&(new Image().src=g.v,b=!0),b||(g.g=l0(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Z(g)}o0(h)}function Qd(h){h.g&&(Um(h),h.g.cancel(),h.g=null)}function Zw(h){Qd(h),h.u&&(a.clearTimeout(h.u),h.u=null),Jd(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function Xd(h){if(!Ue(h.h)&&!h.s){h.s=!0;var g=h.Ga;W||re(),V||(W(),V=!0),G.add(g,h),h.B=0}}function YP(h,g){return zt(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=g.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=le(p(h.Ga,h,g),i0(h,h.B)),h.B++,!0)}t.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const U=new it(this,this.j,h);let q=this.o;if(this.S&&(q?(q=E(q),C(q,this.S)):q=this.S),this.m!==null||this.O||(U.H=q,q=null),this.P)e:{for(var g=0,b=0;b<this.i.length;b++){t:{var R=this.i[b];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=b;break e}if(g===4096||b===this.i.length-1){g=b+1;break e}}g=1e3}else g=1e3;g=t0(this,U,g),b=kt(this.I),xe(b,"RID",h),xe(b,"CVER",22),this.D&&xe(b,"X-HTTP-Session-Id",this.D),Rc(this,b),q&&(this.O?g="headers="+encodeURIComponent(String(qw(q)))+"&"+g:this.m&&Lm(b,this.m,q)),Et(this.h,U),this.Ua&&xe(b,"TYPE","init"),this.P?(xe(b,"$req",g),xe(b,"SID","null"),U.T=!0,At(U,b,null)):At(U,b,g),this.G=2}}else this.G==3&&(h?e0(this,h):this.i.length==0||Ue(this.h)||e0(this))};function e0(h,g){var b;g?b=g.l:b=h.U++;const R=kt(h.I);xe(R,"SID",h.K),xe(R,"RID",b),xe(R,"AID",h.T),Rc(h,R),h.m&&h.o&&Lm(R,h.m,h.o),b=new it(h,h.j,b,h.B+1),h.m===null&&(b.H=h.o),g&&(h.i=g.D.concat(h.i)),g=t0(h,b,1e3),b.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Et(h.h,b),At(b,R,g)}function Rc(h,g){h.H&&O(h.H,function(b,R){xe(g,R,b)}),h.l&&Us({},function(b,R){xe(g,R,b)})}function t0(h,g,b){b=Math.min(h.i.length,b);var R=h.l?p(h.l.Na,h.l,h):null;e:{var U=h.i;let q=-1;for(;;){const se=["count="+b];q==-1?0<b?(q=U[0].g,se.push("ofs="+q)):q=0:se.push("ofs="+q);let _t=!0;for(let On=0;On<b;On++){let tt=U[On].g;const Gn=U[On].map;if(tt-=q,0>tt)q=Math.max(0,U[On].g-100),_t=!1;else try{HP(Gn,se,"req"+tt+"_")}catch{R&&R(Gn)}}if(_t){R=se.join("&");break e}}}return h=h.i.splice(0,b),g.D=h,R}function n0(h){if(!h.g&&!h.u){h.Y=1;var g=h.Fa;W||re(),V||(W(),V=!0),G.add(g,h),h.v=0}}function Vm(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=le(p(h.Fa,h),i0(h,h.v)),h.v++,!0)}t.Fa=function(){if(this.u=null,r0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=le(p(this.ab,this),h)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,z(10),Qd(this),r0(this))};function Um(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function r0(h){h.g=new it(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var g=kt(h.qa);xe(g,"RID","rpc"),xe(g,"SID",h.K),xe(g,"AID",h.T),xe(g,"CI",h.F?"0":"1"),!h.F&&h.ja&&xe(g,"TO",h.ja),xe(g,"TYPE","xmlhttp"),Rc(h,g),h.m&&h.o&&Lm(g,h.m,h.o),h.L&&(h.g.I=h.L);var b=h.g;h=h.ia,b.L=1,b.v=Tt(kt(g)),b.m=null,b.P=!0,In(b,h)}t.Za=function(){this.C!=null&&(this.C=null,Qd(this),Vm(this),z(19))};function Jd(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function s0(h,g){var b=null;if(h.g==g){Jd(h),Um(h),h.g=null;var R=2}else if(ot(h.h,g))b=g.D,xn(h.h,g),R=1;else return;if(h.G!=0){if(g.o)if(R==1){b=g.m?g.m.length:0,g=Date.now()-g.F;var U=h.B;R=$(),Mt(R,new ve(R,b)),Xd(h)}else n0(h);else if(U=g.s,U==3||U==0&&0<g.X||!(R==1&&YP(h,g)||R==2&&Vm(h)))switch(b&&0<b.length&&(g=h.h,g.i=g.i.concat(b)),U){case 1:ra(h,5);break;case 4:ra(h,10);break;case 3:ra(h,6);break;default:ra(h,2)}}}function i0(h,g){let b=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(b*=2),b*g}function ra(h,g){if(h.j.info("Error code "+g),g==2){var b=p(h.fb,h),R=h.Xa;const U=!R;R=new vt(R||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||_i(R,"https"),Tt(R),U?zP(R.toString(),b):$P(R.toString(),b)}else z(2);h.G=0,h.l&&h.l.sa(g),o0(h),Zw(h)}t.fb=function(h){h?(this.j.info("Successfully pinged google.com"),z(2)):(this.j.info("Failed to ping google.com"),z(1))};function o0(h){if(h.G=0,h.ka=[],h.l){const g=wn(h.h);(g.length!=0||h.i.length!=0)&&(y(h.ka,g),y(h.ka,h.i),h.h.i.length=0,w(h.i),h.i.length=0),h.l.ra()}}function a0(h,g,b){var R=b instanceof vt?kt(b):new vt(b);if(R.g!="")g&&(R.g=g+"."+R.g),el(R,R.s);else{var U=a.location;R=U.protocol,g=g?g+"."+U.hostname:U.hostname,U=+U.port;var q=new vt(null);R&&_i(q,R),g&&(q.g=g),U&&el(q,U),b&&(q.l=b),R=q}return b=h.D,g=h.ya,b&&g&&xe(R,b,g),xe(R,"VER",h.la),Rc(h,R),R}function l0(h,g,b){if(g&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=h.Ca&&!h.pa?new Yt(new Gd({eb:b})):new Yt(h.pa),g.Ha(h.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function c0(){}t=c0.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zd(){}Zd.prototype.g=function(h,g){return new Wr(h,g)};function Wr(h,g){bt.call(this),this.g=new Jw(g),this.l=h,this.h=g&&g.messageUrlParams||null,h=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(h?h["X-WebChannel-Content-Type"]=g.messageContentType:h={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(h?h["X-WebChannel-Client-Profile"]=g.va:h={"X-WebChannel-Client-Profile":g.va}),this.g.S=h,(h=g&&g.Sb)&&!v(h)&&(this.g.m=h),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!v(g)&&(this.g.D=g,h=this.h,h!==null&&g in h&&(h=this.h,g in h&&delete h[g])),this.j=new nl(this)}x(Wr,bt),Wr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Wr.prototype.close=function(){Fm(this.g)},Wr.prototype.o=function(h){var g=this.g;if(typeof h=="string"){var b={};b.__data__=h,h=b}else this.u&&(b={},b.__data__=ge(h),h=b);g.i.push(new $r(g.Ya++,h)),g.G==3&&Xd(g)},Wr.prototype.N=function(){this.g.l=null,delete this.j,Fm(this.g),delete this.g,Wr.aa.N.call(this)};function u0(h){ur.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var g=h.__sm__;if(g){e:{for(const b in g){h=b;break e}h=void 0}(this.i=h)&&(h=this.i,g=g!==null&&h in g?g[h]:void 0),this.data=g}else this.data=h}x(u0,ur);function d0(){zr.call(this),this.status=1}x(d0,zr);function nl(h){this.g=h}x(nl,c0),nl.prototype.ua=function(){Mt(this.g,"a")},nl.prototype.ta=function(h){Mt(this.g,new u0(h))},nl.prototype.sa=function(h){Mt(this.g,new d0)},nl.prototype.ra=function(){Mt(this.g,"b")},Zd.prototype.createWebChannel=Zd.prototype.g,Wr.prototype.send=Wr.prototype.o,Wr.prototype.open=Wr.prototype.m,Wr.prototype.close=Wr.prototype.close,YC=function(){return new Zd},KC=function(){return $()},GC=Sn,iv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ye.NO_ERROR=0,Ye.TIMEOUT=8,Ye.HTTP_ERROR=6,hf=Ye,et.COMPLETE="complete",qC=et,xs.EventType=rt,rt.OPEN="a",rt.CLOSE="b",rt.ERROR="c",rt.MESSAGE="d",bt.prototype.listen=bt.prototype.K,ru=xs,Yt.prototype.listenOnce=Yt.prototype.L,Yt.prototype.getLastError=Yt.prototype.Ka,Yt.prototype.getLastErrorCode=Yt.prototype.Ba,Yt.prototype.getStatus=Yt.prototype.Z,Yt.prototype.getResponseJson=Yt.prototype.Oa,Yt.prototype.getResponseText=Yt.prototype.oa,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Ha,HC=Yt}).apply(typeof _h<"u"?_h:typeof self<"u"?self:typeof window<"u"?window:{});const c1="@firebase/firestore",u1="4.7.14";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Jn.UNAUTHENTICATED=new Jn(null),Jn.GOOGLE_CREDENTIALS=new Jn("google-credentials-uid"),Jn.FIRST_PARTY=new Jn("first-party-uid"),Jn.MOCK_USER=new Jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yc="11.7.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=new W_("@firebase/firestore");function ul(){return Oa.logLevel}function pe(t,...e){if(Oa.logLevel<=We.DEBUG){const n=e.map(cx);Oa.debug(`Firestore (${yc}): ${t}`,...n)}}function Bi(t,...e){if(Oa.logLevel<=We.ERROR){const n=e.map(cx);Oa.error(`Firestore (${yc}): ${t}`,...n)}}function Kl(t,...e){if(Oa.logLevel<=We.WARN){const n=e.map(cx);Oa.warn(`Firestore (${yc}): ${t}`,...n)}}function cx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,QC(t,r,n)}function QC(t,e,n){let r=`FIRESTORE (${yc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Bi(r),new Error(r)}function ct(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||QC(e,s,r)}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ue extends ys{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Jn.UNAUTHENTICATED))}shutdown(){}}class qV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class GV{constructor(e){this.t=e,this.currentUser=Jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ct(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new ri;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ri,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ri)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ct(typeof r.accessToken=="string",31837,{l:r}),new XC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ct(e===null||typeof e=="string",2055,{h:e}),new Jn(e)}}class KV{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Jn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class YV{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new KV(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Jn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class d1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class QV{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,nr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ct(this.o===void 0,3512);const r=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new d1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new d1(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XV(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=XV(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Be(t,e){return t<e?-1:t>e?1:0}function ov(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Be(r,s);{const i=JC(),o=JV(i.encode(h1(t,n)),i.encode(h1(e,n)));return o!==0?o:Be(r,s)}}n+=r>65535?2:1}return Be(t.length,e.length)}function h1(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function JV(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Be(t[n],e[n]);return Be(t.length,e.length)}function Yl(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1=-62135596800,p1=1e6;class cn{static now(){return cn.fromMillis(Date.now())}static fromDate(e){return cn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*p1);return new cn(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ue(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ue(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<f1)throw new ue(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ue(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/p1}_compareTo(e){return this.seconds===e.seconds?Be(this.nanoseconds,e.nanoseconds):Be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-f1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{static fromTimestamp(e){return new Ne(e)}static min(){return new Ne(new cn(0,0))}static max(){return new Ne(new cn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="__name__";class Ks{constructor(e,n,r){n===void 0?n=0:n>e.length&&Se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ks.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ks?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Ks.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Be(e.length,n.length)}static compareSegments(e,n){const r=Ks.isNumericId(e),s=Ks.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Ks.extractNumericId(e).compare(Ks.extractNumericId(n)):ov(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Co.fromString(e.substring(4,e.length-2))}}class St extends Ks{construct(e,n,r){return new St(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ue(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new St(n)}static emptyPath(){return new St([])}}const ZV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vn extends Ks{construct(e,n,r){return new Vn(e,n,r)}static isValidIdentifier(e){return ZV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===m1}static keyField(){return new Vn([m1])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ue(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ue(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ue(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ue(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vn(n)}static emptyPath(){return new Vn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(St.fromString(e))}static fromName(e){return new Ee(St.fromString(e).popFirst(5))}static empty(){return new Ee(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&St.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return St.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new St(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const id=-1;function e4(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Ne.fromTimestamp(r===1e9?new cn(n+1,0):new cn(n,r));return new Mo(s,Ee.empty(),e)}function t4(t){return new Mo(t.readTime,t.key,id)}class Mo{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mo(Ne.min(),Ee.empty(),id)}static max(){return new Mo(Ne.max(),Ee.empty(),id)}}function n4(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ee.comparator(t.documentKey,e.documentKey),n!==0?n:Be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class s4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vc(t){if(t.code!==X.FAILED_PRECONDITION||t.message!==r4)throw t;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new J((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof J?n:J.resolve(n)}catch(n){return J.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):J.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):J.reject(n)}static resolve(e){return new J((n,r)=>{n(e)})}static reject(e){return new J((n,r)=>{r(e)})}static waitFor(e){return new J((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=J.resolve(!1);for(const r of e)n=n.next(s=>s?J.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new J((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new J((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function i4(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function _c(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}nm.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux=-1;function rm(t){return t==null}function np(t){return t===0&&1/t==-1/0}function o4(t){return typeof t=="number"&&Number.isInteger(t)&&!np(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="";function a4(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=g1(e)),e=l4(t.get(n),e);return g1(e)}function l4(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case eA:n+="";break;default:n+=i}}return n}function g1(t){return t+eA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function c4(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function tA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,n){this.comparator=e,this.root=n||Fn.EMPTY}insert(e,n){return new Kt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xh(this.root,e,this.comparator,!1)}getReverseIterator(){return new xh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xh(this.root,e,this.comparator,!0)}}class xh{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fn{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Fn.RED,this.left=s??Fn.EMPTY,this.right=i??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Fn(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Fn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Se(27949);return e+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw Se(57766)}get value(){throw Se(16141)}get color(){throw Se(16727)}get left(){throw Se(29726)}get right(){throw Se(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Fn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new v1(this.data.getIterator())}getIteratorFrom(e){return new v1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Tn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Tn(this.comparator);return n.data=e,n}}class v1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.fields=e,e.sort(Vn.comparator)}static empty(){return new Yr([])}unionWith(e){let n=new Tn(Vn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new nA("Invalid base64 string: "+i):i}}(e);return new Hn(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Hn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const u4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oo(t){if(ct(!!t,39018),typeof t=="string"){let e=0;const n=u4.exec(t);if(ct(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rn(t.seconds),nanos:rn(t.nanos)}}function rn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Lo(t){return typeof t=="string"?Hn.fromBase64String(t):Hn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="server_timestamp",sA="__type__",iA="__previous_value__",oA="__local_write_time__";function dx(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[sA])===null||n===void 0?void 0:n.stringValue)===rA}function sm(t){const e=t.mapValue.fields[iA];return dx(e)?sm(e):e}function od(t){const e=Oo(t.mapValue.fields[oA].timestampValue);return new cn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e,n,r,s,i,o,a,l,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=d}}const rp="(default)";class ad{constructor(e,n){this.projectId=e,this.database=n||rp}static empty(){return new ad("","")}get isDefaultDatabase(){return this.database===rp}isEqual(e){return e instanceof ad&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="__type__",h4="__max__",wh={mapValue:{}},lA="__vector__",sp="value";function Fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dx(t)?4:p4(t)?9007199254740991:f4(t)?10:11:Se(28295,{value:t})}function ai(t,e){if(t===e)return!0;const n=Fo(t);if(n!==Fo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return od(t).isEqual(od(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Oo(s.timestampValue),a=Oo(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Lo(s.bytesValue).isEqual(Lo(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return rn(s.geoPointValue.latitude)===rn(i.geoPointValue.latitude)&&rn(s.geoPointValue.longitude)===rn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return rn(s.integerValue)===rn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=rn(s.doubleValue),a=rn(i.doubleValue);return o===a?np(o)===np(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Yl(t.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(y1(o)!==y1(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ai(o[l],a[l])))return!1;return!0}(t,e);default:return Se(52216,{left:t})}}function ld(t,e){return(t.values||[]).find(n=>ai(n,e))!==void 0}function Ql(t,e){if(t===e)return 0;const n=Fo(t),r=Fo(e);if(n!==r)return Be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Be(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=rn(i.integerValue||i.doubleValue),l=rn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return _1(t.timestampValue,e.timestampValue);case 4:return _1(od(t),od(e));case 5:return ov(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Lo(i),l=Lo(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=Be(a[c],l[c]);if(d!==0)return d}return Be(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Be(rn(i.latitude),rn(o.latitude));return a!==0?a:Be(rn(i.longitude),rn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return x1(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,d;const f=i.fields||{},p=o.fields||{},m=(a=f[sp])===null||a===void 0?void 0:a.arrayValue,x=(l=p[sp])===null||l===void 0?void 0:l.arrayValue,w=Be(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=x==null?void 0:x.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:x1(m,x)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===wh.mapValue&&o===wh.mapValue)return 0;if(i===wh.mapValue)return 1;if(o===wh.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=ov(l[f],d[f]);if(p!==0)return p;const m=Ql(a[l[f]],c[d[f]]);if(m!==0)return m}return Be(l.length,d.length)}(t.mapValue,e.mapValue);default:throw Se(23264,{Pe:n})}}function _1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Be(t,e);const n=Oo(t),r=Oo(e),s=Be(n.seconds,r.seconds);return s!==0?s:Be(n.nanos,r.nanos)}function x1(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ql(n[s],r[s]);if(i)return i}return Be(n.length,r.length)}function Xl(t){return av(t)}function av(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Oo(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Lo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=av(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${av(n.fields[o])}`;return s+"}"}(t.mapValue):Se(61005,{value:t})}function ff(t){switch(Fo(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sm(t);return e?16+ff(e):16;case 5:return 2*t.stringValue.length;case 6:return Lo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ff(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Jo(r.fields,(i,o)=>{s+=i.length+ff(o)}),s}(t.mapValue);default:throw Se(13486,{value:t})}}function w1(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function lv(t){return!!t&&"integerValue"in t}function hx(t){return!!t&&"arrayValue"in t}function b1(t){return!!t&&"nullValue"in t}function E1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function pf(t){return!!t&&"mapValue"in t}function f4(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[aA])===null||n===void 0?void 0:n.stringValue)===lA}function ku(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Jo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ku(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ku(t.arrayValue.values[n]);return e}return Object.assign({},t)}function p4(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===h4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this.value=e}static empty(){return new Nr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!pf(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ku(n)}setAll(e){let n=Vn.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ku(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());pf(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ai(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];pf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Jo(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Nr(ku(this.value))}}function cA(t){const e=[];return Jo(t.fields,(n,r)=>{const s=new Vn([n]);if(pf(r)){const i=cA(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Yr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new tr(e,0,Ne.min(),Ne.min(),Ne.min(),Nr.empty(),0)}static newFoundDocument(e,n,r,s){return new tr(e,1,n,Ne.min(),r,s,0)}static newNoDocument(e,n){return new tr(e,2,n,Ne.min(),Ne.min(),Nr.empty(),0)}static newUnknownDocument(e,n){return new tr(e,3,n,Ne.min(),Ne.min(),Nr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,n){this.position=e,this.inclusive=n}}function k1(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=Ee.comparator(Ee.fromName(o.referenceValue),n.key):r=Ql(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function T1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ai(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n="asc"){this.field=e,this.dir=n}}function m4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{}class yn extends uA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new y4(e,n,r):n==="array-contains"?new x4(e,r):n==="in"?new w4(e,r):n==="not-in"?new b4(e,r):n==="array-contains-any"?new E4(e,r):new yn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new v4(e,r):new _4(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ql(n,this.value)):n!==null&&Fo(this.value)===Fo(n)&&this.matchesComparison(Ql(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class js extends uA{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new js(e,n)}matches(e){return dA(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function dA(t){return t.op==="and"}function hA(t){return g4(t)&&dA(t)}function g4(t){for(const e of t.filters)if(e instanceof js)return!1;return!0}function cv(t){if(t instanceof yn)return t.field.canonicalString()+t.op.toString()+Xl(t.value);if(hA(t))return t.filters.map(e=>cv(e)).join(",");{const e=t.filters.map(n=>cv(n)).join(",");return`${t.op}(${e})`}}function fA(t,e){return t instanceof yn?function(r,s){return s instanceof yn&&r.op===s.op&&r.field.isEqual(s.field)&&ai(r.value,s.value)}(t,e):t instanceof js?function(r,s){return s instanceof js&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&fA(o,s.filters[a]),!0):!1}(t,e):void Se(19439)}function pA(t){return t instanceof yn?function(n){return`${n.field.canonicalString()} ${n.op} ${Xl(n.value)}`}(t):t instanceof js?function(n){return n.op.toString()+" {"+n.getFilters().map(pA).join(" ,")+"}"}(t):"Filter"}class y4 extends yn{constructor(e,n,r){super(e,n,r),this.key=Ee.fromName(r.referenceValue)}matches(e){const n=Ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class v4 extends yn{constructor(e,n){super(e,"in",n),this.keys=mA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class _4 extends yn{constructor(e,n){super(e,"not-in",n),this.keys=mA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function mA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ee.fromName(r.referenceValue))}class x4 extends yn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return hx(n)&&ld(n.arrayValue,this.value)}}class w4 extends yn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ld(this.value.arrayValue,n)}}class b4 extends yn{constructor(e,n){super(e,"not-in",n)}matches(e){if(ld(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ld(this.value.arrayValue,n)}}class E4 extends yn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!hx(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ld(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Ie=null}}function S1(t,e=null,n=[],r=[],s=null,i=null,o=null){return new k4(t,e,n,r,s,i,o)}function fx(t){const e=Ae(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>cv(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),rm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Xl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Xl(r)).join(",")),e.Ie=n}return e.Ie}function px(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!m4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!fA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!T1(t.startAt,e.startAt)&&T1(t.endAt,e.endAt)}function uv(t){return Ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function T4(t,e,n,r,s,i,o,a){return new Ga(t,e,n,r,s,i,o,a)}function im(t){return new Ga(t)}function I1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function gA(t){return t.collectionGroup!==null}function Tu(t){const e=Ae(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Tn(Vn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new cd(i,r))}),n.has(Vn.keyField().canonicalString())||e.Ee.push(new cd(Vn.keyField(),r))}return e.Ee}function si(t){const e=Ae(t);return e.de||(e.de=yA(e,Tu(t))),e.de}function S4(t){const e=Ae(t);return e.Ae||(e.Ae=yA(e,t.explicitOrderBy)),e.Ae}function yA(t,e){if(t.limitType==="F")return S1(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new cd(s.field,i)});const n=t.endAt?new ip(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ip(t.startAt.position,t.startAt.inclusive):null;return S1(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function dv(t,e){const n=t.filters.concat([e]);return new Ga(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function op(t,e,n){return new Ga(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function om(t,e){return px(si(t),si(e))&&t.limitType===e.limitType}function vA(t){return`${fx(si(t))}|lt:${t.limitType}`}function dl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>pA(s)).join(", ")}]`),rm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Xl(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Xl(s)).join(",")),`Target(${r})`}(si(t))}; limitType=${t.limitType})`}function am(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Tu(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=k1(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Tu(r),s)||r.endAt&&!function(o,a,l){const c=k1(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Tu(r),s))}(t,e)}function I4(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function _A(t){return(e,n)=>{let r=!1;for(const s of Tu(t)){const i=C4(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function C4(t,e,n){const r=t.field.isKeyField()?Ee.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ql(l,c):Se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Jo(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return tA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4=new Kt(Ee.comparator);function zi(){return A4}const xA=new Kt(Ee.comparator);function su(...t){let e=xA;for(const n of t)e=e.insert(n.key,n);return e}function wA(t){let e=xA;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function va(){return Su()}function bA(){return Su()}function Su(){return new Ka(t=>t.toString(),(t,e)=>t.isEqual(e))}const R4=new Kt(Ee.comparator),N4=new Tn(Ee.comparator);function He(...t){let e=N4;for(const n of t)e=e.add(n);return e}const P4=new Tn(Be);function j4(){return P4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:np(e)?"-0":e}}function EA(t){return{integerValue:""+t}}function kA(t,e){return o4(e)?EA(e):mx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(){this._=void 0}}function D4(t,e,n){return t instanceof ud?function(s,i){const o={fields:{[sA]:{stringValue:rA},[oA]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&dx(i)&&(i=sm(i)),i&&(o.fields[iA]=i),{mapValue:o}}(n,e):t instanceof Jl?SA(t,e):t instanceof dd?IA(t,e):function(s,i){const o=TA(s,i),a=C1(o)+C1(s.Re);return lv(o)&&lv(s.Re)?EA(a):mx(s.serializer,a)}(t,e)}function M4(t,e,n){return t instanceof Jl?SA(t,e):t instanceof dd?IA(t,e):n}function TA(t,e){return t instanceof hd?function(r){return lv(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ud extends lm{}class Jl extends lm{constructor(e){super(),this.elements=e}}function SA(t,e){const n=CA(e);for(const r of t.elements)n.some(s=>ai(s,r))||n.push(r);return{arrayValue:{values:n}}}class dd extends lm{constructor(e){super(),this.elements=e}}function IA(t,e){let n=CA(e);for(const r of t.elements)n=n.filter(s=>!ai(s,r));return{arrayValue:{values:n}}}class hd extends lm{constructor(e,n){super(),this.serializer=e,this.Re=n}}function C1(t){return rn(t.integerValue||t.doubleValue)}function CA(t){return hx(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,n){this.field=e,this.transform=n}}function O4(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Jl&&s instanceof Jl||r instanceof dd&&s instanceof dd?Yl(r.elements,s.elements,ai):r instanceof hd&&s instanceof hd?ai(r.Re,s.Re):r instanceof ud&&s instanceof ud}(t.transform,e.transform)}class L4{constructor(e,n){this.version=e,this.transformResults=n}}class yr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new yr}static exists(e){return new yr(void 0,e)}static updateTime(e){return new yr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cm{}function AA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new um(t.key,yr.none()):new Rd(t.key,t.data,yr.none());{const n=t.data,r=Nr.empty();let s=new Tn(Vn.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Zo(t.key,r,new Yr(s.toArray()),yr.none())}}function F4(t,e,n){t instanceof Rd?function(s,i,o){const a=s.value.clone(),l=R1(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Zo?function(s,i,o){if(!mf(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=R1(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(RA(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Iu(t,e,n,r){return t instanceof Rd?function(i,o,a,l){if(!mf(i.precondition,o))return a;const c=i.value.clone(),d=N1(i.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Zo?function(i,o,a,l){if(!mf(i.precondition,o))return a;const c=N1(i.fieldTransforms,l,o),d=o.data;return d.setAll(RA(i)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,r):function(i,o,a){return mf(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function V4(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=TA(r.transform,s||null);i!=null&&(n===null&&(n=Nr.empty()),n.set(r.field,i))}return n||null}function A1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Yl(r,s,(i,o)=>O4(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Rd extends cm{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Zo extends cm{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function RA(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function R1(t,e,n){const r=new Map;ct(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,M4(o,a,n[s]))}return r}function N1(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,D4(i,o,e))}return r}class um extends cm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class U4 extends cm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&F4(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Iu(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Iu(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=bA();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=AA(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),He())}isEqual(e){return this.batchId===e.batchId&&Yl(this.mutations,e.mutations,(n,r)=>A1(n,r))&&Yl(this.baseMutations,e.baseMutations,(n,r)=>A1(n,r))}}class yx{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ct(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return R4}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new yx(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn,Qe;function H4(t){switch(t){case X.OK:return Se(64938);case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0;default:return Se(15467,{code:t})}}function NA(t){if(t===void 0)return Bi("GRPC error has no .code"),X.UNKNOWN;switch(t){case fn.OK:return X.OK;case fn.CANCELLED:return X.CANCELLED;case fn.UNKNOWN:return X.UNKNOWN;case fn.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case fn.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case fn.INTERNAL:return X.INTERNAL;case fn.UNAVAILABLE:return X.UNAVAILABLE;case fn.UNAUTHENTICATED:return X.UNAUTHENTICATED;case fn.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case fn.NOT_FOUND:return X.NOT_FOUND;case fn.ALREADY_EXISTS:return X.ALREADY_EXISTS;case fn.PERMISSION_DENIED:return X.PERMISSION_DENIED;case fn.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case fn.ABORTED:return X.ABORTED;case fn.OUT_OF_RANGE:return X.OUT_OF_RANGE;case fn.UNIMPLEMENTED:return X.UNIMPLEMENTED;case fn.DATA_LOSS:return X.DATA_LOSS;default:return Se(39323,{code:t})}}(Qe=fn||(fn={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=new Co([4294967295,4294967295],0);function P1(t){const e=JC().encode(t),n=new WC;return n.update(e),new Uint8Array(n.digest())}function j1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Co([n,r],0),new Co([s,i],0)]}class vx{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new iu(`Invalid padding: ${n}`);if(r<0)throw new iu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new iu(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new iu(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=Co.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(Co.fromNumber(r)));return s.compare(q4)===1&&(s=new Co([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=P1(e),[r,s]=j1(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.be(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new vx(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.pe===0)return;const n=P1(e),[r,s]=j1(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class iu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Nd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new dm(Ne.min(),s,new Kt(Be),zi(),He())}}class Nd{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Nd(r,n,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class PA{constructor(e,n){this.targetId=e,this.Ce=n}}class jA{constructor(e,n,r=Hn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class D1{constructor(){this.Fe=0,this.Me=M1(),this.xe=Hn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=He(),n=He(),r=He();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Se(38017,{changeType:i})}}),new Nd(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=M1()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,ct(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class G4{constructor(e){this.ze=e,this.je=new Map,this.He=zi(),this.Je=bh(),this.Ye=bh(),this.Ze=new Kt(Be)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:Se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(uv(i))if(r===0){const o=new Ee(i.path);this.tt(n,o,tr.newNoDocument(o,Ne.min()))}else ct(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const a=this.ct(e),l=a?this.lt(a,e,o):1;if(l!==0){this.st(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,c)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Lo(r).toUint8Array()}catch(l){if(l instanceof nA)return Kl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new vx(o,s,i)}catch(l){return Kl(l instanceof iu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.pe===0?null:a}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const a=this._t(o);if(a){if(i.current&&uv(a.target)){const l=new Ee(a.target.path);this.Et(l).has(o)||this.dt(o,l)||this.tt(o,l,tr.newNoDocument(l,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=He();this.Ye.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this._t(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new dm(e,n,this.Ze,this.He,r);return this.He=zi(),this.Je=bh(),this.Ye=bh(),this.Ze=new Kt(Be),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new D1,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Tn(Be),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Tn(Be),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||pe("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new D1),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function bh(){return new Kt(Ee.comparator)}function M1(){return new Kt(Ee.comparator)}const K4={asc:"ASCENDING",desc:"DESCENDING"},Y4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Q4={and:"AND",or:"OR"};class X4{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function hv(t,e){return t.useProto3Json||rm(e)?e:{value:e}}function ap(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function J4(t,e){return ap(t,e.toTimestamp())}function ii(t){return ct(!!t,49232),Ne.fromTimestamp(function(n){const r=Oo(n);return new cn(r.seconds,r.nanos)}(t))}function _x(t,e){return fv(t,e).canonicalString()}function fv(t,e){const n=function(s){return new St(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function MA(t){const e=St.fromString(t);return ct(BA(e),10190,{key:e.toString()}),e}function pv(t,e){return _x(t.databaseId,e.path)}function Sg(t,e){const n=MA(e);if(n.get(1)!==t.databaseId.projectId)throw new ue(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ue(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ee(LA(n))}function OA(t,e){return _x(t.databaseId,e)}function Z4(t){const e=MA(t);return e.length===4?St.emptyPath():LA(e)}function mv(t){return new St(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function LA(t){return ct(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function O1(t,e,n){return{name:pv(t,e),fields:n.value.mapValue.fields}}function eU(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Se(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,d){return c.useProto3Json?(ct(d===void 0||typeof d=="string",58123),Hn.fromBase64String(d||"")):(ct(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Hn.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?X.UNKNOWN:NA(c.code);return new ue(d,c.message||"")}(o);n=new jA(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Sg(t,r.document.name),i=ii(r.document.updateTime),o=r.document.createTime?ii(r.document.createTime):Ne.min(),a=new Nr({mapValue:{fields:r.document.fields}}),l=tr.newFoundDocument(s,i,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new gf(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Sg(t,r.document),i=r.readTime?ii(r.readTime):Ne.min(),o=tr.newNoDocument(s,i),a=r.removedTargetIds||[];n=new gf([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Sg(t,r.document),i=r.removedTargetIds||[];n=new gf([],i,s,null)}else{if(!("filter"in e))return Se(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new W4(s,i),a=r.targetId;n=new PA(a,o)}}return n}function tU(t,e){let n;if(e instanceof Rd)n={update:O1(t,e.key,e.value)};else if(e instanceof um)n={delete:pv(t,e.key)};else if(e instanceof Zo)n={update:O1(t,e.key,e.data),updateMask:uU(e.fieldMask)};else{if(!(e instanceof U4))return Se(16599,{ft:e.type});n={verify:pv(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ud)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Jl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof dd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof hd)return{fieldPath:o.field.canonicalString(),increment:a.Re};throw Se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:J4(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Se(27497)}(t,e.precondition)),n}function nU(t,e){return t&&t.length>0?(ct(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?ii(s.updateTime):ii(i);return o.isEqual(Ne.min())&&(o=ii(i)),new L4(o,s.transformResults||[])}(n,e))):[]}function rU(t,e){return{documents:[OA(t,e.path)]}}function FA(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=OA(t,s);const i=function(c){if(c.length!==0)return UA(js.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(d=>function(p){return{field:oo(p.field),direction:aU(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=hv(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{gt:n,parent:s}}function sU(t,e,n,r){const{gt:s,parent:i}=FA(t,e),o={},a=[];let l=0;return n.forEach(c=>{const d="aggregate_"+l++;o[d]=c.alias,c.aggregateType==="count"?a.push({alias:d,count:{}}):c.aggregateType==="avg"?a.push({alias:d,avg:{field:oo(c.fieldPath)}}):c.aggregateType==="sum"&&a.push({alias:d,sum:{field:oo(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},yt:o,parent:i}}function iU(t){let e=Z4(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ct(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(f){const p=VA(f);return p instanceof js&&hA(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(p=>function(x){return new cd(hl(x.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,rm(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(f){const p=!!f.before,m=f.values||[];return new ip(m,p)}(n.startAt));let c=null;return n.endAt&&(c=function(f){const p=!f.before,m=f.values||[];return new ip(m,p)}(n.endAt)),T4(e,s,o,i,a,"F",l,c)}function oU(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Se(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function VA(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=hl(n.unaryFilter.field);return yn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=hl(n.unaryFilter.field);return yn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=hl(n.unaryFilter.field);return yn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=hl(n.unaryFilter.field);return yn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Se(61313);default:return Se(60726)}}(t):t.fieldFilter!==void 0?function(n){return yn.create(hl(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Se(58110);default:return Se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return js.create(n.compositeFilter.filters.map(r=>VA(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Se(1026)}}(n.compositeFilter.op))}(t):Se(30097,{filter:t})}function aU(t){return K4[t]}function lU(t){return Y4[t]}function cU(t){return Q4[t]}function oo(t){return{fieldPath:t.canonicalString()}}function hl(t){return Vn.fromServerFormat(t.fieldPath)}function UA(t){return t instanceof yn?function(n){if(n.op==="=="){if(E1(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NAN"}};if(b1(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(E1(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NOT_NAN"}};if(b1(n.value))return{unaryFilter:{field:oo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oo(n.field),op:lU(n.op),value:n.value}}}(t):t instanceof js?function(n){const r=n.getFilters().map(s=>UA(s));return r.length===1?r[0]:{compositeFilter:{op:cU(n.op),filters:r}}}(t):Se(54877,{filter:t})}function uU(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function BA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e,n,r,s,i=Ne.min(),o=Ne.min(),a=Hn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ho(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ho(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ho(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ho(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e){this.wt=e}}function hU(t){const e=iU({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?op(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(){this.yn=new pU}addToCollectionParentIndex(e,n){return this.yn.add(n),J.resolve()}getCollectionParents(e,n){return J.resolve(this.yn.getEntries(n))}addFieldIndex(e,n){return J.resolve()}deleteFieldIndex(e,n){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,n){return J.resolve()}getDocumentsMatchingTarget(e,n){return J.resolve(null)}getIndexType(e,n){return J.resolve(0)}getFieldIndexes(e,n){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,n){return J.resolve(Mo.min())}getMinOffsetFromCollectionGroup(e,n){return J.resolve(Mo.min())}updateCollectionGroup(e,n,r){return J.resolve()}updateIndexEntries(e,n){return J.resolve()}}class pU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Tn(St.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Tn(St.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zA=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(zA,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new Zl(0)}static ir(){return new Zl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="LruGarbageCollector",mU=1048576;function V1([t,e],[n,r]){const s=Be(t,n);return s===0?Be(e,r):s}class gU{constructor(e){this.cr=e,this.buffer=new Tn(V1),this.lr=0}hr(){return++this.lr}Pr(e){const n=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();V1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class yU{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Tr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return this.Tr!==null}Ir(e){pe(F1,`Garbage collection scheduled in ${e}ms`),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Tr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){_c(n)?pe(F1,"Ignoring IndexedDB error during garbage collection: ",n):await vc(n)}await this.Ir(3e5)})}}class vU{constructor(e,n){this.Er=e,this.params=n}calculateTargetCount(e,n){return this.Er.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return J.resolve(nm.le);const r=new gU(n);return this.Er.forEachTarget(e,s=>r.Pr(s.sequenceNumber)).next(()=>this.Er.Ar(e,s=>r.Pr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Er.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Er.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),J.resolve(L1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),L1):this.Rr(e,n))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,n){let r,s,i,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),s=this.params.maximumSequenceNumbersToCollect):s=f,o=Date.now(),this.nthSequenceNumber(e,s))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(i=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(c=Date.now(),ul()<=We.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),J.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:f})))}}function _U(t,e){return new vU(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(){this.changes=new Ka(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?J.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Iu(r.mutation,s,Yr.empty(),cn.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,He()).next(()=>r))}getLocalViewOfDocuments(e,n,r=He()){const s=va();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=su();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=va();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,He()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=zi();const o=Su(),a=function(){return Su()}();return n.forEach((l,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof Zo)?i=i.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Iu(d.mutation,c,d.mutation.getFieldMask(),cn.now())):o.set(c.key,Yr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var f;return a.set(c,new wU(d,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Su();let s=new Kt((o,a)=>o-a),i=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||Yr.empty();d=a.applyToLocalView(c,d),r.set(l,d);const f=(s.get(a.batchId)||He()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,f=bA();d.forEach(p=>{if(!i.has(p)){const m=AA(n.get(p),r.get(p));m!==null&&f.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return J.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return Ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):gA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):J.resolve(va());let a=id,l=i;return o.next(c=>J.forEach(c,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(d)?J.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,He())).next(d=>({batchId:a,changes:wA(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ee(n)).next(r=>{let s=su();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=su();return this.indexManager.getCollectionParents(e,i).next(a=>J.forEach(a,l=>{const c=function(f,p){return new Ga(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,tr.newInvalidDocument(d)))});let a=su();return o.forEach((l,c)=>{const d=i.get(l);d!==void 0&&Iu(d.mutation,c,Yr.empty(),cn.now()),am(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,n){return J.resolve(this.Fr.get(n))}saveBundleMetadata(e,n){return this.Fr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ii(s.createTime)}}(n)),J.resolve()}getNamedQuery(e,n){return J.resolve(this.Mr.get(n))}saveNamedQuery(e,n){return this.Mr.set(n.name,function(s){return{name:s.name,query:hU(s.bundledQuery),readTime:ii(s.readTime)}}(n)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(){this.overlays=new Kt(Ee.comparator),this.Or=new Map}getOverlay(e,n){return J.resolve(this.overlays.get(n))}getOverlays(e,n){const r=va();return J.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),J.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Or.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Or.delete(r)),J.resolve()}getOverlaysForCollection(e,n,r){const s=va(),i=n.length+1,o=new Ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return J.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Kt((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=va(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=va(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=s)););return J.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Or.get(s.largestBatchId).delete(r.key);this.Or.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new z4(n,r));let i=this.Or.get(n);i===void 0&&(i=He(),this.Or.set(n,i)),this.Or.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(){this.Nr=new Tn(Cn.Br),this.Lr=new Tn(Cn.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,n){const r=new Cn(e,n);this.Nr=this.Nr.add(r),this.Lr=this.Lr.add(r)}qr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Qr(new Cn(e,n))}$r(e,n){e.forEach(r=>this.removeReference(r,n))}Ur(e){const n=new Ee(new St([])),r=new Cn(n,e),s=new Cn(n,e+1),i=[];return this.Lr.forEachInRange([r,s],o=>{this.Qr(o),i.push(o.key)}),i}Kr(){this.Nr.forEach(e=>this.Qr(e))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){const n=new Ee(new St([])),r=new Cn(n,e),s=new Cn(n,e+1);let i=He();return this.Lr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Cn(e,0),r=this.Nr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Cn{constructor(e,n){this.key=e,this.Gr=n}static Br(e,n){return Ee.comparator(e.key,n.key)||Be(e.Gr,n.Gr)}static kr(e,n){return Be(e.Gr,n.Gr)||Ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Jn=1,this.zr=new Tn(Cn.Br)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new B4(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.zr=this.zr.add(new Cn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return J.resolve(o)}lookupMutationBatch(e,n){return J.resolve(this.jr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Hr(r),i=s<0?0:s;return J.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?ux:this.Jn-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Cn(n,0),s=new Cn(n,Number.POSITIVE_INFINITY),i=[];return this.zr.forEachInRange([r,s],o=>{const a=this.jr(o.Gr);i.push(a)}),J.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Tn(Be);return n.forEach(s=>{const i=new Cn(s,0),o=new Cn(s,Number.POSITIVE_INFINITY);this.zr.forEachInRange([i,o],a=>{r=r.add(a.Gr)})}),J.resolve(this.Jr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Ee.isDocumentKey(i)||(i=i.child(""));const o=new Cn(new Ee(i),0);let a=new Tn(Be);return this.zr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Gr)),!0)},o),J.resolve(this.Jr(a))}Jr(e){const n=[];return e.forEach(r=>{const s=this.jr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ct(this.Yr(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.zr;return J.forEach(n.mutations,s=>{const i=new Cn(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.zr=r})}Xn(e){}containsKey(e,n){const r=new Cn(n,0),s=this.zr.firstAfterOrEqual(r);return J.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}Yr(e,n){return this.Hr(e)}Hr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}jr(e){const n=this.Hr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{constructor(e){this.Zr=e,this.docs=function(){return new Kt(Ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Zr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return J.resolve(r?r.document.mutableCopy():tr.newInvalidDocument(n))}getEntries(e,n){let r=zi();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():tr.newInvalidDocument(s))}),J.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=zi();const o=n.path,a=new Ee(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||n4(t4(d),r)<=0||(s.has(d.key)||am(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return J.resolve(i)}getAllFromCollectionGroup(e,n,r,s){Se(9500)}Xr(e,n){return J.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new CU(this)}getSize(e){return J.resolve(this.size)}}class CU extends xU{constructor(e){super(),this.vr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.vr.addEntry(e,s)):this.vr.removeEntry(r)}),J.waitFor(n)}getFromCache(e,n){return this.vr.getEntry(e,n)}getAllFromCache(e,n){return this.vr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e){this.persistence=e,this.ei=new Ka(n=>fx(n),px),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.ti=0,this.ni=new xx,this.targetCount=0,this.ri=Zl.rr()}forEachTarget(e,n){return this.ei.forEach((r,s)=>n(s)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ti&&(this.ti=n),J.resolve()}ar(e){this.ei.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ri=new Zl(n),this.highestTargetId=n),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,n){return this.ar(n),this.targetCount+=1,J.resolve()}updateTargetData(e,n){return this.ar(n),J.resolve()}removeTargetData(e,n){return this.ei.delete(n.target),this.ni.Ur(n.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ei.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ei.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),J.waitFor(i).next(()=>s)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,n){const r=this.ei.get(n)||null;return J.resolve(r)}addMatchingKeys(e,n,r){return this.ni.qr(n,r),J.resolve()}removeMatchingKeys(e,n,r){this.ni.$r(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),J.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ni.Ur(n),J.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ni.Wr(n);return J.resolve(r)}containsKey(e,n){return J.resolve(this.ni.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,n){this.ii={},this.overlays={},this.si=new nm(0),this.oi=!1,this.oi=!0,this._i=new TU,this.referenceDelegate=e(this),this.ai=new AU(this),this.indexManager=new fU,this.remoteDocumentCache=function(s){return new IU(s)}(r=>this.referenceDelegate.ui(r)),this.serializer=new dU(n),this.ci=new EU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new kU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ii[e.toKey()];return r||(r=new SU(n,this.referenceDelegate),this.ii[e.toKey()]=r),r}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,n,r){pe("MemoryPersistence","Starting transaction:",e);const s=new RU(this.si.next());return this.referenceDelegate.li(),r(s).next(i=>this.referenceDelegate.hi(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Pi(e,n){return J.or(Object.values(this.ii).map(r=>()=>r.containsKey(e,n)))}}class RU extends s4{constructor(e){super(),this.currentSequenceNumber=e}}class wx{constructor(e){this.persistence=e,this.Ti=new xx,this.Ii=null}static Ei(e){return new wx(e)}get di(){if(this.Ii)return this.Ii;throw Se(60996)}addReference(e,n,r){return this.Ti.addReference(r,n),this.di.delete(r.toString()),J.resolve()}removeReference(e,n,r){return this.Ti.removeReference(r,n),this.di.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),J.resolve()}removeTarget(e,n){this.Ti.Ur(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}li(){this.Ii=new Set}hi(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.di,r=>{const s=Ee.fromPath(r);return this.Ai(e,s).next(i=>{i||n.removeEntry(s,Ne.min())})}).next(()=>(this.Ii=null,n.apply(e)))}updateLimboDocument(e,n){return this.Ai(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}ui(e){return 0}Ai(e,n){return J.or([()=>J.resolve(this.Ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Pi(e,n)])}}class lp{constructor(e,n){this.persistence=e,this.Ri=new Ka(r=>a4(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=_U(this,n)}static Ei(e,n){return new lp(e,n)}li(){}hi(e){return J.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Vr(e){let n=0;return this.Ar(e,r=>{n++}).next(()=>n)}Ar(e,n){return J.forEach(this.Ri,(r,s)=>this.gr(e,r,s).next(i=>i?J.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.Xr(e,o=>this.gr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,Ne.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.Ri.set(n,e.currentSequenceNumber),J.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.Ri.set(r,e.currentSequenceNumber),J.resolve()}removeReference(e,n,r){return this.Ri.set(r,e.currentSequenceNumber),J.resolve()}updateLimboDocument(e,n){return this.Ri.set(n,e.currentSequenceNumber),J.resolve()}ui(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ff(e.data.value)),n}gr(e,n,r){return J.or([()=>this.persistence.Pi(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.Ri.get(n);return J.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ls=r,this.hs=s}static Ps(e,n){let r=He(),s=He();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new bx(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=function(){return HM()?8:i4(lr())>0?6:4}()}initialize(e,n){this.As=e,this.indexManager=n,this.Ts=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Rs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Vs(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new NU;return this.fs(e,n,o).next(a=>{if(i.result=a,this.Is)return this.gs(e,n,o,a.size)})}).next(()=>i.result)}gs(e,n,r,s){return r.documentReadCount<this.Es?(ul()<=We.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",dl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),J.resolve()):(ul()<=We.DEBUG&&pe("QueryEngine","Query:",dl(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(ul()<=We.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",dl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,si(n))):J.resolve())}Rs(e,n){if(I1(n))return J.resolve(null);let r=si(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=op(n,null,"F"),r=si(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=He(...i);return this.As.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ps(n,a);return this.ys(n,c,o,l.readTime)?this.Rs(e,op(n,null,"F")):this.ws(e,c,n,l)}))})))}Vs(e,n,r,s){return I1(n)||s.isEqual(Ne.min())?J.resolve(null):this.As.getDocuments(e,r).next(i=>{const o=this.ps(n,i);return this.ys(n,o,r,s)?J.resolve(null):(ul()<=We.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),dl(n)),this.ws(e,o,n,e4(s,id)).next(a=>a))})}ps(e,n){let r=new Tn(_A(e));return n.forEach((s,i)=>{am(e,i)&&(r=r.add(i))}),r}ys(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}fs(e,n,r){return ul()<=We.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",dl(n)),this.As.getDocumentsMatchingQuery(e,n,Mo.min(),r)}ws(e,n,r,s){return this.As.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex="LocalStore",jU=3e8;class DU{constructor(e,n,r,s){this.persistence=e,this.bs=n,this.serializer=s,this.Ss=new Kt(Be),this.Ds=new Ka(i=>fx(i),px),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(r)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bU(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ss))}}function MU(t,e,n,r){return new DU(t,e,n,r)}async function WA(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Fs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=He();for(const c of s){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of i){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ms:c,removedBatchIds:o,addedBatchIds:a}))})})}function OU(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const f=c.batch,p=f.keys();let m=J.resolve();return p.forEach(x=>{m=m.next(()=>d.getEntry(l,x)).next(w=>{const y=c.docVersions.get(x);ct(y!==null,48541),w.version.compareTo(y)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),d.addEntry(w)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=He();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function HA(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.ai.getLastRemoteSnapshotVersion(n))}function LU(t,e){const n=Ae(t),r=e.snapshotVersion;let s=n.Ss;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Cs.newChangeBuffer({trackRemovals:!0});s=n.Ss;const a=[];e.targetChanges.forEach((d,f)=>{const p=s.get(f);if(!p)return;a.push(n.ai.removeMatchingKeys(i,d.removedDocuments,f).next(()=>n.ai.addMatchingKeys(i,d.addedDocuments,f)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(Hn.EMPTY_BYTE_STRING,Ne.min()).withLastLimboFreeSnapshotVersion(Ne.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(f,m),function(w,y,_){return w.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=jU?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(p,m,d)&&a.push(n.ai.updateTargetData(i,m))});let l=zi(),c=He();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(FU(i,o,e.documentUpdates).next(d=>{l=d.xs,c=d.Os})),!r.isEqual(Ne.min())){const d=n.ai.getLastRemoteSnapshotVersion(i).next(f=>n.ai.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return J.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.Ss=s,i))}function FU(t,e,n){let r=He(),s=He();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=zi();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Ne.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):pe(Ex,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{xs:o,Os:s}})}function VU(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ux),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function UU(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.ai.getTargetData(r,e).next(i=>i?(s=i,J.resolve(s)):n.ai.allocateTargetId(r).next(o=>(s=new ho(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.ai.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ss.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ss=n.Ss.insert(r.targetId,r),n.Ds.set(e,r.targetId)),r})}async function gv(t,e,n){const r=Ae(t),s=r.Ss.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!_c(o))throw o;pe(Ex,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ss=r.Ss.remove(e),r.Ds.delete(s.target)}function U1(t,e,n){const r=Ae(t);let s=Ne.min(),i=He();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const f=Ae(l),p=f.Ds.get(d);return p!==void 0?J.resolve(f.Ss.get(p)):f.ai.getTargetData(c,d)}(r,o,si(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.bs.getDocumentsMatchingQuery(o,e,n?s:Ne.min(),n?i:He())).next(a=>(BU(r,I4(e),a),{documents:a,Ns:i})))}function BU(t,e,n){let r=t.vs.get(e)||Ne.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.vs.set(e,r)}class B1{constructor(){this.activeTargetIds=j4()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class zU{constructor(){this.So=new B1,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,n,r){this.Do[e]=n}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new B1,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{vo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1="ConnectivityMonitor";class $1{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){pe(z1,"Network connectivity changed: AVAILABLE");for(const e of this.Oo)e(0)}xo(){pe(z1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Oo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Eh=null;function yv(){return Eh===null?Eh=function(){return 268435456+Math.round(2147483648*Math.random())}():Eh++,"0x"+Eh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="RestConnection",WU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HU{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Lo=n+"://"+e.host,this.ko=`projects/${r}/databases/${s}`,this.qo=this.databaseId.database===rp?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Qo(e,n,r,s,i){const o=yv(),a=this.$o(e,n.toUriEncodedString());pe(Ig,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(l,s,i);const{host:c}=new URL(a),d=Ko(c);return this.Ko(e,a,l,r,d).then(f=>(pe(Ig,`Received RPC '${e}' ${o}: `,f),f),f=>{throw Kl(Ig,`RPC '${e}' ${o} failed with error: `,f,"url: ",a,"request:",r),f})}Wo(e,n,r,s,i,o){return this.Qo(e,n,r,s,i)}Uo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}$o(e,n){const r=WU[e];return`${this.Lo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="WebChannelConnection";class GU extends HU{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,n,r,s,i){const o=yv();return new Promise((a,l)=>{const c=new HC;c.setWithCredentials(!0),c.listenOnce(qC.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case hf.NO_ERROR:const f=c.getResponseJson();pe(Xn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(f)),a(f);break;case hf.TIMEOUT:pe(Xn,`RPC '${e}' ${o} timed out`),l(new ue(X.DEADLINE_EXCEEDED,"Request time out"));break;case hf.HTTP_ERROR:const p=c.getStatus();if(pe(Xn,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const x=m==null?void 0:m.error;if(x&&x.status&&x.message){const w=function(_){const v=_.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(v)>=0?v:X.UNKNOWN}(x.status);l(new ue(w,x.message))}else l(new ue(X.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ue(X.UNAVAILABLE,"Connection failed."));break;default:Se(9055,{s_:e,streamId:o,o_:c.getLastErrorCode(),__:c.getLastError()})}}finally{pe(Xn,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);pe(Xn,`RPC '${e}' ${o} sending request:`,s),c.send(n,"POST",d,r,15)})}a_(e,n,r){const s=yv(),i=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=YC(),a=KC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Uo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=i.join("");pe(Xn,`Creating RPC '${e}' stream ${s}: ${d}`,l);const f=o.createWebChannel(d,l);let p=!1,m=!1;const x=new qU({Go:y=>{m?pe(Xn,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(p||(pe(Xn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),pe(Xn,`RPC '${e}' stream ${s} sending:`,y),f.send(y))},zo:()=>f.close()}),w=(y,_,v)=>{y.listen(_,k=>{try{v(k)}catch(A){setTimeout(()=>{throw A},0)}})};return w(f,ru.EventType.OPEN,()=>{m||(pe(Xn,`RPC '${e}' stream ${s} transport opened.`),x.t_())}),w(f,ru.EventType.CLOSE,()=>{m||(m=!0,pe(Xn,`RPC '${e}' stream ${s} transport closed`),x.r_())}),w(f,ru.EventType.ERROR,y=>{m||(m=!0,Kl(Xn,`RPC '${e}' stream ${s} transport errored. Name:`,y.name,"Message:",y.message),x.r_(new ue(X.UNAVAILABLE,"The operation could not be completed")))}),w(f,ru.EventType.MESSAGE,y=>{var _;if(!m){const v=y.data[0];ct(!!v,16349);const k=v,A=(k==null?void 0:k.error)||((_=k[0])===null||_===void 0?void 0:_.error);if(A){pe(Xn,`RPC '${e}' stream ${s} received error:`,A);const D=A.status;let O=function(S){const C=fn[S];if(C!==void 0)return NA(C)}(D),I=A.message;O===void 0&&(O=X.INTERNAL,I="Unknown error status: "+D+" with message "+A.message),m=!0,x.r_(new ue(O,I)),f.close()}else pe(Xn,`RPC '${e}' stream ${s} received:`,v),x.i_(v)}}),w(a,GC.STAT_EVENT,y=>{y.stat===iv.PROXY?pe(Xn,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===iv.NOPROXY&&pe(Xn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.n_()},0),x}}function Cg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(t){return new X4(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e,n,r=1e3,s=1.5,i=6e4){this.bi=e,this.timerId=n,this.u_=r,this.c_=s,this.l_=i,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();const n=Math.floor(this.h_+this.d_()),r=Math.max(0,Date.now()-this.T_),s=Math.max(0,n-r);s>0&&pe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.h_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.P_=this.bi.enqueueAfterDelay(this.timerId,s,()=>(this.T_=Date.now(),e())),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){this.P_!==null&&(this.P_.skipDelay(),this.P_=null)}cancel(){this.P_!==null&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1="PersistentStream";class GA{constructor(e,n,r,s,i,o,a,l){this.bi=e,this.R_=r,this.V_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new qA(e,n)}w_(){return this.state===1||this.state===5||this.b_()}b_(){return this.state===2||this.state===3}start(){this.p_=0,this.state!==4?this.auth():this.S_()}async stop(){this.w_()&&await this.close(0)}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&this.f_===null&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,()=>this.C_()))}F_(e){this.M_(),this.stream.send(e)}async C_(){if(this.b_())return this.close(0)}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}async close(e,n){this.M_(),this.x_(),this.y_.cancel(),this.m_++,e!==4?this.y_.reset():n&&n.code===X.RESOURCE_EXHAUSTED?(Bi(n.toString()),Bi("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):n&&n.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zo(n)}O_(){}auth(){this.state=1;const e=this.N_(this.m_),n=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.m_===n&&this.B_(r,s)},r=>{e(()=>{const s=new ue(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.L_(s)})})}B_(e,n){const r=this.N_(this.m_);this.stream=this.k_(e,n),this.stream.jo(()=>{r(()=>this.listener.jo())}),this.stream.Jo(()=>{r(()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,()=>(this.b_()&&(this.state=3),Promise.resolve())),this.listener.Jo()))}),this.stream.Zo(s=>{r(()=>this.L_(s))}),this.stream.onMessage(s=>{r(()=>++this.p_==1?this.q_(s):this.onNext(s))})}S_(){this.state=5,this.y_.E_(async()=>{this.state=0,this.start()})}L_(e){return pe(W1,`close with error: ${e}`),this.stream=null,this.close(4,e)}N_(e){return n=>{this.bi.enqueueAndForget(()=>this.m_===e?n():(pe(W1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class KU extends GA{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}k_(e,n){return this.connection.a_("Listen",e,n)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();const n=eU(this.serializer,e),r=function(i){if(!("targetChange"in i))return Ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ne.min():o.readTime?ii(o.readTime):Ne.min()}(e);return this.listener.Q_(n,r)}U_(e){const n={};n.database=mv(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=uv(l)?{documents:rU(i,l)}:{query:FA(i,l).gt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=DA(i,o.resumeToken);const c=hv(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(Ne.min())>0){a.readTime=ap(i,o.snapshotVersion.toTimestamp());const c=hv(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=oU(this.serializer,e);r&&(n.labels=r),this.F_(n)}K_(e){const n={};n.database=mv(this.serializer),n.removeTarget=e,this.F_(n)}}class YU extends GA{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,n){return this.connection.a_("Write",e,n)}q_(e){return ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.z_()}onNext(e){ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();const n=nU(e.writeResults,e.commitTime),r=ii(e.commitTime);return this.listener.j_(r,n)}H_(){const e={};e.database=mv(this.serializer),this.F_(e)}G_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>tU(this.serializer,r))};this.F_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{}class XU extends QU{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.J_=!1}Y_(){if(this.J_)throw new ue(X.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,n,r,s){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Qo(e,fv(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ue(X.UNKNOWN,i.toString())})}Wo(e,n,r,s,i){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,fv(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ue(X.UNKNOWN,o.toString())})}terminate(){this.J_=!0,this.connection.terminate()}}class JU{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){this.Z_===0&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve())))}ia(e){this.state==="Online"?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.na("Offline")))}set(e){this.sa(),this.Z_=0,e==="Online"&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ea?(Bi(n),this.ea=!1):pe("OnlineStateTracker",n)}sa(){this.X_!==null&&(this.X_.cancel(),this.X_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="RemoteStore";class ZU{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=i,this.ca.vo(o=>{r.enqueueAndForget(async()=>{Ya(this)&&(pe(La,"Restarting streams for network reachability change."),await async function(l){const c=Ae(l);c.aa.add(4),await Pd(c),c.la.set("Unknown"),c.aa.delete(4),await fm(c)}(this))})}),this.la=new JU(r,s)}}async function fm(t){if(Ya(t))for(const e of t.ua)await e(!0)}async function Pd(t){for(const e of t.ua)await e(!1)}function KA(t,e){const n=Ae(t);n._a.has(e.targetId)||(n._a.set(e.targetId,e),Ix(n)?Sx(n):xc(n).b_()&&Tx(n,e))}function kx(t,e){const n=Ae(t),r=xc(n);n._a.delete(e),r.b_()&&YA(n,e),n._a.size===0&&(r.b_()?r.v_():Ya(n)&&n.la.set("Unknown"))}function Tx(t,e){if(t.ha.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xc(t).U_(e)}function YA(t,e){t.ha.Ke(e),xc(t).K_(e)}function Sx(t){t.ha=new G4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t._a.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),xc(t).start(),t.la.ta()}function Ix(t){return Ya(t)&&!xc(t).w_()&&t._a.size>0}function Ya(t){return Ae(t).aa.size===0}function QA(t){t.ha=void 0}async function e3(t){t.la.set("Online")}async function t3(t){t._a.forEach((e,n)=>{Tx(t,e)})}async function n3(t,e){QA(t),Ix(t)?(t.la.ia(e),Sx(t)):t.la.set("Unknown")}async function r3(t,e,n){if(t.la.set("Online"),e instanceof jA&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s._a.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s._a.delete(a),s.ha.removeTarget(a))}(t,e)}catch(r){pe(La,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await cp(t,r)}else if(e instanceof gf?t.ha.Xe(e):e instanceof PA?t.ha.ot(e):t.ha.nt(e),!n.isEqual(Ne.min()))try{const r=await HA(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.ha.It(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=i._a.get(c);d&&i._a.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=i._a.get(l);if(!d)return;i._a.set(l,d.withResumeToken(Hn.EMPTY_BYTE_STRING,d.snapshotVersion)),YA(i,l);const f=new ho(d.target,l,c,d.sequenceNumber);Tx(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){pe(La,"Failed to raise snapshot:",r),await cp(t,r)}}async function cp(t,e,n){if(!_c(e))throw e;t.aa.add(1),await Pd(t),t.la.set("Offline"),n||(n=()=>HA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{pe(La,"Retrying IndexedDB access"),await n(),t.aa.delete(1),await fm(t)})}function XA(t,e){return e().catch(n=>cp(t,n,e))}async function pm(t){const e=Ae(t),n=Vo(e);let r=e.oa.length>0?e.oa[e.oa.length-1].batchId:ux;for(;s3(e);)try{const s=await VU(e.localStore,r);if(s===null){e.oa.length===0&&n.v_();break}r=s.batchId,i3(e,s)}catch(s){await cp(e,s)}JA(e)&&ZA(e)}function s3(t){return Ya(t)&&t.oa.length<10}function i3(t,e){t.oa.push(e);const n=Vo(t);n.b_()&&n.W_&&n.G_(e.mutations)}function JA(t){return Ya(t)&&!Vo(t).w_()&&t.oa.length>0}function ZA(t){Vo(t).start()}async function o3(t){Vo(t).H_()}async function a3(t){const e=Vo(t);for(const n of t.oa)e.G_(n.mutations)}async function l3(t,e,n){const r=t.oa.shift(),s=yx.from(r,e,n);await XA(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await pm(t)}async function c3(t,e){e&&Vo(t).W_&&await async function(r,s){if(function(o){return H4(o)&&o!==X.ABORTED}(s.code)){const i=r.oa.shift();Vo(r).D_(),await XA(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await pm(r)}}(t,e),JA(t)&&ZA(t)}async function H1(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),pe(La,"RemoteStore received new credentials");const r=Ya(n);n.aa.add(3),await Pd(n),r&&n.la.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.aa.delete(3),await fm(n)}async function u3(t,e){const n=Ae(t);e?(n.aa.delete(2),await fm(n)):e||(n.aa.add(2),await Pd(n),n.la.set("Unknown"))}function xc(t){return t.Pa||(t.Pa=function(n,r,s){const i=Ae(n);return i.Y_(),new KU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{jo:e3.bind(null,t),Jo:t3.bind(null,t),Zo:n3.bind(null,t),Q_:r3.bind(null,t)}),t.ua.push(async e=>{e?(t.Pa.D_(),Ix(t)?Sx(t):t.la.set("Unknown")):(await t.Pa.stop(),QA(t))})),t.Pa}function Vo(t){return t.Ta||(t.Ta=function(n,r,s){const i=Ae(n);return i.Y_(),new YU(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{jo:()=>Promise.resolve(),Jo:o3.bind(null,t),Zo:c3.bind(null,t),z_:a3.bind(null,t),j_:l3.bind(null,t)}),t.ua.push(async e=>{e?(t.Ta.D_(),await pm(t)):(await t.Ta.stop(),t.oa.length>0&&(pe(La,`Stopping write stream with ${t.oa.length} pending writes`),t.oa=[]))})),t.Ta}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Cx(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ue(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ax(t,e){if(Bi("AsyncQueue",`${e}: ${t}`),_c(t))return new ue(X.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{static emptySet(e){return new Ll(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ee.comparator(n.key,r.key):(n,r)=>Ee.comparator(n.key,r.key),this.keyedMap=su(),this.sortedSet=new Kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ll)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ll;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(){this.Ia=new Kt(Ee.comparator)}track(e){const n=e.doc.key,r=this.Ia.get(n);r?e.type!==0&&r.type===3?this.Ia=this.Ia.insert(n,e):e.type===3&&r.type!==1?this.Ia=this.Ia.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Ia=this.Ia.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Ia=this.Ia.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Ia=this.Ia.remove(n):e.type===1&&r.type===2?this.Ia=this.Ia.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Ia=this.Ia.insert(n,{type:2,doc:e.doc}):Se(63341,{Vt:e,Ea:r}):this.Ia=this.Ia.insert(n,e)}da(){const e=[];return this.Ia.inorderTraversal((n,r)=>{e.push(r)}),e}}class ec{constructor(e,n,r,s,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ec(e,n,Ll.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&om(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some(e=>e.ma())}}class h3{constructor(){this.queries=G1(),this.onlineState="Unknown",this.fa=new Set}terminate(){(function(n,r){const s=Ae(n),i=s.queries;s.queries=G1(),i.forEach((o,a)=>{for(const l of a.Ra)l.onError(r)})})(this,new ue(X.ABORTED,"Firestore shutting down"))}}function G1(){return new Ka(t=>vA(t),om)}async function Rx(t,e){const n=Ae(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Va()&&e.ma()&&(r=2):(i=new d3,r=e.ma()?0:1);try{switch(r){case 0:i.Aa=await n.onListen(s,!0);break;case 1:i.Aa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Ax(o,`Initialization of query '${dl(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Ra.push(e),e.ga(n.onlineState),i.Aa&&e.pa(i.Aa)&&Px(n)}async function Nx(t,e){const n=Ae(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Ra.indexOf(e);o>=0&&(i.Ra.splice(o,1),i.Ra.length===0?s=e.ma()?0:1:!i.Va()&&e.ma()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function f3(t,e){const n=Ae(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Ra)a.pa(s)&&(r=!0);o.Aa=s}}r&&Px(n)}function p3(t,e,n){const r=Ae(t),s=r.queries.get(e);if(s)for(const i of s.Ra)i.onError(n);r.queries.delete(e)}function Px(t){t.fa.forEach(e=>{e.next()})}var vv,K1;(K1=vv||(vv={})).ya="default",K1.Cache="cache";class jx{constructor(e,n,r){this.query=e,this.wa=n,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=r||{}}pa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ec(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ba?this.Da(e)&&(this.wa.next(e),n=!0):this.va(e,this.onlineState)&&(this.Ca(e),n=!0),this.Sa=e,n}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let n=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),n=!0),n}va(e,n){if(!e.fromCache||!this.ma())return!0;const r=n!=="Offline";return(!this.options.Fa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Da(e){if(e.docChanges.length>0)return!0;const n=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ca(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==vv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e){this.key=e}}class tR{constructor(e){this.key=e}}class m3{constructor(e,n){this.query=e,this.qa=n,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=He(),this.mutatedKeys=He(),this.Ua=_A(e),this.Ka=new Ll(this.Ua)}get Wa(){return this.qa}Ga(e,n){const r=n?n.za:new q1,s=n?n.Ka:this.Ka;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,f)=>{const p=s.get(d),m=am(this.query,f)?f:null,x=!!p&&this.mutatedKeys.has(p.key),w=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let y=!1;p&&m?p.data.isEqual(m.data)?x!==w&&(r.track({type:3,doc:m}),y=!0):this.ja(p,m)||(r.track({type:2,doc:m}),y=!0,(l&&this.Ua(m,l)>0||c&&this.Ua(m,c)<0)&&(a=!0)):!p&&m?(r.track({type:0,doc:m}),y=!0):p&&!m&&(r.track({type:1,doc:p}),y=!0,(l||c)&&(a=!0)),y&&(m?(o=o.add(m),i=w?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ka:o,za:r,ys:a,mutatedKeys:i}}ja(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;const o=e.za.da();o.sort((d,f)=>function(m,x){const w=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Se(20277,{Vt:y})}};return w(m)-w(x)}(d.type,f.type)||this.Ua(d.doc,f.doc)),this.Ha(r),s=s!=null&&s;const a=n&&!s?this.Ja():[],l=this.$a.size===0&&this.current&&!s?1:0,c=l!==this.Qa;return this.Qa=l,o.length!==0||c?{snapshot:new ec(this.query,e.Ka,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ya:a}:{Ya:a}}ga(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new q1,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach(n=>this.qa=this.qa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.qa=this.qa.delete(n)),this.current=e.current)}Ja(){if(!this.current)return[];const e=this.$a;this.$a=He(),this.Ka.forEach(r=>{this.Za(r.key)&&(this.$a=this.$a.add(r.key))});const n=[];return e.forEach(r=>{this.$a.has(r)||n.push(new tR(r))}),this.$a.forEach(r=>{e.has(r)||n.push(new eR(r))}),n}Xa(e){this.qa=e.Ns,this.$a=He();const n=this.Ga(e.documents);return this.applyChanges(n,!0)}eu(){return ec.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,this.Qa===0,this.hasCachedResults)}}const Dx="SyncEngine";class g3{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class y3{constructor(e){this.key=e,this.tu=!1}}class v3{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.nu={},this.ru=new Ka(a=>vA(a),om),this.iu=new Map,this.su=new Set,this.ou=new Kt(Ee.comparator),this._u=new Map,this.au=new xx,this.uu={},this.cu=new Map,this.lu=Zl.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return this.hu===!0}}async function _3(t,e,n=!0){const r=aR(t);let s;const i=r.ru.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.eu()):s=await nR(r,e,n,!0),s}async function x3(t,e){const n=aR(t);await nR(n,e,!0,!1)}async function nR(t,e,n,r){const s=await UU(t.localStore,si(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await w3(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&KA(t.remoteStore,s),a}async function w3(t,e,n,r,s){t.Pu=(f,p,m)=>async function(w,y,_,v){let k=y.view.Ga(_);k.ys&&(k=await U1(w.localStore,y.query,!1).then(({documents:I})=>y.view.Ga(I,k)));const A=v&&v.targetChanges.get(y.targetId),D=v&&v.targetMismatches.get(y.targetId)!=null,O=y.view.applyChanges(k,w.isPrimaryClient,A,D);return Q1(w,y.targetId,O.Ya),O.snapshot}(t,f,p,m);const i=await U1(t.localStore,e,!0),o=new m3(e,i.Ns),a=o.Ga(i.documents),l=Nd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=o.applyChanges(a,t.isPrimaryClient,l);Q1(t,n,c.Ya);const d=new g3(e,n,o);return t.ru.set(e,d),t.iu.has(n)?t.iu.get(n).push(e):t.iu.set(n,[e]),c.snapshot}async function b3(t,e,n){const r=Ae(t),s=r.ru.get(e),i=r.iu.get(s.targetId);if(i.length>1)return r.iu.set(s.targetId,i.filter(o=>!om(o,e))),void r.ru.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await gv(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&kx(r.remoteStore,s.targetId),_v(r,s.targetId)}).catch(vc)):(_v(r,s.targetId),await gv(r.localStore,s.targetId,!0))}async function E3(t,e){const n=Ae(t),r=n.ru.get(e),s=n.iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),kx(n.remoteStore,r.targetId))}async function k3(t,e,n){const r=N3(t);try{const s=await function(o,a){const l=Ae(o),c=cn.now(),d=a.reduce((m,x)=>m.add(x.key),He());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let x=zi(),w=He();return l.Cs.getEntries(m,d).next(y=>{x=y,x.forEach((_,v)=>{v.isValidDocument()||(w=w.add(_))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,x)).next(y=>{f=y;const _=[];for(const v of a){const k=V4(v,f.get(v.key).overlayedDocument);k!=null&&_.push(new Zo(v.key,k,cA(k.value.mapValue),yr.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,_,a)}).next(y=>{p=y;const _=y.applyToLocalDocumentSet(f,w);return l.documentOverlayCache.saveOverlays(m,y.batchId,_)})}).then(()=>({batchId:p.batchId,changes:wA(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.uu[o.currentUser.toKey()];c||(c=new Kt(Be)),c=c.insert(a,l),o.uu[o.currentUser.toKey()]=c}(r,s.batchId,n),await jd(r,s.changes),await pm(r.remoteStore)}catch(s){const i=Ax(s,"Failed to persist write");n.reject(i)}}async function rR(t,e){const n=Ae(t);try{const r=await LU(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n._u.get(i);o&&(ct(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.tu=!0:s.modifiedDocuments.size>0?ct(o.tu,14607):s.removedDocuments.size>0&&(ct(o.tu,42227),o.tu=!1))}),await jd(n,r,e)}catch(r){await vc(r)}}function Y1(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ru.forEach((i,o)=>{const a=o.view.ga(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=Ae(o);l.onlineState=a;let c=!1;l.queries.forEach((d,f)=>{for(const p of f.Ra)p.ga(a)&&(c=!0)}),c&&Px(l)}(r.eventManager,e),s.length&&r.nu.Q_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function T3(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r._u.get(e),i=s&&s.key;if(i){let o=new Kt(Ee.comparator);o=o.insert(i,tr.newNoDocument(i,Ne.min()));const a=He().add(i),l=new dm(Ne.min(),new Map,new Kt(Be),o,a);await rR(r,l),r.ou=r.ou.remove(i),r._u.delete(e),Mx(r)}else await gv(r.localStore,e,!1).then(()=>_v(r,e,n)).catch(vc)}async function S3(t,e){const n=Ae(t),r=e.batch.batchId;try{const s=await OU(n.localStore,e);iR(n,r,null),sR(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await jd(n,s)}catch(s){await vc(s)}}async function I3(t,e,n){const r=Ae(t);try{const s=await function(o,a){const l=Ae(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(ct(f!==null,37113),d=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);iR(r,e,n),sR(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await jd(r,s)}catch(s){await vc(s)}}function sR(t,e){(t.cu.get(e)||[]).forEach(n=>{n.resolve()}),t.cu.delete(e)}function iR(t,e,n){const r=Ae(t);let s=r.uu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.uu[r.currentUser.toKey()]=s}}function _v(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.iu.get(e))t.ru.delete(r),n&&t.nu.Tu(r,n);t.iu.delete(e),t.isPrimaryClient&&t.au.Ur(e).forEach(r=>{t.au.containsKey(r)||oR(t,r)})}function oR(t,e){t.su.delete(e.path.canonicalString());const n=t.ou.get(e);n!==null&&(kx(t.remoteStore,n),t.ou=t.ou.remove(e),t._u.delete(n),Mx(t))}function Q1(t,e,n){for(const r of n)r instanceof eR?(t.au.addReference(r.key,e),C3(t,r)):r instanceof tR?(pe(Dx,"Document no longer in limbo: "+r.key),t.au.removeReference(r.key,e),t.au.containsKey(r.key)||oR(t,r.key)):Se(19791,{Iu:r})}function C3(t,e){const n=e.key,r=n.path.canonicalString();t.ou.get(n)||t.su.has(r)||(pe(Dx,"New document in limbo: "+n),t.su.add(r),Mx(t))}function Mx(t){for(;t.su.size>0&&t.ou.size<t.maxConcurrentLimboResolutions;){const e=t.su.values().next().value;t.su.delete(e);const n=new Ee(St.fromString(e)),r=t.lu.next();t._u.set(r,new y3(n)),t.ou=t.ou.insert(n,r),KA(t.remoteStore,new ho(si(im(n.path)),r,"TargetPurposeLimboResolution",nm.le))}}async function jd(t,e,n){const r=Ae(t),s=[],i=[],o=[];r.ru.isEmpty()||(r.ru.forEach((a,l)=>{o.push(r.Pu(l,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const f=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=bx.Ps(l.targetId,c);i.push(f)}}))}),await Promise.all(o),r.nu.Q_(s),await async function(l,c){const d=Ae(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>J.forEach(c,p=>J.forEach(p.ls,m=>d.persistence.referenceDelegate.addReference(f,p.targetId,m)).next(()=>J.forEach(p.hs,m=>d.persistence.referenceDelegate.removeReference(f,p.targetId,m)))))}catch(f){if(!_c(f))throw f;pe(Ex,"Failed to update sequence numbers: "+f)}for(const f of c){const p=f.targetId;if(!f.fromCache){const m=d.Ss.get(p),x=m.snapshotVersion,w=m.withLastLimboFreeSnapshotVersion(x);d.Ss=d.Ss.insert(p,w)}}}(r.localStore,i))}async function A3(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){pe(Dx,"User change. New user:",e.toKey());const r=await WA(n.localStore,e);n.currentUser=e,function(i,o){i.cu.forEach(a=>{a.forEach(l=>{l.reject(new ue(X.CANCELLED,o))})}),i.cu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await jd(n,r.Ms)}}function R3(t,e){const n=Ae(t),r=n._u.get(e);if(r&&r.tu)return He().add(r.key);{let s=He();const i=n.iu.get(e);if(!i)return s;for(const o of i){const a=n.ru.get(o);s=s.unionWith(a.view.Wa)}return s}}function aR(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=R3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=T3.bind(null,e),e.nu.Q_=f3.bind(null,e.eventManager),e.nu.Tu=p3.bind(null,e.eventManager),e}function N3(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=S3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=I3.bind(null,e),e}class up{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hm(e.databaseInfo.databaseId),this.sharedClientState=this.Au(e),this.persistence=this.Ru(e),await this.persistence.start(),this.localStore=this.Vu(e),this.gcScheduler=this.mu(e,this.localStore),this.indexBackfillerScheduler=this.fu(e,this.localStore)}mu(e,n){return null}fu(e,n){return null}Vu(e){return MU(this.persistence,new PU,e.initialUser,this.serializer)}Ru(e){return new $A(wx.Ei,this.serializer)}Au(e){return new zU}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}up.provider={build:()=>new up};class P3 extends up{constructor(e){super(),this.cacheSizeBytes=e}mu(e,n){ct(this.persistence.referenceDelegate instanceof lp,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new yU(r,e.asyncQueue,n)}Ru(e){const n=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new $A(r=>lp.Ei(r,n),this.serializer)}}class xv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Y1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=A3.bind(null,this.syncEngine),await u3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new h3}()}createDatastore(e){const n=hm(e.databaseInfo.databaseId),r=function(i){return new GU(i)}(e.databaseInfo);return function(i,o,a,l){return new XU(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new ZU(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Y1(this.syncEngine,n,0),function(){return $1.C()?new $1:new $U}())}createSyncEngine(e,n){return function(s,i,o,a,l,c,d){const f=new v3(s,i,o,a,l,c);return d&&(f.hu=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ae(s);pe(La,"RemoteStore shutting down."),i.aa.add(5),await Pd(i),i.ca.shutdown(),i.la.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}xv.provider={build:()=>new xv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):Bi("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="FirestoreClient";class j3{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Jn.UNAUTHENTICATED,this.clientId=ZC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{pe(Uo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(pe(Uo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ax(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ag(t,e){t.asyncQueue.verifyOperationInProgress(),pe(Uo,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await WA(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function X1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await D3(t);pe(Uo,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>H1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>H1(e.remoteStore,s)),t._onlineComponents=e}async function D3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){pe(Uo,"Using user provided OfflineComponentProvider");try{await Ag(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===X.FAILED_PRECONDITION||s.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Kl("Error using user provided cache. Falling back to memory cache: "+n),await Ag(t,new up)}}else pe(Uo,"Using default OfflineComponentProvider"),await Ag(t,new P3(void 0));return t._offlineComponents}async function Lx(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(pe(Uo,"Using user provided OnlineComponentProvider"),await X1(t,t._uninitializedComponentsProvider._online)):(pe(Uo,"Using default OnlineComponentProvider"),await X1(t,new xv))),t._onlineComponents}function M3(t){return Lx(t).then(e=>e.syncEngine)}function O3(t){return Lx(t).then(e=>e.datastore)}async function dp(t){const e=await Lx(t),n=e.eventManager;return n.onListen=_3.bind(null,e.syncEngine),n.onUnlisten=b3.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=x3.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=E3.bind(null,e.syncEngine),n}function L3(t,e,n={}){const r=new ri;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new Ox({next:p=>{d.yu(),o.enqueueAndForget(()=>Nx(i,f));const m=p.docs.has(a);!m&&p.fromCache?c.reject(new ue(X.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new ue(X.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),f=new jx(im(a.path),d,{includeMetadataChanges:!0,Fa:!0});return Rx(i,f)}(await dp(t),t.asyncQueue,e,n,r)),r.promise}function F3(t,e,n={}){const r=new ri;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const d=new Ox({next:p=>{d.yu(),o.enqueueAndForget(()=>Nx(i,f)),p.fromCache&&l.source==="server"?c.reject(new ue(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),f=new jx(a,d,{includeMetadataChanges:!0,Fa:!0});return Rx(i,f)}(await dp(t),t.asyncQueue,e,n,r)),r.promise}function V3(t,e,n){const r=new ri;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await O3(t);r.resolve(async function(o,a,l){var c;const d=Ae(o),{request:f,yt:p,parent:m}=sU(d.serializer,S4(a),l);d.connection.Bo||delete f.parent;const x=(await d.Wo("RunAggregationQuery",d.serializer.databaseId,m,f,1)).filter(y=>!!y.result);ct(x.length===1,64727);const w=(c=x[0].result)===null||c===void 0?void 0:c.aggregateFields;return Object.keys(w).reduce((y,_)=>(y[p[_]]=w[_],y),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(t,e,n){if(!n)throw new ue(X.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function U3(t,e,n,r){if(e===!0&&r===!0)throw new ue(X.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Z1(t){if(!Ee.isDocumentKey(t))throw new ue(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function eE(t){if(Ee.isDocumentKey(t))throw new ue(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function mm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Se(12329,{type:typeof t})}function zn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ue(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=mm(t);throw new ue(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function B3(t,e){if(e<=0)throw new ue(X.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR="firestore.googleapis.com",tE=!0;class nE{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ue(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=cR,this.ssl=tE}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:tE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mU)throw new ue(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}U3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ue(X.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ue(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ue(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new HV;switch(r.type){case"firstParty":return new YV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ue(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,Yo("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=J1.get(n);r&&(pe("ComponentProvider","Removing Datastore"),J1.delete(n),r.terminate())}(this),Promise.resolve()}}function z3(t,e,n,r={}){var s;t=zn(t,Dd);const i=Ko(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),l=`${e}:${n}`;o.host!==cR&&o.host!==l&&Kl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:i,emulatorOptions:r});if(!Do(c,a)&&(t._setSettings(c),i&&(Yp(`https://${l}`),Yo("Firestore",!0)),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=Jn.MOCK_USER;else{d=GI(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new ue(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Jn(p)}t._authCredentials=new qV(new XC(d,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new fi(this.firestore,e,this._query)}}class ir{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ir(this.firestore,e,this._key)}}class Ao extends fi{constructor(e,n,r){super(e,n,im(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ir(this.firestore,null,new Ee(e))}withConverter(e){return new Ao(this.firestore,e,this._path)}}function be(t,e,...n){if(t=Fe(t),Fx("collection","path",e),t instanceof Dd){const r=St.fromString(e,...n);return eE(r),new Ao(t,null,r)}{if(!(t instanceof ir||t instanceof Ao))throw new ue(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(St.fromString(e,...n));return eE(r),new Ao(t.firestore,null,r)}}function yf(t,e){if(t=zn(t,Dd),Fx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ue(X.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new fi(t,null,function(r){return new Ga(St.emptyPath(),r)}(e))}function oe(t,e,...n){if(t=Fe(t),arguments.length===1&&(e=ZC.newId()),Fx("doc","path",e),t instanceof Dd){const r=St.fromString(e,...n);return Z1(r),new ir(t,null,new Ee(r))}{if(!(t instanceof ir||t instanceof Ao))throw new ue(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(St.fromString(e,...n));return Z1(r),new ir(t.firestore,t instanceof Ao?t.converter:null,new Ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="AsyncQueue";class sE{constructor(e=Promise.resolve()){this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new qA(this,"async_queue_retry"),this.ju=()=>{const r=Cg();r&&pe(rE,"Visibility state changed to "+r.visibilityState),this.y_.A_()},this.Hu=e;const n=Cg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;const n=Cg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise(()=>{});const n=new ri;return this.Yu(()=>this.$u&&this.Gu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qu.push(e),this.Zu()))}async Zu(){if(this.Qu.length!==0){try{await this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!_c(e))throw e;pe(rE,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_(()=>this.Zu())}}Yu(e){const n=this.Hu.then(()=>(this.Wu=!0,e().catch(r=>{throw this.Ku=r,this.Wu=!1,Bi("INTERNAL UNHANDLED ERROR: ",iE(r)),r}).then(r=>(this.Wu=!1,r))));return this.Hu=n,n}enqueueAfterDelay(e,n,r){this.Ju(),this.zu.indexOf(e)>-1&&(n=0);const s=Cx.createAndSchedule(this,e,n,r,i=>this.Xu(i));return this.Uu.push(s),s}Ju(){this.Ku&&Se(47125,{ec:iE(this.Ku)})}verifyOperationInProgress(){}async tc(){let e;do e=this.Hu,await e;while(e!==this.Hu)}nc(e){for(const n of this.Uu)if(n.timerId===e)return!0;return!1}rc(e){return this.tc().then(()=>{this.Uu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Uu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.tc()})}sc(e){this.zu.push(e)}Xu(e){const n=this.Uu.indexOf(e);this.Uu.splice(n,1)}}function iE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Ds extends Dd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new sE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sE(e),this._firestoreClient=void 0,await e}}}function $3(t,e){const n=typeof t=="object"?t:Td(),r=typeof t=="string"?t:rp,s=Qo(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=$_("firestore");i&&z3(s,...i)}return s}function wc(t){if(t._terminated)throw new ue(X.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||W3(t),t._firestoreClient}function W3(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,c,d){return new d4(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,lR(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new j3(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class q3{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tc(Hn.fromBase64String(e))}catch(n){throw new ue(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new tc(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ue(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ue(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ue(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Be(this._lat,e._lat)||Be(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3=/^__.*__$/;class K3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Zo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Rd(e,this.data,n,this.fieldTransforms)}}class uR{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Zo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function dR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Se(40011,{oc:t})}}class gm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this._c(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new gm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ac({path:r,cc:!1});return s.lc(e),s}hc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ac({path:r,cc:!1});return s._c(),s}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return hp(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(e.length===0)throw this.Tc("Document fields must not be empty");if(dR(this.oc)&&G3.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}}class Y3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||hm(e)}dc(e,n,r,s=!1){return new gm({oc:e,methodName:n,Ec:r,path:Vn.emptyPath(),cc:!1,Ic:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Od(t){const e=t._freezeSettings(),n=hm(t._databaseId);return new Y3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Bx(t,e,n,r,s,i={}){const o=t.dc(i.merge||i.mergeFields?2:0,e,n,s);Hx("Data must be an object, but it was:",o,r);const a=pR(r,o);let l,c;if(i.merge)l=new Yr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const f of i.mergeFields){const p=wv(e,f,n);if(!o.contains(p))throw new ue(X.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);gR(d,p)||d.push(p)}l=new Yr(d),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new K3(new Nr(a),l,c)}class ym extends bc{_toFieldTransform(e){if(e.oc!==2)throw e.oc===1?e.Tc(`${this._methodName}() can only appear at the top level of your update data`):e.Tc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ym}}function Q3(t,e,n){return new gm({oc:3,Ec:e.settings.Ec,methodName:t._methodName,cc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class zx extends bc{_toFieldTransform(e){return new gx(e.path,new ud)}isEqual(e){return e instanceof zx}}class $x extends bc{constructor(e,n){super(e),this.Ac=n}_toFieldTransform(e){const n=Q3(this,e,!0),r=this.Ac.map(i=>Ec(i,n)),s=new Jl(r);return new gx(e.path,s)}isEqual(e){return e instanceof $x&&Do(this.Ac,e.Ac)}}class Wx extends bc{constructor(e,n){super(e),this.Rc=n}_toFieldTransform(e){const n=new hd(e.serializer,kA(e.serializer,this.Rc));return new gx(e.path,n)}isEqual(e){return e instanceof Wx&&this.Rc===e.Rc}}function hR(t,e,n,r){const s=t.dc(1,e,n);Hx("Data must be an object, but it was:",s,r);const i=[],o=Nr.empty();Jo(r,(l,c)=>{const d=qx(e,l,n);c=Fe(c);const f=s.hc(d);if(c instanceof ym)i.push(d);else{const p=Ec(c,f);p!=null&&(i.push(d),o.set(d,p))}});const a=new Yr(i);return new uR(o,a,s.fieldTransforms)}function fR(t,e,n,r,s,i){const o=t.dc(1,e,n),a=[wv(e,r,n)],l=[s];if(i.length%2!=0)throw new ue(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(wv(e,i[p])),l.push(i[p+1]);const c=[],d=Nr.empty();for(let p=a.length-1;p>=0;--p)if(!gR(c,a[p])){const m=a[p];let x=l[p];x=Fe(x);const w=o.hc(m);if(x instanceof ym)c.push(m);else{const y=Ec(x,w);y!=null&&(c.push(m),d.set(m,y))}}const f=new Yr(c);return new uR(d,f,o.fieldTransforms)}function X3(t,e,n,r=!1){return Ec(n,t.dc(r?4:3,e))}function Ec(t,e){if(mR(t=Fe(t)))return Hx("Unsupported field value:",e,t),pR(t,e);if(t instanceof bc)return function(r,s){if(!dR(s.oc))throw s.Tc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Tc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.cc&&e.oc!==4)throw e.Tc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Ec(a,s.Pc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Fe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kA(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=cn.fromDate(r);return{timestampValue:ap(s.serializer,i)}}if(r instanceof cn){const i=new cn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ap(s.serializer,i)}}if(r instanceof Vx)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof tc)return{bytesValue:DA(s.serializer,r._byteString)};if(r instanceof ir){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Tc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:_x(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ux)return function(o,a){return{mapValue:{fields:{[aA]:{stringValue:lA},[sp]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Tc("VectorValues must only contain numeric values.");return mx(a.serializer,c)})}}}}}}(r,s);throw s.Tc(`Unsupported field value: ${mm(r)}`)}(t,e)}function pR(t,e){const n={};return tA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jo(t,(r,s)=>{const i=Ec(s,e.uc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function mR(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof cn||t instanceof Vx||t instanceof tc||t instanceof ir||t instanceof bc||t instanceof Ux)}function Hx(t,e,n){if(!mR(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=mm(n);throw r==="an object"?e.Tc(t+" a custom object"):e.Tc(t+" "+r)}}function wv(t,e,n){if((e=Fe(e))instanceof Md)return e._internalPath;if(typeof e=="string")return qx(t,e);throw hp("Field path arguments must be of type string or ",t,!1,void 0,n)}const J3=new RegExp("[~\\*/\\[\\]]");function qx(t,e,n){if(e.search(J3)>=0)throw hp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Md(...e.split("."))._internalPath}catch{throw hp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function hp(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new ue(X.INVALID_ARGUMENT,a+t+l)}function gR(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ir(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Z3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(vm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Z3 extends yR{data(){return super.data()}}function vm(t,e){return typeof e=="string"?qx(t,e):e instanceof Md?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ue(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gx{}class Kx extends Gx{}function un(t,e,...n){let r=[];e instanceof Gx&&r.push(e),r=r.concat(n),function(i){const o=i.filter(l=>l instanceof Yx).length,a=i.filter(l=>l instanceof _m).length;if(o>1||o>0&&a>0)throw new ue(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class _m extends Kx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new _m(e,n,r)}_apply(e){const n=this._parse(e);return _R(e._query,n),new fi(e.firestore,e.converter,dv(e._query,n))}_parse(e){const n=Od(e.firestore);return function(i,o,a,l,c,d,f){let p;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ue(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){lE(f,d);const x=[];for(const w of f)x.push(aE(l,i,w));p={arrayValue:{values:x}}}else p=aE(l,i,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||lE(f,d),p=X3(a,o,f,d==="in"||d==="not-in");return yn.create(c,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Nt(t,e,n){const r=e,s=vm("where",t);return _m._create(s,r,n)}class Yx extends Gx{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Yx(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:js.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)_R(o,l),o=dv(o,l)}(e._query,n),new fi(e.firestore,e.converter,dv(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Qx extends Kx{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Qx(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new ue(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ue(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cd(i,o)}(e._query,this._field,this._direction);return new fi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Ga(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function bv(t,e="asc"){const n=e,r=vm("orderBy",t);return Qx._create(r,n)}class Xx extends Kx{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Xx(e,n,r)}_apply(e){return new fi(e.firestore,e.converter,op(e._query,this._limit,this._limitType))}}function Ev(t){return B3("limit",t),Xx._create("limit",t,"F")}function aE(t,e,n){if(typeof(n=Fe(n))=="string"){if(n==="")throw new ue(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gA(e)&&n.indexOf("/")!==-1)throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(St.fromString(n));if(!Ee.isDocumentKey(r))throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return w1(t,new Ee(r))}if(n instanceof ir)return w1(t,n._key);throw new ue(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mm(n)}.`)}function lE(t,e){if(!Array.isArray(t)||t.length===0)throw new ue(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function _R(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ue(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ue(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class e5{convertValue(e,n="none"){switch(Fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Lo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Jo(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[sp].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>rn(o.doubleValue));return new Ux(i)}convertGeoPoint(e){return new Vx(rn(e.latitude),rn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=sm(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(od(e));default:return null}}convertTimestamp(e){const n=Oo(e);return new cn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=St.fromString(e);ct(BA(r),9688,{name:e});const s=new ad(r.get(1),r.get(3)),i=new Ee(r.popFirst(5));return s.isEqual(n)||Bi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jx(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function t5(){return new H3("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xR extends yR{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new vf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(vm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class vf extends xR{data(e={}){return super.data(e)}}class wR{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ou(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new vf(this._firestore,this._userDataWriter,r.key,r,new ou(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ue(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new vf(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ou(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new vf(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ou(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:n5(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function n5(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Se(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(t){t=zn(t,ir);const e=zn(t.firestore,Ds);return L3(wc(e),t._key).then(n=>bR(e,t,n))}class xm extends e5{constructor(e){super(),this.firestore=e}convertBytes(e){return new tc(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ir(this.firestore,null,n)}}function Le(t){t=zn(t,fi);const e=zn(t.firestore,Ds),n=wc(e),r=new xm(e);return vR(t._query),F3(n,t._query).then(s=>new wR(e,r,t,s))}function li(t,e,n){t=zn(t,ir);const r=zn(t.firestore,Ds),s=Jx(t.converter,e,n);return Ld(r,[Bx(Od(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,yr.none())])}function nt(t,e,n,...r){t=zn(t,ir);const s=zn(t.firestore,Ds),i=Od(s);let o;return o=typeof(e=Fe(e))=="string"||e instanceof Md?fR(i,"updateDoc",t._key,e,n,r):hR(i,"updateDoc",t._key,e),Ld(s,[o.toMutation(t._key,yr.exists(!0))])}function Dr(t){return Ld(zn(t.firestore,Ds),[new um(t._key,yr.none())])}function Vr(t,e){const n=zn(t.firestore,Ds),r=oe(t),s=Jx(t.converter,e);return Ld(n,[Bx(Od(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,yr.exists(!1))]).then(()=>r)}function fp(t,...e){var n,r,s;t=Fe(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||oE(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(oE(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,d;if(t instanceof ir)c=zn(t.firestore,Ds),d=im(t._key.path),l={next:f=>{e[o]&&e[o](bR(c,t,f))},error:e[o+1],complete:e[o+2]};else{const f=zn(t,fi);c=zn(f.firestore,Ds),d=f._query;const p=new xm(c);l={next:m=>{e[o]&&e[o](new wR(c,p,f,m))},error:e[o+1],complete:e[o+2]},vR(t._query)}return function(p,m,x,w){const y=new Ox(w),_=new jx(m,y,x);return p.asyncQueue.enqueueAndForget(async()=>Rx(await dp(p),_)),()=>{y.yu(),p.asyncQueue.enqueueAndForget(async()=>Nx(await dp(p),_))}}(wc(c),d,a,l)}function Ld(t,e){return function(r,s){const i=new ri;return r.asyncQueue.enqueueAndForget(async()=>k3(await M3(r),s,i)),i.promise}(wc(t),e)}function bR(t,e,n){const r=n.docs.get(e._key),s=new xm(t);return new xR(t,s,e._key,r,new ou(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(t){return s5(t,{count:t5()})}function s5(t,e){const n=zn(t.firestore,Ds),r=wc(n),s=c4(e,(i,o)=>new $4(o,i.aggregateType,i._internalFieldPath));return V3(r,t._query,s).then(i=>function(a,l,c){const d=new xm(a);return new q3(l,d,c)}(n,t,i))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Od(e)}set(e,n,r){this._verifyNotCommitted();const s=Rg(e,this._firestore),i=Jx(s.converter,n,r),o=Bx(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,yr.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Rg(e,this._firestore);let o;return o=typeof(n=Fe(n))=="string"||n instanceof Md?fR(this._dataReader,"WriteBatch.update",i._key,n,r,s):hR(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,yr.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Rg(e,this._firestore);return this._mutations=this._mutations.concat(new um(n._key,yr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ue(X.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Rg(t,e){if((t=Fe(t)).firestore!==e)throw new ue(X.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function mn(){return new zx("serverTimestamp")}function ER(...t){return new $x("arrayUnion",t)}function kh(t){return new Wx("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(t){return wc(t=zn(t,Ds)),new i5(t,e=>Ld(t,e))}(function(e,n=!0){(function(s){yc=s})(qa),fs(new es("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Ds(new GV(r.getProvider("auth-internal")),new QV(o,r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ue(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ad(c.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),sr(c1,u1,e),sr(c1,u1,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="firebasestorage.googleapis.com",TR="storageBucket",o5=2*60*1e3,a5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn extends ys{constructor(e,n,r=0){super(Ng(e),`Firebase Storage: ${n} (${Ng(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,nn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ng(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Zt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zt||(Zt={}));function Ng(t){return"storage/"+t}function Zx(){const t="An unknown error occurred, please check the error payload for server response.";return new nn(Zt.UNKNOWN,t)}function l5(t){return new nn(Zt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function c5(t){return new nn(Zt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function u5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new nn(Zt.UNAUTHENTICATED,t)}function d5(){return new nn(Zt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function h5(t){return new nn(Zt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function f5(){return new nn(Zt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p5(){return new nn(Zt.CANCELED,"User canceled the upload/download.")}function m5(t){return new nn(Zt.INVALID_URL,"Invalid URL '"+t+"'.")}function g5(t){return new nn(Zt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function y5(){return new nn(Zt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+TR+"' property when initializing the app?")}function v5(){return new nn(Zt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function _5(){return new nn(Zt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function x5(t){return new nn(Zt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function kv(t){return new nn(Zt.INVALID_ARGUMENT,t)}function SR(){return new nn(Zt.APP_DELETED,"The Firebase app was deleted.")}function w5(t){return new nn(Zt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Cu(t,e){return new nn(Zt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Uc(t){throw new nn(Zt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=pr.makeFromUrl(e,n)}catch{return new pr(e,"")}if(r.path==="")return r;throw g5(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(A){A.path_=decodeURIComponent(A.path)}const d="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${f}/${d}/b/${s}/o${p}`,"i"),x={bucket:1,path:3},w=n===kR?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",_=new RegExp(`^https?://${w}/${s}/${y}`,"i"),k=[{regex:a,indices:l,postModify:i},{regex:m,indices:x,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let A=0;A<k.length;A++){const D=k[A],O=D.regex.exec(e);if(O){const I=O[D.indices.bucket];let E=O[D.indices.path];E||(E=""),r=new pr(I,E),D.postModify(r);break}}if(r==null)throw m5(e);return r}}class b5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E5(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function d(...y){c||(c=!0,e.apply(null,y))}function f(y){s=setTimeout(()=>{s=null,t(m,l())},y)}function p(){i&&clearTimeout(i)}function m(y,..._){if(c){p();return}if(y){p(),d.call(null,y,..._);return}if(l()||o){p(),d.call(null,y,..._);return}r<64&&(r*=2);let k;a===1?(a=2,k=0):k=(r+Math.random())*1e3,f(k)}let x=!1;function w(y){x||(x=!0,p(),!c&&(s!==null?(y||(a=2),clearTimeout(s),f(0)):y||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,w(!0)},n),w}function k5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T5(t){return t!==void 0}function S5(t){return typeof t=="object"&&!Array.isArray(t)}function ew(t){return typeof t=="string"||t instanceof String}function cE(t){return tw()&&t instanceof Blob}function tw(){return typeof Blob<"u"}function Tv(t,e,n,r){if(r<e)throw kv(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw kv(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function IR(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Ta;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ta||(Ta={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I5(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e,n,r,s,i,o,a,l,c,d,f,p=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,w)=>{this.resolve_=x,this.reject_=w,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Sh(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Ta.NO_ERROR,l=i.getStatus();if(!a||I5(l,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Ta.ABORT;r(!1,new Sh(!1,null,d));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Sh(c,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());T5(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=Zx();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?SR():p5();o(l)}else{const l=f5();o(l)}};this.canceled_?n(!1,new Sh(!1,null,!0)):this.backoffId_=E5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&k5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function A5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function R5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function N5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function P5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function j5(t,e,n,r,s,i,o=!0,a=!1){const l=IR(t.urlParams),c=t.url+l,d=Object.assign({},t.headers);return N5(d,e),A5(d,n),R5(d,i),P5(d,r),new C5(c,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function M5(...t){const e=D5();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(tw())return new Blob(t);throw new nn(Zt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function O5(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(t){if(typeof atob>"u")throw x5("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Pg{constructor(e,n){this.data=e,this.contentType=n||null}}function F5(t,e){switch(t){case Zs.RAW:return new Pg(CR(e));case Zs.BASE64:case Zs.BASE64URL:return new Pg(AR(t,e));case Zs.DATA_URL:return new Pg(U5(e),B5(e))}throw Zx()}function CR(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function V5(t){let e;try{e=decodeURIComponent(t)}catch{throw Cu(Zs.DATA_URL,"Malformed data URL.")}return CR(e)}function AR(t,e){switch(t){case Zs.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Cu(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Zs.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Cu(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=L5(e)}catch(s){throw s.message.includes("polyfill")?s:Cu(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class RR{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Cu(Zs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=z5(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function U5(t){const e=new RR(t);return e.base64?AR(Zs.BASE64,e.rest):V5(e.rest)}function B5(t){return new RR(t).contentType}function z5(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,n){let r=0,s="";cE(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(cE(this.data_)){const r=this.data_,s=O5(r,e,n);return s===null?null:new ao(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ao(r,!0)}}static getBlob(...e){if(tw()){const n=e.map(r=>r instanceof ao?r.data_:r);return new ao(M5.apply(null,n))}else{const n=e.map(o=>ew(o)?F5(Zs.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new ao(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(t){let e;try{e=JSON.parse(t)}catch{return null}return S5(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function W5(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function NR(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H5(t,e){return e}class dr{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||H5}}let Ih=null;function q5(t){return!ew(t)||t.length<2?t:NR(t)}function PR(){if(Ih)return Ih;const t=[];t.push(new dr("bucket")),t.push(new dr("generation")),t.push(new dr("metageneration")),t.push(new dr("name","fullPath",!0));function e(i,o){return q5(o)}const n=new dr("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new dr("size");return s.xform=r,t.push(s),t.push(new dr("timeCreated")),t.push(new dr("updated")),t.push(new dr("md5Hash",null,!0)),t.push(new dr("cacheControl",null,!0)),t.push(new dr("contentDisposition",null,!0)),t.push(new dr("contentEncoding",null,!0)),t.push(new dr("contentLanguage",null,!0)),t.push(new dr("contentType",null,!0)),t.push(new dr("metadata","customMetadata",!0)),Ih=t,Ih}function G5(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new pr(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function K5(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return G5(r,t),r}function jR(t,e,n){const r=nw(e);return r===null?null:K5(t,r,n)}function Y5(t,e,n,r){const s=nw(e);if(s===null||!ew(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const d=t.bucket,f=t.fullPath,p="/b/"+o(d)+"/o/"+o(f),m=Fd(p,n,r),x=IR({alt:"media",token:c});return m+x})[0]}function Q5(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE="prefixes",dE="items";function X5(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[uE])for(const s of n[uE]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new pr(e,i));r.prefixes.push(o)}if(n[dE])for(const s of n[dE]){const i=t._makeStorageReference(new pr(e,s.name));r.items.push(i)}return r}function J5(t,e,n){const r=nw(n);return r===null?null:X5(t,e,r)}class wm{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t){if(!t)throw Zx()}function Z5(t,e){function n(r,s){const i=jR(t,s,e);return rw(i!==null),i}return n}function e6(t,e){function n(r,s){const i=J5(t,e,s);return rw(i!==null),i}return n}function t6(t,e){function n(r,s){const i=jR(t,s,e);return rw(i!==null),Y5(i,s,t.host,t._protocol)}return n}function sw(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=d5():s=u5():n.getStatus()===402?s=c5(t.bucket):n.getStatus()===403?s=h5(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function DR(t){const e=sw(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=l5(t.path)),i.serverResponse=s.serverResponse,i}return n}function n6(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=Fd(o,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,d=new wm(a,l,e6(t,e.bucket),c);return d.urlParams=i,d.errorHandler=sw(e),d}function r6(t,e,n){const r=e.fullServerUrl(),s=Fd(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new wm(s,i,t6(t,n),o);return a.errorHandler=DR(e),a}function s6(t,e){const n=e.fullServerUrl(),r=Fd(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(l,c){}const a=new wm(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=DR(e),a}function i6(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function o6(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=i6(null,e)),r}function a6(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let k="";for(let A=0;A<2;A++)k=k+Math.random().toString().slice(2);return k}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=o6(e,r,s),d=Q5(c,n),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,p=`\r
--`+l+"--",m=ao.getBlob(f,r,p);if(m===null)throw v5();const x={name:c.fullPath},w=Fd(i,t.host,t._protocol),y="POST",_=t.maxUploadRetryTime,v=new wm(w,y,Z5(t,n),_);return v.urlParams=x,v.headers=o,v.body=m.uploadData(),v.errorHandler=sw(e),v}class l6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ta.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ta.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ta.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Uc("cannot .send() more than once");if(Ko(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Uc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Uc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Uc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Uc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class c6 extends l6{initXhr(){this.xhr_.responseType="text"}}function bm(){return new c6}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,n){this._service=e,n instanceof pr?this._location=n:this._location=pr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Fa(e,n)}get root(){const e=new pr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return NR(this._location.path)}get storage(){return this._service}get parent(){const e=$5(this._location.path);if(e===null)return null;const n=new pr(this._location.bucket,e);return new Fa(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw w5(e)}}function u6(t,e,n){t._throwIfRoot("uploadBytes");const r=a6(t.storage,t._location,PR(),new ao(e,!0),n);return t.storage.makeRequestWithTokens(r,bm).then(s=>({metadata:s,ref:t}))}function d6(t){const e={prefixes:[],items:[]};return MR(t,e).then(()=>e)}async function MR(t,e,n){const s=await h6(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await MR(t,e,s.nextPageToken)}function h6(t,e){e!=null&&typeof e.maxResults=="number"&&Tv("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=n6(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,bm)}function f6(t){t._throwIfRoot("getDownloadURL");const e=r6(t.storage,t._location,PR());return t.storage.makeRequestWithTokens(e,bm).then(n=>{if(n===null)throw _5();return n})}function p6(t){t._throwIfRoot("deleteObject");const e=s6(t.storage,t._location);return t.storage.makeRequestWithTokens(e,bm)}function m6(t,e){const n=W5(t._location.path,e),r=new pr(t._location.bucket,n);return new Fa(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g6(t){return/^[A-Za-z]+:\/\//.test(t)}function y6(t,e){return new Fa(t,e)}function OR(t,e){if(t instanceof iw){const n=t;if(n._bucket==null)throw y5();const r=new Fa(n,n._bucket);return e!=null?OR(r,e):r}else return e!==void 0?m6(t,e):t}function v6(t,e){if(e&&g6(e)){if(t instanceof iw)return y6(t,e);throw kv("To use ref(service, url), the first argument must be a Storage instance.")}else return OR(t,e)}function hE(t,e){const n=e==null?void 0:e[TR];return n==null?null:pr.makeFromBucketSpec(n,t)}function _6(t,e,n,r={}){t.host=`${e}:${n}`;const s=Ko(e);s&&(Yp(`https://${t.host}`),Yo("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:GI(i,t.app.options.projectId))}class iw{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=kR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=o5,this._maxUploadRetryTime=a5,this._requests=new Set,s!=null?this._bucket=pr.makeFromBucketSpec(s,this._host):this._bucket=hE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pr.makeFromBucketSpec(this._url,e):this._bucket=hE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Tv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Tv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fa(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new b5(SR());{const o=j5(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const fE="@firebase/storage",pE="0.13.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR="storage";function ow(t,e,n){return t=Fe(t),u6(t,e,n)}function x6(t){return t=Fe(t),d6(t)}function aw(t){return t=Fe(t),f6(t)}function Sv(t){return t=Fe(t),p6(t)}function nc(t,e){return t=Fe(t),v6(t,e)}function Em(t=Td(),e){t=Fe(t),Yo("Storage",!1);const r=Qo(t,LR).getImmediate({identifier:e}),s=$_("storage");return s&&w6(r,...s),r}function w6(t,e,n,r={}){_6(t,e,n,r)}function b6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new iw(n,r,s,e,qa)}function E6(){fs(new es(LR,b6,"PUBLIC").setMultipleInstances(!0)),sr(fE,pE,""),sr(fE,pE,"esm2017")}E6();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k6="type.googleapis.com/google.protobuf.Int64Value",T6="type.googleapis.com/google.protobuf.UInt64Value";function FR(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function pp(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>pp(e));if(typeof t=="function"||typeof t=="object")return FR(t,e=>pp(e));throw new Error("Data cannot be encoded in JSON: "+t)}function rc(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case k6:case T6:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>rc(e)):typeof t=="function"||typeof t=="object"?FR(t,e=>rc(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Mr extends ys{constructor(e,n,r){super(`${lw}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Mr.prototype)}}function S6(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function mp(t,e){let n=S6(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!mE[o])return new Mr("internal","internal");n=mE[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=rc(s))}}catch{}return n==="ok"?null:new Mr(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,nr(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="us-central1",C6=/^data: (.*?)(?:\n|$)/;function A6(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Mr("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class R6{constructor(e,n,r,s,i=Iv,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new I6(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=Iv}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function N6(t,e,n){const r=Ko(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(Yp(t.emulatorOrigin),Yo("Functions",!0))}function P6(t,e,n){const r=s=>D6(t,e,s,{});return r.stream=(s,i)=>O6(t,e,s,i),r}async function j6(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function VR(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function D6(t,e,n,r){const s=t._url(e);return M6(t,s,n,r)}async function M6(t,e,n,r){n=pp(n);const s={data:n},i=await VR(t,r),o=r.timeout||7e4,a=A6(o),l=await Promise.race([j6(e,s,i,t.fetchImpl),a.promise,t.cancelAllRequests]);if(a.cancel(),!l)throw new Mr("cancelled","Firebase Functions instance was deleted.");const c=mp(l.status,l.json);if(c)throw c;if(!l.json)throw new Mr("internal","Response is not valid JSON object.");let d=l.json.data;if(typeof d>"u"&&(d=l.json.result),typeof d>"u")throw new Mr("internal","Response is missing data field.");return{data:rc(d)}}function O6(t,e,n,r){const s=t._url(e);return L6(t,s,n,r||{})}async function L6(t,e,n,r){var s;n=pp(n);const i={data:n},o=await VR(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let a;try{a=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const w=new Mr("cancelled","Request was cancelled.");return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}const x=mp(0,null);return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}let l,c;const d=new Promise((m,x)=>{l=m,c=x});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new Mr("cancelled","Request was cancelled.");c(m)});const f=a.body.getReader(),p=F6(f,l,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=p.getReader();return{async next(){const{value:x,done:w}=await m.read();return{value:x,done:w}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function F6(t,e,n,r){const s=(o,a)=>{const l=o.match(C6);if(!l)return;const c=l[1];try{const d=JSON.parse(c);if("result"in d){e(rc(d.result));return}if("message"in d){a.enqueue(rc(d.message));return}if("error"in d){const f=mp(0,d);a.error(f),n(f);return}}catch(d){if(d instanceof Mr){a.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return l();async function l(){if(r!=null&&r.aborted){const c=new Mr("cancelled","Request was cancelled");return o.error(c),n(c),Promise.resolve()}try{const{value:c,done:d}=await t.read();if(d){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const p=new Mr("cancelled","Request was cancelled");o.error(p),n(p),await t.cancel();return}a+=i.decode(c,{stream:!0});const f=a.split(`
`);a=f.pop()||"";for(const p of f)p.trim()&&s(p.trim(),o);return l()}catch(c){const d=c instanceof Mr?c:mp(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const gE="@firebase/functions",yE="0.12.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V6="auth-internal",U6="app-check-internal",B6="messaging-internal";function z6(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(V6),o=n.getProvider(B6),a=n.getProvider(U6);return new R6(s,i,o,a,r)};fs(new es(lw,e,"PUBLIC").setMultipleInstances(!0)),sr(gE,yE,t),sr(gE,yE,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $6(t=Td(),e=Iv){Yo("Functions",!1);const r=Qo(Fe(t),lw).getImmediate({identifier:e}),s=$_("functions");return s&&W6(r,...s),r}function W6(t,e,n){N6(Fe(t),e,n)}function H6(t,e,n){return P6(Fe(t),e)}z6();const UR="@firebase/installations",cw="0.6.16";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR=1e4,zR=`w:${cw}`,$R="FIS_v2",q6="https://firebaseinstallations.googleapis.com/v1",G6=60*60*1e3,K6="installations",Y6="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Va=new Ha(K6,Y6,Q6);function WR(t){return t instanceof ys&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR({projectId:t}){return`${q6}/projects/${t}/installations`}function qR(t){return{token:t.token,requestStatus:2,expiresIn:J6(t.expiresIn),creationTime:Date.now()}}async function GR(t,e){const r=(await e.json()).error;return Va.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function KR({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function X6(t,{refreshToken:e}){const n=KR(t);return n.append("Authorization",Z6(e)),n}async function YR(t){const e=await t();return e.status>=500&&e.status<600?t():e}function J6(t){return Number(t.replace("s","000"))}function Z6(t){return`${$R} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eB({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=HR(t),s=KR(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:$R,appId:t.appId,sdkVersion:zR},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await YR(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:qR(c.authToken)}}else throw await GR("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tB(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nB=/^[cdef][\w-]{21}$/,Cv="";function rB(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=sB(t);return nB.test(n)?n:Cv}catch{return Cv}}function sB(t){return tB(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=new Map;function JR(t,e){const n=km(t);ZR(n,e),iB(n,e)}function ZR(t,e){const n=XR.get(t);if(n)for(const r of n)r(e)}function iB(t,e){const n=oB();n&&n.postMessage({key:t,fid:e}),aB()}let _a=null;function oB(){return!_a&&"BroadcastChannel"in self&&(_a=new BroadcastChannel("[Firebase] FID Change"),_a.onmessage=t=>{ZR(t.data.key,t.data.fid)}),_a}function aB(){XR.size===0&&_a&&(_a.close(),_a=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lB="firebase-installations-database",cB=1,Ua="firebase-installations-store";let jg=null;function uw(){return jg||(jg=Qp(lB,cB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ua)}}})),jg}async function gp(t,e){const n=km(t),s=(await uw()).transaction(Ua,"readwrite"),i=s.objectStore(Ua),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&JR(t,e.fid),e}async function eN(t){const e=km(t),r=(await uw()).transaction(Ua,"readwrite");await r.objectStore(Ua).delete(e),await r.done}async function Tm(t,e){const n=km(t),s=(await uw()).transaction(Ua,"readwrite"),i=s.objectStore(Ua),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&JR(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dw(t){let e;const n=await Tm(t.appConfig,r=>{const s=uB(r),i=dB(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Cv?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function uB(t){const e=t||{fid:rB(),registrationStatus:0};return tN(e)}function dB(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Va.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=hB(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:fB(t)}:{installationEntry:e}}async function hB(t,e){try{const n=await eB(t,e);return gp(t.appConfig,n)}catch(n){throw WR(n)&&n.customData.serverCode===409?await eN(t.appConfig):await gp(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function fB(t){let e=await vE(t.appConfig);for(;e.registrationStatus===1;)await QR(100),e=await vE(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await dw(t);return r||n}return e}function vE(t){return Tm(t,e=>{if(!e)throw Va.create("installation-not-found");return tN(e)})}function tN(t){return pB(t)?{fid:t.fid,registrationStatus:0}:t}function pB(t){return t.registrationStatus===1&&t.registrationTime+BR<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mB({appConfig:t,heartbeatServiceProvider:e},n){const r=gB(t,n),s=X6(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:zR,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await YR(()=>fetch(r,a));if(l.ok){const c=await l.json();return qR(c)}else throw await GR("Generate Auth Token",l)}function gB(t,{fid:e}){return`${HR(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hw(t,e=!1){let n;const r=await Tm(t.appConfig,i=>{if(!nN(i))throw Va.create("not-registered");const o=i.authToken;if(!e&&_B(o))return i;if(o.requestStatus===1)return n=yB(t,e),i;{if(!navigator.onLine)throw Va.create("app-offline");const a=wB(i);return n=vB(t,a),a}});return n?await n:r.authToken}async function yB(t,e){let n=await _E(t.appConfig);for(;n.authToken.requestStatus===1;)await QR(100),n=await _E(t.appConfig);const r=n.authToken;return r.requestStatus===0?hw(t,e):r}function _E(t){return Tm(t,e=>{if(!nN(e))throw Va.create("not-registered");const n=e.authToken;return bB(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function vB(t,e){try{const n=await mB(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await gp(t.appConfig,r),n}catch(n){if(WR(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await eN(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await gp(t.appConfig,r)}throw n}}function nN(t){return t!==void 0&&t.registrationStatus===2}function _B(t){return t.requestStatus===2&&!xB(t)}function xB(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+G6}function wB(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function bB(t){return t.requestStatus===1&&t.requestTime+BR<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EB(t){const e=t,{installationEntry:n,registrationPromise:r}=await dw(e);return r?r.catch(console.error):hw(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kB(t,e=!1){const n=t;return await TB(n),(await hw(n,e)).token}async function TB(t){const{registrationPromise:e}=await dw(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SB(t){if(!t||!t.options)throw Dg("App Configuration");if(!t.name)throw Dg("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Dg(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Dg(t){return Va.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="installations",IB="installations-internal",CB=t=>{const e=t.getProvider("app").getImmediate(),n=SB(e),r=Qo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},AB=t=>{const e=t.getProvider("app").getImmediate(),n=Qo(e,rN).getImmediate();return{getId:()=>EB(n),getToken:s=>kB(n,s)}};function RB(){fs(new es(rN,CB,"PUBLIC")),fs(new es(IB,AB,"PRIVATE"))}RB();sr(UR,cw);sr(UR,cw,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NB="/firebase-messaging-sw.js",PB="/firebase-cloud-messaging-push-scope",sN="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",jB="https://fcmregistrations.googleapis.com/v1",iN="google.c.a.c_id",DB="google.c.a.c_l",MB="google.c.a.ts",OB="google.c.a.e",xE=1e4;var wE;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(wE||(wE={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var fd;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(fd||(fd={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function LB(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="fcm_token_details_db",FB=5,bE="fcm_token_object_Store";async function VB(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Mg))return null;let e=null;return(await Qp(Mg,FB,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(bE))return;const l=o.objectStore(bE),c=await l.index("fcmSenderId").get(t);if(await l.clear(),!!c){if(s===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:(a=d.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Ti(d.vapidKey)}}}else if(s===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ti(d.auth),p256dh:Ti(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ti(d.vapidKey)}}}else if(s===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ti(d.auth),p256dh:Ti(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ti(d.vapidKey)}}}}}})).close(),await vg(Mg),await vg("fcm_vapid_details_db"),await vg("undefined"),UB(e)?e:null}function UB(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BB="firebase-messaging-database",zB=1,pd="firebase-messaging-store";let Og=null;function oN(){return Og||(Og=Qp(BB,zB,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(pd)}}})),Og}async function $B(t){const e=aN(t),r=await(await oN()).transaction(pd).objectStore(pd).get(e);if(r)return r;{const s=await VB(t.appConfig.senderId);if(s)return await fw(t,s),s}}async function fw(t,e){const n=aN(t),s=(await oN()).transaction(pd,"readwrite");return await s.objectStore(pd).put(e,n),await s.done,e}function aN({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},or=new Ha("messaging","Messaging",WB);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HB(t,e){const n=await mw(t),r=lN(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(pw(t.appConfig),s)).json()}catch(o){throw or.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw or.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw or.create("token-subscribe-no-token");return i.token}async function qB(t,e){const n=await mw(t),r=lN(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${pw(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw or.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw or.create("token-update-failed",{errorInfo:o})}if(!i.token)throw or.create("token-update-no-token");return i.token}async function GB(t,e){const r={method:"DELETE",headers:await mw(t)};try{const i=await(await fetch(`${pw(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw or.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw or.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function pw({projectId:t}){return`${jB}/projects/${t}/registrations`}async function mw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function lN({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==sN&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KB=7*24*60*60*1e3;async function YB(t){const e=await XB(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Ti(e.getKey("auth")),p256dh:Ti(e.getKey("p256dh"))},r=await $B(t.firebaseDependencies);if(r){if(JB(r.subscriptionOptions,n))return Date.now()>=r.createTime+KB?QB(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await GB(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return EE(t.firebaseDependencies,n)}else return EE(t.firebaseDependencies,n)}async function QB(t,e){try{const n=await qB(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await fw(t.firebaseDependencies,r),n}catch(n){throw n}}async function EE(t,e){const r={token:await HB(t,e),createTime:Date.now(),subscriptionOptions:e};return await fw(t,r),r.token}async function XB(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:LB(e)})}function JB(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return ZB(e,t),e9(e,t),t9(e,t),e}function ZB(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function e9(t,e){e.data&&(t.data=e.data)}function t9(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const l=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;l&&(t.fcmOptions.analyticsLabel=l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(t){return typeof t=="object"&&!!t&&iN in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r9(t){if(!t||!t.options)throw Lg("App Configuration Object");if(!t.name)throw Lg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Lg(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Lg(t){return or.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=r9(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i9(t){try{t.swRegistration=await navigator.serviceWorker.register(NB,{scope:PB}),t.swRegistration.update().catch(()=>{}),await o9(t.swRegistration)}catch(e){throw or.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function o9(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${xE} ms`)),xE),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)===null||o===void 0?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a9(t,e){if(!e&&!t.swRegistration&&await i9(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw or.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l9(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=sN)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cN(t,e){if(!navigator)throw or.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw or.create("permission-blocked");return await l9(t,e==null?void 0:e.vapidKey),await a9(t,e==null?void 0:e.serviceWorkerRegistration),YB(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c9(t,e,n){const r=u9(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[iN],message_name:n[DB],message_time:n[MB],message_device_time:Math.floor(Date.now()/1e3)})}function u9(t){switch(t){case fd.NOTIFICATION_CLICKED:return"notification_open";case fd.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d9(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===fd.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(kE(n)):t.onMessageHandler.next(kE(n)));const r=n.data;n9(r)&&r[OB]==="1"&&await c9(t,n.messageType,r)}const TE="@firebase/messaging",SE="0.12.20";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9=t=>{const e=new s9(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>d9(e,n)),e},f9=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>cN(e,r)}};function p9(){fs(new es("messaging",h9,"PUBLIC")),fs(new es("messaging-internal",f9,"PRIVATE")),sr(TE,SE),sr(TE,SE,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m9(){try{await YI()}catch{return!1}return typeof window<"u"&&KI()&&qM()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g9(t,e){if(!navigator)throw or.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y9(t=Td()){return m9().then(e=>{if(!e)throw or.create("unsupported-browser")},e=>{throw or.create("indexed-db-unsupported")}),Qo(Fe(t),"messaging").getImmediate()}async function v9(t,e){return t=Fe(t),cN(t,e)}function _9(t,e){return t=Fe(t),g9(t,e)}p9();const x9={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},w9=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID","VITE_FIREBASE_VAPID_KEY"],IE=w9.filter(t=>!x9[t]);if(IE.length){const t=`Missing Firebase environment variables: ${IE.join(", ")}`;throw console.warn(t),new Error(t)}const b9={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},ea=JI(b9),Me=BV(ea),H=$3(ea),Av=Em(ea),E9=$6(ea),CE=y9(ea),AE=(t,e)=>e||null,RE=t=>!t||/^data:/i.test(t)?null:t,NE=t=>/^https?:\/\//i.test(t||""),Zn=({pngUrl:t,webpUrl:e,alt:n="",loading:r="lazy",cacheKey:s,...i})=>{const o=AE(s,t),a=e||(t?t.replace(/\.png$/,".webp"):void 0),l=a?AE(`${s||a}-webp`,a):null,c=RE(NE(o)?o:t),d=RE(NE(l)?l:null);return d?u.jsxs("picture",{children:[u.jsx("source",{srcSet:d,type:"image/webp"}),u.jsx("img",{src:c,alt:n,loading:r,decoding:"async",...i})]}):u.jsx("img",{src:c,alt:n,loading:r,decoding:"async",...i})};function sc(...t){}const k9=({onLogin:t})=>{const[e,n]=T.useState(""),[r,s]=T.useState(""),[i,o]=T.useState(""),[a,l]=T.useState(null),[c,d]=T.useState(""),[f,p]=T.useState(""),m=async w=>{w.preventDefault(),o("");try{await hF(Me,e,r),sc("Sign-in successful"),t&&t()}catch(y){if(y.code==="auth/multi-factor-auth-required")try{const _=_F(Me,y),v={multiFactorHint:_.hints[0],session:_.session},k=new BC(Me,"recaptcha-container",{size:"invisible"}),D=await new ni(Me).verifyPhoneNumber(v,k);d(D),l(_)}catch(_){o(_.message)}else o(y.message)}},x=async w=>{if(w.preventDefault(),!!a){o("");try{const y=ni.credential(c,f),_=lx.assertion(y);await a.resolveSignIn(_),sc("MFA sign-in successful"),t&&t()}catch(y){o(y.message)}}};return u.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen bg-gray-100 dark:bg-[var(--dark-bg)]",children:[u.jsx("div",{className:"mb-4 text-xl font-semibold",children:"CAMPFIRE"}),a?u.jsxs("form",{onSubmit:x,className:"bg-white dark:bg-[var(--dark-sidebar-bg)] p-6 rounded shadow-md w-80",children:[u.jsx("h1",{className:"text-2xl mb-4 text-center",children:"Verify Code"}),u.jsx("label",{className:"block mb-2 text-sm font-medium",children:"SMS Code"}),u.jsx("input",{type:"text",value:f,onChange:w=>p(w.target.value),className:"w-full p-2 border rounded mb-4",required:!0}),i&&u.jsx("p",{className:"text-red-500 text-sm mb-2",children:i}),u.jsx("button",{type:"submit",className:"w-full btn-primary",children:"Verify"})]}):u.jsxs("form",{onSubmit:m,className:"bg-white dark:bg-[var(--dark-sidebar-bg)] p-6 rounded shadow-md w-80",children:[u.jsx("h1",{className:"text-2xl mb-4 text-center",children:"Login"}),u.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Email"}),u.jsx("input",{type:"email",value:e,onChange:w=>n(w.target.value),className:"w-full p-2 border rounded mb-4",required:!0}),u.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Password"}),u.jsx("input",{type:"password",value:r,onChange:w=>s(w.target.value),className:"w-full p-2 border rounded mb-4",required:!0}),i&&u.jsx("p",{className:"text-red-500 text-sm mb-2",children:i}),u.jsx("button",{type:"submit",className:"w-full btn-primary",children:"Sign In"}),u.jsx("div",{id:"recaptcha-container"})]})]})},ic=getComputedStyle(document.documentElement).getPropertyValue("--accent-color").trim()||"#ea580c";var uN={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},PE=Rn.createContext&&Rn.createContext(uN),Ro=function(){return Ro=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Ro.apply(this,arguments)},T9=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};function dN(t){return t&&t.map(function(e,n){return Rn.createElement(e.tag,Ro({key:n},e.attr),dN(e.child))})}function Ze(t){return function(e){return Rn.createElement(S9,Ro({attr:Ro({},t.attr)},e),dN(t.child))}}function S9(t){var e=function(n){var r=t.attr,s=t.size,i=t.title,o=T9(t,["attr","size","title"]),a=s||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),Rn.createElement("svg",Ro({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,o,{className:l,style:Ro(Ro({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&Rn.createElement("title",null,i),t.children)};return PE!==void 0?Rn.createElement(PE.Consumer,null,function(n){return e(n)}):e(uN)}function I9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"}}]})(t)}function hN(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"21 8 21 21 3 21 3 8"}},{tag:"rect",attr:{x:"1",y:"3",width:"22",height:"5"}},{tag:"line",attr:{x1:"10",y1:"12",x2:"14",y2:"12"}}]})(t)}function jE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"}}]})(t)}function yp(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"}}]})(t)}function DE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 11 12 14 22 4"}},{tag:"path",attr:{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"}}]})(t)}function ME(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"polyline",attr:{points:"12 6 12 12 16 14"}}]})(t)}function C9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(t)}function Vd(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}}]})(t)}function Rv(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(t)}function Ud(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(t)}function A9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}},{tag:"polyline",attr:{points:"14 2 14 8 20 8"}},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"}},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"}},{tag:"polyline",attr:{points:"10 9 9 9 8 9"}}]})(t)}function OE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"}},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"}}]})(t)}function R9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"}},{tag:"polyline",attr:{points:"21 15 16 10 5 21"}}]})(t)}function LE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"}},{tag:"polyline",attr:{points:"2 17 12 22 22 17"}},{tag:"polyline",attr:{points:"2 12 12 17 22 12"}}]})(t)}function fN(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}},{tag:"path",attr:{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"}}]})(t)}function N9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"8",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"8",y1:"18",x2:"21",y2:"18"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"3.01",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"12",x2:"3.01",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"3.01",y2:"18"}}]})(t)}function P9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"}}]})(t)}function FE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}},{tag:"polyline",attr:{points:"16 17 21 12 16 7"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"}}]})(t)}function j9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}}]})(t)}function D9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"}},{tag:"polyline",attr:{points:"1 20 1 14 7 14"}},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}}]})(t)}function pN(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"1 4 1 10 7 10"}},{tag:"path",attr:{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"}}]})(t)}function M9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"}},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"}},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"}}]})(t)}function O9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}}]})(t)}function L9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"}},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"}},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"}},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}}]})(t)}function VE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"}}]})(t)}function UE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"}}]})(t)}function Ms(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}}]})(t)}function F9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 9.9-1"}}]})(t)}function BE(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"17 8 12 3 7 8"}},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"}}]})(t)}function V9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"23 7 16 12 23 17 23 7"}},{tag:"rect",attr:{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"}}]})(t)}function U9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(t)}function B9(t){return Ze({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}}]})(t)}const vp=({messages:t})=>!t||t.length===0?null:u.jsx("ul",{className:"text-red-500 text-sm space-y-1","data-testid":"error-list",children:t.map((e,n)=>u.jsxs("li",{className:"flex items-center",children:[u.jsx(I9,{className:"mr-1"}),u.jsx("span",{children:e})]},n))}),z9=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,$9=()=>{const[t,e]=T.useState(1),[n,r]=T.useState("agency"),[s,i]=T.useState(""),[o,a]=T.useState(""),[l,c]=T.useState(""),[d,f]=T.useState(""),[p,m]=T.useState([]),[x,w]=T.useState(!1),y=hi(),_=k=>{if(k.preventDefault(),!s.trim()){m(["Company name is required"]);return}m([]),e(2)},v=async k=>{k.preventDefault();const A=[];if(o.trim()||A.push("Full name is required"),z9.test(l)||A.push("Valid email is required"),d||A.push("Password is required"),A.length){m(A);return}m([]),w(!0);try{const D=await tx(Me,l,d);let O;n==="agency"&&(O=(await Vr(be(H,"agencies"),{name:s.trim(),themeColor:ic,logoUrl:""})).id),await li(oe(H,"users",D.user.uid),{role:n,companyName:s.trim(),fullName:o.trim(),email:l.trim(),...O?{agencyId:O}:{}}),await Zp(D.user),y("/mfa-settings")}catch(D){const O=((D==null?void 0:D.message)||"").replace("Firebase:","").replace(/\(auth.*\)/,"").trim();m([O])}finally{w(!1)}};return u.jsx("div",{className:"flex justify-center p-4",children:u.jsxs("div",{className:"w-80",children:[t===1&&u.jsxs("form",{onSubmit:_,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Business Type"}),u.jsxs("select",{value:n,onChange:k=>r(k.target.value),className:"w-full p-2 border rounded",children:[u.jsx("option",{value:"agency",children:"Agency"}),u.jsx("option",{value:"client",children:"Brand"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Company Name"}),u.jsx("input",{type:"text",value:s,onChange:k=>i(k.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsx(vp,{messages:p}),u.jsx("button",{type:"submit",className:"w-full btn-primary",children:"Next"})]}),t===2&&u.jsxs("form",{onSubmit:v,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Full Name"}),u.jsx("input",{type:"text",value:o,onChange:k=>a(k.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Email"}),u.jsx("input",{type:"email",value:l,onChange:k=>c(k.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Password"}),u.jsx("input",{type:"password",value:d,onChange:k=>f(k.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsx(vp,{messages:p}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:x,children:x?"Creating...":"Create Account"})]})]})})},W9=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,H9=()=>{const[t,e]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState(!1),[l,c]=T.useState([]),d=hi(),f=async p=>{p.preventDefault(),c([]);const m=[];if(t.trim()||m.push("Full name is required"),W9.test(n)||m.push("Valid email is required"),s||m.push("Password is required"),m.length){c(m);return}a(!0);try{const x=await tx(Me,n,s);await li(oe(H,"users",x.user.uid),{role:"designer",fullName:t.trim(),email:n.trim()}),await Zp(x.user),d("/mfa-settings")}catch(x){const w=((x==null?void 0:x.message)||"").replace("Firebase:","").replace(/\(auth.*\)/,"").trim();c([w])}finally{a(!1)}};return u.jsx("div",{className:"min-h-screen p-4 flex justify-center",children:u.jsxs("form",{onSubmit:f,className:"space-y-4 w-80",children:[u.jsx("h1",{className:"text-2xl mb-2 text-center",children:"Designer Sign Up"}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Full Name"}),u.jsx("input",{type:"text",value:t,onChange:p=>e(p.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Email"}),u.jsx("input",{type:"email",value:n,onChange:p=>r(p.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Password"}),u.jsx("input",{type:"password",value:s,onChange:p=>i(p.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsx(vp,{messages:l}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:o,children:o?"Creating...":"Create Account"})]})})},Bd=({visible:t=!0,text:e="Loading...",className:n=""})=>t?u.jsx("div",{className:`loading-overlay ${n}`.trim(),"data-testid":"loading-overlay",children:u.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[u.jsx("div",{className:"loading-ring"}),e&&u.jsx("div",{children:e})]})}):null,Qa=t=>{const[e,n]=T.useState(null),[r,s]=T.useState([]),[i,o]=T.useState(null),[a,l]=T.useState(!0);return T.useEffect(()=>{if(!t){n(null),s([]),o(null),l(!1);return}l(!0);const c=oe(H,"users",t),d=fp(c,f=>{if(sc("Role snapshot:",f.data()),f.exists()){const p=f.data();n(p.role||null);const m=Array.isArray(p.brandCodes)?p.brandCodes:[];s(m),o(p.agencyId||null)}else n(null),s([]),o(null);l(!1)},f=>{console.error("Failed to fetch user role",f),n(null),s([]),o(null),l(!1)});return()=>{d()}},[t]),T.useEffect(()=>{if(i||r.length===0)return;let c=!1;return(async()=>{try{const f=un(be(H,"brands"),Nt("code","in",r),Ev(1)),p=await Le(f);!c&&!p.empty&&o(p.docs[0].data().agencyId||null)}catch(f){console.error("Failed to fetch brand agency",f)}})(),()=>{c=!0}},[r,i]),{role:e,brandCodes:r,agencyId:i,loading:a}},q9=(t,e=1)=>{let n=t.replace("#","");n.length===3&&(n=n.split("").map(a=>a+a).join(""));const r=parseInt(n,16),s=r>>16&255,i=r>>8&255,o=r&255;return`rgba(${s}, ${i}, ${o}, ${e})`},Sa=t=>{document.documentElement.style.setProperty("--accent-color",t),document.documentElement.style.setProperty("--accent-color-10",q9(t,.1))},$s={logoUrl:"",themeColor:ic},G9=t=>{if(!t)return null;try{const e=localStorage.getItem(`agencyTheme-${t}`);return e?JSON.parse(e):null}catch{return null}},zd=t=>{const[e,n]=T.useState(()=>{if(!t)return $s;const o=G9(t),a=o?{...$s,...o}:$s,l=a.themeColor||$s.themeColor;return Sa(l),a}),[r,s]=T.useState(!0);return T.useEffect(()=>{(async()=>{if(!t){n($s),s(!1);return}try{const a=await Qr(oe(H,"agencies",t));if(a.exists()){const l=a.data(),c={...$s,...l};n(c);const d=l.themeColor||$s.themeColor;Sa(d),localStorage.setItem(`agencyTheme-${t}`,JSON.stringify({logoUrl:c.logoUrl,themeColor:d}))}else n($s),localStorage.removeItem(`agencyTheme-${t}`)}catch(a){console.error("Failed to fetch agency",a),n($s),t&&localStorage.removeItem(`agencyTheme-${t}`)}finally{s(!1)}})()},[t]),{agency:e,loading:r,saveAgency:async o=>{t&&(await li(oe(H,"agencies",t),o,{merge:!0}),n(a=>{const l={...a,...o},c=l.themeColor||$s.themeColor;return Sa(c),localStorage.setItem(`agencyTheme-${t}`,JSON.stringify({logoUrl:l.logoUrl,themeColor:c})),l}))}}},fr="https://firebasestorage.googleapis.com/v0/b/tak-campfire-main/o/StudioTak%2Flogo_new.webp?alt=media&token=1f08d552-6c85-444d-ac4f-1e895e97e5bd";function Qt(t){if(!t)return{};const n=t.replace(/\.[^/.]+$/,"").split("_");if(n.length<5)return{brandCode:n[0]||"",adGroupCode:n[1]||"",recipeCode:n[2]||"",aspectRatio:n[3]||"",version:void 0};const[r,s,i,o,a]=n,l=/^V(\d+)/i.exec(a);return{brandCode:r,adGroupCode:s,recipeCode:i,aspectRatio:o,version:l?parseInt(l[1],10):void 0}}function Nv(t=[],e="pending"){return e==="archived"?"archived":e==="in review"?"in review":t.some(n=>n.status==="ready")?"ready":t.length>0&&t.every(n=>n.status!=="ready"&&n.status!=="pending")?"reviewed":e==="review pending"?"review pending":"pending"}function K9(t,e){const n=T.useRef(!1),r=T.useRef(e);T.useEffect(()=>(n.current=!0,()=>{}),[]),T.useEffect(()=>{if(!n.current)return;const s={};Object.keys(e).forEach(i=>{r.current[i]!==e[i]&&(s[i]={previous:r.current[i],current:e[i]})}),Object.keys(s).length>0,r.current=e})}const Fg=typeof navigator<"u"&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent),zE=3,Y9=({user:t,userRole:e=null,brandCodes:n=[],groupId:r=null,reviewerName:s="",agencyId:i=null,forceSplash:o=!1})=>{var Vs;const[a,l]=T.useState([]),[c,d]=T.useState([]),[f,p]=T.useState(0),[m,x]=T.useState(""),[w,y]=T.useState(!1),[_,v]=T.useState(""),[k,A]=T.useState(!1),[D,O]=T.useState(0),[I,E]=T.useState(!1),[S,C]=T.useState(!1),[N,j]=T.useState(!1),[P,ne]=T.useState(!0),[ae,F]=T.useState(!1),[W,V]=T.useState(!1),[G,re]=T.useState(!1),[_e,ke]=T.useState({}),[Ie,Oe]=T.useState(!1),[Dt,ht]=T.useState([]),[wt,Dn]=T.useState(null),[Os,Mn]=T.useState("current"),[Ur,_s]=T.useState(!1),[xr,cr]=T.useState(!1),[dn,pi]=T.useState(!1),[Ce,mi]=T.useState(null),[ss,wr]=T.useState(0),[vn,gi]=T.useState(!1),[Ls,Br]=T.useState(!1),br=T.useRef([]),bt=T.useRef(0),Mt=T.useRef(0),Er=T.useRef(0),B=T.useRef(0),ee=T.useRef(!1),ie=T.useRef(null),de=T.useRef(null),[we,Ve]=T.useState(null),[ge,Ot]=T.useState(null),[_n,kr]=T.useState(null),[Tr,xs]=T.useState(!1),{agency:rt}=zd(i);K9("Review",{groupId:r,agencyId:i,brandCodesLength:n.length,currentIndex:f,reviewAdsLength:c.length,animating:Ce,loading:P}),T.useEffect(()=>()=>{if(i&&["admin","designer"].includes(e)){const Z=localStorage.getItem("accentColor")||ic;Sa(Z)}},[i,e]);const ur=hi(),[zr,Sn]=T.useState(!1),[M,$]=T.useState(!1),[L,K]=T.useState(typeof window<"u"?window.innerWidth<=640:!1);T.useEffect(()=>{const Z=()=>{K(window.innerWidth<=640)};return window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z)},[]),T.useEffect(()=>{Br(!0);const Z=setTimeout(()=>Br(!1),200);return()=>clearTimeout(Z)},[]),T.useEffect(()=>{if(!r)return;const Z=fp(oe(H,"adGroups",r),ye=>{if(!ye.exists())return;const fe=ye.data();Ve(fe.status||"pending"),Ot(fe.lockedBy||null),kr(fe.lockedByUid||null)});return()=>Z()},[r]),T.useEffect(()=>{if(!r||!s||c.length===0||o)return;const Z=async()=>{try{const fe=oe(H,"adGroups",r),De=await Qr(fe),he=De.exists()?De.data():{};if(he.status==="in review"&&(he.lockedByUid&&he.lockedByUid!==t.uid||!he.lockedByUid&&he.lockedBy&&he.lockedBy!==s))throw Ve(he.status),Ot(he.lockedBy),kr(he.lockedByUid||null),new Error("locked");await nt(fe,{status:"in review",lockedBy:s,lockedByUid:t.uid,reviewProgress:f}),Ve("in review"),Ot(s),kr(t.uid)}catch(fe){fe.code==="permission-denied"?(window.alert("Unable to acquire lock for this group. You may not have permission."),xs(!0)):fe.message!=="locked"&&console.error("Failed to lock group",fe)}};!Tr&&(we!=="in review"||(_n?_n!==t.uid:ge!==s))&&Z()},[r,s,c.length,f,we,_n,ge,o,t,Tr]),T.useEffect(()=>{!r||o||we!=="in review"||!(_n?_n===(t==null?void 0:t.uid):ge===s)||nt(oe(H,"adGroups",r),{reviewProgress:f}).catch(ye=>console.error("Failed to save progress",ye))},[f]),T.useEffect(()=>{!r||o||f>=c.length&&c.length>0&&nt(oe(H,"adGroups",r),{status:"reviewed",lockedBy:null,lockedByUid:null,reviewProgress:null}).catch(Z=>console.error("Failed to update status",Z))},[f,c.length,r,o]),T.useEffect(()=>()=>{if(!r||o)return;const Z=_n?_n===(t==null?void 0:t.uid):ge===s;f>=c.length?nt(oe(H,"adGroups",r),{status:"reviewed",lockedBy:null,lockedByUid:null,reviewProgress:null}).catch(()=>{}):Z&&nt(oe(H,"adGroups",r),{status:"review pending",lockedBy:s,lockedByUid:t==null?void 0:t.uid,reviewProgress:f}).catch(()=>{})},[r,f,c.length,_n,ge,s,o,t]);const Q=T.useMemo(()=>{const Z={};a.forEach(fe=>{const De=Qt(fe.filename||""),he=fe.recipeCode||De.recipeCode||"unknown",gt=fe.aspectRatio||De.aspectRatio||"",$r={...fe,recipeCode:he,aspectRatio:gt};Z[he]||(Z[he]=[]),Z[he].push($r)});const ye={"9x16":0,"3x5":1,"1x1":2};return Object.entries(Z).map(([fe,De])=>(De.sort((he,gt)=>(ye[he.aspectRatio]??99)-(ye[gt.aspectRatio]??99)),{recipeCode:fe,assets:De}))},[a]);T.useEffect(()=>{Oe(!1)},[f]),T.useEffect(()=>{Br(!0);const Z=setTimeout(()=>Br(!1),200);return()=>clearTimeout(Z)},[f]),T.useEffect(()=>{pi(!1)},[f]),T.useEffect(()=>{const Z=async()=>{var ye;try{let fe=[],De=0;if(r){const Te=await Qr(oe(H,"adGroups",r));if(Te.exists()){const xe=Te.data();typeof xe.reviewProgress=="number"&&(De=xe.reviewProgress),fe=(await Le(be(H,"adGroups",r,"assets"))).docs.map($t=>({...$t.data(),assetId:$t.id,adGroupId:r,groupName:Te.data().name,firebaseUrl:$t.data().firebaseUrl,...Te.data().brandCode?{brandCode:Te.data().brandCode}:{}}))}}else{const Te=un(yf(H,"assets"),Nt("brandCode","in",n),Nt("status","==","ready"),Nt("isResolved","==",!1)),xe=await Le(Te),Tt={};fe=await Promise.all(xe.docs.map(async $t=>{const is=$t.data(),Bs=is.adGroupId||$t.ref.parent.parent.id;if(!Tt[Bs]){const na=await Qr(oe(H,"adGroups",Bs));Tt[Bs]=na.exists()?na.data().name:""}return{...is,assetId:$t.id,adGroupId:Bs,groupName:Tt[Bs],firebaseUrl:is.firebaseUrl}}))}const he={"9x16":0,"3x5":1,"1x1":2};fe.sort((Te,xe)=>{const Tt=Qt(Te.filename||""),$t=Qt(xe.filename||""),is=Te.recipeCode||Tt.recipeCode||"",Bs=xe.recipeCode||$t.recipeCode||"";if(is<Bs)return-1;if(is>Bs)return 1;const na=Te.aspectRatio||Tt.aspectRatio||"",Om=xe.aspectRatio||$t.aspectRatio||"";return(he[na]??99)-(he[Om]??99)});const gt={};fe.forEach(Te=>{const xe=Te.parentAdId||Te.assetId;(!gt[xe]||(gt[xe].version||1)<(Te.version||1))&&(gt[xe]=Te)});const $r=Object.values(gt),qn=$r.some(Te=>Te.status==="pending"),Ue=$r.filter(Te=>Te.status!=="pending"),zt=fe.filter(Te=>Te.status!=="pending");ht(zt),l(Ue),Sn(qn),fe=Ue.filter(Te=>Te.status==="ready");const Et=r?`lastViewed-${r}`:null,xn=Et?localStorage.getItem(Et):null,wn=xn?new Date(xn):(ye=t==null?void 0:t.metadata)!=null&&ye.lastSignInTime?new Date(t.metadata.lastSignInTime):null;let Sr=fe,yi=[];if(wn&&(yi=fe.filter(Te=>{var Tt;const xe=(Tt=Te.lastUpdatedAt)!=null&&Tt.toDate?Te.lastUpdatedAt.toDate():Te.lastUpdatedAt instanceof Date?Te.lastUpdatedAt:null;return xe&&xe>wn}),yi.length>0&&(Sr=yi)),yi.length===0){const Te={};Ue.forEach(xe=>{let Tt;if(xe.status==="approved"?Tt="approve":xe.status==="rejected"?Tt="reject":xe.status==="edit_requested"&&(Tt="edit"),Tt){const $t=xe.adUrl||xe.firebaseUrl;Te[$t]={adUrl:$t,response:Tt}}}),ke(Te)}const Us=["9x16","3x5","1x1","4x5","Pinterest","Snapchat"],vi=Te=>Te.recipeCode||Qt(Te.filename||"").recipeCode||"unknown",ta=Te=>Te.aspectRatio||Qt(Te.filename||"").aspectRatio||"",vt={};Sr.forEach(Te=>{const xe=vi(Te);vt[xe]||(vt[xe]=[]),vt[xe].push(Te)});const kt=Object.values(vt).map(Te=>{for(const xe of Us){const Tt=Te.find($t=>ta($t)===xe);if(Tt)return Tt}return Te[0]});kt.sort((Te,xe)=>{const Tt=vi(Te),$t=vi(xe);return Tt.localeCompare($t)}),d(kt),p(o?kt.length:De<kt.length?De:0),$(kt.length===0&&Ue.length===0&&qn);const _i=r?`reviewComplete-${r}`:null,el=_i?localStorage.getItem(_i):null;cr(kt.length===0&&Ue.length>0||el==="true")}catch(fe){console.error("Failed to load ads",fe)}finally{ne(!1)}};if(!(t!=null&&t.uid)||!r&&n.length===0){l([]),d([]),ne(!1);return}Z()},[t,n,r]),T.useEffect(()=>{if(c.length===0){F(!0),ie.current=null;return}const Z=c[0],ye=typeof Z=="object"?Z.adUrl||Z.firebaseUrl:Z;if(!ye){F(!0),ie.current=null;return}if(ie.current===ye)return;ie.current=ye,F(!1);const fe=new Image;fe.onload=()=>F(!0),fe.onerror=()=>F(!0),fe.src=ye},[c]),T.useEffect(()=>{if(!i){V(!0),de.current=null;return}const Z=rt.logoUrl||fr;if(de.current===Z)return;de.current=Z,V(!1);const ye=new Image;ye.onload=()=>V(!0),ye.onerror=()=>V(!0),ye.src=Z},[i,rt.logoUrl]);const z=c[f],ve=z&&typeof z=="object"?z.adUrl||z.firebaseUrl:z;z&&typeof z=="object"&&z.brandCode,z&&typeof z=="object"&&z.groupName;const le=(Vs=_e[ve])==null?void 0:Vs.response,Re=xr&&le&&!Ie,je=c.length>0?(f+(Ce?1:0))/c.length*100:0,Ke=()=>{if(!z||!z.parentAdId)return;const Z=Dt.find(ye=>ye.assetId===z.parentAdId);Z&&(Dn({current:z,previous:Z}),Mn("current"))},st=()=>Dn(null),Ct=Z=>{if(dn||Ie||w||S||I)return;const ye=Z.touches[0];bt.current=ye.clientX,Mt.current=ye.clientY,Er.current=ye.clientX,B.current=ye.clientY,gi(!0),wr(0)},Bt=Z=>{if(!vn)return;const ye=Z.touches[0],fe=ye.clientX-bt.current,De=ye.clientY-Mt.current;Math.abs(fe)>Math.abs(De)&&Z.preventDefault(),Er.current=ye.clientX,B.current=ye.clientY,wr(fe)},Ye=()=>{if(!vn)return;const Z=Er.current-bt.current,ye=Math.abs(B.current-Mt.current);Math.abs(Z)>100&&ye<100&&(Z>0?In("approve"):In("reject")),wr(0),gi(!1)},et=Z=>{if(Ce&&Z.target===Z.currentTarget){if(ee.current||(p(ye=>{const fe=ye+1;return console.log("Index updated:",fe),fe}),ee.current=!0),Ce==="reject"){const ye=D+1;O(ye),ye===5&&E(!0)}mi(null)}},yt=async()=>{const Z=c.slice(f),ye=[];Z.forEach(fe=>{const De=Qt(fe.filename||""),he=fe.recipeCode||De.recipeCode||"unknown",gt=Q.find(qn=>qn.recipeCode===he);(gt?gt.assets:[fe]).forEach(qn=>ye.push(nt(oe(H,"adGroups",qn.adGroupId,"assets",qn.assetId),{status:"pending",isResolved:!1})))});try{await Promise.all(ye)}catch(fe){console.error("Failed to mark remaining ads pending",fe)}finally{E(!1),C(!1),j(!1),p(c.length)}},ft={approve:"Approved",reject:"Rejected",edit:"Edit Requested"},it=z?Qt(z.filename||""):{},qe=(z==null?void 0:z.recipeCode)||it.recipeCode,Lt=Q.find(Z=>Z.recipeCode===qe),hn=Lt?Lt.assets.filter(Z=>(Z.adUrl||Z.firebaseUrl)!==ve):[],At=((z==null?void 0:z.aspectRatio)||it.aspectRatio||"9x16").replace("x","/");T.useEffect(()=>{br.current=br.current.filter(Z=>Z.index>f);for(let Z=1;Z<=zE;Z+=1){const ye=f+Z,fe=c[ye];if(!fe)break;if(br.current.find(gt=>gt.index===ye))continue;const De=fe.adUrl||fe.firebaseUrl,he=new Image;he.src=De,br.current.push({index:ye,img:he})}br.current=br.current.slice(-zE)},[f,c,L]);const In=async Z=>{if(!z)return;ee.current=!1,mi(Z),re(!0);const ye=(Lt==null?void 0:Lt.assets)||[z],fe=[],De=Z==="approve"?"approved":Z==="reject"?"rejected":"edit_requested";try{for(const he of ye){const gt=he.adUrl||he.firebaseUrl,$r={adUrl:gt,response:Z,comment:Z==="edit"?m:"",pass:_e[gt]?"revisit":"initial",...he.brandCode?{brandCode:he.brandCode}:{},...he.groupName?{groupName:he.groupName}:{},...s?{reviewerName:s}:{},...t!=null&&t.email?{userEmail:t.email}:{},...t!=null&&t.uid?{userId:t.uid}:{},...e?{userRole:e}:{}};if(he.adGroupId&&fe.push(Vr(be(H,"adGroups",he.adGroupId,"responses"),{...$r,timestamp:mn()})),he.assetId&&he.adGroupId){const qn=oe(H,"adGroups",he.adGroupId,"assets",he.assetId),Ue={status:De,comment:Z==="edit"?m:"",lastUpdatedBy:t.uid,lastUpdatedAt:mn(),...Z==="approve"?{isResolved:!0}:{},...Z==="edit"?{isResolved:!1}:{}};fe.push(nt(qn,Ue)),fe.push(Vr(be(H,"adGroups",he.adGroupId,"assets",he.assetId,"history"),{status:De,updatedBy:t.uid,updatedAt:mn(),...Z==="edit"&&m?{comment:m}:{}}).catch(vt=>{if((vt==null?void 0:vt.code)==="already-exists")console.log("History entry already exists, skipping");else throw vt})),l(vt=>vt.map(kt=>kt.assetId===he.assetId?{...kt,status:De,comment:Z==="edit"?m:"",...Z==="approve"?{isResolved:!0}:Z==="edit"?{isResolved:!1}:{}}:kt)),d(vt=>vt.map(kt=>kt.assetId===he.assetId?{...kt,status:De,comment:Z==="edit"?m:"",...Z==="approve"?{isResolved:!0}:Z==="edit"?{isResolved:!1}:{}}:kt));const zt=he.status,ot=De;let Et=0,xn=0,wn=0,Sr=0;zt==="ready"&&(Et+=1),zt!==ot&&(zt==="approved"&&(xn-=1),zt==="rejected"&&(wn-=1),zt==="edit_requested"&&(Sr-=1),ot==="approved"&&(xn+=1),ot==="rejected"&&(wn+=1),ot==="edit_requested"&&(Sr+=1));const yi=oe(H,"adGroups",he.adGroupId),Us=await Qr(yi),vi={...Et?{reviewedCount:kh(Et)}:{},...xn?{approvedCount:kh(xn)}:{},...wn?{rejectedCount:kh(wn)}:{},...Sr?{editCount:kh(Sr)}:{},lastUpdated:mn(),...Us.exists()&&!Us.data().thumbnailUrl?{thumbnailUrl:he.firebaseUrl}:{}},ta=Nv(a.map(vt=>vt.assetId===he.assetId?{...vt,status:De}:vt),Us.exists()?Us.data().status:"pending");if(ta!==Us.data().status&&(vi.status=ta,Ve(ta)),fe.push(nt(yi,vi)),Z==="approve"&&he.parentAdId){const vt=un(be(H,"adGroups",he.adGroupId,"assets"),Nt("parentAdId","==",he.parentAdId)),kt=await Le(vt);fe.push(Promise.all(kt.docs.map(_i=>nt(oe(H,"adGroups",he.adGroupId,"assets",_i.id),{isResolved:!0})))),fe.push(nt(oe(H,"adGroups",he.adGroupId,"assets",he.parentAdId),{isResolved:!0}))}}ke(qn=>({...qn,[gt]:$r}))}if(ye.length>0){const he=oe(H,"recipes",qe);fe.push(li(he,{history:ER({timestamp:Date.now(),status:De,user:s||(t==null?void 0:t.displayName)||(t==null?void 0:t.uid)||"unknown",...Z==="edit"&&m?{editComment:m}:{}})},{merge:!0}))}await Promise.all(fe),r&&localStorage.setItem(`lastViewed-${r}`,new Date().toISOString())}catch(he){console.error("Failed to submit response",he)}finally{x(""),y(!1),re(!1),Oe(!1),ee.current||(p(he=>{const gt=he+1;return console.log("Index updated:",gt),gt}),ee.current=!0),mi(null)}},Fs=async()=>{if(!(z!=null&&z.adGroupId)){C(!1),v("");return}A(!0);try{await nt(oe(H,"adGroups",z.adGroupId),{clientNote:_.trim(),clientNoteTimestamp:mn(),hasClientNote:!0})}catch(Z){console.error("Failed to submit note",Z)}finally{A(!1),v(""),C(!1),j(!0)}};if(P||!ae||!W)return u.jsx(Bd,{});if(Tr)return u.jsx("div",{className:"p-4 text-center",children:"Unable to acquire lock for this group. Please check your permissions."});if(we==="in review"&&ge&&(_n?_n!==(t==null?void 0:t.uid):ge!==s))return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen space-y-4 text-center",children:[u.jsxs("h1",{className:"text-2xl font-bold",children:[ge," is currently reviewing this group."]}),u.jsx("p",{className:"text-lg",children:"Please wait until they've finished before hopping in."}),i&&u.jsx(Zn,{pngUrl:rt.logoUrl||fr,alt:`${rt.name||"Agency"} logo`,loading:"eager",cacheKey:rt.logoUrl||fr,onLoad:()=>V(!0),className:"mb-2 max-h-16 w-auto"})]});if(!a||a.length===0)return u.jsx("div",{className:"text-center mt-10",children:zr?"ads are pending":"No ads assigned to your account."});if(M)return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen space-y-4 text-center",children:[i&&u.jsx(Zn,{pngUrl:rt.logoUrl||fr,alt:`${rt.name||"Agency"} logo`,loading:"eager",cacheKey:rt.logoUrl||fr,onLoad:()=>V(!0),className:"mb-2 max-h-16 w-auto"}),u.jsx("h1",{className:"text-2xl font-bold",children:"Ads Pending Review"}),u.jsx("p",{className:"text-lg",children:"We'll notify you when your ads are ready."})]});if(f>=c.length){r&&(localStorage.setItem(`lastViewed-${r}`,new Date().toISOString()),localStorage.getItem(`reviewComplete-${r}`)!=="true"&&localStorage.setItem(`reviewComplete-${r}`,"false"));const ye=Object.values(_e).filter(Ue=>Ue.response==="approve").length,fe=a.filter(Ue=>{var ot;const zt=Ue.adUrl||Ue.firebaseUrl;return((ot=_e[zt])==null?void 0:ot.response)==="approve"}),De={},he={"9x16":0,"3x5":1,"1x1":2};fe.forEach(Ue=>{const zt=Qt(Ue.filename||""),ot=Ue.recipeCode||zt.recipeCode||"unknown",Et=Ue.aspectRatio||zt.aspectRatio||"",xn={...Ue,recipeCode:ot,aspectRatio:Et};De[ot]||(De[ot]=[]),De[ot].push(xn)});const $r=Object.entries(De).map(([Ue,zt])=>(zt.sort((ot,Et)=>(he[ot.aspectRatio]??99)-(he[Et.aspectRatio]??99)),{recipeCode:Ue,assets:zt})).map(Ue=>{const zt=Ue.assets.find(ot=>ot.aspectRatio==="9x16")||Ue.assets.find(ot=>ot.aspectRatio==="3x5")||Ue.assets[0];return{recipeCode:Ue.recipeCode,hero:zt,assets:Ue.assets}}),qn=()=>{const Ue={};a.forEach(Et=>{const xn=Qt(Et.filename||""),wn=Et.recipeCode||xn.recipeCode||"unknown";Ue[wn]||(Ue[wn]=[]),Ue[wn].push(Et)});const zt=["9x16","3x5","1x1","4x5","Pinterest","Snapchat"],ot=Object.values(Ue).map(Et=>{for(const xn of zt){const wn=Et.find(Sr=>(Sr.aspectRatio||Qt(Sr.filename||"").aspectRatio||"")===xn);if(wn)return wn}return Et[0]});ot.sort((Et,xn)=>{const wn=Et.recipeCode||Qt(Et.filename||"").recipeCode||"",Sr=xn.recipeCode||Qt(xn.filename||"").recipeCode||"";return wn.localeCompare(Sr)}),d(ot),p(0),cr(!0)};return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen space-y-4 text-center",children:[i&&u.jsx(Zn,{pngUrl:rt.logoUrl||fr,alt:`${rt.name||"Agency"} logo`,loading:"eager",cacheKey:rt.logoUrl||fr,onLoad:()=>V(!0),className:"mb-2 max-h-16 w-auto"}),u.jsx("h1",{className:"text-2xl font-bold",children:"Thank you for your feedback!"}),u.jsxs("h2",{className:"text-xl",children:["You've approved"," ",u.jsx("span",{style:{color:"var(--approved-color)"},children:ye})," ","ads."]}),u.jsx("div",{className:"flex flex-wrap justify-center gap-2 w-full max-w-6xl mx-auto",children:(Ur?$r:$r.slice(0,3)).map(Ue=>(Ur?Ue.assets:[Ue.hero]).map((ot,Et)=>u.jsx(Zn,{pngUrl:ot.firebaseUrl,webpUrl:ot.firebaseUrl.replace(/\.png$/,".webp"),alt:ot.filename,cacheKey:ot.firebaseUrl,className:"w-24 h-24 object-contain"},`${Ue.recipeCode}-${Et}`)))}),u.jsx("button",{onClick:qn,className:"btn-secondary",children:"Change Feedback"}),u.jsx("button",{onClick:()=>_s(Ue=>!Ue),className:"btn-secondary",children:Ur?"Close Gallery":"View Gallery"})]})}return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen space-y-4",children:[I&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm space-y-4 dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[!S&&!N&&u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mb-4 text-center text-lg font-medium",children:"You’ve rejected 5 ads so far. Leave a note so we can regroup?"}),u.jsxs("div",{className:"flex justify-center space-x-2",children:[u.jsx("button",{onClick:()=>C(!0),className:"btn-primary px-3 py-1",children:"Leave Note"}),u.jsx("button",{onClick:()=>{E(!1),C(!1),j(!1)},className:"btn-secondary px-3 py-1 text-white",children:"Keep reviewing"})]})]}),S&&!N&&u.jsxs("div",{className:"flex flex-col space-y-2",children:[u.jsx("textarea",{value:_,onChange:Z=>v(Z.target.value),className:"w-full p-2 border rounded",rows:3,placeholder:"Leave a note for the designer..."}),u.jsxs("div",{className:"flex justify-center space-x-2",children:[u.jsx("button",{onClick:Fs,disabled:k,className:"btn-primary px-3 py-1",children:"Submit Note"}),u.jsx("button",{onClick:()=>{C(!1),v("")},className:"btn-secondary px-3 py-1 text-white",children:"Cancel"})]})]}),N&&u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mb-4 text-center text-lg font-medium",children:"Continue Review?"}),u.jsxs("div",{className:"flex justify-center space-x-2",children:[u.jsx("button",{onClick:()=>{E(!1),j(!1)},className:"btn-primary px-3 py-1",children:"Yes"}),u.jsx("button",{onClick:yt,className:"btn-secondary px-3 py-1 text-white",children:"No"})]})]})]})}),u.jsxs("div",{className:"relative flex flex-col items-center w-fit mx-auto",children:[i&&u.jsx(Zn,{pngUrl:rt.logoUrl||fr,alt:`${rt.name||"Agency"} logo`,loading:"eager",cacheKey:rt.logoUrl||fr,onLoad:()=>V(!0),className:"mb-2 max-h-16 w-auto"}),!xr&&u.jsxs("div",{className:"relative w-full max-w-md mb-2.5 flex justify-center",children:[u.jsx("button",{type:"button",onClick:()=>ur(-1),"aria-label":"Exit Review",className:"absolute left-0 top-1/2 -translate-y-1/2 text-gray-500 hover:text-black dark:hover:text-white",children:u.jsx(U9,{})}),u.jsx("div",{className:"progress-bar",role:"progressbar","aria-valuenow":je,"aria-valuemin":"0","aria-valuemax":"100",children:u.jsx("div",{className:"progress-bar-inner",style:{width:`${je}%`}})})]}),Lt&&Lt.assets.length>1&&u.jsxs("button",{onClick:()=>pi(Z=>!Z),className:"text-xs text-gray-500 mb-2 px-2 py-0.5 rounded-full transition-colors hover:bg-gray-200",children:[Lt.assets.length," sizes"]}),u.jsx("div",{className:"flex justify-center relative",children:u.jsxs("div",{onTouchStart:Fg?void 0:Ct,onTouchMove:Fg?void 0:Bt,onTouchEnd:Fg?void 0:Ye,onAnimationEnd:et,className:`relative z-10 ${L&&dn?"flex flex-col items-center overflow-y-auto h-[72vh]":"size-container"} ${Ce?"simple-fade-out":Ls?"simple-fade-in":""}`,style:L&&dn?{}:Ce?{}:{transform:dn?`translateX(-${hn.length*55}%)`:`translateX(${ss}px)`,transition:vn?"none":void 0},children:[u.jsx("div",{className:`relative ad-aspect max-w-[90%] mx-auto rounded shadow ${L&&dn?"mb-2":"max-h-[72vh]"}`,style:{aspectRatio:At},children:u.jsx(Zn,{pngUrl:ve,webpUrl:ve.replace(/\.png$/,".webp"),alt:"Ad",loading:"eager",cacheKey:ve,onLoad:()=>F(!0),style:L&&dn?{maxHeight:`${72/(hn.length+1)}vh`}:{},className:"w-full h-full object-contain"})}),z&&(z.version||1)>1&&u.jsxs("span",{onClick:Ke,className:"version-badge cursor-pointer",children:["V",z.version||1]}),hn.map((Z,ye)=>u.jsx(Zn,{pngUrl:Z.firebaseUrl,webpUrl:Z.firebaseUrl.replace(/\.png$/,".webp"),alt:Z.filename,cacheKey:Z.firebaseUrl,style:L&&dn?{maxHeight:`${72/(hn.length+1)}vh`}:{transform:dn?`translateX(${(ye+1)*110}%)`:"translateX(0)",opacity:dn?1:0},className:`max-w-[90%] mx-auto rounded shadow ${L&&dn?"mb-2 relative":"size-thumb max-h-[72vh]"}`},ye))]})})]}),!dn&&(Re?u.jsxs("div",{className:"flex items-center space-x-4",children:[f>0&&u.jsx("button",{"aria-label":"Previous",onClick:()=>p(Z=>Math.max(0,Z-1)),className:"btn-arrow",children:"<"}),u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("span",{className:`status-badge text-lg status-${le==="edit"?"edit_requested":le==="reject"?"rejected":"approved"}`,children:ft[le]}),le==="edit"&&z.comment&&u.jsx("p",{className:"text-sm",children:z.comment}),u.jsx("button",{onClick:()=>Oe(!0),className:"btn-secondary",children:"Change"})]}),f<c.length-1&&u.jsx("button",{"aria-label":"Next",onClick:()=>p(Z=>Math.min(c.length-1,Z+1)),className:"btn-arrow",children:">"})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex space-x-4",children:[u.jsx("button",{onClick:()=>In("reject"),className:`btn-reject ${le&&le!=="reject"?"opacity-50":""}`,disabled:G,children:"Reject"}),u.jsx("button",{onClick:()=>y(!0),className:`btn-edit ${le&&le!=="edit"?"opacity-50":""}`,disabled:G,"aria-label":"Request Edit",children:u.jsx(Rv,{})}),u.jsx("button",{onClick:()=>In("approve"),className:`btn-approve ${le&&le!=="approve"?"opacity-50":""}`,disabled:G,children:"Approve"})]}),w&&u.jsxs("div",{className:"flex flex-col items-center space-y-2 w-full max-w-sm",children:[u.jsx("textarea",{value:m,onChange:Z=>x(Z.target.value),className:"w-full p-2 border rounded",placeholder:"Add comments...",rows:3}),u.jsx("button",{onClick:()=>In("edit"),className:"btn-primary",disabled:G,children:"Submit"})]})]})),wt&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-md text-center",children:[u.jsxs("div",{className:"mb-2 space-x-2",children:[u.jsxs("button",{onClick:()=>Mn("current"),className:"btn-secondary px-2 py-1",children:["V",wt.current.version||1]}),u.jsxs("button",{onClick:()=>Mn("previous"),className:"btn-secondary px-2 py-1",children:["V",wt.previous.version||1," (replaced)"]})]}),u.jsx(Zn,{pngUrl:Os==="previous"?wt.previous.firebaseUrl:wt.current.firebaseUrl,webpUrl:(Os==="previous"?wt.previous.firebaseUrl:wt.current.firebaseUrl).replace(/\.png$/,".webp"),alt:"Ad version",cacheKey:Os==="previous"?wt.previous.firebaseUrl:wt.current.firebaseUrl,className:"max-w-full max-h-[70vh] mx-auto"}),u.jsx("button",{onClick:st,className:"mt-2 btn-primary px-3 py-1",children:"Close"})]})})]})},_p=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia.bind(window):null,$E=()=>typeof localStorage>"u"?"system":localStorage.getItem("theme")||"system",WE=t=>t==="system"?_p&&_p("(prefers-color-scheme: dark)").matches?"dark":"light":t,gw=()=>{const[t,e]=T.useState($E()),[n,r]=T.useState(()=>WE($E()));T.useEffect(()=>{const o=c=>{const d=WE(c);r(d),document.documentElement.classList.toggle("dark",d==="dark")};o(t);const a=_p?_p("(prefers-color-scheme: dark)"):null,l=()=>{t==="system"&&o("system")};return t==="system"&&a&&a.addEventListener("change",l),()=>{a&&a.removeEventListener("change",l)}},[t]);const s=o=>{e(o),typeof localStorage<"u"&&localStorage.setItem("theme",o)};return{theme:t,resolvedTheme:n,setTheme:s,toggleTheme:()=>{s(n==="dark"?"light":"dark")}}},Q9=({className:t=""})=>{const{resolvedTheme:e,toggleTheme:n}=gw();return u.jsx("button",{type:"button","aria-label":"Toggle dark mode",onClick:n,className:`p-2 rounded ${t}`,children:e==="dark"?u.jsx(j9,{}):u.jsx(L9,{})})},X9=({userRole:t=null,brandCodes:e=[]})=>{const{groupId:n}=OI(),{search:r}=gs(),s=new URLSearchParams(r).get("done")==="1",[i,o]=T.useState(Me.currentUser),[a,l]=T.useState(""),[c,d]=T.useState(""),[f,p]=T.useState(null),[m,x]=T.useState(null),[w,y]=T.useState(null),[_,v]=T.useState(!1),[k,A]=T.useState(!1),[D,O]=T.useState(!1),[I,E]=T.useState(""),[S,C]=T.useState(!1),[N,j]=T.useState(""),[P,ne]=T.useState(!Me.currentUser);if(T.useEffect(()=>{i||IC(Me).then(()=>{o(Me.currentUser),ne(!1)}).catch(F=>{console.error("Anonymous sign-in failed",F),j(F.message),ne(!1)})},[i]),T.useEffect(()=>{if(!n){p(null);return}(async()=>{try{const W=await Qr(oe(H,"adGroups",n));if(!W.exists()){p(null);return}const V=W.data().brandCode;if(!V){p(null);return}const G=un(be(H,"brands"),Nt("code","==",V)),re=await Le(G);re.empty?p(null):p(re.docs[0].data().agencyId||null)}catch(W){console.error("Failed to fetch agency",W),p(null)}})()},[n]),T.useEffect(()=>{if(!n){x(null),y(null),O(!1);return}(async()=>{var W;try{const V=await Qr(oe(H,"adGroups",n));if(!V.exists()){O(!0),x(null),y(null),v(!1),A(!1);return}const G=V.data();x(G.password||null),y(G.visibility||"private"),v(!!G.requireAuth),A(!!G.requirePassword);const re=G.visibility!=="public"||G.requireAuth&&((W=Me.currentUser)==null?void 0:W.isAnonymous);O(re)}catch(V){console.error("Failed to fetch group info",V),O(!0),x(null),y(null),v(!1),A(!1)}})()},[n]),T.useEffect(()=>{if(m===null||D)return;const F=typeof localStorage<"u"?localStorage.getItem(`reviewPassword-${n}`):null;(!k||F===m)&&C(!0)},[m,k,n,D]),T.useEffect(()=>{if(i)if(i.isAnonymous){const F=typeof localStorage<"u"?localStorage.getItem("reviewerName"):"";F&&(l(F),d(F))}else l(i.displayName||"")},[i]),T.useEffect(()=>{i!=null&&i.isAnonymous&&a&&localStorage.setItem("reviewerName",a)},[a,i]),N)return u.jsx("div",{className:"p-4 text-center text-red-500",children:N});if(P)return u.jsx(Bd,{});if(D)return u.jsx("div",{className:"p-4 text-center",children:"This link is currently private."});if(k&&!S)return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 space-y-2",children:[u.jsx("label",{className:"text-lg",htmlFor:"reviewPassword",children:"Group Password"}),u.jsx("input",{id:"reviewPassword",type:"password",value:I,onChange:F=>E(F.target.value),className:"w-full max-w-xs p-2 border rounded"}),u.jsx("button",{onClick:()=>{I===m?(localStorage.setItem(`reviewPassword-${n}`,m),C(!0)):window.alert("Incorrect password")},className:"btn-primary",disabled:!I.trim(),children:"Enter"})]});if(i!=null&&i.isAnonymous&&!a)return u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 space-y-2",children:[u.jsx("label",{className:"text-lg",htmlFor:"reviewerName",children:"Your Name"}),u.jsx("input",{id:"reviewerName",type:"text",value:c,onChange:F=>d(F.target.value),className:"w-full max-w-xs p-2 border rounded"}),u.jsx("button",{onClick:()=>l(c.trim()),className:"btn-primary",disabled:!c.trim(),children:"Continue"})]});const ae=i!=null&&i.isAnonymous?{uid:i.uid||"public",email:"public@campfire"}:i;return u.jsxs("div",{className:"min-h-screen relative",children:[(i==null?void 0:i.isAnonymous)&&u.jsx(Q9,{className:"absolute top-2 right-2"}),u.jsx(Y9,{user:ae,groupId:n,reviewerName:a,userRole:i!=null&&i.isAnonymous?null:t,brandCodes:i!=null&&i.isAnonymous?[]:e,agencyId:f,forceSplash:s})]})},J9=()=>{const[t,e]=T.useState(Me.currentUser),[n,r]=T.useState(!Me.currentUser);T.useEffect(()=>{t||IC(Me).then(()=>{e(Me.currentUser),r(!1)}).catch(l=>{console.error("Anonymous sign-in failed",l),r(!1)})},[t]);const s=t==null?void 0:t.isAnonymous,{role:i,brandCodes:o,loading:a}=Qa(s?null:t==null?void 0:t.uid);return a||n?u.jsx(Bd,{}):u.jsx(X9,{userRole:s?null:i,brandCodes:s?[]:o})};function mN(t){return Ze({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"}}]})(t)}const Z9=({options:t=[],value:e=[],onChange:n,id:r="tag-checklist"})=>{const[s,i]=T.useState(""),o=Object.fromEntries(t.map(p=>[p.name,p.id])),a=e||[],l=t.filter(p=>!a.includes(p.id)),c=p=>{const m=o[p];m&&(a.includes(m)||n([...a,m]),i(""))},d=p=>{n(a.filter(m=>m!==p))},f=p=>{p.key==="Enter"&&(p.preventDefault(),c(s.trim()))};return u.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[a.map(p=>{const m=t.find(w=>w.id===p),x=m?m.name:p;return u.jsxs("span",{className:"tag bg-accent-10 text-accent flex items-center",children:[x,u.jsx("button",{type:"button",onClick:()=>d(p),className:"ml-1 text-xs text-red-500",children:"×"})]},p)}),u.jsx("input",{id:r,list:`${r}-list`,value:s,onChange:p=>i(p.target.value),onKeyDown:f,className:"flex-1 p-1 border rounded"}),l.length>0&&u.jsx("datalist",{id:`${r}-list`,children:l.map(p=>u.jsx("option",{value:p.name},p.id))})]})},Sm=({value:t=[],onChange:e,suggestions:n=[],id:r="tag-input"})=>{const[s,i]=T.useState(""),o=c=>{const d=c.trim();d&&(t.includes(d)||e([...t,d]),i(""))},a=c=>{e(t.filter(d=>d!==c))},l=c=>{c.key==="Enter"&&(c.preventDefault(),o(s))};return u.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[t.map(c=>u.jsxs("span",{className:"tag bg-accent-10 text-accent flex items-center",children:[c,u.jsx("button",{type:"button",onClick:()=>a(c),className:"ml-1 text-xs text-red-500",children:"×"})]},c)),u.jsx("input",{id:r,list:`${r}-list`,value:s,onChange:c=>i(c.target.value),onKeyDown:l,className:"flex-1 p-1 border rounded"}),n.length>0&&u.jsx("datalist",{id:`${r}-list`,children:n.map(c=>u.jsx("option",{value:c},c))})]})};function HE(t){if(t==null)return"";let e=[];return Array.isArray(t)?e=t:typeof t=="string"&&(e=t.split(/[;,\n]+/).map(n=>n.trim()).filter(Boolean)),e.length===0?"":e[Math.floor(Math.random()*e.length)]}function ez(t=""){return t.toLowerCase().split(/[;,\s]+/).map(e=>e.trim()).filter(Boolean)}function xp(t=""){const e=[];let n="",r=!1;for(let s=0;s<t.length;s+=1){const i=t[s];i==='"'?r&&t[s+1]==='"'?(n+='"',s+=1):r=!r:i===","&&!r?(e.push(n),n=""):n+=i}return e.push(n),e}const tz=(t,e)=>{if(!t||!e)return 1;const n=t.toString().toLowerCase(),r=e.toString().toLowerCase();if(n===r)return 10;const s=new Set(n.split(/\s+/)),i=new Set(r.split(/\s+/));let o=0;s.forEach(l=>{i.has(l)&&(o+=1)});const a=new Set([...s,...i]);return Math.round(o/a.size*9)+1},il=t=>{if(!t)return"";const e=t.toString().trim().toLowerCase();if(!e)return"";const n=["still","image","static","img","picture","photo"],r=["motion","video","animated","gif"];return n.some(s=>e.includes(s))?"image":r.some(s=>e.includes(s))?"video":e},Pv=({onSave:t=null,initialResults:e=null,showOnlyResults:n=!1,onSelectChange:r=null})=>{var gi,Ls,Br,br,bt,Mt,Er;const[s,i]=T.useState([]),[o,a]=T.useState([]),[l,c]=T.useState([]),[d,f]=T.useState([]),[p,m]=T.useState(""),[x,w]=T.useState(""),[y,_]=T.useState({}),[v,k]=T.useState({}),[A,D]=T.useState([]),[O,I]=T.useState(1),[E,S]=T.useState({}),[C,N]=T.useState(!1),[j,P]=T.useState([]),[ne,ae]=T.useState([]),[F,W]=T.useState({}),[V,G]=T.useState({}),{role:re}=Qa((gi=Me.currentUser)==null?void 0:gi.uid),_e=re==="admin"||re==="agency";T.useEffect(()=>{(async()=>{try{const ee=await Le(be(H,"recipeTypes"));i(ee.docs.map(Ve=>({id:Ve.id,...Ve.data()})));const ie=await Le(be(H,"componentTypes"));a(ie.docs.map(Ve=>{const ge=Ve.data();return{id:Ve.id,...ge,selectionMode:ge.selectionMode||"dropdown"}}));const de=await Le(be(H,"componentInstances"));c(de.docs.map(Ve=>({id:Ve.id,...Ve.data()})));const we=await Le(be(H,"brands"));f(we.docs.map(Ve=>({id:Ve.id,...Ve.data()})))}catch(ee){console.error("Failed to load data",ee)}})()},[]),T.useEffect(()=>{var B,ee;e&&Array.isArray(e)&&(D(e.map((ie,de)=>({recipeNo:de+1,...ie}))),(B=e[0])!=null&&B.type&&w(e[0].type),(ee=e[0])!=null&&ee.brandCode&&m(e[0].brandCode))},[e]);const ke=async B=>{var ur,zr,Sn;const ee=(ur=B.target.files)==null?void 0:ur[0];if(!ee){P([]),ae([]),W({}),G({});return}const de=(await ee.text()).trim().split(/\r?\n/);if(de.length===0){P([]),ae([]),W({}),G({});return}const we=xp(de[0]).map(M=>M.trim()),Ve=[];for(let M=1;M<de.length;M+=1){if(!de[M])continue;const $=xp(de[M]).map(K=>K.trim()),L={};we.forEach((K,Q)=>{L[K]=$[Q]||""}),Ve.push(L)}P(Ve),ae(we);const ge={};((Ce==null?void 0:Ce.assetMatchFields)||[]).forEach(M=>{ge[M]={header:we.includes(M)?M:"",score:10}});const Ot=we.find(M=>/url/i.test(M));Ot&&(ge.imageUrl={header:Ot,score:10});const _n=we.find(M=>/(name|file)/i.test(M));_n&&(ge.imageName={header:_n,score:10});const kr=we.find(M=>/context/i.test(M));kr&&(ge.context={header:kr});const Tr=we.find(M=>/asset.?type/i.test(M)||/^type$/i.test(M));Tr&&(ge.assetType={header:Tr}),W(ge);const xs=((zr=ge.imageName)==null?void 0:zr.header)||((Sn=ge.imageUrl)==null?void 0:Sn.header)||"",rt={};Ve.forEach(M=>{const $=M[xs]||M.imageUrl||M.imageName||"";$&&(rt[$]=0)}),G(rt),sc("Asset CSV loaded",{headers:we,rowsSample:Ve.slice(0,2),map:ge})},Ie=async(B=null,ee=p)=>{var zr,Sn,M,$;if(!Ce)return null;let ie=Ce.gptPrompt||"";ie=ie.replace(/{{brandCode}}/g,ee);const de=B?{...B}:{...y},we={};ss.forEach(L=>{var K,Q;if(B)(K=L.attributes)==null||K.forEach(z=>{const ve=de[`${L.key}.${z.key}`]||"";we[`${L.key}.${z.key}`]=ve;const le=new RegExp(`{{${L.key}\\.${z.key}}}`,"g");ie=ie.replace(le,ve)});else{const z=l.filter(le=>{var Re;return le.componentKey===L.key&&(!((Re=le.relationships)!=null&&Re.brandCode)||le.relationships.brandCode===ee)});let ve=null;if(L.selectionMode==="random")z.length>0&&(ve=z[Math.floor(Math.random()*z.length)]);else if(L.selectionMode==="checklist"){const Re=(v[L.key]!==void 0?v[L.key]:z.map(je=>je.id)).map(je=>z.find(Ke=>Ke.id===je)).filter(Boolean);Re.length>0&&(ve=Re[Math.floor(Math.random()*Re.length)])}else{const le=v[L.key],Re=z.find(je=>je.id===le);Re&&(ve=Re)}(Q=L.attributes)==null||Q.forEach(le=>{var Ke;let Re="";ve?Re=((Ke=ve.values)==null?void 0:Ke[le.key])||"":Re=de[`${L.key}.${le.key}`]||"",we[`${L.key}.${le.key}`]=Re;const je=new RegExp(`{{${L.key}\\.${le.key}}}`,"g");ie=ie.replace(je,Re)})}}),(Ce.writeInFields||[]).forEach(L=>{let K=de[L.key];B?K===void 0&&(K=""):L.inputType==="list"||Array.isArray(K)?K=HE(K):K===void 0&&(K=""),we[L.key]=K;const Q=new RegExp(`{{${L.key}}}`,"g");ie=ie.replace(Q,K)});const ge={};Object.entries(we).forEach(([L,K])=>{const Q=L.match(/^(.+)\.(assetNo|assetCount)$/);if(Q){const z=parseInt(K,10);z>0&&(ge[Q[1]]=z)}});const Ot=Object.keys(ge).length>0?Object.values(ge).reduce((L,K)=>L+K,0):parseInt(we["layout.assetNo"],10)||parseInt(we["layout.assetCount"],10)||0,_n=(L=V,K=null)=>{var st,Ct,Bt;sc("Searching best asset",{rows:j.length,map:F});let Q=0,z=[];if((K&&((st=F.assetType)!=null&&st.header)?j.filter(Ye=>il(Ye[F.assetType.header])===il(K)):j).forEach((Ye,et)=>{let yt=0;const ft={};(Ce.assetMatchFields||[]).forEach(qe=>{const Lt=F[qe];if(!Lt||!Lt.header)return;const hn=Ye[Lt.header];if(hn===void 0)return;const At=we[qe]||"",In=tz(At,hn);ft[qe]={recipeVal:At,rowVal:hn,sim:In,threshold:Lt.score||10},In>=(Lt.score||10)&&(yt+=1)}),yt>Q?(Q=yt,z=[Ye]):yt===Q&&z.push(Ye)}),z.length===0)return null;const le=((Ct=F.imageName)==null?void 0:Ct.header)||((Bt=F.imageUrl)==null?void 0:Bt.header)||"";let Re=1/0;z.forEach(Ye=>{const et=Ye[le]||Ye.imageUrl||Ye.imageName||"",yt=L[et]||0;yt<Re&&(Re=yt)});const je=z.filter(Ye=>{const et=Ye[le]||Ye.imageUrl||Ye.imageName||"";return(L[et]||0)===Re});return je[Math.floor(Math.random()*je.length)]},kr=(L,K,Q,z=null)=>{var Ct,Bt,Ye;if(!L||L.size===0)return null;let ve=0,le=[];if((z&&((Ct=F.assetType)!=null&&Ct.header)?j.filter(et=>il(et[F.assetType.header])===il(z)):j).forEach(et=>{var hn,At,In;const yt=((hn=F.imageName)==null?void 0:hn.header)||((At=F.imageUrl)==null?void 0:At.header)||"",ft=et[yt]||et.imageUrl||et.imageName||"";if(!ft||ft===K)return;const it=((In=F.context)==null?void 0:In.header)||"",qe=new Set(Tr(et[it]||""));let Lt=0;L.forEach(Fs=>{qe.has(Fs)&&(Lt+=1)}),Lt>ve?(ve=Lt,le=[et]):Lt===ve&&le.push(et)}),le.length===0)return null;const je=((Bt=F.imageName)==null?void 0:Bt.header)||((Ye=F.imageUrl)==null?void 0:Ye.header)||"";let Ke=1/0;le.forEach(et=>{const yt=et[je]||et.imageUrl||et.imageName||"",ft=Q[yt]||0;ft<Ke&&(Ke=ft)});const st=le.filter(et=>{const yt=et[je]||et.imageUrl||et.imageName||"";return(Q[yt]||0)===Ke});return st[Math.floor(Math.random()*st.length)]},Tr=L=>ez(L),xs=(L,K,Q)=>{var le,Re,je,Ke,st,Ct,Bt,Ye,et,yt,ft;const z=[];let ve="";if(L>0){const it=_n(Q,K);let qe="";if(it){const hn=((le=F.imageUrl)==null?void 0:le.header)||"imageUrl",At=((Re=F.imageName)==null?void 0:Re.header)||"imageName",In=((je=F.imageName)==null?void 0:je.header)||((Ke=F.imageUrl)==null?void 0:Ke.header)||"",Fs=((st=F.context)==null?void 0:st.header)||"",Vs=it[hn]||it.imageUrl||it.url||"",Z=it[At]||it.imageName||it.filename||Vs;if(qe=it[In]||it.imageUrl||it.imageName||"",ve=it[Fs]||"",qe&&(Q[qe]=(Q[qe]||0)+1),Vs){const ye=((Ct=F.assetType)==null?void 0:Ct.header)||"",fe=ye?it[ye]:"",De=il(fe);z.push({id:Z,adUrl:Vs,assetType:De})}else z.push({needAsset:!0})}else z.push({needAsset:!0});const Lt=new Set(Tr(ve));for(let hn=1;hn<L;hn+=1){const At=kr(Lt,qe,Q,K);if(At){const In=((Bt=F.imageUrl)==null?void 0:Bt.header)||"imageUrl",Fs=((Ye=F.imageName)==null?void 0:Ye.header)||"imageName",Vs=((et=F.imageName)==null?void 0:et.header)||((yt=F.imageUrl)==null?void 0:yt.header)||"",Z=At[In]||At.imageUrl||At.url||"",ye=At[Fs]||At.imageName||At.filename||Z,fe=At[Vs]||At.imageUrl||At.imageName||"";if(fe&&(Q[fe]=(Q[fe]||0)+1),Z){const De=((ft=F.assetType)==null?void 0:ft.header)||"",he=De?At[De]:"",gt=il(he);z.push({id:ye,adUrl:Z,assetType:gt})}else z.push({needAsset:!0})}else z.push({needAsset:!0})}}for(;z.length<L;)z.push({needAsset:!0});return{assets:z,context:ve}},rt=[];let ur="";if(Ot>0){const L={...V};if(Object.keys(ge).length>0)Object.entries(ge).forEach(([K,Q])=>{const z=(we[`${K}.assetType`]||"").trim(),{assets:ve,context:le}=xs(Q,z,L);ur||(ur=le),rt.push(...ve),we[`${K}.assets`]=ve.slice()});else{const{assets:K,context:Q}=xs(Ot,null,L);ur=Q,rt.push(...K)}G(L)}for(;rt.length<Ot;)rt.push({needAsset:!0});ie=ie.replace(/{{csv\.context}}/g,ur);try{const L=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:ie}],temperature:.7})}),K=await L.json();if(!L.ok)return console.error("OpenAI API error",K),null;const Q=(($=(M=(Sn=(zr=K.choices)==null?void 0:zr[0])==null?void 0:Sn.message)==null?void 0:M.content)==null?void 0:$.trim())||"No result",z={type:x,brandCode:ee,components:we,copy:Q,assets:rt.slice()};for(;z.assets.length<Ot;)z.assets.push({needAsset:!0});return z}catch(L){return console.error("Failed to call OpenAI",L),null}},Oe=async B=>{B.preventDefault();const ee=Number(O)||1;for(let ie=0;ie<ee;ie++){const de=await Ie(null,p);de&&D(we=>[...we,{recipeNo:we.length+1,...de,type:x}])}},Dt=()=>{const B={};vn.forEach(ee=>{B[ee.key]=ee.key.endsWith(".assets")?[]:""}),D(ee=>[...ee,{recipeNo:ee.length+1,components:B,copy:"",assets:[]}])},[ht,wt]=T.useState(null),[Dn,Os]=T.useState(""),[Mn,Ur]=T.useState({}),_s=B=>{if(ht===B){const ee=[...A];ee[B].copy=Dn,ee[B].components={...Mn},D(ee),wt(null)}else wt(B),Os(A[B].copy),Ur({...A[B].components})},xr=B=>{D(ee=>ee.filter((ie,de)=>de!==B).map((ie,de)=>({...ie,recipeNo:de+1})))},cr=(B,ee)=>{const ie=l.find(we=>{var Ve;return we.componentKey===B&&we.id===ee&&(!((Ve=we.relationships)!=null&&Ve.brandCode)||we.relationships.brandCode===p)});if(!ie)return;const de={...Mn};Object.entries(ie.values||{}).forEach(([we,Ve])=>{de[`${B}.${we}`]=Ve}),Ur(de)},dn=(B=[])=>u.jsx("div",{className:"flex justify-center gap-1",children:B&&B.length>0?B.map((ee,ie)=>ee.needAsset?u.jsx("span",{className:"text-red-500 text-xs",children:"Need asset"},`na-${ie}`):u.jsxs("span",{className:"relative inline-block group",children:[u.jsx("a",{href:ee.adUrl||ee.firebaseUrl,target:"_blank",rel:"noopener noreferrer",className:`p-2 text-xl rounded inline-flex items-center justify-center ${(ee.assetType||"").toLowerCase()==="video"?"":"bg-accent-10 text-accent"}`,style:(ee.assetType||"").toLowerCase()==="video"?{backgroundColor:"rgba(0,17,255,0.1)",color:"#0011FF"}:{},children:(ee.assetType||"").toLowerCase()==="video"?u.jsx(V9,{}):u.jsx(R9,{})}),u.jsx("img",{src:ee.adUrl||ee.firebaseUrl,alt:"preview",className:"hidden group-hover:block absolute left-[-8rem] top-1/2 -translate-y-1/2 w-32 border shadow-lg z-10"})]},ee.id)):"-"}),pi=async B=>{const ee=A[B].components,ie=await Ie(ee,p);if(ie){const de=[...A];de[B]={...de[B],...ie},D(de)}},Ce=s.find(B=>B.id===x);T.useEffect(()=>{Ce!=null&&Ce.enableAssetCsv||(P([]),ae([]),W({}))},[Ce]);const mi=Object.fromEntries(o.map(B=>[B.key,B])),ss=(Ls=Ce==null?void 0:Ce.components)!=null&&Ls.length?Ce.components.map(B=>mi[B]).filter(Boolean):o,wr=(Ce==null?void 0:Ce.writeInFields)||[],vn=T.useMemo(()=>{const B=[],ee=[];if(ss.length>0?(ss.forEach(ie=>{var de;(de=ie.attributes)==null||de.forEach(we=>{B.push({key:`${ie.key}.${we.key}`,label:`${ie.label} - ${we.label}`}),(we.key==="assetNo"||we.key==="assetCount")&&ee.push({key:`${ie.key}.assets`,label:`${ie.label} Assets`})})}),wr.forEach(ie=>{B.push({key:ie.key,label:ie.label})}),ee.forEach(ie=>B.push(ie))):e&&e.length>0&&Array.from(new Set(e.flatMap(de=>Object.keys(de.components||{})))).forEach(de=>{B.push({key:de,label:de})}),Ce!=null&&Ce.defaultColumns&&Ce.defaultColumns.length>0){const ie=Ce.defaultColumns;B.sort((de,we)=>{const Ve=ie.indexOf(de.key),ge=ie.indexOf(we.key);return Ve===-1&&ge===-1?0:Ve===-1?1:ge===-1?-1:Ve-ge})}return B},[ss,wr,e,Ce]);return T.useEffect(()=>{const B={};Ce!=null&&Ce.defaultColumns&&Ce.defaultColumns.length>0?vn.forEach(ee=>{B[ee.key]=Ce.defaultColumns.includes(ee.key)}):vn.forEach(ee=>{const ie=ee.label.toLowerCase();B[ee.key]=ie.includes("name")||ie.includes("asset")}),S(B)},[vn,Ce]),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl mb-2",children:"Ad Recipe Generation"}),!n&&u.jsxs("form",{onSubmit:Oe,className:"space-y-2 max-w-[50rem]",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Recipe Type"}),u.jsxs("select",{className:"w-full p-2 border rounded",value:x,onChange:B=>w(B.target.value),children:[u.jsx("option",{value:"",children:"Select..."}),s.map(B=>u.jsx("option",{value:B.id,children:B.name},B.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Brand"}),u.jsxs("select",{className:"w-full p-2 border rounded",value:p,onChange:B=>m(B.target.value),children:[u.jsx("option",{value:"",children:"None"}),d.map(B=>u.jsxs("option",{value:B.code,children:[B.code," ",B.name?`- ${B.name}`:""]},B.id))]})]}),(Ce==null?void 0:Ce.enableAssetCsv)&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Asset CSV"}),u.jsx("input",{type:"file",accept:".csv",onChange:ke}),j.length>0&&u.jsxs("p",{className:"text-xs",children:[j.length," rows loaded"]})]}),ne.length>0&&u.jsxs("div",{className:"space-y-1",children:[(Br=Ce.assetMatchFields)==null?void 0:Br.map(B=>{var ee,ie;return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-xs w-28",children:B}),u.jsxs("select",{className:"p-1 border rounded flex-1",value:((ee=F[B])==null?void 0:ee.header)||"",onChange:de=>W({...F,[B]:{...F[B],header:de.target.value}}),children:[u.jsx("option",{value:"",children:"Select..."}),ne.map(de=>u.jsx("option",{value:de,children:de},de))]}),u.jsx("input",{type:"number",min:"1",max:"10",className:"w-16 p-1 border rounded",value:((ie=F[B])==null?void 0:ie.score)||10,onChange:de=>W({...F,[B]:{...F[B],score:Math.min(10,Math.max(1,parseInt(de.target.value,10)||10))}})})]},B)}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-xs w-28",children:"context"}),u.jsxs("select",{className:"p-1 border rounded flex-1",value:((br=F.context)==null?void 0:br.header)||"",onChange:B=>W({...F,context:{header:B.target.value}}),children:[u.jsx("option",{value:"",children:"Ignore"}),ne.map(B=>u.jsx("option",{value:B,children:B},B))]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-xs w-28",children:"imageUrl"}),u.jsxs("select",{className:"p-1 border rounded flex-1",value:((bt=F.imageUrl)==null?void 0:bt.header)||"",onChange:B=>W({...F,imageUrl:{header:B.target.value,score:10}}),children:[u.jsx("option",{value:"",children:"Ignore"}),ne.map(B=>u.jsx("option",{value:B,children:B},B))]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-xs w-28",children:"imageName"}),u.jsxs("select",{className:"p-1 border rounded flex-1",value:((Mt=F.imageName)==null?void 0:Mt.header)||"",onChange:B=>W({...F,imageName:{header:B.target.value,score:10}}),children:[u.jsx("option",{value:"",children:"Ignore"}),ne.map(B=>u.jsx("option",{value:B,children:B},B))]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-xs w-28",children:"assetType"}),u.jsxs("select",{className:"p-1 border rounded flex-1",value:((Er=F.assetType)==null?void 0:Er.header)||"",onChange:B=>W({...F,assetType:{header:B.target.value}}),children:[u.jsx("option",{value:"",children:"Ignore"}),ne.map(B=>u.jsx("option",{value:B,children:B},B))]})]})]})]}),Ce&&u.jsxs("div",{className:"space-y-4",children:[ss.map(B=>{var Ve;const ee=l.filter(ge=>{var Ot;return ge.componentKey===B.key&&(!((Ot=ge.relationships)!=null&&Ot.brandCode)||ge.relationships.brandCode===p)}),ie=ee.map(ge=>ge.id),de=v[B.key]!==void 0?v[B.key]:B.selectionMode==="checklist"?ie:"",we=B.selectionMode==="dropdown"?l.find(ge=>{var Ot;return ge.id===de&&ge.componentKey===B.key&&(!((Ot=ge.relationships)!=null&&Ot.brandCode)||ge.relationships.brandCode===p)}):null;return u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm mb-1",children:B.label}),B.selectionMode==="dropdown"&&ee.length>0&&u.jsxs("select",{className:"w-full p-2 border rounded",value:de,onChange:ge=>k({...v,[B.key]:ge.target.value}),children:[u.jsx("option",{value:"",children:"Custom..."}),ee.map(ge=>u.jsx("option",{value:ge.id,children:ge.name},ge.id))]}),B.selectionMode==="checklist"&&ee.length>0&&u.jsx(Z9,{options:ee.map(ge=>({id:ge.id,name:ge.name})),value:de,onChange:ge=>k({...v,[B.key]:ge}),id:`check-${B.id}`}),B.selectionMode==="random"&&ee.length>0&&u.jsx("p",{className:"text-sm italic",children:"Random instance"}),(B.selectionMode==="dropdown"&&!we||ee.length===0)&&((Ve=B.attributes)==null?void 0:Ve.map(ge=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs mb-1",children:ge.label}),u.jsx("input",{className:"w-full p-2 border rounded",value:y[`${B.key}.${ge.key}`]||"",onChange:Ot=>_({...y,[`${B.key}.${ge.key}`]:Ot.target.value})})]},ge.key)))]},B.id)}),wr.map(B=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:B.label}),B.inputType==="textarea"?u.jsx("textarea",{className:"w-full p-2 border rounded",value:y[B.key]||"",onChange:ee=>_({...y,[B.key]:ee.target.value})}):B.inputType==="list"?u.jsx(Sm,{id:`list-${B.key}`,value:y[B.key]||[],onChange:ee=>_({...y,[B.key]:ee})}):u.jsx("input",{className:"w-full p-2 border rounded",type:B.inputType,value:y[B.key]||"",onChange:ee=>_({...y,[B.key]:ee.target.value})})]},B.key)),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"submit",className:"btn-primary",children:"Generate"}),u.jsx("input",{type:"number",min:"1",className:"p-2 border rounded w-20",value:O,onChange:B=>I(Math.max(1,parseInt(B.target.value,10)||1))})]})]})]}),A.length>0&&u.jsxs("div",{className:"overflow-x-auto table-container mt-6",children:[u.jsxs("div",{className:"relative inline-block mb-2",children:[u.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>N(B=>!B),children:"Columns"}),C&&u.jsx("div",{className:"absolute z-10 bg-white border rounded shadow p-2 right-0",children:vn.map(B=>u.jsxs("label",{className:"block whitespace-nowrap",children:[u.jsx("input",{type:"checkbox",className:"mr-1",checked:E[B.key]||!1,onChange:()=>S({...E,[B.key]:!E[B.key]})}),B.label]},B.key))}),re!=="designer"&&u.jsx("button",{type:"button",className:"btn-secondary ml-2",onClick:Dt,children:"Add Recipe Row"})]}),u.jsxs("table",{className:"ad-table min-w-full table-auto text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Recipe #"}),vn.map(B=>E[B.key]&&u.jsx("th",{children:B.label},B.key)),u.jsx("th",{className:"w-80",children:"Copy"}),u.jsx("th",{className:"text-center",children:_e?"Actions":""})]})}),u.jsx("tbody",{children:A.map((B,ee)=>u.jsxs("tr",{className:re==="designer"&&B.selected?"designer-selected":"",children:[u.jsx("td",{className:"text-center align-middle font-bold",children:B.recipeNo}),vn.map(ie=>E[ie.key]&&u.jsx("td",{className:"align-middle",children:ie.key.endsWith(".assets")?dn(B.components[ie.key]||[]):u.jsxs(u.Fragment,{children:[ht===ee&&ie.key.includes(".")?u.jsxs("select",{className:"p-1 border rounded mb-1",onChange:de=>cr(ie.key.split(".")[0],de.target.value),children:[u.jsx("option",{value:"",children:"Select..."}),l.filter(de=>{var we;return de.componentKey===ie.key.split(".")[0]&&(!((we=de.relationships)!=null&&we.brandCode)||de.relationships.brandCode===p)}).map(de=>u.jsx("option",{value:de.id,children:de.name},de.id))]}):null,ht===ee?Mn[ie.key]:B.components[ie.key]]})},ie.key)),u.jsx("td",{className:"whitespace-pre-wrap break-words w-80 align-middle copy-cell",children:ht===ee?u.jsx("textarea",{className:"w-full p-1 border rounded",value:Dn,onChange:ie=>Os(ie.target.value)}):u.jsx("div",{className:"min-h-[1.5rem] w-full",onClick:()=>navigator.clipboard.writeText(B.copy),children:B.copy})}),u.jsx("td",{className:"text-center align-middle",children:_e?u.jsxs("div",{className:"flex items-center justify-center gap-1",children:[u.jsx("button",{type:"button",onClick:()=>_s(ee),"aria-label":ht===ee?"Save":"Edit",className:"btn-secondary px-1.5 py-0.5 text-xs",children:ht===ee?u.jsx(DE,{}):u.jsx(Vd,{})}),u.jsx("button",{type:"button",onClick:()=>pi(ee),"aria-label":"Refresh",className:"btn-secondary px-1.5 py-0.5 text-xs",children:u.jsx(mN,{})}),u.jsx("button",{type:"button",onClick:()=>xr(ee),"aria-label":"Delete",className:"btn-secondary px-1.5 py-0.5 text-xs btn-delete",children:u.jsx(Ms,{})})]}):u.jsx("button",{type:"button",onClick:()=>{const ie=[...A];ie[ee].selected=!ie[ee].selected,D(ie),r&&r(ie[ee].recipeNo,ie[ee].selected)},"aria-label":"Toggle Select",children:B.selected?u.jsx(DE,{}):u.jsx(O9,{})})})]},ee))})]})]}),A.length>0&&re!=="designer"&&u.jsx("div",{className:"mt-4 text-right",children:u.jsx("button",{type:"button",className:"btn-primary",onClick:()=>t&&t(A),children:"Save Recipes"})})]})},nz=Em(ea);function qE(t){return(t||"").replace(/\//g,"-").replace(/\s+/g," ").trim()}async function rz(t,e,n,r){const s=qE(n),i=qE(r),o=`Campfire/Brands/${s}/Adgroups/${i}/${t.name}`,a=nc(nz,o);return await ow(a,t,{cacheControl:"public,max-age=31536000,immutable"}),await aw(a)}function Au(){const e=new Uint8Array(12);window.crypto.getRandomValues(e);const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return Array.from(e,r=>n[r%n.length]).join("")}const Im=({groupId:t,url:e,visibility:n="private",requireAuth:r=!1,requirePassword:s=!1,password:i="",onClose:o,onUpdate:a})=>{const[l,c]=T.useState(n),[d,f]=T.useState(r?"auth":"any"),[p,m]=T.useState(s),[x,w]=T.useState(i),y=e||(t?`${window.location.origin}/review/${t}`:""),_=()=>{navigator.clipboard.writeText(y).then(()=>window.alert("Link copied to clipboard")).catch(I=>console.error("Failed to copy link",I))},v=async(I=l,E=d,S=p,C=x)=>{if(!t)return;const N={visibility:I,requireAuth:E==="auth",requirePassword:E==="any"?S:!1,password:E==="any"&&S?C:""};try{await nt(oe(H,"adGroups",t),N),a&&a(N)}catch(j){console.error("Failed to update visibility",j)}},k=async()=>{if(l==="public")c("private"),await v("private","any",!1,""),f("any"),m(!1),w("");else{let I=x;d==="any"&&p&&!I&&(I=Au()),c("public"),w(I),await v("public",d,p,I)}},A=async I=>{const E=I.target.value;f(E),l==="public"&&await v(l,E,E==="any"?p:!1,x)},D=async()=>{const I=!p;m(I);let E=x;I&&!E&&(E=Au()),w(E),l==="public"&&d==="any"&&await v(l,d,I,E)},O=async()=>{const I=Au();w(I),l==="public"&&d==="any"&&p&&await v(l,d,!0,I)};return u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm w-full dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsx("h3",{className:"mb-2 font-semibold",children:"Public Review"}),u.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[u.jsx("input",{type:"checkbox",checked:l==="public",onChange:k}),"Enable Public Review"]}),l==="public"&&u.jsxs(u.Fragment,{children:[u.jsxs("label",{className:"block mb-3 text-sm",children:["Who can access this link?",u.jsxs("select",{value:d,onChange:A,className:"mt-1 w-full border rounded p-1 text-black dark:text-black",children:[u.jsx("option",{value:"any",children:"Anyone with the link"}),u.jsx("option",{value:"auth",children:"Only authenticated users"})]})]}),d==="any"&&u.jsxs(u.Fragment,{children:[u.jsxs("label",{className:"flex items-center gap-2 mb-3",children:[u.jsx("input",{type:"checkbox",checked:p,onChange:D}),"Require password"]}),p&&u.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[u.jsx("input",{type:"text",value:x,onChange:async I=>{const E=I.target.value;w(E),l==="public"&&d==="any"&&await v(l,d,!0,E)},className:"flex-1 border rounded p-1 text-black dark:text-black"}),u.jsx("button",{onClick:O,className:"btn-secondary px-2 py-1",children:"Generate Password"})]})]}),u.jsx("button",{onClick:_,className:"btn-primary mb-3 px-3 py-1",children:"Copy Link"})]}),u.jsx("div",{className:"text-right",children:u.jsx("button",{onClick:o,className:"btn-secondary px-3 py-1",children:"Close"})})]})})},sz=new Set(["pending","ready","approved","rejected","edit_requested","archived","draft","reviewed","in_review","review_pending","mixed"]),Ru=({status:t,className:e=""})=>{if(!t)return null;const n=String(t).replace(/\s+/g,"_").toLowerCase(),r=sz.has(n)?`status-${n}`:"status-default";return u.jsx("span",{className:`status-badge ${r} ${e}`.trim(),children:t})};function iz(t=[]){if(!t||t.length===0)return null;const e=["9x16","3x5","1x1","4x5","Pinterest","Snapchat"],n=r=>r.aspectRatio||Qt(r.filename||"").aspectRatio||"";for(const r of e){const s=t.find(i=>n(i)===r);if(s)return s}return t[0]}const oz=()=>{var Sn;const{id:t}=OI(),[e,n]=T.useState(null),[r,s]=T.useState(""),[i,o]=T.useState([]),[a,l]=T.useState(!1),[c,d]=T.useState(!1),[f,p]=T.useState(null),[m,x]=T.useState({}),[w,y]=T.useState(!1),[_,v]=T.useState(null),[k,A]=T.useState(null),[D,O]=T.useState(null),[I,E]=T.useState({}),[S,C]=T.useState(null),[N,j]=T.useState({offer:"",angle:"",audience:""}),[P,ne]=T.useState(!1),[ae,F]=T.useState([]),[W,V]=T.useState(1),[G,re]=T.useState(0),[_e,ke]=T.useState(!1),[Ie,Oe]=T.useState(!1),[Dt,ht]=T.useState(!1),wt=T.useRef(null),{role:Dn}=Qa((Sn=Me.currentUser)==null?void 0:Sn.uid),Os=M=>{let $=0,L=0,K=0,Q=0,z="";return M.forEach(ve=>{!z&&(ve.thumbnailUrl||ve.firebaseUrl)&&(z=ve.thumbnailUrl||ve.firebaseUrl),ve.status!=="ready"&&($+=1),ve.status==="approved"&&(L+=1),ve.status==="edit_requested"&&(K+=1),ve.status==="rejected"&&(Q+=1)}),{reviewed:$,approved:L,edit:K,rejected:Q,thumbnail:z}};T.useEffect(()=>{(async()=>{const L=await Qr(oe(H,"adGroups",t));L.exists()&&n({id:L.id,...L.data()})})();const $=fp(be(H,"adGroups",t,"assets"),L=>{const K=L.docs.map(Q=>({id:Q.id,...Q.data()}));o(K)});return()=>$()},[t]),T.useEffect(()=>{const M=fp(be(H,"adGroups",t,"recipes"),$=>{const L={};$.docs.forEach(K=>{const Q=K.data()||{},z=Q.metadata||{};L[K.id]={id:K.id,...z,components:Q.components||{},copy:Q.copy||"",assets:Q.assets||[],type:Q.type||"",selected:Q.selected||!1}}),E(L)});return()=>M()},[t]),T.useEffect(()=>{(async()=>{if(e!=null&&e.brandCode)try{const $=un(be(H,"brands"),Nt("code","==",e.brandCode)),L=await Le($);L.empty?s(e.brandCode):s(L.docs[0].data().name||e.brandCode)}catch($){console.error("Failed to fetch brand name",$),s(e.brandCode)}})()},[e==null?void 0:e.brandCode]),T.useEffect(()=>{e&&(wt.current={reviewed:e.reviewedCount||0,approved:e.approvedCount||0,edit:e.editCount||0,rejected:e.rejectedCount||0})},[e]),T.useEffect(()=>{if(!e)return;const M=Os(i),$=wt.current||{};if(M.reviewed!==$.reviewed||M.approved!==$.approved||M.edit!==$.edit||M.rejected!==$.rejected||!e.thumbnailUrl&&M.thumbnail){const K={reviewedCount:M.reviewed,approvedCount:M.approved,editCount:M.edit,rejectedCount:M.rejected,lastUpdated:mn(),...e.thumbnailUrl?{}:M.thumbnail?{thumbnailUrl:M.thumbnail}:{}},Q=Nv(i,e.status);Q!==e.status&&(K.status=Q),nt(oe(H,"adGroups",t),K).catch(z=>console.error("Failed to update summary",z)),wt.current=M,n(z=>({...z,...K}))}},[i,e,t]);const Mn=T.useMemo(()=>{const M={};i.forEach(K=>{const Q=Qt(K.filename||""),z=Q.recipeCode||"unknown",ve=Q.aspectRatio||"",le={...K,recipeCode:z,aspectRatio:ve};M[z]||(M[z]=[]),M[z].push(le)});const $={"3x5":0,"9x16":1,"1x1":2},L=Object.entries(M).map(([K,Q])=>(Q.sort((z,ve)=>{const le=($[z.aspectRatio]??99)-($[ve.aspectRatio]??99);return le!==0?le:(z.version||1)-(ve.version||1)}),{recipeCode:K,assets:Q}));return L.sort((K,Q)=>Number(K.recipeCode)-Number(Q.recipeCode)),L},[i]),Ur=T.useMemo(()=>Object.keys(I).length,[I]),_s=T.useMemo(()=>{const M=Object.keys(I);return M.sort(($,L)=>Number($)-Number(L)),M.map($=>({recipeNo:Number($),components:I[$].components||{},copy:I[$].copy||"",assets:I[$].assets||[],type:I[$].type||"",selected:I[$].selected||!1}))},[I]),xr=T.useMemo(()=>{const M={pending:0,ready:0,approved:0,rejected:0,edit_requested:0};return i.forEach($=>{M[$.status]!==void 0&&(M[$.status]+=1)}),M},[i]);function cr(M){const $=Array.from(new Set(M.map(L=>L.status)));return $.length===1?$[0]:"mixed"}const dn=T.useMemo(()=>Mn.filter(M=>["rejected","edit_requested"].includes(cr(M.assets))),[Mn]),pi=T.useMemo(()=>Mn.filter(M=>!["rejected","edit_requested"].includes(cr(M.assets))),[Mn]),Ce=M=>{x($=>({...$,[M]:!$[M]}))},mi=async M=>{try{const $=i.filter(Q=>(Qt(Q.filename||"").recipeCode||"unknown")===M),L=Q=>{var z;return((z=Q==null?void 0:Q.toMillis)==null?void 0:z.call(Q))??(typeof Q=="number"?Q:0)},K=[];for(const Q of $)(await Le(un(be(H,"adGroups",t,"assets",Q.id,"history"),bv("updatedAt","desc")))).docs.forEach(ve=>{const le=ve.data()||{};K.push({lastUpdatedAt:le.updatedAt,email:le.updatedBy||"N/A",status:le.status,comment:le.comment||""})});K.sort((Q,z)=>L(z.lastUpdatedAt)-L(Q.lastUpdatedAt)),v({recipeCode:M,assets:K})}catch($){console.error("Failed to load recipe history",$)}},ss=async M=>{try{const L=(await Le(un(be(H,"adGroups",t,"assets",M.id,"history"),bv("updatedAt","desc")))).docs.map(K=>({lastUpdatedAt:K.data().updatedAt,email:K.data().updatedBy||"N/A",status:K.data().status,comment:K.data().comment||""}));A({filename:M.filename,assets:L})}catch($){console.error("Failed to load ad history",$)}},wr=M=>{const $=i.filter(L=>(Qt(L.filename||"").recipeCode||"unknown")===M);O({recipeCode:M,assets:$})};T.useEffect(()=>{if(S){const M=I[S.id]||I[S.id.toLowerCase()]||S;j({offer:M.offer||"",angle:M.angle||"",audience:M.audience||""})}},[S,I]);const vn=()=>{v(null),A(null),O(null),C(null)},gi=async()=>{if(!e)return;const M=e.status==="in review"?Nv(i,"pending"):"in review";try{await nt(oe(H,"adGroups",t),{status:M}),n($=>({...$,status:M}))}catch($){console.error("Failed to toggle lock",$)}},Ls=async()=>{if(!(!e||!window.confirm("Reset this group to pending?")))try{const $=Th(H);i.forEach(L=>{$.update(oe(H,"adGroups",t,"assets",L.id),{status:"pending",lastUpdatedBy:null,lastUpdatedAt:mn()})}),$.update(oe(H,"adGroups",t),{status:"pending"}),await $.commit(),o(L=>L.map(K=>({...K,status:"pending"}))),n(L=>({...L,status:"pending"}))}catch($){console.error("Failed to reset group",$)}},Br=async()=>{var M;if(e&&window.confirm("Archive this group?"))try{await nt(oe(H,"adGroups",t),{status:"archived",archivedAt:mn(),archivedBy:((M=Me.currentUser)==null?void 0:M.uid)||null}),n($=>({...$,status:"archived"}))}catch($){console.error("Failed to archive group",$)}},br=async()=>{if(e)try{await nt(oe(H,"adGroups",t),{status:"pending",archivedAt:null,archivedBy:null}),n(M=>({...M,status:"pending"}))}catch(M){console.error("Failed to restore group",M)}},bt=async M=>{if(!M||M.length===0)return;if((e==null?void 0:e.status)!=="in review"&&(e==null?void 0:e.status)!=="pending")try{await nt(oe(H,"adGroups",t),{status:"pending"}),n(z=>({...z,status:"pending"}))}catch(z){console.error("Failed to update group status",z)}const $=new Set(i.map(z=>z.filename)),L=new Set,K=[],Q=[];for(const z of Array.from(M))$.has(z.name)||L.has(z.name)?Q.push(z.name):(L.add(z.name),K.push(z));if(Q.length>0&&window.alert(`Duplicate files skipped: ${Q.join(", ")}`),K.length!==0){l(!0);for(const z of K)try{const ve=await rz(z,t,r||(e==null?void 0:e.brandCode),(e==null?void 0:e.name)||t),le=Qt(z.name);let Re=null;if(le.version&&le.version>1){const je=z.name.replace(/_V\d+\.[^/.]+$/,""),Ke=i.find(st=>st.filename.replace(/_V\d+\.[^/.]+$/,"")===je);if(Ke){Re=Ke.id;try{await nt(oe(H,"adGroups",t,"assets",Ke.id),{status:"archived"})}catch(st){console.error("Failed to archive previous version",st)}}}await Vr(be(H,"adGroups",t,"assets"),{adGroupId:t,brandCode:le.brandCode||(e==null?void 0:e.brandCode)||"",adGroupCode:le.adGroupCode||"",recipeCode:le.recipeCode||"",aspectRatio:le.aspectRatio||"",filename:z.name,firebaseUrl:ve,uploadedAt:mn(),status:"pending",comment:null,lastUpdatedBy:null,lastUpdatedAt:mn(),version:le.version||1,parentAdId:Re,isResolved:!1})}catch(ve){console.error("Upload failed",ve)}l(!1)}},Mt=async()=>{if(S)try{await li(oe(H,"adGroups",t,"recipes",S.id),{metadata:N},{merge:!0}),E(M=>({...M,[S.id]:{id:S.id,...N}})),C(null)}catch(M){console.error("Failed to save metadata",M)}},Er=async M=>{if(!(!Array.isArray(M)||M.length===0))try{if(Ie&&Object.keys(I).length>0&&!window.confirm("Replace existing saved recipes with new generation?"))return;const $=Th(H),L=Object.keys(I),K=M.map(Q=>String(Q.recipeNo));L.forEach(Q=>{K.includes(Q)||$.delete(oe(H,"adGroups",t,"recipes",Q))}),M.forEach(Q=>{const z=oe(H,"adGroups",t,"recipes",String(Q.recipeNo));$.set(z,{components:Q.components,copy:Q.copy,assets:Q.assets||[],type:Q.type||"",selected:Q.selected||!1},{merge:!0})}),await $.commit(),Oe(!1),ht(!1)}catch($){console.error("Failed to save recipes",$)}},B=async(M,$)=>{try{await nt(oe(H,"adGroups",t,"recipes",String(M)),{selected:$}),E(L=>({...L,[M]:{...L[M]||{},selected:$}}))}catch(L){console.error("Failed to update selection",L)}},ee=async(M,$,L="")=>{var ve,le,Re;const K=i.filter(je=>(Qt(je.filename||"").recipeCode||"unknown")===M);if(K.length===0)return;const Q=iz(K),z=Th(H);K.forEach(je=>{var Ke;z.update(oe(H,"adGroups",t,"assets",je.id),{status:$,lastUpdatedBy:((Ke=Me.currentUser)==null?void 0:Ke.uid)||null,lastUpdatedAt:mn()})});try{await z.commit(),Q&&await Vr(be(H,"adGroups",t,"assets",Q.id,"history"),{status:$,updatedBy:((ve=Me.currentUser)==null?void 0:ve.uid)||null,updatedAt:mn()}).catch(je=>{if((je==null?void 0:je.code)==="already-exists")console.log("History entry already exists, skipping");else throw je}),await li(oe(H,"recipes",M),{history:ER({timestamp:Date.now(),status:$,user:((le=Me.currentUser)==null?void 0:le.displayName)||((Re=Me.currentUser)==null?void 0:Re.uid)||"unknown",...L?{editComment:L}:{}})},{merge:!0}),o(je=>je.map(Ke=>K.some(st=>st.id===Ke.id)?{...Ke,status:$}:Ke))}catch(je){console.error("Failed to update recipe status",je)}},ie=async()=>{d(!0);try{const M=Th(H),$=i.filter(L=>L.status==="pending");for(const L of $)M.update(oe(H,"adGroups",t,"assets",L.id),{status:"ready",lastUpdatedBy:null,lastUpdatedAt:mn()});M.update(oe(H,"adGroups",t),{status:"ready"}),await M.commit(),$.length>0&&o(L=>L.map(K=>$.some(Q=>Q.id===K.id)?{...K,status:"ready"}:K))}catch(M){console.error("Failed to mark ready",M)}finally{d(!1)}},[de,we]=T.useState(!1),Ve=()=>{we(!0)},ge=M=>(M||"").replace(/[\\/:*?"<>|]/g,"").replace(/\s+/g," ").trim()||"unknown",Ot=()=>{const M=i.filter(L=>L.status==="approved"),$={};return M.forEach(L=>{const K=Qt(L.filename||""),Q=I[K.recipeCode]||{},ve=ae.map(le=>ge(Q[le])).join("|");$[ve]||($[ve]=[]),$[ve].push({asset:L,meta:Q})}),Object.values($)};T.useEffect(()=>{if(!P)return;const M=Ot();re(M.length)},[P,ae,W,i,I]);const _n=T.useMemo(()=>{const M=new Uint32Array(256);for(let $=0;$<256;$+=1){let L=$;for(let K=0;K<8;K+=1)L=L&1?3988292384^L>>>1:L>>>1;M[$]=L>>>0}return M},[]),kr=M=>{let $=4294967295;for(let L=0;L<M.length;L+=1)$=_n[($^M[L])&255]^$>>>8;return($^4294967295)>>>0},Tr=async M=>{const $=new TextEncoder,L=[],K=[];let Q=0;for(const Ct of M){const Bt=$.encode(Ct.path),Ye=new Uint8Array(Ct.data),et=kr(Ye),yt=new Uint8Array(30+Bt.length),ft=new DataView(yt.buffer);ft.setUint32(0,67324752,!0),ft.setUint16(4,20,!0),ft.setUint16(6,0,!0),ft.setUint16(8,0,!0),ft.setUint16(10,0,!0),ft.setUint16(12,0,!0),ft.setUint32(14,et,!0),ft.setUint32(18,Ye.length,!0),ft.setUint32(22,Ye.length,!0),ft.setUint16(26,Bt.length,!0),ft.setUint16(28,0,!0),yt.set(Bt,30),L.push(yt,Ye);const it=new Uint8Array(46+Bt.length),qe=new DataView(it.buffer);qe.setUint32(0,33639248,!0),qe.setUint16(4,20,!0),qe.setUint16(6,20,!0),qe.setUint16(8,0,!0),qe.setUint16(10,0,!0),qe.setUint16(12,0,!0),qe.setUint16(14,0,!0),qe.setUint32(16,et,!0),qe.setUint32(20,Ye.length,!0),qe.setUint32(24,Ye.length,!0),qe.setUint16(28,Bt.length,!0),qe.setUint16(30,0,!0),qe.setUint16(32,0,!0),qe.setUint16(34,0,!0),qe.setUint16(36,0,!0),qe.setUint32(38,0,!0),qe.setUint32(42,Q,!0),it.set(Bt,46),K.push(it),Q+=yt.length+Ye.length}const z=Q,ve=K.reduce((Ct,Bt)=>Ct+Bt.length,0),le=new Uint8Array(22),Re=new DataView(le.buffer);Re.setUint32(0,101010256,!0),Re.setUint16(8,M.length,!0),Re.setUint16(10,M.length,!0),Re.setUint32(12,ve,!0),Re.setUint32(16,z,!0),Re.setUint16(20,0,!0);const je=L.reduce((Ct,Bt)=>Ct+Bt.length,0)+ve+le.length,Ke=new Uint8Array(je);let st=0;for(const Ct of L)Ke.set(Ct,st),st+=Ct.length;for(const Ct of K)Ke.set(Ct,st),st+=Ct.length;return Ke.set(le,st),new Blob([Ke],{type:"application/zip"})},xs=async()=>{ke(!0);try{const M=Ot(),$=[];for(const z of M){if(z.length===0)continue;const ve=z[0].meta,le=ae.map(je=>ge(ve[je])).join("-")||"group",Re=z.slice(0,W);for(const{asset:je}of Re){const st=await(await fetch(je.firebaseUrl)).arrayBuffer();$.push({path:`${le}/${je.filename}`,data:st})}}if($.length===0){window.alert("No approved ads found");return}const L=await Tr($),K=URL.createObjectURL(L),Q=document.createElement("a");Q.href=K,Q.download=`${(e==null?void 0:e.name)||"export"}.zip`,document.body.appendChild(Q),Q.click(),Q.remove(),URL.revokeObjectURL(K),ne(!1)}catch(M){console.error("Export failed",M),window.alert("Export failed")}finally{ke(!1)}},rt=async M=>{if(window.confirm("Delete this asset?"))try{await Dr(oe(H,"adGroups",t,"assets",M.id));try{await Dr(oe(H,"adAssets",M.id))}catch{}if(M.filename||M.firebaseUrl)try{const L=nc(Av,M.firebaseUrl||`Campfire/Brands/${r||(e==null?void 0:e.brandCode)}/Adgroups/${(e==null?void 0:e.name)||t}/${M.filename}`);await Sv(L)}catch(L){console.error("Failed to delete storage file",L)}o(L=>L.filter(K=>K.id!==M.id))}catch(L){console.error("Failed to delete asset",L)}},ur=async M=>{if(!window.confirm("Delete this recipe and all assets?"))return;const L=i.filter(K=>(Qt(K.filename||"").recipeCode||"unknown")===M);try{await Promise.all(L.map(async K=>{await Dr(oe(H,"adGroups",t,"assets",K.id));try{await Dr(oe(H,"adAssets",K.id))}catch{}if(K.filename||K.firebaseUrl)try{const Q=nc(Av,K.firebaseUrl||`Campfire/Brands/${r||(e==null?void 0:e.brandCode)}/Adgroups/${(e==null?void 0:e.name)||t}/${K.filename}`);await Sv(Q)}catch(Q){console.error("Failed to delete storage file",Q)}})),o(K=>K.filter(Q=>!L.some(z=>z.id===Q.id)))}catch(K){console.error("Failed to delete recipe assets",K)}},zr=M=>{var $;return u.jsx("tbody",{className:"table-row-group",children:u.jsxs("tr",{onClick:()=>Ce(M.recipeCode),className:"cursor-pointer recipe-row",children:[u.jsxs("td",{colSpan:"2",className:"font-semibold relative",children:["Recipe ",M.recipeCode,u.jsx("div",{className:`asset-panel absolute left-0 w-full ${m[M.recipeCode]?"open":""}`,children:u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsx("table",{className:"ad-table min-w-max w-full",children:u.jsx("tbody",{children:M.assets.map(L=>u.jsxs("tr",{className:"asset-row",children:[u.jsx("td",{className:"break-all",children:L.filename}),u.jsx("td",{className:"text-center",children:L.version||1}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx(Ru,{status:L.status}),L.status==="edit_requested"&&L.comment&&u.jsx("span",{className:"italic text-xs",children:L.comment})]})}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{onClick:K=>{K.stopPropagation(),ss(L)},className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1","aria-label":"History",children:u.jsx(ME,{})}),u.jsx("button",{onClick:K=>{K.stopPropagation(),rt(L)},className:"btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},L.id))})})})})]}),u.jsxs("td",{className:"flex flex-col",children:[Dn==="designer"||Dn==="client"?cr(M.assets)==="pending"?u.jsxs("select",{className:"status-select status-pending",value:"pending",onChange:L=>{L.stopPropagation(),ee(M.recipeCode,L.target.value)},children:[u.jsx("option",{value:"pending",children:"pending"}),u.jsx("option",{value:"ready",children:"ready"})]}):u.jsx(Ru,{status:cr(M.assets)}):u.jsxs("select",{className:`status-select status-${cr(M.assets)}`,value:cr(M.assets),onChange:L=>{L.stopPropagation(),ee(M.recipeCode,L.target.value)},children:[u.jsx("option",{value:"pending",children:"pending"}),u.jsx("option",{value:"ready",children:"ready"}),u.jsx("option",{value:"approved",children:"approved"}),u.jsx("option",{value:"rejected",children:"rejected"}),u.jsx("option",{value:"edit_requested",children:"edit_requested"}),u.jsx("option",{value:"archived",children:"archived"}),u.jsx("option",{value:"mixed",disabled:!0,children:"mixed"})]}),M.assets.find(L=>L.status==="edit_requested"&&L.comment)&&u.jsx("span",{className:"italic text-xs mt-1 max-w-[20rem] block",children:($=M.assets.find(L=>L.status==="edit_requested"&&L.comment))==null?void 0:$.comment})]}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs("button",{onClick:L=>{L.stopPropagation(),wr(M.recipeCode)},className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"View",children:[u.jsx(Ud,{}),u.jsx("span",{className:"ml-1",children:"View"})]}),u.jsxs("button",{onClick:L=>{L.stopPropagation(),mi(M.recipeCode)},className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"History",children:[u.jsx(ME,{}),u.jsx("span",{className:"ml-1",children:"History"})]}),Dn==="admin"&&u.jsxs("button",{onClick:L=>{L.stopPropagation(),C(I[M.recipeCode]||I[M.recipeCode.toLowerCase()]||{id:M.recipeCode})},className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"Metadata",children:[u.jsx(jE,{}),u.jsx("span",{className:"ml-1",children:"Metadata"})]}),u.jsx("button",{onClick:L=>{L.stopPropagation(),ur(M.recipeCode)},className:"btn-delete text-xs","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]})},M.recipeCode)};return e?u.jsxs("div",{className:"min-h-screen p-4 ",children:[u.jsx("h1",{className:"text-2xl mb-2",children:e.name}),u.jsxs("p",{className:"text-sm text-gray-500 flex flex-wrap items-center gap-2",children:["Brand: ",e.brandCode,u.jsx("span",{className:"hidden sm:inline",children:"|"}),"Status: ",u.jsx(Ru,{status:e.status})]}),e.status==="archived"&&u.jsx("p",{className:"text-red-500 text-sm mb-2",children:"This ad group is archived and read-only."}),u.jsxs("div",{className:"text-sm text-gray-500 mb-4 flex flex-wrap items-center gap-2",children:[(Dn==="admin"||Dn==="agency")&&u.jsx(u.Fragment,{children:e.status==="archived"?u.jsx(u.Fragment,{children:Dn==="admin"&&u.jsxs("button",{onClick:br,className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(pN,{}),"Restore"]})}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:()=>Oe(!0),className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(mN,{}),"Recipes"]}),u.jsx("input",{id:"upload-input",type:"file",multiple:!0,onChange:M=>{const $=M.target.files;bt($),M.target.value=null},className:"hidden"}),u.jsxs("button",{onClick:()=>document.getElementById("upload-input").click(),className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(BE,{}),"Upload"]}),u.jsxs("button",{onClick:gi,className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[e.status==="in review"?u.jsx(F9,{}):u.jsx(P9,{}),e.status==="in review"?"Unlock":"Lock"]}),u.jsxs("button",{onClick:Ls,className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(D9,{}),"Reset"]}),u.jsxs("button",{onClick:ie,disabled:c||i.length===0||e.status==="ready"||e.status==="in review",className:"btn-primary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(yp,{}),c?"Processing...":"Ready"]}),u.jsxs(So,{to:`/review/${t}`,className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(jE,{}),"Review"]}),u.jsxs("button",{onClick:Ve,className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(M9,{}),"Share"]}),Dn==="admin"&&u.jsxs("button",{onClick:()=>ne(!0),className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(C9,{}),"Export Approved"]}),Dn==="admin"&&u.jsxs("button",{onClick:Br,className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(hN,{}),"Archive"]})]})}),Dn==="designer"&&e.status!=="archived"&&u.jsxs(u.Fragment,{children:[u.jsx("input",{id:"upload-input",type:"file",multiple:!0,onChange:M=>{const $=M.target.files;bt($),M.target.value=null},className:"hidden"}),u.jsxs("button",{onClick:()=>document.getElementById("upload-input").click(),className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:[u.jsx(BE,{}),"Upload"]})]})]}),a&&u.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Uploading..."}),!w&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-4",children:[u.jsxs("div",{className:"stat-card",children:[u.jsx("p",{className:"stat-card-title",children:"Recipes"}),u.jsx("p",{className:"stat-card-value",children:Ur})]}),u.jsxs("div",{className:"stat-card",children:[u.jsx("p",{className:"stat-card-title",children:"Total Ads"}),u.jsx("p",{className:"stat-card-value",children:i.length})]})]}),u.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-4",children:[u.jsxs("div",{className:"stat-card status-pending",children:[u.jsx("p",{className:"stat-card-title",children:"Pending"}),u.jsx("p",{className:"stat-card-value",children:xr.pending})]}),u.jsxs("div",{className:"stat-card status-ready",children:[u.jsx("p",{className:"stat-card-title",children:"Ready"}),u.jsx("p",{className:"stat-card-value",children:xr.ready})]}),u.jsxs("div",{className:"stat-card status-approved",children:[u.jsx("p",{className:"stat-card-title",children:"Approved"}),u.jsx("p",{className:"stat-card-value",children:xr.approved})]}),u.jsxs("div",{className:"stat-card status-rejected",children:[u.jsx("p",{className:"stat-card-title",children:"Rejected"}),u.jsx("p",{className:"stat-card-value",children:xr.rejected})]}),u.jsxs("div",{className:"stat-card status-edit_requested",children:[u.jsx("p",{className:"stat-card-title",children:"Edit"}),u.jsx("p",{className:"stat-card-value",children:xr.edit_requested})]})]})]}),(w||dn.length>0)&&u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsxs("table",{className:"ad-table min-w-max",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Filename"}),u.jsx("th",{children:"Version"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Actions"})]})}),[...dn,...w?pi:[]].map(M=>zr(M))]})}),u.jsxs("div",{className:"flex my-4",children:[u.jsx("button",{onClick:()=>y(M=>!M),className:"btn-secondary px-2 py-0.5 flex items-center gap-1",children:w?"Hide Table":"Show All Ads"}),_s.length>0&&u.jsx("button",{onClick:()=>ht(M=>!M),className:"btn-secondary px-2 py-0.5 flex items-center gap-1 ml-2",children:Dt?"Hide Recipes":"Show Brief"})]}),Dt&&_s.length>0&&u.jsx("div",{className:"my-4",children:u.jsx(Pv,{onSave:Er,initialResults:_s,showOnlyResults:!0,onSelectChange:B})}),D&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-md dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsxs("h3",{className:"mb-2 font-semibold",children:["Recipe ",D.recipeCode]}),u.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-[60vh] overflow-auto",children:D.assets.map(M=>u.jsx(Zn,{pngUrl:M.thumbnailUrl||M.firebaseUrl,alt:M.filename,className:"w-full object-contain max-h-40"},M.id))}),u.jsx("button",{onClick:vn,className:"mt-2 btn-primary px-3 py-1",children:"Close"})]})}),_&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-md dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsxs("h3",{className:"mb-2 font-semibold",children:["Recipe ",_.recipeCode," History"]}),u.jsx("ul",{className:"mb-2 space-y-2 max-h-[60vh] overflow-auto",children:_.assets.map((M,$)=>u.jsxs("li",{className:"border-b pb-2 last:border-none",children:[u.jsxs("div",{className:"text-sm font-medium",children:[M.lastUpdatedAt?M.lastUpdatedAt.toDate?M.lastUpdatedAt.toDate().toLocaleString():new Date(M.lastUpdatedAt).toLocaleString():""," ","- ",M.email]}),u.jsxs("div",{className:"text-sm",children:["Status: ",M.status]}),M.comment&&u.jsxs("div",{className:"text-sm italic",children:["Note: ",M.comment]})]},$))}),u.jsx("button",{onClick:vn,className:"btn-primary px-3 py-1",children:"Close"})]})}),k&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-md dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsxs("h3",{className:"mb-2 font-semibold",children:["Ad ",k.filename," History"]}),u.jsx("ul",{className:"mb-2 space-y-2 max-h-[60vh] overflow-auto",children:k.assets.map((M,$)=>u.jsxs("li",{className:"border-b pb-2 last:border-none",children:[u.jsxs("div",{className:"text-sm font-medium",children:[M.lastUpdatedAt?M.lastUpdatedAt.toDate?M.lastUpdatedAt.toDate().toLocaleString():new Date(M.lastUpdatedAt).toLocaleString():""," ","- ",M.email]}),u.jsxs("div",{className:"text-sm",children:["Status: ",M.status]}),M.comment&&u.jsxs("div",{className:"text-sm italic",children:["Note: ",M.comment]})]},$))}),u.jsx("button",{onClick:vn,className:"btn-primary px-3 py-1",children:"Close"})]})}),S&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsxs("h3",{className:"mb-2 font-semibold",children:["Metadata for Recipe ",S.id]}),u.jsxs("div",{className:"space-y-2",children:[S.components&&u.jsx("div",{className:"text-sm",children:Object.entries(S.components).map(([M,$])=>u.jsxs("div",{children:[u.jsxs("span",{className:"font-semibold mr-1",children:[M,":"]}),$]},M))}),S.copy&&u.jsx("div",{className:"text-sm whitespace-pre-wrap border-t pt-2",children:S.copy}),u.jsxs("label",{className:"block text-sm",children:["Offer",u.jsx("input",{type:"text",className:"mt-1 w-full border rounded p-1 text-black dark:text-black",value:N.offer,onChange:M=>j({...N,offer:M.target.value})})]}),u.jsxs("label",{className:"block text-sm",children:["Angle",u.jsx("input",{type:"text",className:"mt-1 w-full border rounded p-1 text-black dark:text-black",value:N.angle,onChange:M=>j({...N,angle:M.target.value})})]}),u.jsxs("label",{className:"block text-sm",children:["Audience",u.jsx("input",{type:"text",className:"mt-1 w-full border rounded p-1 text-black dark:text-black",value:N.audience,onChange:M=>j({...N,audience:M.target.value})})]})]}),u.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[u.jsx("button",{onClick:vn,className:"btn-secondary px-3 py-1",children:"Cancel"}),u.jsx("button",{onClick:Mt,className:"btn-primary px-3 py-1",children:"Save"})]})]})}),P&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm w-full dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsx("h3",{className:"mb-2 font-semibold",children:"Export Approved Ads"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium mb-1",children:"Group By"}),u.jsxs("label",{className:"mr-2 text-sm",children:[u.jsx("input",{type:"checkbox",className:"mr-1",checked:ae.includes("offer"),onChange:M=>{M.target.checked?F($=>[...$,"offer"]):F($=>$.filter(L=>L!=="offer"))}}),"Offer"]}),u.jsxs("label",{className:"mr-2 text-sm",children:[u.jsx("input",{type:"checkbox",className:"mr-1",checked:ae.includes("angle"),onChange:M=>{M.target.checked?F($=>[...$,"angle"]):F($=>$.filter(L=>L!=="angle"))}}),"Angle"]}),u.jsxs("label",{className:"text-sm",children:[u.jsx("input",{type:"checkbox",className:"mr-1",checked:ae.includes("audience"),onChange:M=>{M.target.checked?F($=>[...$,"audience"]):F($=>$.filter(L=>L!=="audience"))}}),"Audience"]})]}),u.jsxs("label",{className:"block text-sm",children:["Max Ads per Group",u.jsxs("select",{className:"mt-1 w-full border rounded p-1 text-black dark:text-black",value:W,onChange:M=>V(Number(M.target.value)),children:[u.jsx("option",{value:1,children:"1"}),u.jsx("option",{value:2,children:"2"}),u.jsx("option",{value:3,children:"3"})]})]}),u.jsxs("p",{className:"text-sm",children:["Preview Groups: ",G]})]}),u.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>ne(!1),className:"btn-secondary px-3 py-1",children:"Cancel"}),u.jsx("button",{onClick:xs,disabled:_e,className:"btn-primary px-3 py-1",children:_e?"Exporting...":"Export"})]})]})}),Ie&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-[50rem] w-full overflow-auto max-h-[90vh] relative dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsx("button",{onClick:()=>Oe(!1),className:"absolute top-2 right-2 btn-secondary px-3 py-1",children:"Close"}),u.jsx(Pv,{onSave:Er})]})}),de&&u.jsx(Im,{groupId:t,visibility:e==null?void 0:e.visibility,requireAuth:e==null?void 0:e.requireAuth,requirePassword:e==null?void 0:e.requirePassword,password:e==null?void 0:e.password,onClose:()=>we(!1),onUpdate:M=>n($=>({...$,...M}))})]}):u.jsx(Bd,{})},gN=async t=>{const e=await x6(t);await Promise.all(e.items.map(n=>Sv(n))),await Promise.all(e.prefixes.map(n=>gN(n)))};async function yN(t,e,n){const r=await Le(be(H,"adGroups",t,"assets"));await Promise.all(r.docs.map(a=>Dr(oe(H,"adGroups",t,"assets",a.id))));const s=un(be(H,"adAssets"),Nt("adGroupId","==",t)),i=await Le(s);await Promise.all(i.docs.map(a=>Dr(oe(H,"adAssets",a.id))));const o=`Campfire/Brands/${e}/Adgroups/${n}`;await gN(nc(Av,o)),await Dr(oe(H,"adGroups",t))}const az=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState(null),o=Me.currentUser,{brandCodes:a}=Qa(o==null?void 0:o.uid),[l,c]=T.useState(null);return T.useEffect(()=>{(async()=>{var f;r(!0);try{let p;a&&a.length>0?p=un(be(H,"adGroups"),Nt("brandCode","in",a)):p=un(be(H,"adGroups"),Nt("uploadedBy","==",((f=Me.currentUser)==null?void 0:f.uid)||""),Nt("status","not-in",["archived"]));const m=await Le(p),w=(await Promise.all(m.docs.map(async y=>{const _=y.data();let v=_.recipeCount;if(v===void 0)try{v=(await Le(be(H,"adGroups",y.id,"recipes"))).size}catch(k){console.error("Failed to load recipes",k),v=0}return{id:y.id,..._,recipeCount:v}}))).filter(y=>y.status!=="archived");e(w)}catch(p){console.error("Failed to fetch groups",p),e([])}finally{r(!1)}})()},[a]),u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Designer Dashboard"}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-xl mb-2",children:"My Ad Groups"}),n?u.jsx("p",{children:"Loading groups..."}):t.length===0?u.jsx("p",{children:"No ad groups found."}):u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:t.map(d=>u.jsxs(So,{to:`/ad-group/${d.id}`,className:"flex flex-col items-center",children:[u.jsx("div",{className:"w-32 h-32 bg-accent-10 border border-accent rounded-2xl flex items-center justify-center",children:u.jsx("span",{className:"text-accent font-bold text-2xl",children:d.recipeCount})}),u.jsx("p",{className:"mt-2 font-semibold text-center text-black dark:text-[var(--dark-text)] mb-0",children:d.name}),u.jsx("p",{className:"text-black dark:text-[var(--dark-text)] text-sm text-center",children:d.brandCode})]},d.id))})]}),s&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsx("p",{className:"mb-4 whitespace-pre-wrap",children:s}),u.jsx("button",{onClick:()=>i(null),className:"btn-primary px-3 py-1",children:"Close"})]})}),l&&u.jsx(Im,{url:l.url,password:l.password,onClose:()=>c(null)})]})},lz=({group:t})=>{const e=T.useMemo(()=>t.previewAds.map(()=>Math.random()*10-5),[t.id,t.previewAds.length]),n=t.previewAds[0]||{},r=Qt(n.filename||""),s=(n.aspectRatio||r.aspectRatio||"9x16").replace("x","/");return u.jsxs(So,{to:`/review/${t.id}`,className:"block text-center p-3",children:[u.jsx("div",{className:"relative mb-2",style:{aspectRatio:s},children:t.previewAds.map((i,o)=>u.jsx(Zn,{pngUrl:i.thumbnailUrl||i.firebaseUrl,alt:t.name,className:"absolute inset-0 w-full h-full object-cover rounded shadow",style:{transform:`rotate(${e[o]}deg)`,zIndex:o+1,top:`${-o*4}px`,left:`${o*4}px`}},i.id))}),u.jsxs("div",{className:"flex justify-center items-center gap-2 mb-1 text-sm",children:[t.status!=="ready"&&u.jsx(Ru,{status:t.status}),t.hasReady?u.jsx("span",{className:"tag tag-new",children:"New!"}):t.counts.approved>0?u.jsxs("span",{className:"tag bg-green-500 text-white",children:[t.counts.approved," Approved"]}):null]}),u.jsx("h3",{className:"font-medium text-gray-700 dark:text-white",children:t.name})]})},cz=({user:t,brandCodes:e=[]})=>{const[n,r]=T.useState([]),[s,i]=T.useState(!0);return T.useEffect(()=>{(async()=>{if(!(t!=null&&t.uid)||e.length===0){r([]),i(!1);return}i(!0);try{const a=un(be(H,"adGroups"),Nt("brandCode","in",e),Nt("status","==","ready")),l=await Le(a),c=await Promise.all(l.docs.map(async d=>{var y;const f=d.data(),p={id:d.id,...f,thumbnail:f.thumbnailUrl||"",lastUpdated:(y=f.lastUpdated)!=null&&y.toDate?f.lastUpdated.toDate():null,counts:{reviewed:f.reviewedCount||0,approved:f.approvedCount||0,edit:f.editCount||0,rejected:f.rejectedCount||0}};let m;try{m=await Le(un(be(H,"adGroups",d.id,"assets"),Ev(3)))}catch(_){console.error("Failed to load preview ads",_),m={docs:[]}}p.previewAds=m.docs.map(_=>({id:_.id,..._.data()}));let x=!1;try{x=!(await Le(un(be(H,"adGroups",d.id,"assets"),Nt("status","==","ready"),Ev(1)))).empty}catch(_){console.error("Failed to check ready status",_)}if(p.hasReady=x,!f.thumbnailUrl||f.reviewedCount===void 0||f.approvedCount===void 0||f.editCount===void 0||f.rejectedCount===void 0){const _=await Le(be(H,"adGroups",d.id,"assets")),v={reviewed:0,approved:0,edit:0,rejected:0,thumbnail:""};_.docs.forEach(k=>{const A=k.data();!v.thumbnail&&(A.thumbnailUrl||A.firebaseUrl)&&(v.thumbnail=A.thumbnailUrl||A.firebaseUrl),A.status!=="ready"&&(v.reviewed+=1),A.status==="approved"&&(v.approved+=1),A.status==="edit_requested"&&(v.edit+=1),A.status==="rejected"&&(v.rejected+=1)}),p.thumbnail=p.thumbnail||v.thumbnail,p.counts={reviewed:v.reviewed,approved:v.approved,edit:v.edit,rejected:v.rejected};try{const k={reviewedCount:v.reviewed,approvedCount:v.approved,editCount:v.edit,rejectedCount:v.rejected,...f.thumbnailUrl?{}:v.thumbnail?{thumbnailUrl:v.thumbnail}:{}};await nt(oe(H,"adGroups",d.id),k)}catch(k){console.error("Failed to update group summary",k)}}return p}));r(c)}catch(a){console.error("Failed to fetch groups",a),r([])}finally{i(!1)}})()},[e,t]),u.jsx("div",{className:"min-h-screen p-4",children:s?u.jsx("p",{children:"Loading groups..."}):n.length===0?u.jsx("p",{children:"No ad groups found."}):u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 md:grid-cols-3",children:n.map(o=>u.jsx(lz,{group:o},o.id))})})},uz=({startDate:t,endDate:e,onChange:n})=>u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx("input",{type:"date",value:t,onChange:r=>n({start:r.target.value,end:e}),className:"border px-2 py-1 rounded"}),u.jsx("span",{children:"-"}),u.jsx("input",{type:"date",value:e,onChange:r=>n({start:t,end:r.target.value}),className:"border px-2 py-1 rounded"})]});/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function $d(t){return t+.5|0}const fo=(t,e,n)=>Math.max(Math.min(t,n),e);function au(t){return fo($d(t*2.55),0,255)}function No(t){return fo($d(t*255),0,255)}function Ii(t){return fo($d(t/2.55)/100,0,1)}function GE(t){return fo($d(t*100),0,100)}const os={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},jv=[..."0123456789ABCDEF"],dz=t=>jv[t&15],hz=t=>jv[(t&240)>>4]+jv[t&15],Ch=t=>(t&240)>>4===(t&15),fz=t=>Ch(t.r)&&Ch(t.g)&&Ch(t.b)&&Ch(t.a);function pz(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&os[t[1]]*17,g:255&os[t[2]]*17,b:255&os[t[3]]*17,a:e===5?os[t[4]]*17:255}:(e===7||e===9)&&(n={r:os[t[1]]<<4|os[t[2]],g:os[t[3]]<<4|os[t[4]],b:os[t[5]]<<4|os[t[6]],a:e===9?os[t[7]]<<4|os[t[8]]:255})),n}const mz=(t,e)=>t<255?e(t):"";function gz(t){var e=fz(t)?dz:hz;return t?"#"+e(t.r)+e(t.g)+e(t.b)+mz(t.a,e):void 0}const yz=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function vN(t,e,n){const r=e*Math.min(n,1-n),s=(i,o=(i+t/30)%12)=>n-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function vz(t,e,n){const r=(s,i=(s+t/60)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}function _z(t,e,n){const r=vN(t,1,.5);let s;for(e+n>1&&(s=1/(e+n),e*=s,n*=s),s=0;s<3;s++)r[s]*=1-e-n,r[s]+=e;return r}function xz(t,e,n,r,s){return t===s?(e-n)/r+(e<n?6:0):e===s?(n-t)/r+2:(t-e)/r+4}function yw(t){const n=t.r/255,r=t.g/255,s=t.b/255,i=Math.max(n,r,s),o=Math.min(n,r,s),a=(i+o)/2;let l,c,d;return i!==o&&(d=i-o,c=a>.5?d/(2-i-o):d/(i+o),l=xz(n,r,s,d,i),l=l*60+.5),[l|0,c||0,a]}function vw(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(No)}function _w(t,e,n){return vw(vN,t,e,n)}function wz(t,e,n){return vw(_z,t,e,n)}function bz(t,e,n){return vw(vz,t,e,n)}function _N(t){return(t%360+360)%360}function Ez(t){const e=yz.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?au(+e[5]):No(+e[5]));const s=_N(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=wz(s,i,o):e[1]==="hsv"?r=bz(s,i,o):r=_w(s,i,o),{r:r[0],g:r[1],b:r[2],a:n}}function kz(t,e){var n=yw(t);n[0]=_N(n[0]+e),n=_w(n),t.r=n[0],t.g=n[1],t.b=n[2]}function Tz(t){if(!t)return;const e=yw(t),n=e[0],r=GE(e[1]),s=GE(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${s}%, ${Ii(t.a)})`:`hsl(${n}, ${r}%, ${s}%)`}const KE={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},YE={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Sz(){const t={},e=Object.keys(YE),n=Object.keys(KE);let r,s,i,o,a;for(r=0;r<e.length;r++){for(o=a=e[r],s=0;s<n.length;s++)i=n[s],a=a.replace(i,KE[i]);i=parseInt(YE[o],16),t[a]=[i>>16&255,i>>8&255,i&255]}return t}let Ah;function Iz(t){Ah||(Ah=Sz(),Ah.transparent=[0,0,0,0]);const e=Ah[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Cz=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Az(t){const e=Cz.exec(t);let n=255,r,s,i;if(e){if(e[7]!==r){const o=+e[7];n=e[8]?au(o):fo(o*255,0,255)}return r=+e[1],s=+e[3],i=+e[5],r=255&(e[2]?au(r):fo(r,0,255)),s=255&(e[4]?au(s):fo(s,0,255)),i=255&(e[6]?au(i):fo(i,0,255)),{r,g:s,b:i,a:n}}}function Rz(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ii(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Vg=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,ol=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Nz(t,e,n){const r=ol(Ii(t.r)),s=ol(Ii(t.g)),i=ol(Ii(t.b));return{r:No(Vg(r+n*(ol(Ii(e.r))-r))),g:No(Vg(s+n*(ol(Ii(e.g))-s))),b:No(Vg(i+n*(ol(Ii(e.b))-i))),a:t.a+n*(e.a-t.a)}}function Rh(t,e,n){if(t){let r=yw(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=_w(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function xN(t,e){return t&&Object.assign(e||{},t)}function QE(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=No(t[3]))):(e=xN(t,{r:0,g:0,b:0,a:1}),e.a=No(e.a)),e}function Pz(t){return t.charAt(0)==="r"?Az(t):Ez(t)}class md{constructor(e){if(e instanceof md)return e;const n=typeof e;let r;n==="object"?r=QE(e):n==="string"&&(r=pz(e)||Iz(e)||Pz(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=xN(this._rgb);return e&&(e.a=Ii(e.a)),e}set rgb(e){this._rgb=QE(e)}rgbString(){return this._valid?Rz(this._rgb):void 0}hexString(){return this._valid?gz(this._rgb):void 0}hslString(){return this._valid?Tz(this._rgb):void 0}mix(e,n){if(e){const r=this.rgb,s=e.rgb;let i;const o=n===i?.5:n,a=2*o-1,l=r.a-s.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;i=1-c,r.r=255&c*r.r+i*s.r+.5,r.g=255&c*r.g+i*s.g+.5,r.b=255&c*r.b+i*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,n){return e&&(this._rgb=Nz(this._rgb,e._rgb,n)),this}clone(){return new md(this.rgb)}alpha(e){return this._rgb.a=No(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=$d(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Rh(this._rgb,2,e),this}darken(e){return Rh(this._rgb,2,-e),this}saturate(e){return Rh(this._rgb,1,e),this}desaturate(e){return Rh(this._rgb,1,-e),this}rotate(e){return kz(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function wi(){}const jz=(()=>{let t=0;return()=>t++})();function Ge(t){return t==null}function En(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Je(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ps(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Ws(t,e){return ps(t)?t:e}function ze(t,e){return typeof t>"u"?e:t}const Dz=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function xt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function dt(t,e,n,r){let s,i,o;if(En(t))for(i=t.length,s=0;s<i;s++)e.call(n,t[s],s);else if(Je(t))for(o=Object.keys(t),i=o.length,s=0;s<i;s++)e.call(n,t[o[s]],o[s])}function wp(t,e){let n,r,s,i;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(s=t[n],i=e[n],s.datasetIndex!==i.datasetIndex||s.index!==i.index)return!1;return!0}function bp(t){if(En(t))return t.map(bp);if(Je(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let s=0;for(;s<r;++s)e[n[s]]=bp(t[n[s]]);return e}return t}function wN(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Mz(t,e,n,r){if(!wN(t))return;const s=e[t],i=n[t];Je(s)&&Je(i)?ci(s,i,r):e[t]=bp(i)}function ci(t,e,n){const r=En(e)?e:[e],s=r.length;if(!Je(t))return t;n=n||{};const i=n.merger||Mz;let o;for(let a=0;a<s;++a){if(o=r[a],!Je(o))continue;const l=Object.keys(o);for(let c=0,d=l.length;c<d;++c)i(l[c],t,o,n)}return t}function Nu(t,e){return ci(t,e,{merger:Oz})}function Oz(t,e,n){if(!wN(t))return;const r=e[t],s=n[t];Je(r)&&Je(s)?Nu(r,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=bp(s))}const XE={"":t=>t,x:t=>t.x,y:t=>t.y};function Lz(t){const e=t.split("."),n=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function Fz(t){const e=Lz(t);return n=>{for(const r of e){if(r==="")break;n=n&&n[r]}return n}}function oc(t,e){return(XE[e]||(XE[e]=Fz(e)))(t)}function xw(t){return t.charAt(0).toUpperCase()+t.slice(1)}const gd=t=>typeof t<"u",Bo=t=>typeof t=="function",JE=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Vz(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Pt=Math.PI,$n=2*Pt,Uz=$n+Pt,Ep=Number.POSITIVE_INFINITY,Bz=Pt/180,Un=Pt/2,sa=Pt/4,ZE=Pt*2/3,bN=Math.log10,oi=Math.sign;function Pu(t,e,n){return Math.abs(t-e)<n}function ek(t){const e=Math.round(t);t=Pu(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(bN(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function zz(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((s,i)=>s-i).pop(),e}function $z(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function yd(t){return!$z(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Wz(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function Hz(t,e,n){let r,s,i;for(r=0,s=t.length;r<s;r++)i=t[r][n],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function xa(t){return t*(Pt/180)}function qz(t){return t*(180/Pt)}function tk(t){if(!ps(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function EN(t,e){const n=e.x-t.x,r=e.y-t.y,s=Math.sqrt(n*n+r*r);let i=Math.atan2(r,n);return i<-.5*Pt&&(i+=$n),{angle:i,distance:s}}function Dv(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Gz(t,e){return(t-e+Uz)%$n-Pt}function Ts(t){return(t%$n+$n)%$n}function ww(t,e,n,r){const s=Ts(t),i=Ts(e),o=Ts(n),a=Ts(i-s),l=Ts(o-s),c=Ts(s-i),d=Ts(s-o);return s===i||s===o||r&&i===o||a>l&&c<d}function rr(t,e,n){return Math.max(e,Math.min(n,t))}function Kz(t){return rr(t,-32768,32767)}function po(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function bw(t,e,n){n=n||(o=>t[o]<e);let r=t.length-1,s=0,i;for(;r-s>1;)i=s+r>>1,n(i)?s=i:r=i;return{lo:s,hi:r}}const wa=(t,e,n,r)=>bw(t,n,r?s=>{const i=t[s][e];return i<n||i===n&&t[s+1][e]===n}:s=>t[s][e]<n),Yz=(t,e,n)=>bw(t,n,r=>t[r][e]>=n);function Qz(t,e,n){let r=0,s=t.length;for(;r<s&&t[r]<e;)r++;for(;s>r&&t[s-1]>n;)s--;return r>0||s<t.length?t.slice(r,s):t}const kN=["push","pop","shift","splice","unshift"];function Xz(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),kN.forEach(n=>{const r="_onData"+xw(n),s=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...i){const o=s.apply(this,i);return t._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...i)}),o}})})}function nk(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(kN.forEach(i=>{delete t[i]}),delete t._chartjs)}function TN(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const SN=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function IN(t,e){let n=[],r=!1;return function(...s){n=s,r||(r=!0,SN.call(window,()=>{r=!1,t.apply(e,n)}))}}function Jz(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const CN=t=>t==="start"?"left":t==="end"?"right":"center",Hr=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Zz=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e;function e$(t,e,n){const r=e.length;let s=0,i=r;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,d=o.axis,{min:f,max:p,minDefined:m,maxDefined:x}=o.getUserBounds();if(m){if(s=Math.min(wa(l,d,f).lo,n?r:wa(e,d,o.getPixelForValue(f)).lo),c){const w=l.slice(0,s+1).reverse().findIndex(y=>!Ge(y[a.axis]));s-=Math.max(0,w)}s=rr(s,0,r-1)}if(x){let w=Math.max(wa(l,o.axis,p,!0).hi+1,n?0:wa(e,d,o.getPixelForValue(p),!0).hi+1);if(c){const y=l.slice(w-1).findIndex(_=>!Ge(_[a.axis]));w+=Math.max(0,y)}i=rr(w,s,r)-s}else i=r-s}return{start:s,count:i}}function t$(t){const{xScale:e,yScale:n,_scaleRanges:r}=t,s={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!r)return t._scaleRanges=s,!0;const i=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,s),i}const Nh=t=>t===0||t===1,rk=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*$n/n)),sk=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*$n/n)+1,ju={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Un)+1,easeOutSine:t=>Math.sin(t*Un),easeInOutSine:t=>-.5*(Math.cos(Pt*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Nh(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Nh(t)?t:rk(t,.075,.3),easeOutElastic:t=>Nh(t)?t:sk(t,.075,.3),easeInOutElastic(t){return Nh(t)?t:t<.5?.5*rk(t*2,.1125,.45):.5+.5*sk(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-ju.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?ju.easeInBounce(t*2)*.5:ju.easeOutBounce(t*2-1)*.5+.5};function Ew(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function ik(t){return Ew(t)?t:new md(t)}function Ug(t){return Ew(t)?t:new md(t).saturate(.5).darken(.1).hexString()}const n$=["x","y","borderWidth","radius","tension"],r$=["color","borderColor","backgroundColor"];function s$(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:r$},numbers:{type:"number",properties:n$}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function i$(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ok=new Map;function o$(t,e){e=e||{};const n=t+JSON.stringify(e);let r=ok.get(n);return r||(r=new Intl.NumberFormat(t,e),ok.set(n,r)),r}function AN(t,e,n){return o$(e,n).format(t)}const a$={values(t){return En(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let s,i=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),i=l$(t,n)}const o=bN(Math.abs(i)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),AN(t,r,l)}};function l$(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var RN={formatters:a$};function c$(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:RN.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ba=Object.create(null),Mv=Object.create(null);function Du(t,e){if(!e)return t;const n=e.split(".");for(let r=0,s=n.length;r<s;++r){const i=n[r];t=t[i]||(t[i]=Object.create(null))}return t}function Bg(t,e,n){return typeof e=="string"?ci(Du(t,e),n):ci(Du(t,""),e)}class u${constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>Ug(s.backgroundColor),this.hoverBorderColor=(r,s)=>Ug(s.borderColor),this.hoverColor=(r,s)=>Ug(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Bg(this,e,n)}get(e){return Du(this,e)}describe(e,n){return Bg(Mv,e,n)}override(e,n){return Bg(Ba,e,n)}route(e,n,r,s){const i=Du(this,e),o=Du(this,r),a="_"+n;Object.defineProperties(i,{[a]:{value:i[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[s];return Je(l)?Object.assign({},c,l):ze(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Jt=new u$({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[s$,i$,c$]);function d$(t){return!t||Ge(t.size)||Ge(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function ak(t,e,n,r,s){let i=e[s];return i||(i=e[s]=t.measureText(s).width,n.push(s)),i>r&&(r=i),r}function ia(t,e,n){const r=t.currentDevicePixelRatio,s=n!==0?Math.max(n/2,.5):0;return Math.round((e-s)*r)/r+s}function lk(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Ov(t,e,n,r){NN(t,e,n,r,null)}function NN(t,e,n,r,s){let i,o,a,l,c,d,f,p;const m=e.pointStyle,x=e.rotation,w=e.radius;let y=(x||0)*Bz;if(m&&typeof m=="object"&&(i=m.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(y),t.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),t.restore();return}if(!(isNaN(w)||w<=0)){switch(t.beginPath(),m){default:s?t.ellipse(n,r,s/2,w,0,0,$n):t.arc(n,r,w,0,$n),t.closePath();break;case"triangle":d=s?s/2:w,t.moveTo(n+Math.sin(y)*d,r-Math.cos(y)*w),y+=ZE,t.lineTo(n+Math.sin(y)*d,r-Math.cos(y)*w),y+=ZE,t.lineTo(n+Math.sin(y)*d,r-Math.cos(y)*w),t.closePath();break;case"rectRounded":c=w*.516,l=w-c,o=Math.cos(y+sa)*l,f=Math.cos(y+sa)*(s?s/2-c:l),a=Math.sin(y+sa)*l,p=Math.sin(y+sa)*(s?s/2-c:l),t.arc(n-f,r-a,c,y-Pt,y-Un),t.arc(n+p,r-o,c,y-Un,y),t.arc(n+f,r+a,c,y,y+Un),t.arc(n-p,r+o,c,y+Un,y+Pt),t.closePath();break;case"rect":if(!x){l=Math.SQRT1_2*w,d=s?s/2:l,t.rect(n-d,r-l,2*d,2*l);break}y+=sa;case"rectRot":f=Math.cos(y)*(s?s/2:w),o=Math.cos(y)*w,a=Math.sin(y)*w,p=Math.sin(y)*(s?s/2:w),t.moveTo(n-f,r-a),t.lineTo(n+p,r-o),t.lineTo(n+f,r+a),t.lineTo(n-p,r+o),t.closePath();break;case"crossRot":y+=sa;case"cross":f=Math.cos(y)*(s?s/2:w),o=Math.cos(y)*w,a=Math.sin(y)*w,p=Math.sin(y)*(s?s/2:w),t.moveTo(n-f,r-a),t.lineTo(n+f,r+a),t.moveTo(n+p,r-o),t.lineTo(n-p,r+o);break;case"star":f=Math.cos(y)*(s?s/2:w),o=Math.cos(y)*w,a=Math.sin(y)*w,p=Math.sin(y)*(s?s/2:w),t.moveTo(n-f,r-a),t.lineTo(n+f,r+a),t.moveTo(n+p,r-o),t.lineTo(n-p,r+o),y+=sa,f=Math.cos(y)*(s?s/2:w),o=Math.cos(y)*w,a=Math.sin(y)*w,p=Math.sin(y)*(s?s/2:w),t.moveTo(n-f,r-a),t.lineTo(n+f,r+a),t.moveTo(n+p,r-o),t.lineTo(n-p,r+o);break;case"line":o=s?s/2:Math.cos(y)*w,a=Math.sin(y)*w,t.moveTo(n-o,r-a),t.lineTo(n+o,r+a);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(y)*(s?s/2:w),r+Math.sin(y)*w);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function vd(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function kw(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Tw(t){t.restore()}function h$(t,e,n,r,s){if(!e)return t.lineTo(n.x,n.y);if(s==="middle"){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else s==="after"!=!!r?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function f$(t,e,n,r){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function p$(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Ge(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function m$(t,e,n,r,s){if(s.strikethrough||s.underline){const i=t.measureText(r),o=e-i.actualBoundingBoxLeft,a=e+i.actualBoundingBoxRight,l=n-i.actualBoundingBoxAscent,c=n+i.actualBoundingBoxDescent,d=s.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(o,d),t.lineTo(a,d),t.stroke()}}function g$(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function kp(t,e,n,r,s,i={}){const o=En(e)?e:[e],a=i.strokeWidth>0&&i.strokeColor!=="";let l,c;for(t.save(),t.font=s.string,p$(t,i),l=0;l<o.length;++l)c=o[l],i.backdrop&&g$(t,i.backdrop),a&&(i.strokeColor&&(t.strokeStyle=i.strokeColor),Ge(i.strokeWidth)||(t.lineWidth=i.strokeWidth),t.strokeText(c,n,r,i.maxWidth)),t.fillText(c,n,r,i.maxWidth),m$(t,n,r,c,i),r+=Number(s.lineHeight);t.restore()}function Tp(t,e){const{x:n,y:r,w:s,h:i,radius:o}=e;t.arc(n+o.topLeft,r+o.topLeft,o.topLeft,1.5*Pt,Pt,!0),t.lineTo(n,r+i-o.bottomLeft),t.arc(n+o.bottomLeft,r+i-o.bottomLeft,o.bottomLeft,Pt,Un,!0),t.lineTo(n+s-o.bottomRight,r+i),t.arc(n+s-o.bottomRight,r+i-o.bottomRight,o.bottomRight,Un,0,!0),t.lineTo(n+s,r+o.topRight),t.arc(n+s-o.topRight,r+o.topRight,o.topRight,0,-Un,!0),t.lineTo(n+o.topLeft,r)}const y$=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,v$=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function _$(t,e){const n=(""+t).match(y$);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const x$=t=>+t||0;function Sw(t,e){const n={},r=Je(e),s=r?Object.keys(e):e,i=Je(t)?r?o=>ze(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of s)n[o]=x$(i(o));return n}function PN(t){return Sw(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Fl(t){return Sw(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ms(t){const e=PN(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function mr(t,e){t=t||{},e=e||Jt.font;let n=ze(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=ze(t.style,e.style);r&&!(""+r).match(v$)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:ze(t.family,e.family),lineHeight:_$(ze(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:ze(t.weight,e.weight),string:""};return s.string=d$(s),s}function Vt(t,e,n,r){let s,i,o;for(s=0,i=t.length;s<i;++s)if(o=t[s],o!==void 0&&(e!==void 0&&typeof o=="function"&&(o=o(e)),n!==void 0&&En(o)&&(o=o[n%o.length]),o!==void 0))return o}function w$(t,e,n){const{min:r,max:s}=t,i=Dz(e,(s-r)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(r,-Math.abs(i)),max:o(s,i)}}function Xa(t,e){return Object.assign(Object.create(t),e)}function Iw(t,e=[""],n,r,s=()=>t[0]){const i=n||t;typeof r>"u"&&(r=ON("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:r,_getTarget:s,override:a=>Iw([a,...t],e,i,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return DN(a,l,()=>A$(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return uk(a).includes(l)},ownKeys(a){return uk(a)},set(a,l,c){const d=a._storage||(a._storage=s());return a[l]=d[l]=c,delete a._keys,!0}})}function ac(t,e,n,r){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:jN(t,r),setContext:i=>ac(t,i,n,r),override:i=>ac(t.override(i),e,n,r)};return new Proxy(s,{deleteProperty(i,o){return delete i[o],delete t[o],!0},get(i,o,a){return DN(i,o,()=>E$(i,o,a))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(i,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(i,o,a){return t[o]=a,delete i[o],!0}})}function jN(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:n,indexable:r,isScriptable:Bo(n)?n:()=>n,isIndexable:Bo(r)?r:()=>r}}const b$=(t,e)=>t?t+xw(e):e,Cw=(t,e)=>Je(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function DN(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=n();return t[e]=r,r}function E$(t,e,n){const{_proxy:r,_context:s,_subProxy:i,_descriptors:o}=t;let a=r[e];return Bo(a)&&o.isScriptable(e)&&(a=k$(e,a,t,n)),En(a)&&a.length&&(a=T$(e,a,t,o.isIndexable)),Cw(e,a)&&(a=ac(a,s,i&&i[e],o)),a}function k$(t,e,n,r){const{_proxy:s,_context:i,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(i,o||r);return a.delete(t),Cw(t,l)&&(l=Aw(s._scopes,s,t,l)),l}function T$(t,e,n,r){const{_proxy:s,_context:i,_subProxy:o,_descriptors:a}=n;if(typeof i.index<"u"&&r(t))return e[i.index%e.length];if(Je(e[0])){const l=e,c=s._scopes.filter(d=>d!==l);e=[];for(const d of l){const f=Aw(c,s,t,d);e.push(ac(f,i,o&&o[t],a))}}return e}function MN(t,e,n){return Bo(t)?t(e,n):t}const S$=(t,e)=>t===!0?e:typeof t=="string"?oc(e,t):void 0;function I$(t,e,n,r,s){for(const i of e){const o=S$(n,i);if(o){t.add(o);const a=MN(o._fallback,n,s);if(typeof a<"u"&&a!==n&&a!==r)return a}else if(o===!1&&typeof r<"u"&&n!==r)return null}return!1}function Aw(t,e,n,r){const s=e._rootScopes,i=MN(e._fallback,n,r),o=[...t,...s],a=new Set;a.add(r);let l=ck(a,o,n,i||n,r);return l===null||typeof i<"u"&&i!==n&&(l=ck(a,o,i,l,r),l===null)?!1:Iw(Array.from(a),[""],s,i,()=>C$(e,n,r))}function ck(t,e,n,r,s){for(;n;)n=I$(t,e,n,r,s);return n}function C$(t,e,n){const r=t._getTarget();e in r||(r[e]={});const s=r[e];return En(s)&&Je(n)?n:s||{}}function A$(t,e,n,r){let s;for(const i of e)if(s=ON(b$(i,t),n),typeof s<"u")return Cw(t,s)?Aw(n,r,t,s):s}function ON(t,e){for(const n of e){if(!n)continue;const r=n[t];if(typeof r<"u")return r}}function uk(t){let e=t._keys;return e||(e=t._keys=R$(t._scopes)),e}function R$(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const N$=Number.EPSILON||1e-14,lc=(t,e)=>e<t.length&&!t[e].skip&&t[e],LN=t=>t==="x"?"y":"x";function P$(t,e,n,r){const s=t.skip?e:t,i=e,o=n.skip?e:n,a=Dv(i,s),l=Dv(o,i);let c=a/(a+l),d=l/(a+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const f=r*c,p=r*d;return{previous:{x:i.x-f*(o.x-s.x),y:i.y-f*(o.y-s.y)},next:{x:i.x+p*(o.x-s.x),y:i.y+p*(o.y-s.y)}}}function j$(t,e,n){const r=t.length;let s,i,o,a,l,c=lc(t,0);for(let d=0;d<r-1;++d)if(l=c,c=lc(t,d+1),!(!l||!c)){if(Pu(e[d],0,N$)){n[d]=n[d+1]=0;continue}s=n[d]/e[d],i=n[d+1]/e[d],a=Math.pow(s,2)+Math.pow(i,2),!(a<=9)&&(o=3/Math.sqrt(a),n[d]=s*o*e[d],n[d+1]=i*o*e[d])}}function D$(t,e,n="x"){const r=LN(n),s=t.length;let i,o,a,l=lc(t,0);for(let c=0;c<s;++c){if(o=a,a=l,l=lc(t,c+1),!a)continue;const d=a[n],f=a[r];o&&(i=(d-o[n])/3,a[`cp1${n}`]=d-i,a[`cp1${r}`]=f-i*e[c]),l&&(i=(l[n]-d)/3,a[`cp2${n}`]=d+i,a[`cp2${r}`]=f+i*e[c])}}function M$(t,e="x"){const n=LN(e),r=t.length,s=Array(r).fill(0),i=Array(r);let o,a,l,c=lc(t,0);for(o=0;o<r;++o)if(a=l,l=c,c=lc(t,o+1),!!l){if(c){const d=c[e]-l[e];s[o]=d!==0?(c[n]-l[n])/d:0}i[o]=a?c?oi(s[o-1])!==oi(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}j$(t,s,i),D$(t,i,e)}function Ph(t,e,n){return Math.max(Math.min(t,n),e)}function O$(t,e){let n,r,s,i,o,a=vd(t[0],e);for(n=0,r=t.length;n<r;++n)o=i,i=a,a=n<r-1&&vd(t[n+1],e),i&&(s=t[n],o&&(s.cp1x=Ph(s.cp1x,e.left,e.right),s.cp1y=Ph(s.cp1y,e.top,e.bottom)),a&&(s.cp2x=Ph(s.cp2x,e.left,e.right),s.cp2y=Ph(s.cp2y,e.top,e.bottom)))}function L$(t,e,n,r,s){let i,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")M$(t,s);else{let c=r?t[t.length-1]:t[0];for(i=0,o=t.length;i<o;++i)a=t[i],l=P$(c,a,t[Math.min(i+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&O$(t,n)}function Rw(){return typeof window<"u"&&typeof document<"u"}function Nw(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Sp(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const Cm=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function F$(t,e){return Cm(t).getPropertyValue(e)}const V$=["top","right","bottom","left"];function Ia(t,e,n){const r={};n=n?"-"+n:"";for(let s=0;s<4;s++){const i=V$[s];r[i]=parseFloat(t[e+"-"+i+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const U$=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function B$(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:s,offsetY:i}=r;let o=!1,a,l;if(U$(s,i,t.target))a=s,l=i;else{const c=e.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function ua(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,s=Cm(n),i=s.boxSizing==="border-box",o=Ia(s,"padding"),a=Ia(s,"border","width"),{x:l,y:c,box:d}=B$(t,n),f=o.left+(d&&a.left),p=o.top+(d&&a.top);let{width:m,height:x}=e;return i&&(m-=o.width+a.width,x-=o.height+a.height),{x:Math.round((l-f)/m*n.width/r),y:Math.round((c-p)/x*n.height/r)}}function z$(t,e,n){let r,s;if(e===void 0||n===void 0){const i=t&&Nw(t);if(!i)e=t.clientWidth,n=t.clientHeight;else{const o=i.getBoundingClientRect(),a=Cm(i),l=Ia(a,"border","width"),c=Ia(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,r=Sp(a.maxWidth,i,"clientWidth"),s=Sp(a.maxHeight,i,"clientHeight")}}return{width:e,height:n,maxWidth:r||Ep,maxHeight:s||Ep}}const jh=t=>Math.round(t*10)/10;function $$(t,e,n,r){const s=Cm(t),i=Ia(s,"margin"),o=Sp(s.maxWidth,t,"clientWidth")||Ep,a=Sp(s.maxHeight,t,"clientHeight")||Ep,l=z$(t,e,n);let{width:c,height:d}=l;if(s.boxSizing==="content-box"){const p=Ia(s,"border","width"),m=Ia(s,"padding");c-=m.width+p.width,d-=m.height+p.height}return c=Math.max(0,c-i.width),d=Math.max(0,r?c/r:d-i.height),c=jh(Math.min(c,o,l.maxWidth)),d=jh(Math.min(d,a,l.maxHeight)),c&&!d&&(d=jh(c/2)),(e!==void 0||n!==void 0)&&r&&l.height&&d>l.height&&(d=l.height,c=jh(Math.floor(d*r))),{width:c,height:d}}function dk(t,e,n){const r=e||1,s=Math.floor(t.height*r),i=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||o.height!==s||o.width!==i?(t.currentDevicePixelRatio=r,o.height=s,o.width=i,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const W$=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Rw()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function hk(t,e){const n=F$(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function da(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function H$(t,e,n,r){return{x:t.x+n*(e.x-t.x),y:r==="middle"?n<.5?t.y:e.y:r==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function q$(t,e,n,r){const s={x:t.cp2x,y:t.cp2y},i={x:e.cp1x,y:e.cp1y},o=da(t,s,n),a=da(s,i,n),l=da(i,e,n),c=da(o,a,n),d=da(a,l,n);return da(c,d,n)}const G$=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},K$=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Vl(t,e,n){return t?G$(e,n):K$()}function FN(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function VN(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function UN(t){return t==="angle"?{between:ww,compare:Gz,normalize:Ts}:{between:po,compare:(e,n)=>e-n,normalize:e=>e}}function fk({start:t,end:e,count:n,loop:r,style:s}){return{start:t%n,end:e%n,loop:r&&(e-t+1)%n===0,style:s}}function Y$(t,e,n){const{property:r,start:s,end:i}=n,{between:o,normalize:a}=UN(r),l=e.length;let{start:c,end:d,loop:f}=t,p,m;if(f){for(c+=l,d+=l,p=0,m=l;p<m&&o(a(e[c%l][r]),s,i);++p)c--,d--;c%=l,d%=l}return d<c&&(d+=l),{start:c,end:d,loop:f,style:t.style}}function Q$(t,e,n){if(!n)return[t];const{property:r,start:s,end:i}=n,o=e.length,{compare:a,between:l,normalize:c}=UN(r),{start:d,end:f,loop:p,style:m}=Y$(t,e,n),x=[];let w=!1,y=null,_,v,k;const A=()=>l(s,k,_)&&a(s,k)!==0,D=()=>a(i,_)===0||l(i,k,_),O=()=>w||A(),I=()=>!w||D();for(let E=d,S=d;E<=f;++E)v=e[E%o],!v.skip&&(_=c(v[r]),_!==k&&(w=l(_,s,i),y===null&&O()&&(y=a(_,s)===0?E:S),y!==null&&I()&&(x.push(fk({start:y,end:E,loop:p,count:o,style:m})),y=null),S=E,k=_));return y!==null&&x.push(fk({start:y,end:f,loop:p,count:o,style:m})),x}function X$(t,e){const n=[],r=t.segments;for(let s=0;s<r.length;s++){const i=Q$(r[s],t.points,e);i.length&&n.push(...i)}return n}function J$(t,e,n,r){let s=0,i=e-1;if(n&&!r)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,n&&(i+=s);i>s&&t[i%e].skip;)i--;return i%=e,{start:s,end:i}}function Z$(t,e,n,r){const s=t.length,i=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%s];c.skip||c.stop?a.skip||(r=!1,i.push({start:e%s,end:(l-1)%s,loop:r}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&i.push({start:e%s,end:o%s,loop:r}),i}function eW(t,e){const n=t.points,r=t.options.spanGaps,s=n.length;if(!s)return[];const i=!!t._loop,{start:o,end:a}=J$(n,s,i,r);if(r===!0)return pk(t,[{start:o,end:a,loop:i}],n,e);const l=a<o?a+s:a,c=!!t._fullLoop&&o===0&&a===s-1;return pk(t,Z$(n,o,l,c),n,e)}function pk(t,e,n,r){return!r||!r.setContext||!n?e:tW(t,e,n,r)}function tW(t,e,n,r){const s=t._chart.getContext(),i=mk(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let d=i,f=e[0].start,p=f;function m(x,w,y,_){const v=a?-1:1;if(x!==w){for(x+=l;n[x%l].skip;)x-=v;for(;n[w%l].skip;)w+=v;x%l!==w%l&&(c.push({start:x%l,end:w%l,loop:y,style:_}),d=_,f=w%l)}}for(const x of e){f=a?f:x.start;let w=n[f%l],y;for(p=f+1;p<=x.end;p++){const _=n[p%l];y=mk(r.setContext(Xa(s,{type:"segment",p0:w,p1:_,p0DataIndex:(p-1)%l,p1DataIndex:p%l,datasetIndex:o}))),nW(y,d)&&m(f,p-1,x.loop,d),w=_,d=y}f<p-1&&m(f,p-1,x.loop,d)}return c}function mk(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function nW(t,e){if(!e)return!1;const n=[],r=function(s,i){return Ew(i)?(n.includes(i)||n.push(i),n.indexOf(i)):i};return JSON.stringify(t,r)!==JSON.stringify(e,r)}function Dh(t,e,n){return t.options.clip?t[n]:e[n]}function rW(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:Dh(n,e,"left"),right:Dh(n,e,"right"),top:Dh(r,e,"top"),bottom:Dh(r,e,"bottom")}:e}function sW(t,e){const n=e._clip;if(n.disabled)return!1;const r=rW(e,t.chartArea);return{left:n.left===!1?0:r.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:r.right+(n.right===!0?0:n.right),top:n.top===!1?0:r.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:r.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class iW{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,s){const i=n.listeners[s],o=n.duration;i.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(r-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=SN.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const i=r.items;let o=i.length-1,a=!1,l;for(;o>=0;--o)l=i[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(i[o]=i[i.length-1],i.pop());a&&(s.draw(),this._notify(s,r,e,"progress")),i.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),n+=i.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var bi=new iW;const gk="transparent",oW={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=ik(t||gk),s=r.valid&&ik(e||gk);return s&&s.valid?s.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class aW{constructor(e,n,r,s){const i=n[r];s=Vt([e.to,s,i,e.from]);const o=Vt([e.from,i,s]);this._active=!0,this._fn=e.fn||oW[e.type||typeof o],this._easing=ju[e.easing]||ju.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const s=this._target[this._prop],i=r-this._start,o=this._duration-i;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Vt([e.to,n,s,e.from]),this._from=Vt([e.from,s,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,s=this._prop,i=this._from,o=this._loop,a=this._to;let l;if(this._active=i!==a&&(o||n<r),!this._active){this._target[s]=a,this._notify(!0);return}if(n<0){this._target[s]=i;return}l=n/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(i,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][n]()}}class BN{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Je(e))return;const n=Object.keys(Jt.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const i=e[s];if(!Je(i))return;const o={};for(const a of n)o[a]=i[a];(En(i.properties)&&i.properties||[s]).forEach(a=>{(a===s||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,n){const r=n.options,s=cW(e,r);if(!s)return[];const i=this._createAnimations(s,r);return r.$shared&&lW(e.options.$animations,r).then(()=>{e.options=r},()=>{}),i}_createAnimations(e,n){const r=this._properties,s=[],i=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(e,n));continue}const d=n[c];let f=i[c];const p=r.get(c);if(f)if(p&&f.active()){f.update(p,d,a);continue}else f.cancel();if(!p||!p.duration){e[c]=d;continue}i[c]=f=new aW(p,e,c,d),s.push(f)}return s}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return bi.add(this._chart,r),!0}}function lW(t,e){const n=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const i=t[r[s]];i&&i.active()&&n.push(i.wait())}return Promise.all(n)}function cW(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function yk(t,e){const n=t&&t.options||{},r=n.reverse,s=n.min===void 0?e:0,i=n.max===void 0?e:0;return{start:r?i:s,end:r?s:i}}function uW(t,e,n){if(n===!1)return!1;const r=yk(t,n),s=yk(e,n);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function dW(t){let e,n,r,s;return Je(t)?(e=t.top,n=t.right,r=t.bottom,s=t.left):e=n=r=s=t,{top:e,right:n,bottom:r,left:s,disabled:t===!1}}function zN(t,e){const n=[],r=t._getSortedDatasetMetas(e);let s,i;for(s=0,i=r.length;s<i;++s)n.push(r[s].index);return n}function vk(t,e,n,r={}){const s=t.keys,i=r.mode==="single";let o,a,l,c;if(e===null)return;let d=!1;for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===n){if(d=!0,r.all)continue;break}c=t.values[l],ps(c)&&(i||e===0||oi(e)===oi(c))&&(e+=c)}return!d&&!r.all?0:e}function hW(t,e){const{iScale:n,vScale:r}=e,s=n.axis==="x"?"x":"y",i=r.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,d;for(l=0,c=o.length;l<c;++l)d=o[l],a[l]={[s]:d,[i]:t[d]};return a}function zg(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function fW(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function pW(t){const{min:e,max:n,minDefined:r,maxDefined:s}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}function mW(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function _k(t,e,n,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const i=t[s.index];if(n&&i>0||!n&&i<0)return s.index}return null}function xk(t,e){const{chart:n,_cachedMeta:r}=t,s=n._stacks||(n._stacks={}),{iScale:i,vScale:o,index:a}=r,l=i.axis,c=o.axis,d=fW(i,o,r),f=e.length;let p;for(let m=0;m<f;++m){const x=e[m],{[l]:w,[c]:y}=x,_=x._stacks||(x._stacks={});p=_[c]=mW(s,d,w),p[a]=y,p._top=_k(p,o,!0,r.type),p._bottom=_k(p,o,!1,r.type);const v=p._visualValues||(p._visualValues={});v[a]=y}}function $g(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function gW(t,e){return Xa(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function yW(t,e,n){return Xa(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Bc(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const s of e){const i=s._stacks;if(!i||i[r]===void 0||i[r][n]===void 0)return;delete i[r][n],i[r]._visualValues!==void 0&&i[r]._visualValues[n]!==void 0&&delete i[r]._visualValues[n]}}}const Wg=t=>t==="reset"||t==="none",wk=(t,e)=>e?t:Object.assign({},t),vW=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:zN(n,!0),values:null};class Ul{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=zg(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Bc(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),s=(f,p,m,x)=>f==="x"?p:f==="r"?x:m,i=n.xAxisID=ze(r.xAxisID,$g(e,"x")),o=n.yAxisID=ze(r.yAxisID,$g(e,"y")),a=n.rAxisID=ze(r.rAxisID,$g(e,"r")),l=n.indexAxis,c=n.iAxisID=s(l,i,o,a),d=n.vAxisID=s(l,o,i,a);n.xScale=this.getScaleForId(i),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&nk(this._data,this),e._stacked&&Bc(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(Je(n)){const s=this._cachedMeta;this._data=hW(n,s)}else if(r!==n){if(r){nk(r,this);const s=this._cachedMeta;Bc(s),s._parsed=[]}n&&Object.isExtensible(n)&&Xz(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const i=n._stacked;n._stacked=zg(n.vScale,n),n.stack!==r.stack&&(s=!0,Bc(n),n.stack=r.stack),this._resyncElements(e),(s||i!==n._stacked)&&(xk(this,n._parsed),n._stacked=zg(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:s}=this,{iScale:i,_stacked:o}=r,a=i.axis;let l=e===0&&n===s.length?!0:r._sorted,c=e>0&&r._parsed[e-1],d,f,p;if(this._parsing===!1)r._parsed=s,r._sorted=!0,p=s;else{En(s[e])?p=this.parseArrayData(r,s,e,n):Je(s[e])?p=this.parseObjectData(r,s,e,n):p=this.parsePrimitiveData(r,s,e,n);const m=()=>f[a]===null||c&&f[a]<c[a];for(d=0;d<n;++d)r._parsed[d+e]=f=p[d],l&&(m()&&(l=!1),c=f);r._sorted=l}o&&xk(this,p)}parsePrimitiveData(e,n,r,s){const{iScale:i,vScale:o}=e,a=i.axis,l=o.axis,c=i.getLabels(),d=i===o,f=new Array(s);let p,m,x;for(p=0,m=s;p<m;++p)x=p+r,f[p]={[a]:d||i.parse(c[x],x),[l]:o.parse(n[x],x)};return f}parseArrayData(e,n,r,s){const{xScale:i,yScale:o}=e,a=new Array(s);let l,c,d,f;for(l=0,c=s;l<c;++l)d=l+r,f=n[d],a[l]={x:i.parse(f[0],d),y:o.parse(f[1],d)};return a}parseObjectData(e,n,r,s){const{xScale:i,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let d,f,p,m;for(d=0,f=s;d<f;++d)p=d+r,m=n[p],c[d]={x:i.parse(oc(m,a),p),y:o.parse(oc(m,l),p)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const s=this.chart,i=this._cachedMeta,o=n[e.axis],a={keys:zN(s,!0),values:n._stacks[e.axis]._visualValues};return vk(a,o,i.index,{mode:r})}updateRangeFromParsed(e,n,r,s){const i=r[n.axis];let o=i===null?NaN:i;const a=s&&r._stacks[n.axis];s&&a&&(s.values=a,o=vk(s,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const r=this._cachedMeta,s=r._parsed,i=r._sorted&&e===r.iScale,o=s.length,a=this._getOtherScale(e),l=vW(n,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:f}=pW(a);let p,m;function x(){m=s[p];const w=m[a.axis];return!ps(m[e.axis])||d>w||f<w}for(p=0;p<o&&!(!x()&&(this.updateRangeFromParsed(c,e,m,l),i));++p);if(i){for(p=o-1;p>=0;--p)if(!x()){this.updateRangeFromParsed(c,e,m,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let s,i,o;for(s=0,i=n.length;s<i;++s)o=n[s][e.axis],ps(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,s=n.vScale,i=this.getParsed(e);return{label:r?""+r.getLabelForValue(i[r.axis]):"",value:s?""+s.getLabelForValue(i[s.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=dW(ze(this.options.clip,uW(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,s=r.data||[],i=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||s.length-a,c=this.options.drawActiveElementsOnTop;let d;for(r.dataset&&r.dataset.draw(e,i,a,l),d=a;d<a+l;++d){const f=s[d];f.hidden||(f.active&&c?o.push(f):f.draw(e,i))}for(d=0;d<o.length;++d)o[d].draw(e,i)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const s=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=yW(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=s.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=gW(this.chart.getContext(),this.index)),i.dataset=s,i.index=i.datasetIndex=this.index;return i.active=!!n,i.mode=r,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const s=n==="active",i=this._cachedDataOpts,o=e+"-"+n,a=i[o],l=this.enableOptionSharing&&gd(r);if(a)return wk(a,l);const c=this.chart.config,d=c.datasetElementScopeKeys(this._type,e),f=s?[`${e}Hover`,"hover",e,""]:[e,""],p=c.getOptionScopes(this.getDataset(),d),m=Object.keys(Jt.elements[e]),x=()=>this.getContext(r,s,n),w=c.resolveNamedOptions(p,m,x,f);return w.$shared&&(w.$shared=l,i[o]=Object.freeze(wk(w,l))),w}_resolveAnimations(e,n,r){const s=this.chart,i=this._cachedDataOpts,o=`animation-${n}`,a=i[o];if(a)return a;let l;if(s.options.animation!==!1){const d=this.chart.config,f=d.datasetAnimationScopeKeys(this._type,n),p=d.getOptionScopes(this.getDataset(),f);l=d.createResolver(p,this.getContext(e,r,n))}const c=new BN(s,l&&l.animations);return l&&l._cacheable&&(i[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Wg(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const r=this.resolveDataElementOptions(e,n),s=this._sharedOptions,i=this.getSharedOptions(r),o=this.includeOptions(n,i)||i!==s;return this.updateSharedOptions(i,n,r),{sharedOptions:i,includeOptions:o}}updateElement(e,n,r,s){Wg(s)?Object.assign(e,r):this._resolveAnimations(n,s).update(e,r)}updateSharedOptions(e,n,r){e&&!Wg(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,s){e.active=s;const i=this.getStyle(n,s);this._resolveAnimations(n,r,s).update(e,{options:!s&&this.getSharedOptions(i)||i})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const s=r.length,i=n.length,o=Math.min(i,s);o&&this.parse(0,o),i>s?this._insertElements(s,i-s,e):i<s&&this._removeElements(i,s-i)}_insertElements(e,n,r=!0){const s=this._cachedMeta,i=s.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(i),a=e;a<o;++a)i[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,n),r&&this.updateElements(i,e,n,"reset")}updateElements(e,n,r,s){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,n);r._stacked&&Bc(r,s)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,s]=e;this[n](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Y(Ul,"defaults",{}),Y(Ul,"datasetElementType",null),Y(Ul,"dataElementType",null);function _W(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let s=0,i=n.length;s<i;s++)r=r.concat(n[s].controller.getAllParsedValues(t));t._cache.$bar=TN(r.sort((s,i)=>s-i))}return t._cache.$bar}function xW(t){const e=t.iScale,n=_W(e,t.type);let r=e._length,s,i,o,a;const l=()=>{o===32767||o===-32768||(gd(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(s=0,i=n.length;s<i;++s)o=e.getPixelForValue(n[s]),l();for(a=void 0,s=0,i=e.ticks.length;s<i;++s)o=e.getPixelForTick(s),l();return r}function wW(t,e,n,r){const s=n.barThickness;let i,o;return Ge(s)?(i=e.min*n.categoryPercentage,o=n.barPercentage):(i=s*r,o=1),{chunk:i/r,ratio:o,start:e.pixels[t]-i/2}}function bW(t,e,n,r){const s=e.pixels,i=s[t];let o=t>0?s[t-1]:null,a=t<s.length-1?s[t+1]:null;const l=n.categoryPercentage;o===null&&(o=i-(a===null?e.end-e.start:a-i)),a===null&&(a=i+i-o);const c=i-(i-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/r,ratio:n.barPercentage,start:c}}function EW(t,e,n,r){const s=n.parse(t[0],r),i=n.parse(t[1],r),o=Math.min(s,i),a=Math.max(s,i);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:s,end:i,min:o,max:a}}function $N(t,e,n,r){return En(t)?EW(t,e,n,r):e[n.axis]=n.parse(t,r),e}function bk(t,e,n,r){const s=t.iScale,i=t.vScale,o=s.getLabels(),a=s===i,l=[];let c,d,f,p;for(c=n,d=n+r;c<d;++c)p=e[c],f={},f[s.axis]=a||s.parse(o[c],c),l.push($N(p,f,i,c));return l}function Hg(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function kW(t,e,n){return t!==0?oi(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function TW(t){let e,n,r,s,i;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(s="end",i="start"):(s="start",i="end"),{start:n,end:r,reverse:e,top:s,bottom:i}}function SW(t,e,n,r){let s=e.borderSkipped;const i={};if(!s){t.borderSkipped=i;return}if(s===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:d}=TW(t);s==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?s=c:(n._bottom||0)===r?s=d:(i[Ek(d,o,a,l)]=!0,s=c)),i[Ek(s,o,a,l)]=!0,t.borderSkipped=i}function Ek(t,e,n,r){return r?(t=IW(t,e,n),t=kk(t,n,e)):t=kk(t,e,n),t}function IW(t,e,n){return t===e?n:t===n?e:t}function kk(t,e,n){return t==="start"?e:t==="end"?n:t}function CW(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class _f extends Ul{parsePrimitiveData(e,n,r,s){return bk(e,n,r,s)}parseArrayData(e,n,r,s){return bk(e,n,r,s)}parseObjectData(e,n,r,s){const{iScale:i,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=i.axis==="x"?a:l,d=o.axis==="x"?a:l,f=[];let p,m,x,w;for(p=r,m=r+s;p<m;++p)w=n[p],x={},x[i.axis]=i.parse(oc(w,c),p),f.push($N(oc(w,d),x,o,p));return f}updateRangeFromParsed(e,n,r,s){super.updateRangeFromParsed(e,n,r,s);const i=r._custom;i&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:r,vScale:s}=n,i=this.getParsed(e),o=i._custom,a=Hg(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(i[s.axis]);return{label:""+r.getLabelForValue(i[r.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,s){const i=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),d=this._getRuler(),{sharedOptions:f,includeOptions:p}=this._getSharedOptions(n,s);for(let m=n;m<n+r;m++){const x=this.getParsed(m),w=i||Ge(x[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(m),y=this._calculateBarIndexPixels(m,d),_=(x._stacks||{})[a.axis],v={horizontal:c,base:w.base,enableBorderRadius:!_||Hg(x._custom)||o===_._top||o===_._bottom,x:c?w.head:y.center,y:c?y.center:w.head,height:c?y.size:Math.abs(w.size),width:c?Math.abs(w.size):y.size};p&&(v.options=f||this.resolveDataElementOptions(m,e[m].active?"active":s));const k=v.options||e[m].options;SW(v,k,_,o),CW(v,k,d.ratio),this.updateElement(e[m],m,v,s)}}_getStacks(e,n){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),i=r.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[r.axis],c=d=>{const f=d._parsed.find(m=>m[r.axis]===l),p=f&&f[d.vScale.axis];if(Ge(p)||isNaN(p))return!0};for(const d of s)if(!(n!==void 0&&c(d))&&((i===!1||o.indexOf(d.stack)===-1||i===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[ze(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,r){const s=this._getStacks(e,r),i=n!==void 0?s.indexOf(n):-1;return i===-1?s.length-1:i}_getRuler(){const e=this.options,n=this._cachedMeta,r=n.iScale,s=[];let i,o;for(i=0,o=n.data.length;i<o;++i)s.push(r.getPixelForValue(this.getParsed(i)[r.axis],i));const a=e.barThickness;return{min:a||xW(n),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:r,index:s},options:{base:i,minBarLength:o}}=this,a=i||0,l=this.getParsed(e),c=l._custom,d=Hg(c);let f=l[n.axis],p=0,m=r?this.applyStack(n,l,r):f,x,w;m!==f&&(p=m-f,m=f),d&&(f=c.barStart,m=c.barEnd-c.barStart,f!==0&&oi(f)!==oi(c.barEnd)&&(p=0),p+=f);const y=!Ge(i)&&!d?i:p;let _=n.getPixelForValue(y);if(this.chart.getDataVisibility(e)?x=n.getPixelForValue(p+m):x=_,w=x-_,Math.abs(w)<o){w=kW(w,n,a)*o,f===a&&(_-=w/2);const v=n.getPixelForDecimal(0),k=n.getPixelForDecimal(1),A=Math.min(v,k),D=Math.max(v,k);_=Math.max(Math.min(_,D),A),x=_+w,r&&!d&&(l._stacks[n.axis]._visualValues[s]=n.getValueForPixel(x)-n.getValueForPixel(_))}if(_===n.getPixelForValue(a)){const v=oi(w)*n.getLineWidthForValue(a)/2;_+=v,w-=v}return{size:w,base:_,head:x,center:x+w/2}}_calculateBarIndexPixels(e,n){const r=n.scale,s=this.options,i=s.skipNull,o=ze(s.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(n.grouped){const d=i?this._getStackCount(e):n.stackCount,f=s.barThickness==="flex"?bW(e,n,s,d*c):wW(e,n,s,d*c),p=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf(ze(p,this.getFirstScaleIdForIndexAxis())),x=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+m;a=f.start+f.chunk*x+f.chunk/2,l=Math.min(o,f.chunk*f.ratio)}else a=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,r=e.data,s=r.length;let i=0;for(;i<s;++i)this.getParsed(i)[n.axis]!==null&&!r[i].hidden&&r[i].draw(this._ctx)}}Y(_f,"id","bar"),Y(_f,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Y(_f,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class xf extends Ul{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:r,data:s=[],_dataset:i}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=e$(n,s,o);this._drawStart=a,this._drawCount=l,t$(n)&&(a=0,l=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!i._decimated,r.points=s;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},e),this.updateElements(s,a,l,e)}updateElements(e,n,r,s){const i=s==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:d,includeOptions:f}=this._getSharedOptions(n,s),p=o.axis,m=a.axis,{spanGaps:x,segment:w}=this.options,y=yd(x)?x:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||i||s==="none",v=n+r,k=e.length;let A=n>0&&this.getParsed(n-1);for(let D=0;D<k;++D){const O=e[D],I=_?O:{};if(D<n||D>=v){I.skip=!0;continue}const E=this.getParsed(D),S=Ge(E[m]),C=I[p]=o.getPixelForValue(E[p],D),N=I[m]=i||S?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,E,l):E[m],D);I.skip=isNaN(C)||isNaN(N)||S,I.stop=D>0&&Math.abs(E[p]-A[p])>y,w&&(I.parsed=E,I.raw=c.data[D]),f&&(I.options=d||this.resolveDataElementOptions(D,O.active?"active":s)),_||this.updateElement(O,D,I,s),A=E}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,r=n.options&&n.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const i=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Y(xf,"id","line"),Y(xf,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Y(xf,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function oa(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Pw{constructor(e){Y(this,"options");this.options=e||{}}static override(e){Object.assign(Pw.prototype,e)}init(){}formats(){return oa()}parse(){return oa()}format(){return oa()}add(){return oa()}diff(){return oa()}startOf(){return oa()}endOf(){return oa()}}var WN={_date:Pw};function AW(t,e,n,r){const{controller:s,data:i,_sorted:o}=t,a=s._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&i.length){const c=a._reversePixels?Yz:wa;if(r){if(s._sharedOptions){const d=i[0],f=typeof d.getRange=="function"&&d.getRange(e);if(f){const p=c(i,e,n-f),m=c(i,e,n+f);return{lo:p.lo,hi:m.hi}}}}else{const d=c(i,e,n);if(l){const{vScale:f}=s._cachedMeta,{_parsed:p}=t,m=p.slice(0,d.lo+1).reverse().findIndex(w=>!Ge(w[f.axis]));d.lo-=Math.max(0,m);const x=p.slice(d.hi).findIndex(w=>!Ge(w[f.axis]));d.hi+=Math.max(0,x)}return d}}return{lo:0,hi:i.length-1}}function Am(t,e,n,r,s){const i=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=i.length;a<l;++a){const{index:c,data:d}=i[a],{lo:f,hi:p}=AW(i[a],e,o,s);for(let m=f;m<=p;++m){const x=d[m];x.skip||r(x,c,m)}}}function RW(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,s){const i=e?Math.abs(r.x-s.x):0,o=n?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function qg(t,e,n,r,s){const i=[];return!s&&!t.isPointInArea(e)||Am(t,n,e,function(a,l,c){!s&&!vd(a,t.chartArea,0)||a.inRange(e.x,e.y,r)&&i.push({element:a,datasetIndex:l,index:c})},!0),i}function NW(t,e,n,r){let s=[];function i(o,a,l){const{startAngle:c,endAngle:d}=o.getProps(["startAngle","endAngle"],r),{angle:f}=EN(o,{x:e.x,y:e.y});ww(f,c,d)&&s.push({element:o,datasetIndex:a,index:l})}return Am(t,n,e,i),s}function PW(t,e,n,r,s,i){let o=[];const a=RW(n);let l=Number.POSITIVE_INFINITY;function c(d,f,p){const m=d.inRange(e.x,e.y,s);if(r&&!m)return;const x=d.getCenterPoint(s);if(!(!!i||t.isPointInArea(x))&&!m)return;const y=a(e,x);y<l?(o=[{element:d,datasetIndex:f,index:p}],l=y):y===l&&o.push({element:d,datasetIndex:f,index:p})}return Am(t,n,e,c),o}function Gg(t,e,n,r,s,i){return!i&&!t.isPointInArea(e)?[]:n==="r"&&!r?NW(t,e,n,s):PW(t,e,n,r,s,i)}function Tk(t,e,n,r,s){const i=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return Am(t,n,e,(l,c,d)=>{l[o]&&l[o](e[n],s)&&(i.push({element:l,datasetIndex:c,index:d}),a=a||l.inRange(e.x,e.y,s))}),r&&!a?[]:i}var jW={modes:{index(t,e,n,r){const s=ua(e,t),i=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?qg(t,s,i,r,o):Gg(t,s,i,!1,r,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const d=a[0].index,f=c.data[d];f&&!f.skip&&l.push({element:f,datasetIndex:c.index,index:d})}),l):[]},dataset(t,e,n,r){const s=ua(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?qg(t,s,i,r,o):Gg(t,s,i,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let d=0;d<c.length;++d)a.push({element:c[d],datasetIndex:l,index:d})}return a},point(t,e,n,r){const s=ua(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return qg(t,s,i,r,o)},nearest(t,e,n,r){const s=ua(e,t),i=n.axis||"xy",o=n.includeInvisible||!1;return Gg(t,s,i,n.intersect,r,o)},x(t,e,n,r){const s=ua(e,t);return Tk(t,s,"x",n.intersect,r)},y(t,e,n,r){const s=ua(e,t);return Tk(t,s,"y",n.intersect,r)}}};const HN=["left","top","right","bottom"];function zc(t,e){return t.filter(n=>n.pos===e)}function Sk(t,e){return t.filter(n=>HN.indexOf(n.pos)===-1&&n.box.axis===e)}function $c(t,e){return t.sort((n,r)=>{const s=e?r:n,i=e?n:r;return s.weight===i.weight?s.index-i.index:s.weight-i.weight})}function DW(t){const e=[];let n,r,s,i,o,a;for(n=0,r=(t||[]).length;n<r;++n)s=t[n],{position:i,options:{stack:o,stackWeight:a=1}}=s,e.push({index:n,box:s,pos:i,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&i+o,stackWeight:a});return e}function MW(t){const e={};for(const n of t){const{stack:r,pos:s,stackWeight:i}=n;if(!r||!HN.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function OW(t,e){const n=MW(t),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let i,o,a;for(i=0,o=t.length;i<o;++i){a=t[i];const{fullSize:l}=a.box,c=n[a.stack],d=c&&a.stackWeight/c.weight;a.horizontal?(a.width=d?d*r:l&&e.availableWidth,a.height=s):(a.width=r,a.height=d?d*s:l&&e.availableHeight)}return n}function LW(t){const e=DW(t),n=$c(e.filter(c=>c.box.fullSize),!0),r=$c(zc(e,"left"),!0),s=$c(zc(e,"right")),i=$c(zc(e,"top"),!0),o=$c(zc(e,"bottom")),a=Sk(e,"x"),l=Sk(e,"y");return{fullSize:n,leftAndTop:r.concat(i),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:zc(e,"chartArea"),vertical:r.concat(s).concat(l),horizontal:i.concat(o).concat(a)}}function Ik(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function qN(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function FW(t,e,n,r){const{pos:s,box:i}=n,o=t.maxPadding;if(!Je(s)){n.size&&(t[s]-=n.size);const f=r[n.stack]||{size:0,count:1};f.size=Math.max(f.size,n.horizontal?i.height:i.width),n.size=f.size/f.count,t[s]+=n.size}i.getPadding&&qN(o,i.getPadding());const a=Math.max(0,e.outerWidth-Ik(o,t,"left","right")),l=Math.max(0,e.outerHeight-Ik(o,t,"top","bottom")),c=a!==t.w,d=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:d}:{same:d,other:c}}function VW(t){const e=t.maxPadding;function n(r){const s=Math.max(e[r]-t[r],0);return t[r]+=s,s}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function UW(t,e){const n=e.maxPadding;function r(s){const i={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{i[o]=Math.max(e[o],n[o])}),i}return r(t?["left","right"]:["top","bottom"])}function lu(t,e,n,r){const s=[];let i,o,a,l,c,d;for(i=0,o=t.length,c=0;i<o;++i){a=t[i],l=a.box,l.update(a.width||e.w,a.height||e.h,UW(a.horizontal,e));const{same:f,other:p}=FW(e,n,a,r);c|=f&&s.length,d=d||p,l.fullSize||s.push(a)}return c&&lu(s,e,n,r)||d}function Mh(t,e,n,r,s){t.top=n,t.left=e,t.right=e+r,t.bottom=n+s,t.width=r,t.height=s}function Ck(t,e,n,r){const s=n.padding;let{x:i,y:o}=e;for(const a of t){const l=a.box,c=r[a.stack]||{placed:0,weight:1},d=a.stackWeight/c.weight||1;if(a.horizontal){const f=e.w*d,p=c.size||l.height;gd(c.start)&&(o=c.start),l.fullSize?Mh(l,s.left,o,n.outerWidth-s.right-s.left,p):Mh(l,e.left+c.placed,o,f,p),c.start=o,c.placed+=f,o=l.bottom}else{const f=e.h*d,p=c.size||l.width;gd(c.start)&&(i=c.start),l.fullSize?Mh(l,i,s.top,p,n.outerHeight-s.bottom-s.top):Mh(l,i,e.top+c.placed,p,f),c.start=i,c.placed+=f,i=l.right}}e.x=i,e.y=o}var mo={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const s=ms(t.options.layout.padding),i=Math.max(e-s.width,0),o=Math.max(n-s.height,0),a=LW(t.boxes),l=a.vertical,c=a.horizontal;dt(t.boxes,w=>{typeof w.beforeLayout=="function"&&w.beforeLayout()});const d=l.reduce((w,y)=>y.box.options&&y.box.options.display===!1?w:w+1,0)||1,f=Object.freeze({outerWidth:e,outerHeight:n,padding:s,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/d,hBoxMaxHeight:o/2}),p=Object.assign({},s);qN(p,ms(r));const m=Object.assign({maxPadding:p,w:i,h:o,x:s.left,y:s.top},s),x=OW(l.concat(c),f);lu(a.fullSize,m,f,x),lu(l,m,f,x),lu(c,m,f,x)&&lu(l,m,f,x),VW(m),Ck(a.leftAndTop,m,f,x),m.x+=m.w,m.y+=m.h,Ck(a.rightAndBottom,m,f,x),t.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},dt(a.chartArea,w=>{const y=w.box;Object.assign(y,t.chartArea),y.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class GN{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,s){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,s?Math.floor(n/s):r)}}isAttached(e){return!0}updateConfig(e){}}class BW extends GN{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const wf="$chartjs",zW={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ak=t=>t===null||t==="";function $W(t,e){const n=t.style,r=t.getAttribute("height"),s=t.getAttribute("width");if(t[wf]={initial:{height:r,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ak(s)){const i=hk(t,"width");i!==void 0&&(t.width=i)}if(Ak(r))if(t.style.height==="")t.height=t.width/(e||2);else{const i=hk(t,"height");i!==void 0&&(t.height=i)}return t}const KN=W$?{passive:!0}:!1;function WW(t,e,n){t&&t.addEventListener(e,n,KN)}function HW(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,KN)}function qW(t,e){const n=zW[t.type]||t.type,{x:r,y:s}=ua(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:s!==void 0?s:null}}function Ip(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function GW(t,e,n){const r=t.canvas,s=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Ip(a.addedNodes,r),o=o&&!Ip(a.removedNodes,r);o&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}function KW(t,e,n){const r=t.canvas,s=new MutationObserver(i=>{let o=!1;for(const a of i)o=o||Ip(a.removedNodes,r),o=o&&!Ip(a.addedNodes,r);o&&n()});return s.observe(document,{childList:!0,subtree:!0}),s}const _d=new Map;let Rk=0;function YN(){const t=window.devicePixelRatio;t!==Rk&&(Rk=t,_d.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function YW(t,e){_d.size||window.addEventListener("resize",YN),_d.set(t,e)}function QW(t){_d.delete(t),_d.size||window.removeEventListener("resize",YN)}function XW(t,e,n){const r=t.canvas,s=r&&Nw(r);if(!s)return;const i=IN((a,l)=>{const c=s.clientWidth;n(a,l),c<s.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,d=l.contentRect.height;c===0&&d===0||i(c,d)});return o.observe(s),YW(t,i),o}function Kg(t,e,n){n&&n.disconnect(),e==="resize"&&QW(t)}function JW(t,e,n){const r=t.canvas,s=IN(i=>{t.ctx!==null&&n(qW(i,t))},t);return WW(r,e,s),s}class ZW extends GN{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?($W(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[wf])return!1;const r=n[wf].initial;["height","width"].forEach(i=>{const o=r[i];Ge(o)?n.removeAttribute(i):n.setAttribute(i,o)});const s=r.style||{};return Object.keys(s).forEach(i=>{n.style[i]=s[i]}),n.width=n.width,delete n[wf],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const s=e.$proxies||(e.$proxies={}),o={attach:GW,detach:KW,resize:XW}[n]||JW;s[n]=o(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),s=r[n];if(!s)return;({attach:Kg,detach:Kg,resize:Kg}[n]||HW)(e,n,s),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,s){return $$(e,n,r,s)}isAttached(e){const n=e&&Nw(e);return!!(n&&n.isConnected)}}function eH(t){return!Rw()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?BW:ZW}class ui{constructor(){Y(this,"x");Y(this,"y");Y(this,"active",!1);Y(this,"options");Y(this,"$animations")}tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return yd(this.x)&&yd(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const s={};return e.forEach(i=>{s[i]=r[i]&&r[i].active()?r[i]._to:this[i]}),s}}Y(ui,"defaults",{}),Y(ui,"defaultRoutes");function tH(t,e){const n=t.options.ticks,r=nH(t),s=Math.min(n.maxTicksLimit||r,r),i=n.major.enabled?sH(e):[],o=i.length,a=i[0],l=i[o-1],c=[];if(o>s)return iH(e,c,i,o/s),c;const d=rH(i,e,s);if(o>0){let f,p;const m=o>1?Math.round((l-a)/(o-1)):null;for(Oh(e,c,d,Ge(m)?0:a-m,a),f=0,p=o-1;f<p;f++)Oh(e,c,d,i[f],i[f+1]);return Oh(e,c,d,l,Ge(m)?e.length:l+m),c}return Oh(e,c,d),c}function nH(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),s=t._maxLength/n;return Math.floor(Math.min(r,s))}function rH(t,e,n){const r=oH(t),s=e.length/n;if(!r)return Math.max(s,1);const i=zz(r);for(let o=0,a=i.length-1;o<a;o++){const l=i[o];if(l>s)return l}return Math.max(s,1)}function sH(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function iH(t,e,n,r){let s=0,i=n[0],o;for(r=Math.ceil(r),o=0;o<t.length;o++)o===i&&(e.push(t[o]),s++,i=n[s*r])}function Oh(t,e,n,r,s){const i=ze(r,0),o=Math.min(ze(s,t.length),t.length);let a=0,l,c,d;for(n=Math.ceil(n),s&&(l=s-r,n=l/Math.floor(l/n)),d=i;d<0;)a++,d=Math.round(i+a*n);for(c=Math.max(i,0);c<o;c++)c===d&&(e.push(t[c]),a++,d=Math.round(i+a*n))}function oH(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const aH=t=>t==="left"?"right":t==="right"?"left":t,Nk=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Pk=(t,e)=>Math.min(e||t,t);function jk(t,e){const n=[],r=t.length/e,s=t.length;let i=0;for(;i<s;i+=r)n.push(t[Math.floor(i)]);return n}function lH(t,e,n){const r=t.ticks.length,s=Math.min(e,r-1),i=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(s),c;if(!(n&&(r===1?c=Math.max(l-i,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(s-1))/2,l+=s<e?c:-c,l<i-a||l>o+a)))return l}function cH(t,e){dt(t,n=>{const r=n.gc,s=r.length/2;let i;if(s>e){for(i=0;i<s;++i)delete n.data[r[i]];r.splice(0,s)}})}function Wc(t){return t.drawTicks?t.tickLength:0}function Dk(t,e){if(!t.display)return 0;const n=mr(t.font,e),r=ms(t.padding);return(En(t.text)?t.text.length:1)*n.lineHeight+r.height}function uH(t,e){return Xa(t,{scale:e,type:"scale"})}function dH(t,e,n){return Xa(t,{tick:n,index:e,type:"tick"})}function hH(t,e,n){let r=CN(t);return(n&&e!=="right"||!n&&e==="right")&&(r=aH(r)),r}function fH(t,e,n,r){const{top:s,left:i,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:d}=l;let f=0,p,m,x;const w=o-s,y=a-i;if(t.isHorizontal()){if(m=Hr(r,i,a),Je(n)){const _=Object.keys(n)[0],v=n[_];x=d[_].getPixelForValue(v)+w-e}else n==="center"?x=(c.bottom+c.top)/2+w-e:x=Nk(t,n,e);p=a-i}else{if(Je(n)){const _=Object.keys(n)[0],v=n[_];m=d[_].getPixelForValue(v)-y+e}else n==="center"?m=(c.left+c.right)/2-y+e:m=Nk(t,n,e);x=Hr(r,o,s),f=n==="left"?-Un:Un}return{titleX:m,titleY:x,maxWidth:p,rotation:f}}class kc extends ui{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:s}=this;return e=Ws(e,Number.POSITIVE_INFINITY),n=Ws(n,Number.NEGATIVE_INFINITY),r=Ws(r,Number.POSITIVE_INFINITY),s=Ws(s,Number.NEGATIVE_INFINITY),{min:Ws(e,r),max:Ws(n,s),minDefined:ps(e),maxDefined:ps(n)}}getMinMax(e){let{min:n,max:r,minDefined:s,maxDefined:i}=this.getUserBounds(),o;if(s&&i)return{min:n,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),s||(n=Math.min(n,o.min)),i||(r=Math.max(r,o.max));return n=i&&n>r?r:n,r=s&&n>r?n:r,{min:Ws(n,Ws(r,n)),max:Ws(r,Ws(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){xt(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:s,grace:i,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=w$(this,i,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?jk(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=tH(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){xt(this.options.afterUpdate,[this])}beforeSetDimensions(){xt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){xt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),xt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){xt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,s,i;for(r=0,s=e.length;r<s;r++)i=e[r],i.label=xt(n.callback,[i.value,r,e],this)}afterTickToLabelConversion(){xt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){xt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=Pk(this.ticks.length,e.ticks.maxTicksLimit),s=n.minRotation||0,i=n.maxRotation;let o=s,a,l,c;if(!this._isVisible()||!n.display||s>=i||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const d=this._getLabelSizes(),f=d.widest.width,p=d.highest.height,m=rr(this.chart.width-f,0,this.maxWidth);a=e.offset?this.maxWidth/r:m/(r-1),f+6>a&&(a=m/(r-(e.offset?.5:1)),l=this.maxHeight-Wc(e.grid)-n.padding-Dk(e.title,this.chart.options.font),c=Math.sqrt(f*f+p*p),o=qz(Math.min(Math.asin(rr((d.highest.height+6)/a,-1,1)),Math.asin(rr(l/c,-1,1))-Math.asin(rr(p/c,-1,1)))),o=Math.max(s,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){xt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){xt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:s,grid:i}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=Dk(s,n.options.font);if(a?(e.width=this.maxWidth,e.height=Wc(i)+l):(e.height=this.maxHeight,e.width=Wc(i)+l),r.display&&this.ticks.length){const{first:c,last:d,widest:f,highest:p}=this._getLabelSizes(),m=r.padding*2,x=xa(this.labelRotation),w=Math.cos(x),y=Math.sin(x);if(a){const _=r.mirror?0:y*f.width+w*p.height;e.height=Math.min(this.maxHeight,e.height+_+m)}else{const _=r.mirror?0:w*f.width+y*p.height;e.width=Math.min(this.maxWidth,e.width+_+m)}this._calculatePadding(c,d,y,w)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,s){const{ticks:{align:i,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let p=0,m=0;l?c?(p=s*e.width,m=r*n.height):(p=r*e.height,m=s*n.width):i==="start"?m=n.width:i==="end"?p=e.width:i!=="inner"&&(p=e.width/2,m=n.width/2),this.paddingLeft=Math.max((p-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((m-f+o)*this.width/(this.width-f),0)}else{let d=n.height/2,f=e.height/2;i==="start"?(d=0,f=e.height):i==="end"&&(d=n.height,f=0),this.paddingTop=d+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){xt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)Ge(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=jk(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,r){const{ctx:s,_longestTextCache:i}=this,o=[],a=[],l=Math.floor(n/Pk(n,r));let c=0,d=0,f,p,m,x,w,y,_,v,k,A,D;for(f=0;f<n;f+=l){if(x=e[f].label,w=this._resolveTickFontOptions(f),s.font=y=w.string,_=i[y]=i[y]||{data:{},gc:[]},v=w.lineHeight,k=A=0,!Ge(x)&&!En(x))k=ak(s,_.data,_.gc,k,x),A=v;else if(En(x))for(p=0,m=x.length;p<m;++p)D=x[p],!Ge(D)&&!En(D)&&(k=ak(s,_.data,_.gc,k,D),A+=v);o.push(k),a.push(A),c=Math.max(k,c),d=Math.max(A,d)}cH(i,n);const O=o.indexOf(c),I=a.indexOf(d),E=S=>({width:o[S]||0,height:a[S]||0});return{first:E(0),last:E(n-1),widest:E(O),highest:E(I),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Kz(this._alignToPixels?ia(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=dH(this.getContext(),e,r))}return this.$context||(this.$context=uH(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=xa(this.labelRotation),r=Math.abs(Math.cos(n)),s=Math.abs(Math.sin(n)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,l=i?i.highest.height+o:0;return this.isHorizontal()?l*r>a*s?a/r:l/s:l*s<a*r?l/r:a/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,s=this.options,{grid:i,position:o,border:a}=s,l=i.offset,c=this.isHorizontal(),f=this.ticks.length+(l?1:0),p=Wc(i),m=[],x=a.setContext(this.getContext()),w=x.display?x.width:0,y=w/2,_=function(F){return ia(r,F,w)};let v,k,A,D,O,I,E,S,C,N,j,P;if(o==="top")v=_(this.bottom),I=this.bottom-p,S=v-y,N=_(e.top)+y,P=e.bottom;else if(o==="bottom")v=_(this.top),N=e.top,P=_(e.bottom)-y,I=v+y,S=this.top+p;else if(o==="left")v=_(this.right),O=this.right-p,E=v-y,C=_(e.left)+y,j=e.right;else if(o==="right")v=_(this.left),C=e.left,j=_(e.right)-y,O=v+y,E=this.left+p;else if(n==="x"){if(o==="center")v=_((e.top+e.bottom)/2+.5);else if(Je(o)){const F=Object.keys(o)[0],W=o[F];v=_(this.chart.scales[F].getPixelForValue(W))}N=e.top,P=e.bottom,I=v+y,S=I+p}else if(n==="y"){if(o==="center")v=_((e.left+e.right)/2);else if(Je(o)){const F=Object.keys(o)[0],W=o[F];v=_(this.chart.scales[F].getPixelForValue(W))}O=v-y,E=O-p,C=e.left,j=e.right}const ne=ze(s.ticks.maxTicksLimit,f),ae=Math.max(1,Math.ceil(f/ne));for(k=0;k<f;k+=ae){const F=this.getContext(k),W=i.setContext(F),V=a.setContext(F),G=W.lineWidth,re=W.color,_e=V.dash||[],ke=V.dashOffset,Ie=W.tickWidth,Oe=W.tickColor,Dt=W.tickBorderDash||[],ht=W.tickBorderDashOffset;A=lH(this,k,l),A!==void 0&&(D=ia(r,A,G),c?O=E=C=j=D:I=S=N=P=D,m.push({tx1:O,ty1:I,tx2:E,ty2:S,x1:C,y1:N,x2:j,y2:P,width:G,color:re,borderDash:_e,borderDashOffset:ke,tickWidth:Ie,tickColor:Oe,tickBorderDash:Dt,tickBorderDashOffset:ht}))}return this._ticksLength=f,this._borderValue=v,m}_computeLabelItems(e){const n=this.axis,r=this.options,{position:s,ticks:i}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:d,mirror:f}=i,p=Wc(r.grid),m=p+d,x=f?-d:m,w=-xa(this.labelRotation),y=[];let _,v,k,A,D,O,I,E,S,C,N,j,P="middle";if(s==="top")O=this.bottom-x,I=this._getXAxisLabelAlignment();else if(s==="bottom")O=this.top+x,I=this._getXAxisLabelAlignment();else if(s==="left"){const ae=this._getYAxisLabelAlignment(p);I=ae.textAlign,D=ae.x}else if(s==="right"){const ae=this._getYAxisLabelAlignment(p);I=ae.textAlign,D=ae.x}else if(n==="x"){if(s==="center")O=(e.top+e.bottom)/2+m;else if(Je(s)){const ae=Object.keys(s)[0],F=s[ae];O=this.chart.scales[ae].getPixelForValue(F)+m}I=this._getXAxisLabelAlignment()}else if(n==="y"){if(s==="center")D=(e.left+e.right)/2-m;else if(Je(s)){const ae=Object.keys(s)[0],F=s[ae];D=this.chart.scales[ae].getPixelForValue(F)}I=this._getYAxisLabelAlignment(p).textAlign}n==="y"&&(l==="start"?P="top":l==="end"&&(P="bottom"));const ne=this._getLabelSizes();for(_=0,v=a.length;_<v;++_){k=a[_],A=k.label;const ae=i.setContext(this.getContext(_));E=this.getPixelForTick(_)+i.labelOffset,S=this._resolveTickFontOptions(_),C=S.lineHeight,N=En(A)?A.length:1;const F=N/2,W=ae.color,V=ae.textStrokeColor,G=ae.textStrokeWidth;let re=I;o?(D=E,I==="inner"&&(_===v-1?re=this.options.reverse?"left":"right":_===0?re=this.options.reverse?"right":"left":re="center"),s==="top"?c==="near"||w!==0?j=-N*C+C/2:c==="center"?j=-ne.highest.height/2-F*C+C:j=-ne.highest.height+C/2:c==="near"||w!==0?j=C/2:c==="center"?j=ne.highest.height/2-F*C:j=ne.highest.height-N*C,f&&(j*=-1),w!==0&&!ae.showLabelBackdrop&&(D+=C/2*Math.sin(w))):(O=E,j=(1-N)*C/2);let _e;if(ae.showLabelBackdrop){const ke=ms(ae.backdropPadding),Ie=ne.heights[_],Oe=ne.widths[_];let Dt=j-ke.top,ht=0-ke.left;switch(P){case"middle":Dt-=Ie/2;break;case"bottom":Dt-=Ie;break}switch(I){case"center":ht-=Oe/2;break;case"right":ht-=Oe;break;case"inner":_===v-1?ht-=Oe:_>0&&(ht-=Oe/2);break}_e={left:ht,top:Dt,width:Oe+ke.width,height:Ie+ke.height,color:ae.backdropColor}}y.push({label:A,font:S,textOffset:j,options:{rotation:w,color:W,strokeColor:V,strokeWidth:G,textAlign:re,textBaseline:P,translation:[D,O],backdrop:_e}})}return y}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-xa(this.labelRotation))return e==="top"?"left":"right";let s="center";return n.align==="start"?s="left":n.align==="end"?s="right":n.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:s,padding:i}}=this.options,o=this._getLabelSizes(),a=e+i,l=o.widest.width;let c,d;return n==="left"?s?(d=this.right+i,r==="near"?c="left":r==="center"?(c="center",d+=l/2):(c="right",d+=l)):(d=this.right-a,r==="near"?c="right":r==="center"?(c="center",d-=l/2):(c="left",d=this.left)):n==="right"?s?(d=this.left+i,r==="near"?c="right":r==="center"?(c="center",d-=l/2):(c="left",d-=l)):(d=this.left+a,r==="near"?c="left":r==="center"?(c="center",d+=l/2):(c="right",d=this.right)):c="right",{textAlign:c,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:s,width:i,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,s,i,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const s=this.ticks.findIndex(i=>i.value===e);return s>=0?n.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const a=(l,c,d)=>{!d.width||!d.color||(r.save(),r.lineWidth=d.width,r.strokeStyle=d.color,r.setLineDash(d.borderDash||[]),r.lineDashOffset=d.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(n.display)for(i=0,o=s.length;i<o;++i){const l=s[i];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:r,grid:s}}=this,i=r.setContext(this.getContext()),o=r.display?i.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,d,f,p;this.isHorizontal()?(c=ia(e,this.left,o)-o/2,d=ia(e,this.right,a)+a/2,f=p=l):(f=ia(e,this.top,o)-o/2,p=ia(e,this.bottom,a)+a/2,c=d=l),n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.beginPath(),n.moveTo(c,f),n.lineTo(d,p),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&kw(r,s);const i=this.getLabelItems(e);for(const o of i){const a=o.options,l=o.font,c=o.label,d=o.textOffset;kp(r,c,0,d,l,a)}s&&Tw(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:s}}=this;if(!r.display)return;const i=mr(r.font),o=ms(r.padding),a=r.align;let l=i.lineHeight/2;n==="bottom"||n==="center"||Je(n)?(l+=o.bottom,En(r.text)&&(l+=i.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:d,maxWidth:f,rotation:p}=fH(this,l,n,a);kp(e,r.text,0,0,i,{color:r.color,maxWidth:f,rotation:p,textAlign:hH(a,n,s),textBaseline:"middle",translation:[c,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=ze(e.grid&&e.grid.z,-1),s=ze(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==kc.prototype.draw?[{z:n,draw:i=>{this.draw(i)}}]:[{z:r,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:n,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let i,o;for(i=0,o=n.length;i<o;++i){const a=n[i];a[r]===this.id&&(!e||a.type===e)&&s.push(a)}return s}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return mr(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Lh{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;gH(n)&&(r=this.register(n));const s=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in s||(s[i]=e,pH(e,o,r),this.override&&Jt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,s=this.scope;r in n&&delete n[r],s&&r in Jt[s]&&(delete Jt[s][r],this.override&&delete Ba[r])}}function pH(t,e,n){const r=ci(Object.create(null),[n?Jt.get(n):{},Jt.get(e),t.defaults]);Jt.set(e,r),t.defaultRoutes&&mH(e,t.defaultRoutes),t.descriptors&&Jt.describe(e,t.descriptors)}function mH(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),s=r.pop(),i=[t].concat(r).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Jt.route(i,s,l,a)})}function gH(t){return"id"in t&&"defaults"in t}class yH{constructor(){this.controllers=new Lh(Ul,"datasets",!0),this.elements=new Lh(ui,"elements"),this.plugins=new Lh(Object,"plugins"),this.scales=new Lh(kc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(s=>{const i=r||this._getRegistryForType(s);r||i.isForType(s)||i===this.plugins&&s.id?this._exec(e,i,s):dt(s,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,r){const s=xw(e);xt(r["before"+s],[],r),n[e](r),xt(r["after"+s],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const s=n.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var Gs=new yH;class vH{constructor(){this._init=[]}notify(e,n,r,s){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(i,e,n,r);return n==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,n,r,s){s=s||{};for(const i of e){const o=i.plugin,a=o[r],l=[n,s,i.options];if(xt(a,l,o)===!1&&s.cancelable)return!1}return!0}invalidate(){Ge(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,s=ze(r.options&&r.options.plugins,{}),i=_H(r);return s===!1&&!n?[]:wH(e,i,s,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,s=(i,o)=>i.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(s(n,r),e,"stop"),this._notify(s(r,n),e,"start")}}function _H(t){const e={},n=[],r=Object.keys(Gs.plugins.items);for(let i=0;i<r.length;i++)n.push(Gs.getPlugin(r[i]));const s=t.plugins||[];for(let i=0;i<s.length;i++){const o=s[i];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function xH(t,e){return!e&&t===!1?null:t===!0?{}:t}function wH(t,{plugins:e,localIds:n},r,s){const i=[],o=t.getContext();for(const a of e){const l=a.id,c=xH(r[l],s);c!==null&&i.push({plugin:a,options:bH(t.config,{plugin:a,local:n[l]},c,o)})}return i}function bH(t,{plugin:e,local:n},r,s){const i=t.pluginScopeKeys(e),o=t.getOptionScopes(r,i);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Lv(t,e){const n=Jt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function EH(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function kH(t,e){return t===e?"_index_":"_value_"}function Mk(t){if(t==="x"||t==="y"||t==="r")return t}function TH(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Fv(t,...e){if(Mk(t))return t;for(const n of e){const r=n.axis||TH(n.position)||t.length>1&&Mk(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Ok(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function SH(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(n.length)return Ok(t,"x",n[0])||Ok(t,"y",n[0])}return{}}function IH(t,e){const n=Ba[t.type]||{scales:{}},r=e.scales||{},s=Lv(t.type,e),i=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Je(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=Fv(o,a,SH(o,t),Jt.scales[a.type]),c=kH(l,s),d=n.scales||{};i[o]=Nu(Object.create(null),[{axis:l},a,d[l],d[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||Lv(a,e),d=(Ba[a]||{}).scales||{};Object.keys(d).forEach(f=>{const p=EH(f,l),m=o[p+"AxisID"]||p;i[m]=i[m]||Object.create(null),Nu(i[m],[{axis:p},r[m],d[f]])})}),Object.keys(i).forEach(o=>{const a=i[o];Nu(a,[Jt.scales[a.type],Jt.scale])}),i}function QN(t){const e=t.options||(t.options={});e.plugins=ze(e.plugins,{}),e.scales=IH(t,e)}function XN(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function CH(t){return t=t||{},t.data=XN(t.data),QN(t),t}const Lk=new Map,JN=new Set;function Fh(t,e){let n=Lk.get(t);return n||(n=e(),Lk.set(t,n),JN.add(n)),n}const Hc=(t,e,n)=>{const r=oc(e,n);r!==void 0&&t.add(r)};class AH{constructor(e){this._config=CH(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=XN(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),QN(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Fh(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Fh(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Fh(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return Fh(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let s=r.get(e);return(!s||n)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,n,r){const{options:s,type:i}=this,o=this._cachedScopes(e,r),a=o.get(n);if(a)return a;const l=new Set;n.forEach(d=>{e&&(l.add(e),d.forEach(f=>Hc(l,e,f))),d.forEach(f=>Hc(l,s,f)),d.forEach(f=>Hc(l,Ba[i]||{},f)),d.forEach(f=>Hc(l,Jt,f)),d.forEach(f=>Hc(l,Mv,f))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),JN.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,Ba[n]||{},Jt.datasets[n]||{},{type:n},Jt,Mv]}resolveNamedOptions(e,n,r,s=[""]){const i={$shared:!0},{resolver:o,subPrefixes:a}=Fk(this._resolverCache,e,s);let l=o;if(NH(o,n)){i.$shared=!1,r=Bo(r)?r():r;const c=this.createResolver(e,r,a);l=ac(o,r,c)}for(const c of n)i[c]=l[c];return i}createResolver(e,n,r=[""],s){const{resolver:i}=Fk(this._resolverCache,e,r);return Je(n)?ac(i,n,void 0,s):i}}function Fk(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const s=n.join();let i=r.get(s);return i||(i={resolver:Iw(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},r.set(s,i)),i}const RH=t=>Je(t)&&Object.getOwnPropertyNames(t).some(e=>Bo(t[e]));function NH(t,e){const{isScriptable:n,isIndexable:r}=jN(t);for(const s of e){const i=n(s),o=r(s),a=(o||i)&&t[s];if(i&&(Bo(a)||RH(a))||o&&En(a))return!0}return!1}var PH="4.5.0";const jH=["top","bottom","left","right","chartArea"];function Vk(t,e){return t==="top"||t==="bottom"||jH.indexOf(t)===-1&&e==="x"}function Uk(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function Bk(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),xt(n&&n.onComplete,[t],e)}function DH(t){const e=t.chart,n=e.options.animation;xt(n&&n.onProgress,[t],e)}function ZN(t){return Rw()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const bf={},zk=t=>{const e=ZN(t);return Object.values(bf).filter(n=>n.canvas===e).pop()};function MH(t,e,n){const r=Object.keys(t);for(const s of r){const i=+s;if(i>=e){const o=t[s];delete t[s],(n>0||i>e)&&(t[i+n]=o)}}}function OH(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}var Xi;let Hi=(Xi=class{static register(...e){Gs.add(...e),$k()}static unregister(...e){Gs.remove(...e),$k()}constructor(e,n){const r=this.config=new AH(n),s=ZN(e),i=zk(s);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||eH(s)),this.platform.updateConfig(r);const a=this.platform.acquireContext(s,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,d=l&&l.width;if(this.id=jz(),this.ctx=a,this.canvas=l,this.width=d,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new vH,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Jz(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],bf[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}bi.listen(this,"complete",Bk),bi.listen(this,"progress",DH),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:s,_aspectRatio:i}=this;return Ge(e)?n&&i?i:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Gs}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():dk(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return lk(this.canvas,this.ctx),this}stop(){return bi.stop(this),this}resize(e,n){bi.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,s=this.canvas,i=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,n,i),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,dk(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),xt(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};dt(n,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,s=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let i=[];n&&(i=i.concat(Object.keys(n).map(o=>{const a=n[o],l=Fv(o,a),c=l==="r",d=l==="x";return{options:a,dposition:c?"chartArea":d?"bottom":"left",dtype:c?"radialLinear":d?"category":"linear"}}))),dt(i,o=>{const a=o.options,l=a.id,c=Fv(l,a),d=ze(a.type,o.dtype);(a.position===void 0||Vk(a.position,c)!==Vk(o.dposition))&&(a.position=o.dposition),s[l]=!0;let f=null;if(l in r&&r[l].type===d)f=r[l];else{const p=Gs.getScale(d);f=new p({id:l,type:d,ctx:this.ctx,chart:this}),r[f.id]=f}f.init(a,e)}),dt(s,(o,a)=>{o||delete r[a]}),dt(r,o=>{mo.configure(this,o,o.options),mo.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((s,i)=>s.index-i.index),r>n){for(let s=n;s<r;++s)this._destroyDatasetMeta(s);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(Uk("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,s)=>{n.filter(i=>i===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=n.length;r<s;r++){const i=n[r];let o=this.getDatasetMeta(r);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=i.indexAxis||Lv(a,this.options),o.order=i.order||0,o.index=r,o.label=""+i.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=Gs.getController(a),{datasetElementType:c,dataElementType:d}=Jt.datasets[a];Object.assign(l,{dataElementType:Gs.getElement(d),datasetElementType:c&&Gs.getElement(c)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){dt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,d=this.data.datasets.length;c<d;c++){const{controller:f}=this.getDatasetMeta(c),p=!s&&i.indexOf(f)===-1;f.buildOrUpdateElements(p),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||dt(i,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Uk("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){dt(this.scales,e=>{mo.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!JE(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:i}of n){const o=r==="_removeElements"?-i:i;MH(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=i=>new Set(e.filter(o=>o[0]===i).map((o,a)=>a+","+o.splice(1).join(","))),s=r(0);for(let i=1;i<n;i++)if(!JE(s,r(i)))return;return Array.from(s).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;mo.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],dt(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,i)=>{s._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,Bo(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(n),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(bi.has(this)?this.attached&&!bi.running(this)&&bi.start(this):(this.draw(),Bk({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let s,i;for(s=0,i=n.length;s<i;++s){const o=n[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=sW(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&kw(n,s),e.controller.draw(),s&&Tw(n),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return vd(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,s){const i=jW.modes[n];return typeof i=="function"?i(this,e,r,s):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let s=r.filter(i=>i&&i._dataset===n).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=Xa(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const s=r?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,s);gd(n)?(i.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(i,{visible:r}),this.update(a=>a.datasetIndex===e?s:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),bi.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),lk(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete bf[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(i,o)=>{n.addEventListener(this,i,o),e[i]=o},s=(i,o,a)=>{i.offsetX=o,i.offsetY=a,this._eventHandler(i)};dt(this.options.events,i=>r(i,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},s=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},i=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),r("resize",i),r("detach",o)};o=()=>{this.attached=!1,s("resize",i),this._stop(),this._resize(0,0),r("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){dt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},dt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const s=r?"set":"remove";let i,o,a,l;for(n==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:i,index:o})=>{const a=this.getDatasetMeta(i);if(!a)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:a.data[o],index:o}});!wp(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){const s=this.options.hover,i=(l,c)=>l.filter(d=>!c.some(f=>d.datasetIndex===f.datasetIndex&&d.index===f.index)),o=i(n,e),a=r?e:i(e,n);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const i=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(i||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:s=[],options:i}=this,o=n,a=this._getActiveElements(e,s,r,o),l=Vz(e),c=OH(e,this._lastEvent,r,l);r&&(this._lastEvent=null,xt(i.onHover,[e,a,this],this),l&&xt(i.onClick,[e,a,this],this));const d=!wp(a,s);return(d||n)&&(this._active=a,this._updateHoverStyles(a,s,n)),this._lastEvent=c,d}_getActiveElements(e,n,r,s){if(e.type==="mouseout")return[];if(!r)return n;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,s)}},Y(Xi,"defaults",Jt),Y(Xi,"instances",bf),Y(Xi,"overrides",Ba),Y(Xi,"registry",Gs),Y(Xi,"version",PH),Y(Xi,"getChart",zk),Xi);function $k(){return dt(Hi.instances,t=>t._plugins.invalidate())}function LH(t,e,n){const{startAngle:r,x:s,y:i,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:c,borderJoinStyle:d}=l,f=Math.min(c/o,Ts(r-n));if(t.beginPath(),t.arc(s,i,o-c/2,r+f/2,n-f/2),a>0){const p=Math.min(c/a,Ts(r-n));t.arc(s,i,a+c/2,n-p/2,r+p/2,!0)}else{const p=Math.min(c/2,o*Ts(r-n));if(d==="round")t.arc(s,i,p,n-Pt/2,r+Pt/2,!0);else if(d==="bevel"){const m=2*p*p,x=-m*Math.cos(n+Pt/2)+s,w=-m*Math.sin(n+Pt/2)+i,y=m*Math.cos(r+Pt/2)+s,_=m*Math.sin(r+Pt/2)+i;t.lineTo(x,w),t.lineTo(y,_)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function FH(t,e,n){const{startAngle:r,pixelMargin:s,x:i,y:o,outerRadius:a,innerRadius:l}=e;let c=s/a;t.beginPath(),t.arc(i,o,a,r-c,n+c),l>s?(c=s/l,t.arc(i,o,l,n+c,r-c,!0)):t.arc(i,o,s,n+Un,r-Un),t.closePath(),t.clip()}function VH(t){return Sw(t,["outerStart","outerEnd","innerStart","innerEnd"])}function UH(t,e,n,r){const s=VH(t.options.borderRadius),i=(n-e)/2,o=Math.min(i,r*e/2),a=l=>{const c=(n-Math.min(i,l))*r/2;return rr(l,0,Math.min(i,c))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:rr(s.innerStart,0,o),innerEnd:rr(s.innerEnd,0,o)}}function al(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function Cp(t,e,n,r,s,i){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:d}=e,f=Math.max(e.outerRadius+r+n-c,0),p=d>0?d+r+n+c:0;let m=0;const x=s-l;if(r){const ae=d>0?d-r:0,F=f>0?f-r:0,W=(ae+F)/2,V=W!==0?x*W/(W+r):x;m=(x-V)/2}const w=Math.max(.001,x*f-n/Pt)/f,y=(x-w)/2,_=l+y+m,v=s-y-m,{outerStart:k,outerEnd:A,innerStart:D,innerEnd:O}=UH(e,p,f,v-_),I=f-k,E=f-A,S=_+k/I,C=v-A/E,N=p+D,j=p+O,P=_+D/N,ne=v-O/j;if(t.beginPath(),i){const ae=(S+C)/2;if(t.arc(o,a,f,S,ae),t.arc(o,a,f,ae,C),A>0){const G=al(E,C,o,a);t.arc(G.x,G.y,A,C,v+Un)}const F=al(j,v,o,a);if(t.lineTo(F.x,F.y),O>0){const G=al(j,ne,o,a);t.arc(G.x,G.y,O,v+Un,ne+Math.PI)}const W=(v-O/p+(_+D/p))/2;if(t.arc(o,a,p,v-O/p,W,!0),t.arc(o,a,p,W,_+D/p,!0),D>0){const G=al(N,P,o,a);t.arc(G.x,G.y,D,P+Math.PI,_-Un)}const V=al(I,_,o,a);if(t.lineTo(V.x,V.y),k>0){const G=al(I,S,o,a);t.arc(G.x,G.y,k,_-Un,S)}}else{t.moveTo(o,a);const ae=Math.cos(S)*f+o,F=Math.sin(S)*f+a;t.lineTo(ae,F);const W=Math.cos(C)*f+o,V=Math.sin(C)*f+a;t.lineTo(W,V)}t.closePath()}function BH(t,e,n,r,s){const{fullCircles:i,startAngle:o,circumference:a}=e;let l=e.endAngle;if(i){Cp(t,e,n,r,l,s);for(let c=0;c<i;++c)t.fill();isNaN(a)||(l=o+(a%$n||$n))}return Cp(t,e,n,r,l,s),t.fill(),l}function zH(t,e,n,r,s){const{fullCircles:i,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:d,borderDash:f,borderDashOffset:p,borderRadius:m}=l,x=l.borderAlign==="inner";if(!c)return;t.setLineDash(f||[]),t.lineDashOffset=p,x?(t.lineWidth=c*2,t.lineJoin=d||"round"):(t.lineWidth=c,t.lineJoin=d||"bevel");let w=e.endAngle;if(i){Cp(t,e,n,r,w,s);for(let y=0;y<i;++y)t.stroke();isNaN(a)||(w=o+(a%$n||$n))}x&&FH(t,e,w),l.selfJoin&&w-o>=Pt&&m===0&&d!=="miter"&&LH(t,e,w),i||(Cp(t,e,n,r,w,s),t.stroke())}class cu extends ui{constructor(n){super();Y(this,"circumference");Y(this,"endAngle");Y(this,"fullCircles");Y(this,"innerRadius");Y(this,"outerRadius");Y(this,"pixelMargin");Y(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,r,s){const i=this.getProps(["x","y"],s),{angle:o,distance:a}=EN(i,{x:n,y:r}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:f,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),m=(this.options.spacing+this.options.borderWidth)/2,x=ze(p,c-l),w=ww(o,l,c)&&l!==c,y=x>=$n||w,_=po(a,d+m,f+m);return y&&_}getCenterPoint(n){const{x:r,y:s,startAngle:i,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:c,spacing:d}=this.options,f=(i+o)/2,p=(a+l+d+c)/2;return{x:r+Math.cos(f)*p,y:s+Math.sin(f)*p}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:r,circumference:s}=this,i=(r.offset||0)/4,o=(r.spacing||0)/2,a=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=s>$n?Math.floor(s/$n):0,s===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const l=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(l)*i,Math.sin(l)*i);const c=1-Math.sin(Math.min(Pt,s||0)),d=i*c;n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,BH(n,this,d,o,a),zH(n,this,d,o,a),n.restore()}}Y(cu,"id","arc"),Y(cu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Y(cu,"defaultRoutes",{backgroundColor:"backgroundColor"}),Y(cu,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function eP(t,e,n=e){t.lineCap=ze(n.borderCapStyle,e.borderCapStyle),t.setLineDash(ze(n.borderDash,e.borderDash)),t.lineDashOffset=ze(n.borderDashOffset,e.borderDashOffset),t.lineJoin=ze(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=ze(n.borderWidth,e.borderWidth),t.strokeStyle=ze(n.borderColor,e.borderColor)}function $H(t,e,n){t.lineTo(n.x,n.y)}function WH(t){return t.stepped?h$:t.tension||t.cubicInterpolationMode==="monotone"?f$:$H}function tP(t,e,n={}){const r=t.length,{start:s=0,end:i=r-1}=n,{start:o,end:a}=e,l=Math.max(s,o),c=Math.min(i,a),d=s<o&&i<o||s>a&&i>a;return{count:r,start:l,loop:e.loop,ilen:c<l&&!d?r+c-l:c-l}}function HH(t,e,n,r){const{points:s,options:i}=e,{count:o,start:a,loop:l,ilen:c}=tP(s,n,r),d=WH(i);let{move:f=!0,reverse:p}=r||{},m,x,w;for(m=0;m<=c;++m)x=s[(a+(p?c-m:m))%o],!x.skip&&(f?(t.moveTo(x.x,x.y),f=!1):d(t,w,x,p,i.stepped),w=x);return l&&(x=s[(a+(p?c:0))%o],d(t,w,x,p,i.stepped)),!!l}function qH(t,e,n,r){const s=e.points,{count:i,start:o,ilen:a}=tP(s,n,r),{move:l=!0,reverse:c}=r||{};let d=0,f=0,p,m,x,w,y,_;const v=A=>(o+(c?a-A:A))%i,k=()=>{w!==y&&(t.lineTo(d,y),t.lineTo(d,w),t.lineTo(d,_))};for(l&&(m=s[v(0)],t.moveTo(m.x,m.y)),p=0;p<=a;++p){if(m=s[v(p)],m.skip)continue;const A=m.x,D=m.y,O=A|0;O===x?(D<w?w=D:D>y&&(y=D),d=(f*d+A)/++f):(k(),t.lineTo(A,D),x=O,f=0,w=y=D),_=D}k()}function Vv(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?qH:HH}function GH(t){return t.stepped?H$:t.tension||t.cubicInterpolationMode==="monotone"?q$:da}function KH(t,e,n,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,n,r)&&s.closePath()),eP(t,e.options),t.stroke(s)}function YH(t,e,n,r){const{segments:s,options:i}=e,o=Vv(e);for(const a of s)eP(t,i,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+r-1})&&t.closePath(),t.stroke()}const QH=typeof Path2D=="function";function XH(t,e,n,r){QH&&!e.options.segment?KH(t,e,n,r):YH(t,e,n,r)}class ba extends ui{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;L$(this._points,r,e,s,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=eW(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,r=e.length;return r&&n[e[r-1].end]}interpolate(e,n){const r=this.options,s=e[n],i=this.points,o=X$(this,{property:n,start:s,end:s});if(!o.length)return;const a=[],l=GH(r);let c,d;for(c=0,d=o.length;c<d;++c){const{start:f,end:p}=o[c],m=i[f],x=i[p];if(m===x){a.push(m);continue}const w=Math.abs((s-m[n])/(x[n]-m[n])),y=l(m,x,w,r.stepped);y[n]=e[n],a.push(y)}return a.length===1?a[0]:a}pathSegment(e,n,r){return Vv(this)(e,this,n,r)}path(e,n,r){const s=this.segments,i=Vv(this);let o=this._loop;n=n||0,r=r||this.points.length-n;for(const a of s)o&=i(e,this,a,{start:n,end:n+r-1});return!!o}draw(e,n,r,s){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),XH(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Y(ba,"id","line"),Y(ba,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Y(ba,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Y(ba,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function Wk(t,e,n,r){const s=t.options,{[n]:i}=t.getProps([n],r);return Math.abs(e-i)<s.radius+s.hitRadius}class Ca extends ui{constructor(n){super();Y(this,"parsed");Y(this,"skip");Y(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,r,s){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],s);return Math.pow(n-o,2)+Math.pow(r-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(n,r){return Wk(this,n,"x",r)}inYRange(n,r){return Wk(this,n,"y",r)}getCenterPoint(n){const{x:r,y:s}=this.getProps(["x","y"],n);return{x:r,y:s}}size(n){n=n||this.options||{};let r=n.radius||0;r=Math.max(r,r&&n.hoverRadius||0);const s=r&&n.borderWidth||0;return(r+s)*2}draw(n,r){const s=this.options;this.skip||s.radius<.1||!vd(this,r,this.size(s)/2)||(n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.fillStyle=s.backgroundColor,Ov(n,s,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Y(Ca,"id","point"),Y(Ca,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Y(Ca,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function nP(t,e){const{x:n,y:r,base:s,width:i,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,d,f;return t.horizontal?(f=o/2,a=Math.min(n,s),l=Math.max(n,s),c=r-f,d=r+f):(f=i/2,a=n-f,l=n+f,c=Math.min(r,s),d=Math.max(r,s)),{left:a,top:c,right:l,bottom:d}}function go(t,e,n,r){return t?0:rr(e,n,r)}function JH(t,e,n){const r=t.options.borderWidth,s=t.borderSkipped,i=PN(r);return{t:go(s.top,i.top,0,n),r:go(s.right,i.right,0,e),b:go(s.bottom,i.bottom,0,n),l:go(s.left,i.left,0,e)}}function ZH(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,i=Fl(s),o=Math.min(e,n),a=t.borderSkipped,l=r||Je(s);return{topLeft:go(!l||a.top||a.left,i.topLeft,0,o),topRight:go(!l||a.top||a.right,i.topRight,0,o),bottomLeft:go(!l||a.bottom||a.left,i.bottomLeft,0,o),bottomRight:go(!l||a.bottom||a.right,i.bottomRight,0,o)}}function e8(t){const e=nP(t),n=e.right-e.left,r=e.bottom-e.top,s=JH(t,n/2,r/2),i=ZH(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:i},inner:{x:e.left+s.l,y:e.top+s.t,w:n-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,i.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(s.b,s.r))}}}}function Yg(t,e,n,r){const s=e===null,i=n===null,a=t&&!(s&&i)&&nP(t,r);return a&&(s||po(e,a.left,a.right))&&(i||po(n,a.top,a.bottom))}function t8(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function n8(t,e){t.rect(e.x,e.y,e.w,e.h)}function Qg(t,e,n={}){const r=t.x!==n.x?-e:0,s=t.y!==n.y?-e:0,i=(t.x+t.w!==n.x+n.w?e:0)-r,o=(t.y+t.h!==n.y+n.h?e:0)-s;return{x:t.x+r,y:t.y+s,w:t.w+i,h:t.h+o,radius:t.radius}}class Aa extends ui{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:r,backgroundColor:s}}=this,{inner:i,outer:o}=e8(this),a=t8(o.radius)?Tp:n8;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),a(e,Qg(o,n,i)),e.clip(),a(e,Qg(i,-n,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,Qg(i,n)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,n,r){return Yg(this,e,n,r)}inXRange(e,n){return Yg(this,e,null,n)}inYRange(e,n){return Yg(this,null,e,n)}getCenterPoint(e){const{x:n,y:r,base:s,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(n+s)/2:n,y:i?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Y(Aa,"id","bar"),Y(Aa,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Y(Aa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Hk=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},r8=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class qk extends ui{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=xt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=mr(r.font),i=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Hk(r,i);let c,d;n.font=s.string,this.isHorizontal()?(c=this.maxWidth,d=this._fitRows(o,i,a,l)+10):(d=this.maxHeight,c=this._fitCols(o,s,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,s){const{ctx:i,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],d=s+a;let f=e;i.textAlign="left",i.textBaseline="middle";let p=-1,m=-d;return this.legendItems.forEach((x,w)=>{const y=r+n/2+i.measureText(x.text).width;(w===0||c[c.length-1]+y+2*a>o)&&(f+=d,c[c.length-(w>0?0:1)]=0,m+=d,p++),l[w]={left:0,top:m,row:p,width:y,height:s},c[c.length-1]+=y+a}),f}_fitCols(e,n,r,s){const{ctx:i,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],d=o-e;let f=a,p=0,m=0,x=0,w=0;return this.legendItems.forEach((y,_)=>{const{itemWidth:v,itemHeight:k}=s8(r,n,i,y,s);_>0&&m+k+2*a>d&&(f+=p+a,c.push({width:p,height:m}),x+=p+a,w++,p=m=0),l[_]={left:x,top:m,col:w,width:v,height:k},p=Math.max(p,v),m+=k+a}),f+=p,c.push({width:p,height:m}),f}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:s},rtl:i}}=this,o=Vl(i,this.left,this.width);if(this.isHorizontal()){let a=0,l=Hr(r,this.left+s,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Hr(r,this.left+s,this.right-this.lineWidths[a])),c.top+=this.top+e+s,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+s}else{let a=0,l=Hr(r,this.top+e+s,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Hr(r,this.top+e+s,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+s,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;kw(e,this),this._draw(),Tw(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:s}=this,{align:i,labels:o}=e,a=Jt.color,l=Vl(e.rtl,this.left,this.width),c=mr(o.font),{padding:d}=o,f=c.size,p=f/2;let m;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:x,boxHeight:w,itemHeight:y}=Hk(o,f),_=function(O,I,E){if(isNaN(x)||x<=0||isNaN(w)||w<0)return;s.save();const S=ze(E.lineWidth,1);if(s.fillStyle=ze(E.fillStyle,a),s.lineCap=ze(E.lineCap,"butt"),s.lineDashOffset=ze(E.lineDashOffset,0),s.lineJoin=ze(E.lineJoin,"miter"),s.lineWidth=S,s.strokeStyle=ze(E.strokeStyle,a),s.setLineDash(ze(E.lineDash,[])),o.usePointStyle){const C={radius:w*Math.SQRT2/2,pointStyle:E.pointStyle,rotation:E.rotation,borderWidth:S},N=l.xPlus(O,x/2),j=I+p;NN(s,C,N,j,o.pointStyleWidth&&x)}else{const C=I+Math.max((f-w)/2,0),N=l.leftForLtr(O,x),j=Fl(E.borderRadius);s.beginPath(),Object.values(j).some(P=>P!==0)?Tp(s,{x:N,y:C,w:x,h:w,radius:j}):s.rect(N,C,x,w),s.fill(),S!==0&&s.stroke()}s.restore()},v=function(O,I,E){kp(s,E.text,O,I+y/2,c,{strikethrough:E.hidden,textAlign:l.textAlign(E.textAlign)})},k=this.isHorizontal(),A=this._computeTitleHeight();k?m={x:Hr(i,this.left+d,this.right-r[0]),y:this.top+d+A,line:0}:m={x:this.left+d,y:Hr(i,this.top+A+d,this.bottom-n[0].height),line:0},FN(this.ctx,e.textDirection);const D=y+d;this.legendItems.forEach((O,I)=>{s.strokeStyle=O.fontColor,s.fillStyle=O.fontColor;const E=s.measureText(O.text).width,S=l.textAlign(O.textAlign||(O.textAlign=o.textAlign)),C=x+p+E;let N=m.x,j=m.y;l.setWidth(this.width),k?I>0&&N+C+d>this.right&&(j=m.y+=D,m.line++,N=m.x=Hr(i,this.left+d,this.right-r[m.line])):I>0&&j+D>this.bottom&&(N=m.x=N+n[m.line].width+d,m.line++,j=m.y=Hr(i,this.top+A+d,this.bottom-n[m.line].height));const P=l.x(N);if(_(P,j,O),N=Zz(S,N+x+p,k?N+C:this.right,e.rtl),v(l.x(N),j,O),k)m.x+=C+d;else if(typeof O.text!="string"){const ne=c.lineHeight;m.y+=rP(O,ne)+d}else m.y+=D}),VN(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=mr(n.font),s=ms(n.padding);if(!n.display)return;const i=Vl(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=r.size/2,c=s.top+l;let d,f=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),d=this.top+c,f=Hr(e.align,f,this.right-p);else{const x=this.columnSizes.reduce((w,y)=>Math.max(w,y.height),0);d=c+Hr(e.align,this.top,this.bottom-x-e.labels.padding-this._computeTitleHeight())}const m=Hr(a,f,f+p);o.textAlign=i.textAlign(CN(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=r.string,kp(o,n.text,m,d,r)}_computeTitleHeight(){const e=this.options.title,n=mr(e.font),r=ms(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,s,i;if(po(e,this.left,this.right)&&po(n,this.top,this.bottom)){for(i=this.legendHitBoxes,r=0;r<i.length;++r)if(s=i[r],po(e,s.left,s.left+s.width)&&po(n,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!a8(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,i=r8(s,r);s&&!i&&xt(n.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!i&&xt(n.onHover,[e,r,this],this)}else r&&xt(n.onClick,[e,r,this],this)}}function s8(t,e,n,r,s){const i=i8(r,t,e,n),o=o8(s,r,e.lineHeight);return{itemWidth:i,itemHeight:o}}function i8(t,e,n,r){let s=t.text;return s&&typeof s!="string"&&(s=s.reduce((i,o)=>i.length>o.length?i:o)),e+n.size/2+r.measureText(s).width}function o8(t,e,n){let r=t;return typeof e.text!="string"&&(r=rP(e,n)),r}function rP(t,e){const n=t.text?t.text.length:0;return e*n}function a8(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var Rm={id:"legend",_element:qk,start(t,e,n){const r=t.legend=new qk({ctx:t.ctx,options:n,chart:t});mo.configure(t,r,n),mo.addBox(t,r)},stop(t){mo.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;mo.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,s=n.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:s,color:i,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),d=ms(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:i,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const uu={average(t){if(!t.length)return!1;let e,n,r=new Set,s=0,i=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();r.add(l.x),s+=l.y,++i}}return i===0||r.size===0?!1:{x:[...r].reduce((a,l)=>a+l)/r.size,y:s/i}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,s=Number.POSITIVE_INFINITY,i,o,a;for(i=0,o=t.length;i<o;++i){const l=t[i].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),d=Dv(e,c);d<s&&(s=d,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,r=l.y}return{x:n,y:r}}};function Hs(t,e){return e&&(En(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ei(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function l8(t,e){const{element:n,datasetIndex:r,index:s}=e,i=t.getDatasetMeta(r).controller,{label:o,value:a}=i.getLabelAndValue(s);return{chart:t,label:o,parsed:i.getParsed(s),raw:t.data.datasets[r].data[s],formattedValue:a,dataset:i.getDataset(),dataIndex:s,datasetIndex:r,element:n}}function Gk(t,e){const n=t.chart.ctx,{body:r,footer:s,title:i}=t,{boxWidth:o,boxHeight:a}=e,l=mr(e.bodyFont),c=mr(e.titleFont),d=mr(e.footerFont),f=i.length,p=s.length,m=r.length,x=ms(e.padding);let w=x.height,y=0,_=r.reduce((A,D)=>A+D.before.length+D.lines.length+D.after.length,0);if(_+=t.beforeBody.length+t.afterBody.length,f&&(w+=f*c.lineHeight+(f-1)*e.titleSpacing+e.titleMarginBottom),_){const A=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;w+=m*A+(_-m)*l.lineHeight+(_-1)*e.bodySpacing}p&&(w+=e.footerMarginTop+p*d.lineHeight+(p-1)*e.footerSpacing);let v=0;const k=function(A){y=Math.max(y,n.measureText(A).width+v)};return n.save(),n.font=c.string,dt(t.title,k),n.font=l.string,dt(t.beforeBody.concat(t.afterBody),k),v=e.displayColors?o+2+e.boxPadding:0,dt(r,A=>{dt(A.before,k),dt(A.lines,k),dt(A.after,k)}),v=0,n.font=d.string,dt(t.footer,k),n.restore(),y+=x.width,{width:y,height:w}}function c8(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function u8(t,e,n,r){const{x:s,width:i}=r,o=n.caretSize+n.caretPadding;if(t==="left"&&s+i+o>e.width||t==="right"&&s-i-o<0)return!0}function d8(t,e,n,r){const{x:s,width:i}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return r==="center"?c=s<=(a+l)/2?"left":"right":s<=i/2?c="left":s>=o-i/2&&(c="right"),u8(c,t,e,n)&&(c="center"),c}function Kk(t,e,n){const r=n.yAlign||e.yAlign||c8(t,n);return{xAlign:n.xAlign||e.xAlign||d8(t,e,n,r),yAlign:r}}function h8(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function f8(t,e,n){let{y:r,height:s}=t;return e==="top"?r+=n:e==="bottom"?r-=s+n:r-=s/2,r}function Yk(t,e,n,r){const{caretSize:s,caretPadding:i,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=s+i,{topLeft:d,topRight:f,bottomLeft:p,bottomRight:m}=Fl(o);let x=h8(e,a);const w=f8(e,l,c);return l==="center"?a==="left"?x+=c:a==="right"&&(x-=c):a==="left"?x-=Math.max(d,p)+s:a==="right"&&(x+=Math.max(f,m)+s),{x:rr(x,0,r.width-e.width),y:rr(w,0,r.height-e.height)}}function Vh(t,e,n){const r=ms(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function Qk(t){return Hs([],Ei(t))}function p8(t,e,n){return Xa(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function Xk(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const sP={beforeTitle:wi,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:wi,beforeBody:wi,beforeLabel:wi,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Ge(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:wi,afterBody:wi,beforeFooter:wi,footer:wi,afterFooter:wi};function Ir(t,e,n,r){const s=t[e].call(n,r);return typeof s>"u"?sP[e].call(n,r):s}class Uv extends ui{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&n.options.animation&&r.animations,i=new BN(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=p8(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,s=Ir(r,"beforeTitle",this,e),i=Ir(r,"title",this,e),o=Ir(r,"afterTitle",this,e);let a=[];return a=Hs(a,Ei(s)),a=Hs(a,Ei(i)),a=Hs(a,Ei(o)),a}getBeforeBody(e,n){return Qk(Ir(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:r}=n,s=[];return dt(e,i=>{const o={before:[],lines:[],after:[]},a=Xk(r,i);Hs(o.before,Ei(Ir(a,"beforeLabel",this,i))),Hs(o.lines,Ir(a,"label",this,i)),Hs(o.after,Ei(Ir(a,"afterLabel",this,i))),s.push(o)}),s}getAfterBody(e,n){return Qk(Ir(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:r}=n,s=Ir(r,"beforeFooter",this,e),i=Ir(r,"footer",this,e),o=Ir(r,"afterFooter",this,e);let a=[];return a=Hs(a,Ei(s)),a=Hs(a,Ei(i)),a=Hs(a,Ei(o)),a}_createItems(e){const n=this._active,r=this.chart.data,s=[],i=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(l8(this.chart,n[l]));return e.filter&&(a=a.filter((d,f,p)=>e.filter(d,f,p,r))),e.itemSort&&(a=a.sort((d,f)=>e.itemSort(d,f,r))),dt(a,d=>{const f=Xk(e.callbacks,d);s.push(Ir(f,"labelColor",this,d)),i.push(Ir(f,"labelPointStyle",this,d)),o.push(Ir(f,"labelTextColor",this,d))}),this.labelColors=s,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const r=this.options.setContext(this.getContext()),s=this._active;let i,o=[];if(!s.length)this.opacity!==0&&(i={opacity:0});else{const a=uu[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=Gk(this,r),c=Object.assign({},a,l),d=Kk(this.chart,r,c),f=Yk(r,c,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,i={opacity:1,x:f.x,y:f.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,s){const i=this.getCaretPosition(e,r,s);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)}getCaretPosition(e,n,r){const{xAlign:s,yAlign:i}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:d,bottomRight:f}=Fl(a),{x:p,y:m}=e,{width:x,height:w}=n;let y,_,v,k,A,D;return i==="center"?(A=m+w/2,s==="left"?(y=p,_=y-o,k=A+o,D=A-o):(y=p+x,_=y+o,k=A-o,D=A+o),v=y):(s==="left"?_=p+Math.max(l,d)+o:s==="right"?_=p+x-Math.max(c,f)-o:_=this.caretX,i==="top"?(k=m,A=k-o,y=_-o,v=_+o):(k=m+w,A=k+o,y=_+o,v=_-o),D=k),{x1:y,x2:_,x3:v,y1:k,y2:A,y3:D}}drawTitle(e,n,r){const s=this.title,i=s.length;let o,a,l;if(i){const c=Vl(r.rtl,this.x,this.width);for(e.x=Vh(this,r.titleAlign,r),n.textAlign=c.textAlign(r.titleAlign),n.textBaseline="middle",o=mr(r.titleFont),a=r.titleSpacing,n.fillStyle=r.titleColor,n.font=o.string,l=0;l<i;++l)n.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===i&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,n,r,s,i){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=i,d=mr(i.bodyFont),f=Vh(this,"left",i),p=s.x(f),m=l<d.lineHeight?(d.lineHeight-l)/2:0,x=n.y+m;if(i.usePointStyle){const w={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},y=s.leftForLtr(p,c)+c/2,_=x+l/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,Ov(e,w,y,_),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Ov(e,w,y,_)}else{e.lineWidth=Je(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const w=s.leftForLtr(p,c),y=s.leftForLtr(s.xPlus(p,1),c-2),_=Fl(o.borderRadius);Object.values(_).some(v=>v!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Tp(e,{x:w,y:x,w:c,h:l,radius:_}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Tp(e,{x:y,y:x+1,w:c-2,h:l-2,radius:_}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(w,x,c,l),e.strokeRect(w,x,c,l),e.fillStyle=o.backgroundColor,e.fillRect(y,x+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:s}=this,{bodySpacing:i,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:d}=r,f=mr(r.bodyFont);let p=f.lineHeight,m=0;const x=Vl(r.rtl,this.x,this.width),w=function(E){n.fillText(E,x.x(e.x+m),e.y+p/2),e.y+=p+i},y=x.textAlign(o);let _,v,k,A,D,O,I;for(n.textAlign=o,n.textBaseline="middle",n.font=f.string,e.x=Vh(this,y,r),n.fillStyle=r.bodyColor,dt(this.beforeBody,w),m=a&&y!=="right"?o==="center"?c/2+d:c+2+d:0,A=0,O=s.length;A<O;++A){for(_=s[A],v=this.labelTextColors[A],n.fillStyle=v,dt(_.before,w),k=_.lines,a&&k.length&&(this._drawColorBox(n,e,A,x,r),p=Math.max(f.lineHeight,l)),D=0,I=k.length;D<I;++D)w(k[D]),p=f.lineHeight;dt(_.after,w)}m=0,p=f.lineHeight,dt(this.afterBody,w),e.y-=i}drawFooter(e,n,r){const s=this.footer,i=s.length;let o,a;if(i){const l=Vl(r.rtl,this.x,this.width);for(e.x=Vh(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=l.textAlign(r.footerAlign),n.textBaseline="middle",o=mr(r.footerFont),n.fillStyle=r.footerColor,n.font=o.string,a=0;a<i;++a)n.fillText(s[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,n,r,s){const{xAlign:i,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:d}=r,{topLeft:f,topRight:p,bottomLeft:m,bottomRight:x}=Fl(s.cornerRadius);n.fillStyle=s.backgroundColor,n.strokeStyle=s.borderColor,n.lineWidth=s.borderWidth,n.beginPath(),n.moveTo(a+f,l),o==="top"&&this.drawCaret(e,n,r,s),n.lineTo(a+c-p,l),n.quadraticCurveTo(a+c,l,a+c,l+p),o==="center"&&i==="right"&&this.drawCaret(e,n,r,s),n.lineTo(a+c,l+d-x),n.quadraticCurveTo(a+c,l+d,a+c-x,l+d),o==="bottom"&&this.drawCaret(e,n,r,s),n.lineTo(a+m,l+d),n.quadraticCurveTo(a,l+d,a,l+d-m),o==="center"&&i==="left"&&this.drawCaret(e,n,r,s),n.lineTo(a,l+f),n.quadraticCurveTo(a,l,a+f,l),n.closePath(),n.fill(),s.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,s=r&&r.x,i=r&&r.y;if(s||i){const o=uu[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Gk(this,e),l=Object.assign({},o,this._size),c=Kk(n,e,l),d=Yk(e,l,c,n);(s._to!==d.x||i._to!==d.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const s={width:this.width,height:this.height},i={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=ms(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(i,e,s,n),FN(e,n.textDirection),i.y+=o.top,this.drawTitle(i,e,n),this.drawBody(i,e,n),this.drawFooter(i,e,n),VN(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,s=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),i=!wp(r,s),o=this._positionChanged(s,n);(i||o)&&(this._active=s,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,i=this._active||[],o=this._getActiveElements(e,i,n,r),a=this._positionChanged(o,e),l=n||!wp(o,i)||a;return l&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,r,s){const i=this.options;if(e.type==="mouseout")return[];if(!s)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,r);return i.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:r,caretY:s,options:i}=this,o=uu[i.position].call(this,e,n);return o!==!1&&(r!==o.x||s!==o.y)}}Y(Uv,"positioners",uu);var Tc={id:"tooltip",_element:Uv,positioners:uu,afterInit(t,e,n){n&&(t.tooltip=new Uv({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:sP},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const m8=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function g8(t,e,n,r){const s=t.indexOf(e);if(s===-1)return m8(t,e,n,r);const i=t.lastIndexOf(e);return s!==i?n:s}const y8=(t,e)=>t===null?null:rr(Math.round(t),0,e);function Jk(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class zo extends kc{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:s,label:i}of n)r[s]===i&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Ge(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:g8(r,e,ze(n,e),this._addedLabels),y8(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,s=[];let i=this.getLabels();i=e===0&&n===i.length-1?i:i.slice(e,n+1),this._valueRange=Math.max(i.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=n;o++)s.push({value:o});return s}getLabelForValue(e){return Jk.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Y(zo,"id","category"),Y(zo,"defaults",{ticks:{callback:Jk}});function v8(t,e){const n=[],{bounds:s,step:i,min:o,max:a,precision:l,count:c,maxTicks:d,maxDigits:f,includeBounds:p}=t,m=i||1,x=d-1,{min:w,max:y}=e,_=!Ge(o),v=!Ge(a),k=!Ge(c),A=(y-w)/(f+1);let D=ek((y-w)/x/m)*m,O,I,E,S;if(D<1e-14&&!_&&!v)return[{value:w},{value:y}];S=Math.ceil(y/D)-Math.floor(w/D),S>x&&(D=ek(S*D/x/m)*m),Ge(l)||(O=Math.pow(10,l),D=Math.ceil(D*O)/O),s==="ticks"?(I=Math.floor(w/D)*D,E=Math.ceil(y/D)*D):(I=w,E=y),_&&v&&i&&Wz((a-o)/i,D/1e3)?(S=Math.round(Math.min((a-o)/D,d)),D=(a-o)/S,I=o,E=a):k?(I=_?o:I,E=v?a:E,S=c-1,D=(E-I)/S):(S=(E-I)/D,Pu(S,Math.round(S),D/1e3)?S=Math.round(S):S=Math.ceil(S));const C=Math.max(tk(D),tk(I));O=Math.pow(10,Ge(l)?C:l),I=Math.round(I*O)/O,E=Math.round(E*O)/O;let N=0;for(_&&(p&&I!==o?(n.push({value:o}),I<o&&N++,Pu(Math.round((I+N*D)*O)/O,o,Zk(o,A,t))&&N++):I<o&&N++);N<S;++N){const j=Math.round((I+N*D)*O)/O;if(v&&j>a)break;n.push({value:j})}return v&&p&&E!==a?n.length&&Pu(n[n.length-1].value,a,Zk(a,A,t))?n[n.length-1].value=a:n.push({value:a}):(!v||E===a)&&n.push({value:E}),n}function Zk(t,e,{horizontal:n,minRotation:r}){const s=xa(r),i=(n?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+t).length;return Math.min(e/i,o)}class _8 extends kc{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Ge(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:s,max:i}=this;const o=l=>s=n?s:l,a=l=>i=r?i:l;if(e){const l=oi(s),c=oi(i);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(s===i){let l=i===0?1:Math.abs(i*.05);a(i+l),e||o(s-l)}this.min=s,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),n=n||11),n&&(s=Math.min(n,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},i=this._range||this,o=v8(s,i);return e.bounds==="ticks"&&Hz(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-n)/Math.max(e.length-1,1)/2;n-=s,r+=s}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return AN(e,this.chart.options.locale,this.options.ticks.format)}}class $o extends _8{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ps(e)?e:0,this.max=ps(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=xa(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,i.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Y($o,"id","linear"),Y($o,"defaults",{ticks:{callback:RN.formatters.numeric}});const Nm={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Pr=Object.keys(Nm);function eT(t,e){return t-e}function tT(t,e){if(Ge(e))return null;const n=t._adapter,{parser:r,round:s,isoWeekday:i}=t._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),ps(o)||(o=typeof r=="string"?n.parse(o,r):n.parse(o)),o===null?null:(s&&(o=s==="week"&&(yd(i)||i===!0)?n.startOf(o,"isoWeek",i):n.startOf(o,s)),+o)}function nT(t,e,n,r){const s=Pr.length;for(let i=Pr.indexOf(t);i<s-1;++i){const o=Nm[Pr[i]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=r)return Pr[i]}return Pr[s-1]}function x8(t,e,n,r,s){for(let i=Pr.length-1;i>=Pr.indexOf(n);i--){const o=Pr[i];if(Nm[o].common&&t._adapter.diff(s,r,o)>=e-1)return o}return Pr[n?Pr.indexOf(n):0]}function w8(t){for(let e=Pr.indexOf(t)+1,n=Pr.length;e<n;++e)if(Nm[Pr[e]].common)return Pr[e]}function rT(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:s}=bw(n,e),i=n[r]>=e?n[r]:n[s];t[i]=!0}}function b8(t,e,n,r){const s=t._adapter,i=+s.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=i;a<=o;a=+s.add(a,1,r))l=n[a],l>=0&&(e[l].major=!0);return e}function sT(t,e,n){const r=[],s={},i=e.length;let o,a;for(o=0;o<i;++o)a=e[o],s[a]=o,r.push({value:a,major:!1});return i===0||!n?r:b8(t,r,s,n)}class za extends kc{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const r=e.time||(e.time={}),s=this._adapter=new WN._date(e.adapters.date);s.init(n),Nu(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:tT(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:s,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!a&&!isNaN(c.max)&&(i=Math.max(i,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=ps(s)&&!isNaN(s)?s:+n.startOf(Date.now(),r),i=ps(i)&&!isNaN(i)?i:+n.endOf(Date.now(),r)+1,this.min=Math.min(s,i-1),this.max=Math.max(s+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const i=this.min,o=this.max,a=Qz(s,i,o);return this._unit=n.unit||(r.autoSkip?nT(n.minUnit,this.min,this.max,this._getLabelCapacity(i)):x8(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:w8(this._unit),this.initOffsets(s),e.reverse&&a.reverse(),sT(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,s,i;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?n=1-s:n=(this.getDecimalForValue(e[1])-s)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?r=i:r=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=rr(n,0,o),r=rr(r,0,o),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,s=this.options,i=s.time,o=i.unit||nT(i.minUnit,n,r,this._getLabelCapacity(n)),a=ze(s.ticks.stepSize,1),l=o==="week"?i.isoWeekday:!1,c=yd(l)||l===!0,d={};let f=n,p,m;if(c&&(f=+e.startOf(f,"isoWeek",l)),f=+e.startOf(f,c?"day":o),e.diff(r,n,o)>1e5*a)throw new Error(n+" and "+r+" are too far apart with stepSize of "+a+" "+o);const x=s.ticks.source==="data"&&this.getDataTimestamps();for(p=f,m=0;p<r;p=+e.add(p,a,o),m++)rT(d,p,x);return(p===r||s.bounds==="ticks"||m===1)&&rT(d,p,x),Object.keys(d).sort(eT).map(w=>+w)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){const s=this.options.time.displayFormats,i=this._unit,o=n||s[i];return this._adapter.format(e,o)}_tickFormatFunction(e,n,r,s){const i=this.options,o=i.ticks.callback;if(o)return xt(o,[e,n,r],this);const a=i.time.displayFormats,l=this._unit,c=this._majorUnit,d=l&&a[l],f=c&&a[c],p=r[n],m=c&&f&&p&&p.major;return this._adapter.format(e,s||(m?f:d))}generateTickLabels(e){let n,r,s;for(n=0,r=e.length;n<r;++n)s=e[n],s.label=this._tickFormatFunction(s.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,s=xa(this.isHorizontal()?n.maxRotation:n.minRotation),i=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:r*i+a*o,h:r*o+a*i}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,s=r[n.unit]||r.millisecond,i=this._tickFormatFunction(e,0,sT(this,[e],this._majorUnit),s),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(n=0,r=s.length;n<r;++n)e=e.concat(s[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const s=this.getLabels();for(n=0,r=s.length;n<r;++n)e.push(tT(this,s[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return TN(e.sort(eT))}}Y(za,"id","time"),Y(za,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Uh(t,e,n){let r=0,s=t.length-1,i,o,a,l;n?(e>=t[r].pos&&e<=t[s].pos&&({lo:r,hi:s}=wa(t,"pos",e)),{pos:i,time:a}=t[r],{pos:o,time:l}=t[s]):(e>=t[r].time&&e<=t[s].time&&({lo:r,hi:s}=wa(t,"time",e)),{time:i,pos:a}=t[r],{time:o,pos:l}=t[s]);const c=o-i;return c?a+(l-a)*(e-i)/c:a}class iT extends za{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Uh(n,this.min),this._tableRange=Uh(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,s=[],i=[];let o,a,l,c,d;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=r&&s.push(c);if(s.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(o=0,a=s.length;o<a;++o)d=s[o+1],l=s[o-1],c=s[o],Math.round((d+l)/2)!==c&&i.push({time:c,pos:o/(a-1)});return i}_generate(){const e=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((s,i)=>s-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Uh(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return Uh(this._table,r*this._tableRange+this._minPos,!0)}}Y(iT,"id","timeseries"),Y(iT,"defaults",za.defaults);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var oT=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),Mu={toTextLines:function(t){var e=[],n;for(t=[].concat(t);t.length;)n=t.pop(),typeof n=="string"?e.unshift.apply(e,n.split(`
`)):Array.isArray(n)?t.push.apply(t,n):Ge(t)||e.unshift(""+n);return e},textSize:function(t,e,n){var r=[].concat(e),s=r.length,i=t.font,o=0,a;for(t.font=n.string,a=0;a<s;++a)o=Math.max(t.measureText(r[a]).width,o);return t.font=i,{height:s*n.lineHeight,width:o}},bound:function(t,e,n){return Math.max(t,Math.min(e,n))},arrayDiff:function(t,e){var n=t.slice(),r=[],s,i,o,a;for(s=0,o=e.length;s<o;++s)a=e[s],i=n.indexOf(a),i===-1?r.push([a,1]):n.splice(i,1);for(s=0,o=n.length;s<o;++s)r.push([n[s],-1]);return r},rasterize:function(t){return Math.round(t*oT)/oT}};function Xg(t,e){var n=e.x,r=e.y;if(n===null)return{x:0,y:-1};if(r===null)return{x:1,y:0};var s=t.x-n,i=t.y-r,o=Math.sqrt(s*s+i*i);return{x:o?s/o:0,y:o?i/o:-1}}function E8(t,e,n,r,s){switch(s){case"center":n=r=0;break;case"bottom":n=0,r=1;break;case"right":n=1,r=0;break;case"left":n=-1,r=0;break;case"top":n=0,r=-1;break;case"start":n=-n,r=-r;break;case"end":break;default:s*=Math.PI/180,n=Math.cos(s),r=Math.sin(s);break}return{x:t,y:e,vx:n,vy:r}}var k8=0,iP=1,oP=2,aP=4,lP=8;function Bh(t,e,n){var r=k8;return t<n.left?r|=iP:t>n.right&&(r|=oP),e<n.top?r|=lP:e>n.bottom&&(r|=aP),r}function T8(t,e){for(var n=t.x0,r=t.y0,s=t.x1,i=t.y1,o=Bh(n,r,e),a=Bh(s,i,e),l,c,d;!(!(o|a)||o&a);)l=o||a,l&lP?(c=n+(s-n)*(e.top-r)/(i-r),d=e.top):l&aP?(c=n+(s-n)*(e.bottom-r)/(i-r),d=e.bottom):l&oP?(d=r+(i-r)*(e.right-n)/(s-n),c=e.right):l&iP&&(d=r+(i-r)*(e.left-n)/(s-n),c=e.left),l===o?(n=c,r=d,o=Bh(n,r,e)):(s=c,i=d,a=Bh(s,i,e));return{x0:n,x1:s,y0:r,y1:i}}function zh(t,e){var n=e.anchor,r=t,s,i;return e.clamp&&(r=T8(r,e.area)),n==="start"?(s=r.x0,i=r.y0):n==="end"?(s=r.x1,i=r.y1):(s=(r.x0+r.x1)/2,i=(r.y0+r.y1)/2),E8(s,i,t.vx,t.vy,e.align)}var $h={arc:function(t,e){var n=(t.startAngle+t.endAngle)/2,r=Math.cos(n),s=Math.sin(n),i=t.innerRadius,o=t.outerRadius;return zh({x0:t.x+r*i,y0:t.y+s*i,x1:t.x+r*o,y1:t.y+s*o,vx:r,vy:s},e)},point:function(t,e){var n=Xg(t,e.origin),r=n.x*t.options.radius,s=n.y*t.options.radius;return zh({x0:t.x-r,y0:t.y-s,x1:t.x+r,y1:t.y+s,vx:n.x,vy:n.y},e)},bar:function(t,e){var n=Xg(t,e.origin),r=t.x,s=t.y,i=0,o=0;return t.horizontal?(r=Math.min(t.x,t.base),i=Math.abs(t.base-t.x)):(s=Math.min(t.y,t.base),o=Math.abs(t.base-t.y)),zh({x0:r,y0:s+o,x1:r+i,y1:s,vx:n.x,vy:n.y},e)},fallback:function(t,e){var n=Xg(t,e.origin);return zh({x0:t.x,y0:t.y,x1:t.x+(t.width||0),y1:t.y+(t.height||0),vx:n.x,vy:n.y},e)}},Ni=Mu.rasterize;function S8(t){var e=t.borderWidth||0,n=t.padding,r=t.size.height,s=t.size.width,i=-s/2,o=-r/2;return{frame:{x:i-n.left-e,y:o-n.top-e,w:s+n.width+e*2,h:r+n.height+e*2},text:{x:i,y:o,w:s,h:r}}}function I8(t,e){var n=e.chart.getDatasetMeta(e.datasetIndex).vScale;if(!n)return null;if(n.xCenter!==void 0&&n.yCenter!==void 0)return{x:n.xCenter,y:n.yCenter};var r=n.getBasePixel();return t.horizontal?{x:r,y:null}:{x:null,y:r}}function C8(t){return t instanceof cu?$h.arc:t instanceof Ca?$h.point:t instanceof Aa?$h.bar:$h.fallback}function A8(t,e,n,r,s,i){var o=Math.PI/2;if(i){var a=Math.min(i,s/2,r/2),l=e+a,c=n+a,d=e+r-a,f=n+s-a;t.moveTo(e,c),l<d&&c<f?(t.arc(l,c,a,-Math.PI,-o),t.arc(d,c,a,-o,0),t.arc(d,f,a,0,o),t.arc(l,f,a,o,Math.PI)):l<d?(t.moveTo(l,n),t.arc(d,c,a,-o,o),t.arc(l,c,a,o,Math.PI+o)):c<f?(t.arc(l,c,a,-Math.PI,0),t.arc(l,f,a,0,Math.PI)):t.arc(l,c,a,-Math.PI,Math.PI),t.closePath(),t.moveTo(e,n)}else t.rect(e,n,r,s)}function R8(t,e,n){var r=n.backgroundColor,s=n.borderColor,i=n.borderWidth;!r&&(!s||!i)||(t.beginPath(),A8(t,Ni(e.x)+i/2,Ni(e.y)+i/2,Ni(e.w)-i,Ni(e.h)-i,n.borderRadius),t.closePath(),r&&(t.fillStyle=r,t.fill()),s&&i&&(t.strokeStyle=s,t.lineWidth=i,t.lineJoin="miter",t.stroke()))}function N8(t,e,n){var r=n.lineHeight,s=t.w,i=t.x,o=t.y+r/2;return e==="center"?i+=s/2:(e==="end"||e==="right")&&(i+=s),{h:r,w:s,x:i,y:o}}function P8(t,e,n){var r=t.shadowBlur,s=n.stroked,i=Ni(n.x),o=Ni(n.y),a=Ni(n.w);s&&t.strokeText(e,i,o,a),n.filled&&(r&&s&&(t.shadowBlur=0),t.fillText(e,i,o,a),r&&s&&(t.shadowBlur=r))}function j8(t,e,n,r){var s=r.textAlign,i=r.color,o=!!i,a=r.font,l=e.length,c=r.textStrokeColor,d=r.textStrokeWidth,f=c&&d,p;if(!(!l||!o&&!f))for(n=N8(n,s,a),t.font=a.string,t.textAlign=s,t.textBaseline="middle",t.shadowBlur=r.textShadowBlur,t.shadowColor=r.textShadowColor,o&&(t.fillStyle=i),f&&(t.lineJoin="round",t.lineWidth=d,t.strokeStyle=c),p=0,l=e.length;p<l;++p)P8(t,e[p],{stroked:f,filled:o,w:n.w,x:n.x,y:n.y+n.h*p})}var cP=function(t,e,n,r){var s=this;s._config=t,s._index=r,s._model=null,s._rects=null,s._ctx=e,s._el=n};ci(cP.prototype,{_modelize:function(t,e,n,r){var s=this,i=s._index,o=mr(Vt([n.font,{}],r,i)),a=Vt([n.color,Jt.color],r,i);return{align:Vt([n.align,"center"],r,i),anchor:Vt([n.anchor,"center"],r,i),area:r.chart.chartArea,backgroundColor:Vt([n.backgroundColor,null],r,i),borderColor:Vt([n.borderColor,null],r,i),borderRadius:Vt([n.borderRadius,0],r,i),borderWidth:Vt([n.borderWidth,0],r,i),clamp:Vt([n.clamp,!1],r,i),clip:Vt([n.clip,!1],r,i),color:a,display:t,font:o,lines:e,offset:Vt([n.offset,4],r,i),opacity:Vt([n.opacity,1],r,i),origin:I8(s._el,r),padding:ms(Vt([n.padding,4],r,i)),positioner:C8(s._el),rotation:Vt([n.rotation,0],r,i)*(Math.PI/180),size:Mu.textSize(s._ctx,e,o),textAlign:Vt([n.textAlign,"start"],r,i),textShadowBlur:Vt([n.textShadowBlur,0],r,i),textShadowColor:Vt([n.textShadowColor,a],r,i),textStrokeColor:Vt([n.textStrokeColor,a],r,i),textStrokeWidth:Vt([n.textStrokeWidth,0],r,i)}},update:function(t){var e=this,n=null,r=null,s=e._index,i=e._config,o,a,l,c=Vt([i.display,!0],t,s);c&&(o=t.dataset.data[s],a=ze(xt(i.formatter,[o,t]),o),l=Ge(a)?[]:Mu.toTextLines(a),l.length&&(n=e._modelize(c,l,i,t),r=S8(n))),e._model=n,e._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var n=this,r=t.ctx,s=n._model,i=n._rects,o;this.visible()&&(r.save(),s.clip&&(o=s.area,r.beginPath(),r.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),r.clip()),r.globalAlpha=Mu.bound(0,s.opacity,1),r.translate(Ni(e.x),Ni(e.y)),r.rotate(s.rotation),R8(r,i.frame,s),j8(r,s.lines,i.text,s),r.restore())}});var D8=Number.MIN_SAFE_INTEGER||-9007199254740991,M8=Number.MAX_SAFE_INTEGER||9007199254740991;function qc(t,e,n){var r=Math.cos(n),s=Math.sin(n),i=e.x,o=e.y;return{x:i+r*(t.x-i)-s*(t.y-o),y:o+s*(t.x-i)+r*(t.y-o)}}function aT(t,e){var n=M8,r=D8,s=e.origin,i,o,a,l,c;for(i=0;i<t.length;++i)o=t[i],a=o.x-s.x,l=o.y-s.y,c=e.vx*a+e.vy*l,n=Math.min(n,c),r=Math.max(r,c);return{min:n,max:r}}function Wh(t,e){var n=e.x-t.x,r=e.y-t.y,s=Math.sqrt(n*n+r*r);return{vx:(e.x-t.x)/s,vy:(e.y-t.y)/s,origin:t,ln:s}}var uP=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};ci(uP.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,n){this._rotation=n,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this,n=1,r=e._rect;return t=qc(t,e.center(),-e._rotation),!(t.x<r.x-n||t.y<r.y-n||t.x>r.x+r.w+n*2||t.y>r.y+r.h+n*2)},intersects:function(t){var e=this._points(),n=t._points(),r=[Wh(e[0],e[1]),Wh(e[0],e[3])],s,i,o;for(this._rotation!==t._rotation&&r.push(Wh(n[0],n[1]),Wh(n[0],n[3])),s=0;s<r.length;++s)if(i=aT(e,r[s]),o=aT(n,r[s]),i.max<o.min||o.max<i.min)return!1;return!0},_points:function(){var t=this,e=t._rect,n=t._rotation,r=t.center();return[qc({x:e.x,y:e.y},r,n),qc({x:e.x+e.w,y:e.y},r,n),qc({x:e.x+e.w,y:e.y+e.h},r,n),qc({x:e.x,y:e.y+e.h},r,n)]}});function dP(t,e,n){var r=e.positioner(t,e),s=r.vx,i=r.vy;if(!s&&!i)return{x:r.x,y:r.y};var o=n.w,a=n.h,l=e.rotation,c=Math.abs(o/2*Math.cos(l))+Math.abs(a/2*Math.sin(l)),d=Math.abs(o/2*Math.sin(l))+Math.abs(a/2*Math.cos(l)),f=1/Math.max(Math.abs(s),Math.abs(i));return c*=s*f,d*=i*f,c+=e.offset*s,d+=e.offset*i,{x:r.x+c,y:r.y+d}}function O8(t,e){var n,r,s,i;for(n=t.length-1;n>=0;--n)for(s=t[n].$layout,r=n-1;r>=0&&s._visible;--r)i=t[r].$layout,i._visible&&s._box.intersects(i._box)&&e(s,i);return t}function L8(t){var e,n,r,s,i,o,a;for(e=0,n=t.length;e<n;++e)r=t[e],s=r.$layout,s._visible&&(a=new Proxy(r._el,{get:(l,c)=>l.getProps([c],!0)[c]}),i=r.geometry(),o=dP(a,r.model(),i),s._box.update(o,i,r.rotation()));return O8(t,function(l,c){var d=l._hidable,f=c._hidable;d&&f||f?c._visible=!1:d&&(l._visible=!1)})}var Ou={prepare:function(t){var e=[],n,r,s,i,o;for(n=0,s=t.length;n<s;++n)for(r=0,i=t[n].length;r<i;++r)o=t[n][r],e.push(o),o.$layout={_box:new uP,_hidable:!1,_visible:!0,_set:n,_idx:o._index};return e.sort(function(a,l){var c=a.$layout,d=l.$layout;return c._idx===d._idx?d._set-c._set:d._idx-c._idx}),this.update(e),e},update:function(t){var e=!1,n,r,s,i,o;for(n=0,r=t.length;n<r;++n)s=t[n],i=s.model(),o=s.$layout,o._hidable=i&&i.display==="auto",o._visible=s.visible(),e|=o._hidable;e&&L8(t)},lookup:function(t,e){var n,r;for(n=t.length-1;n>=0;--n)if(r=t[n].$layout,r&&r._visible&&r._box.contains(e))return t[n];return null},draw:function(t,e){var n,r,s,i,o,a;for(n=0,r=e.length;n<r;++n)s=e[n],i=s.$layout,i._visible&&(o=s.geometry(),a=dP(s._el,s.model(),o),i._box.update(a,o,s.rotation()),s.draw(t,a))}},F8=function(t){if(Ge(t))return null;var e=t,n,r,s;if(Je(t))if(!Ge(t.label))e=t.label;else if(!Ge(t.r))e=t.r;else for(e="",n=Object.keys(t),s=0,r=n.length;s<r;++s)e+=(s!==0?", ":"")+n[s]+": "+t[n[s]];return""+e},V8={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:F8,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},Cr="$datalabels",hP="$default";function U8(t,e){var n=t.datalabels,r={},s=[],i,o;return n===!1?null:(n===!0&&(n={}),e=ci({},[e,n]),i=e.labels||{},o=Object.keys(i),delete e.labels,o.length?o.forEach(function(a){i[a]&&s.push(ci({},[e,i[a],{_key:a}]))}):s.push(e),r=s.reduce(function(a,l){return dt(l.listeners||{},function(c,d){a[d]=a[d]||{},a[d][l._key||hP]=c}),delete l.listeners,a},{}),{labels:s,listeners:r})}function Bv(t,e,n,r){if(e){var s=n.$context,i=n.$groups,o;e[i._set]&&(o=e[i._set][i._key],o&&xt(o,[s,r])===!0&&(t[Cr]._dirty=!0,n.update(s)))}}function B8(t,e,n,r,s){var i,o;!n&&!r||(n?r?n!==r&&(o=i=!0):o=!0:i=!0,o&&Bv(t,e.leave,n,s),i&&Bv(t,e.enter,r,s))}function z8(t,e){var n=t[Cr],r=n._listeners,s,i;if(!(!r.enter&&!r.leave)){if(e.type==="mousemove")i=Ou.lookup(n._labels,e);else if(e.type!=="mouseout")return;s=n._hovered,n._hovered=i,B8(t,r,s,i,e)}}function $8(t,e){var n=t[Cr],r=n._listeners.click,s=r&&Ou.lookup(n._labels,e);s&&Bv(t,r,s,e)}var Pm={id:"datalabels",defaults:V8,beforeInit:function(t){t[Cr]={_actives:[]}},beforeUpdate:function(t){var e=t[Cr];e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,n){var r=e.index,s=t[Cr],i=s._datasets[r]=[],o=t.isDatasetVisible(r),a=t.data.datasets[r],l=U8(a,n),c=e.meta.data||[],d=t.ctx,f,p,m,x,w,y,_,v;for(d.save(),f=0,m=c.length;f<m;++f)if(_=c[f],_[Cr]=[],o&&_&&t.getDataVisibility(f)&&!_.skip)for(p=0,x=l.labels.length;p<x;++p)w=l.labels[p],y=w._key,v=new cP(w,d,_,f),v.$groups={_set:r,_key:y||hP},v.$context={active:!1,chart:t,dataIndex:f,dataset:a,datasetIndex:r},v.update(v.$context),_[Cr].push(v),i.push(v);d.restore(),ci(s._listeners,l.listeners,{merger:function(k,A,D){A[k]=A[k]||{},A[k][e.index]=D[k],s._listened=!0}})},afterUpdate:function(t){t[Cr]._labels=Ou.prepare(t[Cr]._datasets)},afterDatasetsDraw:function(t){Ou.draw(t,t[Cr]._labels)},beforeEvent:function(t,e){if(t[Cr]._listened){var n=e.event;switch(n.type){case"mousemove":case"mouseout":z8(t,n);break;case"click":$8(t,n);break}}},afterEvent:function(t){var e=t[Cr],n=e._actives,r=e._actives=t.getActiveElements(),s=Mu.arrayDiff(n,r),i,o,a,l,c,d,f;for(i=0,o=s.length;i<o;++i)if(c=s[i],c[1])for(f=c[0].element[Cr]||[],a=0,l=f.length;a<l;++a)d=f[a],d.$context.active=c[1]===1,d.update(d.$context);(e._dirty||s.length)&&(Ou.update(e._labels),t.render()),delete e._dirty}};const fP="label";function lT(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function W8(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function pP(t,e){t.labels=e}function mP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fP;const r=[];t.datasets=e.map(s=>{const i=t.datasets.find(o=>o[n]===s[n]);return!i||!s.data||r.includes(i)?{...s}:(r.push(i),Object.assign(i,s),i)})}function H8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fP;const n={labels:[],datasets:[]};return pP(n,t.labels),mP(n,t.datasets,e),n}function q8(t,e){const{height:n=150,width:r=300,redraw:s=!1,datasetIdKey:i,type:o,data:a,options:l,plugins:c=[],fallbackContent:d,updateMode:f,...p}=t,m=T.useRef(null),x=T.useRef(null),w=()=>{m.current&&(x.current=new Hi(m.current,{type:o,data:H8(a,i),options:l&&{...l},plugins:c}),lT(e,x.current))},y=()=>{lT(e,null),x.current&&(x.current.destroy(),x.current=null)};return T.useEffect(()=>{!s&&x.current&&l&&W8(x.current,l)},[s,l]),T.useEffect(()=>{!s&&x.current&&pP(x.current.config.data,a.labels)},[s,a.labels]),T.useEffect(()=>{!s&&x.current&&a.datasets&&mP(x.current.config.data,a.datasets,i)},[s,a.datasets]),T.useEffect(()=>{x.current&&(s?(y(),setTimeout(w)):x.current.update(f))},[s,l,a.labels,a.datasets,f]),T.useEffect(()=>{x.current&&(y(),setTimeout(w))},[o]),T.useEffect(()=>(w(),()=>y()),[]),Rn.createElement("canvas",{ref:m,role:"img",height:n,width:r,...p},d)}const G8=T.forwardRef(q8);function gP(t,e){return Hi.register(e),T.forwardRef((n,r)=>Rn.createElement(G8,{...n,ref:r,type:t}))}const jw=gP("line",xf),Dw=gP("bar",_f);Hi.register(zo,$o,Aa,Tc,Rm,Pm);const Hh=(t,e)=>getComputedStyle(document.documentElement).getPropertyValue(t).trim()||e,K8=({data:t})=>{const e=Object.keys(t),n=["ready","pending","approved","edit requested"],r=[Hh("--accent-color","#60a5fa"),Hh("--pending-color","#fbbf24"),Hh("--approve-color","#34d399"),Hh("--edit-color","#f87171")],s={labels:e,datasets:n.map((o,a)=>({label:o,data:e.map(l=>t[l][o]||0),backgroundColor:r[a]}))},i={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{color:"#fff"}},scales:{x:{stacked:!0},y:{stacked:!0}}};return u.jsx("div",{className:"h-64 max-w-md mx-auto",children:u.jsx(Dw,{data:s,options:i})})};Hi.register(zo,$o,Aa,Tc,Rm,Pm);const qh=(t,e)=>getComputedStyle(document.documentElement).getPropertyValue(t).trim()||e,Y8=({data:t})=>{const e=Object.keys(t),n=[...new Set(Object.values(t).map(o=>o.designer))],r=[qh("--accent-color","#60a5fa"),qh("--approve-color","#34d399"),qh("--edit-color","#fbbf24"),qh("--reject-color","#f87171")],s={labels:e,datasets:n.map((o,a)=>({label:o,data:e.map(l=>t[l].times[o]||0),backgroundColor:r[a%r.length]}))},i={responsive:!0,maintainAspectRatio:!1,indexAxis:"y",plugins:{datalabels:{anchor:"end",align:"right"}},scales:{x:{stacked:!0},y:{stacked:!0}}};return u.jsx("div",{className:"h-64 max-w-md mx-auto",children:u.jsx(Dw,{data:s,options:i})})},yP=6048e5,Q8=864e5,Wd=6e4,Hd=36e5,X8=1e3,cT=Symbol.for("constructDateFrom");function en(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&cT in t?t[cT](e):t instanceof Date?new t.constructor(e):new Date(e)}function Pe(t,e){return en(e||t,t)}function jm(t,e,n){const r=Pe(t,n==null?void 0:n.in);return isNaN(e)?en((n==null?void 0:n.in)||t,NaN):(e&&r.setDate(r.getDate()+e),r)}function Mw(t,e,n){const r=Pe(t,n==null?void 0:n.in);if(isNaN(e))return en(t,NaN);if(!e)return r;const s=r.getDate(),i=en(t,r.getTime());i.setMonth(r.getMonth()+e+1,0);const o=i.getDate();return s>=o?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}function Ow(t,e,n){return en(t,+Pe(t)+e)}function J8(t,e,n){return Ow(t,e*Hd)}let Z8={};function Ja(){return Z8}function di(t,e){var a,l,c,d;const n=Ja(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((d=(c=n.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??0,s=Pe(t,e==null?void 0:e.in),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function cc(t,e){return di(t,{...e,weekStartsOn:1})}function vP(t,e){const n=Pe(t,e==null?void 0:e.in),r=n.getFullYear(),s=en(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=cc(s),o=en(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const a=cc(o);return n.getTime()>=i.getTime()?r+1:n.getTime()>=a.getTime()?r:r-1}function Ap(t){const e=Pe(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Za(t,...e){const n=en.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function zv(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function _P(t,e,n){const[r,s]=Za(n==null?void 0:n.in,t,e),i=zv(r),o=zv(s),a=+i-Ap(i),l=+o-Ap(o);return Math.round((a-l)/Q8)}function e7(t,e){const n=vP(t,e),r=en(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),cc(r)}function t7(t,e,n){const r=Pe(t,n==null?void 0:n.in);return r.setTime(r.getTime()+e*Wd),r}function n7(t,e,n){return Mw(t,e*3,n)}function r7(t,e,n){return Ow(t,e*1e3)}function s7(t,e,n){return jm(t,e*7,n)}function i7(t,e,n){return Mw(t,e*12,n)}function Lu(t,e){const n=+Pe(t)-+Pe(e);return n<0?-1:n>0?1:n}function o7(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function xP(t){return!(!o7(t)&&typeof t!="number"||isNaN(+Pe(t)))}function a7(t,e,n){const[r,s]=Za(n==null?void 0:n.in,t,e),i=r.getFullYear()-s.getFullYear(),o=r.getMonth()-s.getMonth();return i*12+o}function l7(t,e,n){const[r,s]=Za(n==null?void 0:n.in,t,e);return r.getFullYear()-s.getFullYear()}function wP(t,e,n){const[r,s]=Za(n==null?void 0:n.in,t,e),i=uT(r,s),o=Math.abs(_P(r,s));r.setDate(r.getDate()-i*o);const a=+(uT(r,s)===-i),l=i*(o-a);return l===0?0:l}function uT(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function qd(t){return e=>{const r=(t?Math[t]:Math.trunc)(e);return r===0?0:r}}function c7(t,e,n){const[r,s]=Za(n==null?void 0:n.in,t,e),i=(+r-+s)/Hd;return qd(n==null?void 0:n.roundingMethod)(i)}function Lw(t,e){return+Pe(t)-+Pe(e)}function u7(t,e,n){const r=Lw(t,e)/Wd;return qd(n==null?void 0:n.roundingMethod)(r)}function bP(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setHours(23,59,59,999),n}function EP(t,e){const n=Pe(t,e==null?void 0:e.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function d7(t,e){const n=Pe(t,e==null?void 0:e.in);return+bP(n,e)==+EP(n,e)}function kP(t,e,n){const[r,s,i]=Za(n==null?void 0:n.in,t,t,e),o=Lu(s,i),a=Math.abs(a7(s,i));if(a<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-o*a);let l=Lu(s,i)===-o;d7(r)&&a===1&&Lu(r,i)===1&&(l=!1);const c=o*(a-+l);return c===0?0:c}function h7(t,e,n){const r=kP(t,e,n)/3;return qd(n==null?void 0:n.roundingMethod)(r)}function f7(t,e,n){const r=Lw(t,e)/1e3;return qd(n==null?void 0:n.roundingMethod)(r)}function p7(t,e,n){const r=wP(t,e,n)/7;return qd(n==null?void 0:n.roundingMethod)(r)}function m7(t,e,n){const[r,s]=Za(n==null?void 0:n.in,t,e),i=Lu(r,s),o=Math.abs(l7(r,s));r.setFullYear(1584),s.setFullYear(1584);const a=Lu(r,s)===-i,l=i*(o-+a);return l===0?0:l}function g7(t,e){const n=Pe(t,e==null?void 0:e.in),r=n.getMonth(),s=r-r%3;return n.setMonth(s,1),n.setHours(0,0,0,0),n}function y7(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setDate(1),n.setHours(0,0,0,0),n}function v7(t,e){const n=Pe(t,e==null?void 0:e.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function TP(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function _7(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setMinutes(59,59,999),n}function x7(t,e){var a,l;const n=Ja(),r=n.weekStartsOn??((l=(a=n.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??0,s=Pe(t,e==null?void 0:e.in),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function w7(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setSeconds(59,999),n}function b7(t,e){const n=Pe(t,e==null?void 0:e.in),r=n.getMonth(),s=r-r%3+3;return n.setMonth(s,0),n.setHours(23,59,59,999),n}function E7(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setMilliseconds(999),n}const k7={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},T7=(t,e,n)=>{let r;const s=k7[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Jg(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const S7={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},I7={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},C7={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},A7={date:Jg({formats:S7,defaultWidth:"full"}),time:Jg({formats:I7,defaultWidth:"full"}),dateTime:Jg({formats:C7,defaultWidth:"full"})},R7={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},N7=(t,e,n,r)=>R7[t];function Gc(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n!=null&&n.width?String(n.width):o;s=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n!=null&&n.width?String(n.width):t.defaultWidth;s=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const P7={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},j7={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},D7={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},M7={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},O7={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},L7={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},F7=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},V7={ordinalNumber:F7,era:Gc({values:P7,defaultWidth:"wide"}),quarter:Gc({values:j7,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Gc({values:D7,defaultWidth:"wide"}),day:Gc({values:M7,defaultWidth:"wide"}),dayPeriod:Gc({values:O7,defaultWidth:"wide",formattingValues:L7,defaultFormattingWidth:"wide"})};function Kc(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?B7(a,f=>f.test(o)):U7(a,f=>f.test(o));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const d=e.slice(o.length);return{value:c,rest:d}}}function U7(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function B7(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function z7(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const $7=/^(\d+)(th|st|nd|rd)?/i,W7=/\d+/i,H7={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},q7={any:[/^b/i,/^(a|c)/i]},G7={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},K7={any:[/1/i,/2/i,/3/i,/4/i]},Y7={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Q7={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},X7={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},J7={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Z7={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},eq={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},tq={ordinalNumber:z7({matchPattern:$7,parsePattern:W7,valueCallback:t=>parseInt(t,10)}),era:Kc({matchPatterns:H7,defaultMatchWidth:"wide",parsePatterns:q7,defaultParseWidth:"any"}),quarter:Kc({matchPatterns:G7,defaultMatchWidth:"wide",parsePatterns:K7,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Kc({matchPatterns:Y7,defaultMatchWidth:"wide",parsePatterns:Q7,defaultParseWidth:"any"}),day:Kc({matchPatterns:X7,defaultMatchWidth:"wide",parsePatterns:J7,defaultParseWidth:"any"}),dayPeriod:Kc({matchPatterns:Z7,defaultMatchWidth:"any",parsePatterns:eq,defaultParseWidth:"any"})},SP={code:"en-US",formatDistance:T7,formatLong:A7,formatRelative:N7,localize:V7,match:tq,options:{weekStartsOn:0,firstWeekContainsDate:1}};function nq(t,e){const n=Pe(t,e==null?void 0:e.in);return _P(n,TP(n))+1}function IP(t,e){const n=Pe(t,e==null?void 0:e.in),r=+cc(n)-+e7(n);return Math.round(r/yP)+1}function Fw(t,e){var d,f,p,m;const n=Pe(t,e==null?void 0:e.in),r=n.getFullYear(),s=Ja(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(p=s.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,o=en((e==null?void 0:e.in)||t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=di(o,e),l=en((e==null?void 0:e.in)||t,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=di(l,e);return+n>=+a?r+1:+n>=+c?r:r-1}function rq(t,e){var a,l,c,d;const n=Ja(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(c=n.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??1,s=Fw(t,e),i=en((e==null?void 0:e.in)||t,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),di(i,e)}function CP(t,e){const n=Pe(t,e==null?void 0:e.in),r=+di(n,e)-+rq(n,e);return Math.round(r/yP)+1}function pt(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const Qi={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return pt(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):pt(n+1,2)},d(t,e){return pt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return pt(t.getHours()%12||12,e.length)},H(t,e){return pt(t.getHours(),e.length)},m(t,e){return pt(t.getMinutes(),e.length)},s(t,e){return pt(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return pt(s,e.length)}},ll={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},dT={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Qi.y(t,e)},Y:function(t,e,n,r){const s=Fw(t,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return pt(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):pt(i,e.length)},R:function(t,e){const n=vP(t);return pt(n,e.length)},u:function(t,e){const n=t.getFullYear();return pt(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return pt(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return pt(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return Qi.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return pt(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=CP(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):pt(s,e.length)},I:function(t,e,n){const r=IP(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):pt(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Qi.d(t,e)},D:function(t,e,n){const r=nq(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):pt(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return pt(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return pt(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return pt(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=ll.noon:r===0?s=ll.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=ll.evening:r>=12?s=ll.afternoon:r>=4?s=ll.morning:s=ll.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Qi.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Qi.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):pt(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):pt(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Qi.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Qi.s(t,e)},S:function(t,e){return Qi.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return fT(r);case"XXXX":case"XX":return ha(r);case"XXXXX":case"XXX":default:return ha(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return fT(r);case"xxxx":case"xx":return ha(r);case"xxxxx":case"xxx":default:return ha(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+hT(r,":");case"OOOO":default:return"GMT"+ha(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+hT(r,":");case"zzzz":default:return"GMT"+ha(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return pt(r,e.length)},T:function(t,e,n){return pt(+t,e.length)}};function hT(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+e+pt(i,2)}function fT(t,e){return t%60===0?(t>0?"-":"+")+pt(Math.abs(t)/60,2):ha(t,e)}function ha(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=pt(Math.trunc(r/60),2),i=pt(r%60,2);return n+s+e+i}const pT=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},AP=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},sq=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return pT(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",pT(r,e)).replace("{{time}}",AP(s,e))},$v={p:AP,P:sq},iq=/^D+$/,oq=/^Y+$/,aq=["D","DD","YY","YYYY"];function RP(t){return iq.test(t)}function NP(t){return oq.test(t)}function Wv(t,e,n){const r=lq(t,e,n);if(console.warn(r),aq.includes(t))throw new RangeError(r)}function lq(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cq=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,uq=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,dq=/^'([^]*?)'?$/,hq=/''/g,fq=/[a-zA-Z]/;function pq(t,e,n){var d,f,p,m,x,w,y,_;const r=Ja(),s=(n==null?void 0:n.locale)??r.locale??SP,i=(n==null?void 0:n.firstWeekContainsDate)??((f=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(p=r.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((w=(x=n==null?void 0:n.locale)==null?void 0:x.options)==null?void 0:w.weekStartsOn)??r.weekStartsOn??((_=(y=r.locale)==null?void 0:y.options)==null?void 0:_.weekStartsOn)??0,a=Pe(t,n==null?void 0:n.in);if(!xP(a))throw new RangeError("Invalid time value");let l=e.match(uq).map(v=>{const k=v[0];if(k==="p"||k==="P"){const A=$v[k];return A(v,s.formatLong)}return v}).join("").match(cq).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const k=v[0];if(k==="'")return{isToken:!1,value:mq(v)};if(dT[k])return{isToken:!0,value:v};if(k.match(fq))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(v=>{if(!v.isToken)return v.value;const k=v.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&NP(k)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&RP(k))&&Wv(k,e,String(t));const A=dT[k[0]];return A(a,k,s.localize,c)}).join("")}function mq(t){const e=t.match(dq);return e?e[1].replace(hq,"'"):t}function gq(){return Object.assign({},Ja())}function yq(t,e){const n=Pe(t,e==null?void 0:e.in).getDay();return n===0?7:n}function vq(t,e){const n=_q(e)?new e(0):en(e,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n}function _q(t){var e;return typeof t=="function"&&((e=t.prototype)==null?void 0:e.constructor)===t}const xq=10;class PP{constructor(){Y(this,"subPriority",0)}validate(e,n){return!0}}class wq extends PP{constructor(e,n,r,s,i){super(),this.value=e,this.validateValue=n,this.setValue=r,this.priority=s,i&&(this.subPriority=i)}validate(e,n){return this.validateValue(e,this.value,n)}set(e,n,r){return this.setValue(e,n,this.value,r)}}class bq extends PP{constructor(n,r){super();Y(this,"priority",xq);Y(this,"subPriority",-1);this.context=n||(s=>en(r,s))}set(n,r){return r.timestampIsSet?n:en(n,vq(n,this.context))}}class ut{run(e,n,r,s){const i=this.parse(e,n,r,s);return i?{setter:new wq(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,n,r){return!0}}class Eq extends ut{constructor(){super(...arguments);Y(this,"priority",140);Y(this,"incompatibleTokens",["R","u","t","T"])}parse(n,r,s){switch(r){case"G":case"GG":case"GGG":return s.era(n,{width:"abbreviated"})||s.era(n,{width:"narrow"});case"GGGGG":return s.era(n,{width:"narrow"});case"GGGG":default:return s.era(n,{width:"wide"})||s.era(n,{width:"abbreviated"})||s.era(n,{width:"narrow"})}}set(n,r,s){return r.era=s,n.setFullYear(s,0,1),n.setHours(0,0,0,0),n}}const on={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Qs={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function an(t,e){return t&&{value:e(t.value),rest:t.rest}}function Ht(t,e){const n=e.match(t);return n?{value:parseInt(n[0],10),rest:e.slice(n[0].length)}:null}function Xs(t,e){const n=e.match(t);if(!n)return null;if(n[0]==="Z")return{value:0,rest:e.slice(1)};const r=n[1]==="+"?1:-1,s=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:r*(s*Hd+i*Wd+o*X8),rest:e.slice(n[0].length)}}function jP(t){return Ht(on.anyDigitsSigned,t)}function tn(t,e){switch(t){case 1:return Ht(on.singleDigit,e);case 2:return Ht(on.twoDigits,e);case 3:return Ht(on.threeDigits,e);case 4:return Ht(on.fourDigits,e);default:return Ht(new RegExp("^\\d{1,"+t+"}"),e)}}function Rp(t,e){switch(t){case 1:return Ht(on.singleDigitSigned,e);case 2:return Ht(on.twoDigitsSigned,e);case 3:return Ht(on.threeDigitsSigned,e);case 4:return Ht(on.fourDigitsSigned,e);default:return Ht(new RegExp("^-?\\d{1,"+t+"}"),e)}}function Vw(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function DP(t,e){const n=e>0,r=n?e:1-e;let s;if(r<=50)s=t||100;else{const i=r+50,o=Math.trunc(i/100)*100,a=t>=i%100;s=t+o-(a?100:0)}return n?s:1-s}function MP(t){return t%400===0||t%4===0&&t%100!==0}class kq extends ut{constructor(){super(...arguments);Y(this,"priority",130);Y(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(n,r,s){const i=o=>({year:o,isTwoDigitYear:r==="yy"});switch(r){case"y":return an(tn(4,n),i);case"yo":return an(s.ordinalNumber(n,{unit:"year"}),i);default:return an(tn(r.length,n),i)}}validate(n,r){return r.isTwoDigitYear||r.year>0}set(n,r,s){const i=n.getFullYear();if(s.isTwoDigitYear){const a=DP(s.year,i);return n.setFullYear(a,0,1),n.setHours(0,0,0,0),n}const o=!("era"in r)||r.era===1?s.year:1-s.year;return n.setFullYear(o,0,1),n.setHours(0,0,0,0),n}}class Tq extends ut{constructor(){super(...arguments);Y(this,"priority",130);Y(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(n,r,s){const i=o=>({year:o,isTwoDigitYear:r==="YY"});switch(r){case"Y":return an(tn(4,n),i);case"Yo":return an(s.ordinalNumber(n,{unit:"year"}),i);default:return an(tn(r.length,n),i)}}validate(n,r){return r.isTwoDigitYear||r.year>0}set(n,r,s,i){const o=Fw(n,i);if(s.isTwoDigitYear){const l=DP(s.year,o);return n.setFullYear(l,0,i.firstWeekContainsDate),n.setHours(0,0,0,0),di(n,i)}const a=!("era"in r)||r.era===1?s.year:1-s.year;return n.setFullYear(a,0,i.firstWeekContainsDate),n.setHours(0,0,0,0),di(n,i)}}class Sq extends ut{constructor(){super(...arguments);Y(this,"priority",130);Y(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(n,r){return Rp(r==="R"?4:r.length,n)}set(n,r,s){const i=en(n,0);return i.setFullYear(s,0,4),i.setHours(0,0,0,0),cc(i)}}class Iq extends ut{constructor(){super(...arguments);Y(this,"priority",130);Y(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(n,r){return Rp(r==="u"?4:r.length,n)}set(n,r,s){return n.setFullYear(s,0,1),n.setHours(0,0,0,0),n}}class Cq extends ut{constructor(){super(...arguments);Y(this,"priority",120);Y(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(n,r,s){switch(r){case"Q":case"QQ":return tn(r.length,n);case"Qo":return s.ordinalNumber(n,{unit:"quarter"});case"QQQ":return s.quarter(n,{width:"abbreviated",context:"formatting"})||s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQQ":return s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(n,{width:"wide",context:"formatting"})||s.quarter(n,{width:"abbreviated",context:"formatting"})||s.quarter(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=1&&r<=4}set(n,r,s){return n.setMonth((s-1)*3,1),n.setHours(0,0,0,0),n}}class Aq extends ut{constructor(){super(...arguments);Y(this,"priority",120);Y(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(n,r,s){switch(r){case"q":case"qq":return tn(r.length,n);case"qo":return s.ordinalNumber(n,{unit:"quarter"});case"qqq":return s.quarter(n,{width:"abbreviated",context:"standalone"})||s.quarter(n,{width:"narrow",context:"standalone"});case"qqqqq":return s.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(n,{width:"wide",context:"standalone"})||s.quarter(n,{width:"abbreviated",context:"standalone"})||s.quarter(n,{width:"narrow",context:"standalone"})}}validate(n,r){return r>=1&&r<=4}set(n,r,s){return n.setMonth((s-1)*3,1),n.setHours(0,0,0,0),n}}class Rq extends ut{constructor(){super(...arguments);Y(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);Y(this,"priority",110)}parse(n,r,s){const i=o=>o-1;switch(r){case"M":return an(Ht(on.month,n),i);case"MM":return an(tn(2,n),i);case"Mo":return an(s.ordinalNumber(n,{unit:"month"}),i);case"MMM":return s.month(n,{width:"abbreviated",context:"formatting"})||s.month(n,{width:"narrow",context:"formatting"});case"MMMMM":return s.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(n,{width:"wide",context:"formatting"})||s.month(n,{width:"abbreviated",context:"formatting"})||s.month(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=0&&r<=11}set(n,r,s){return n.setMonth(s,1),n.setHours(0,0,0,0),n}}class Nq extends ut{constructor(){super(...arguments);Y(this,"priority",110);Y(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(n,r,s){const i=o=>o-1;switch(r){case"L":return an(Ht(on.month,n),i);case"LL":return an(tn(2,n),i);case"Lo":return an(s.ordinalNumber(n,{unit:"month"}),i);case"LLL":return s.month(n,{width:"abbreviated",context:"standalone"})||s.month(n,{width:"narrow",context:"standalone"});case"LLLLL":return s.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(n,{width:"wide",context:"standalone"})||s.month(n,{width:"abbreviated",context:"standalone"})||s.month(n,{width:"narrow",context:"standalone"})}}validate(n,r){return r>=0&&r<=11}set(n,r,s){return n.setMonth(s,1),n.setHours(0,0,0,0),n}}function Pq(t,e,n){const r=Pe(t,n==null?void 0:n.in),s=CP(r,n)-e;return r.setDate(r.getDate()-s*7),Pe(r,n==null?void 0:n.in)}class jq extends ut{constructor(){super(...arguments);Y(this,"priority",100);Y(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(n,r,s){switch(r){case"w":return Ht(on.week,n);case"wo":return s.ordinalNumber(n,{unit:"week"});default:return tn(r.length,n)}}validate(n,r){return r>=1&&r<=53}set(n,r,s,i){return di(Pq(n,s,i),i)}}function Dq(t,e,n){const r=Pe(t,n==null?void 0:n.in),s=IP(r,n)-e;return r.setDate(r.getDate()-s*7),r}class Mq extends ut{constructor(){super(...arguments);Y(this,"priority",100);Y(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(n,r,s){switch(r){case"I":return Ht(on.week,n);case"Io":return s.ordinalNumber(n,{unit:"week"});default:return tn(r.length,n)}}validate(n,r){return r>=1&&r<=53}set(n,r,s){return cc(Dq(n,s))}}const Oq=[31,28,31,30,31,30,31,31,30,31,30,31],Lq=[31,29,31,30,31,30,31,31,30,31,30,31];class Fq extends ut{constructor(){super(...arguments);Y(this,"priority",90);Y(this,"subPriority",1);Y(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(n,r,s){switch(r){case"d":return Ht(on.date,n);case"do":return s.ordinalNumber(n,{unit:"date"});default:return tn(r.length,n)}}validate(n,r){const s=n.getFullYear(),i=MP(s),o=n.getMonth();return i?r>=1&&r<=Lq[o]:r>=1&&r<=Oq[o]}set(n,r,s){return n.setDate(s),n.setHours(0,0,0,0),n}}class Vq extends ut{constructor(){super(...arguments);Y(this,"priority",90);Y(this,"subpriority",1);Y(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(n,r,s){switch(r){case"D":case"DD":return Ht(on.dayOfYear,n);case"Do":return s.ordinalNumber(n,{unit:"date"});default:return tn(r.length,n)}}validate(n,r){const s=n.getFullYear();return MP(s)?r>=1&&r<=366:r>=1&&r<=365}set(n,r,s){return n.setMonth(0,s),n.setHours(0,0,0,0),n}}function Uw(t,e,n){var f,p,m,x;const r=Ja(),s=(n==null?void 0:n.weekStartsOn)??((p=(f=n==null?void 0:n.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??r.weekStartsOn??((x=(m=r.locale)==null?void 0:m.options)==null?void 0:x.weekStartsOn)??0,i=Pe(t,n==null?void 0:n.in),o=i.getDay(),l=(e%7+7)%7,c=7-s,d=e<0||e>6?e-(o+c)%7:(l+c)%7-(o+c)%7;return jm(i,d,n)}class Uq extends ut{constructor(){super(...arguments);Y(this,"priority",90);Y(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(n,r,s){switch(r){case"E":case"EE":case"EEE":return s.day(n,{width:"abbreviated",context:"formatting"})||s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"});case"EEEEE":return s.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"});case"EEEE":default:return s.day(n,{width:"wide",context:"formatting"})||s.day(n,{width:"abbreviated",context:"formatting"})||s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=0&&r<=6}set(n,r,s,i){return n=Uw(n,s,i),n.setHours(0,0,0,0),n}}class Bq extends ut{constructor(){super(...arguments);Y(this,"priority",90);Y(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(n,r,s,i){const o=a=>{const l=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+l};switch(r){case"e":case"ee":return an(tn(r.length,n),o);case"eo":return an(s.ordinalNumber(n,{unit:"day"}),o);case"eee":return s.day(n,{width:"abbreviated",context:"formatting"})||s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"});case"eeeee":return s.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"});case"eeee":default:return s.day(n,{width:"wide",context:"formatting"})||s.day(n,{width:"abbreviated",context:"formatting"})||s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"})}}validate(n,r){return r>=0&&r<=6}set(n,r,s,i){return n=Uw(n,s,i),n.setHours(0,0,0,0),n}}class zq extends ut{constructor(){super(...arguments);Y(this,"priority",90);Y(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(n,r,s,i){const o=a=>{const l=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+l};switch(r){case"c":case"cc":return an(tn(r.length,n),o);case"co":return an(s.ordinalNumber(n,{unit:"day"}),o);case"ccc":return s.day(n,{width:"abbreviated",context:"standalone"})||s.day(n,{width:"short",context:"standalone"})||s.day(n,{width:"narrow",context:"standalone"});case"ccccc":return s.day(n,{width:"narrow",context:"standalone"});case"cccccc":return s.day(n,{width:"short",context:"standalone"})||s.day(n,{width:"narrow",context:"standalone"});case"cccc":default:return s.day(n,{width:"wide",context:"standalone"})||s.day(n,{width:"abbreviated",context:"standalone"})||s.day(n,{width:"short",context:"standalone"})||s.day(n,{width:"narrow",context:"standalone"})}}validate(n,r){return r>=0&&r<=6}set(n,r,s,i){return n=Uw(n,s,i),n.setHours(0,0,0,0),n}}function $q(t,e,n){const r=Pe(t,n==null?void 0:n.in),s=yq(r,n),i=e-s;return jm(r,i,n)}class Wq extends ut{constructor(){super(...arguments);Y(this,"priority",90);Y(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(n,r,s){const i=o=>o===0?7:o;switch(r){case"i":case"ii":return tn(r.length,n);case"io":return s.ordinalNumber(n,{unit:"day"});case"iii":return an(s.day(n,{width:"abbreviated",context:"formatting"})||s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"}),i);case"iiiii":return an(s.day(n,{width:"narrow",context:"formatting"}),i);case"iiiiii":return an(s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"}),i);case"iiii":default:return an(s.day(n,{width:"wide",context:"formatting"})||s.day(n,{width:"abbreviated",context:"formatting"})||s.day(n,{width:"short",context:"formatting"})||s.day(n,{width:"narrow",context:"formatting"}),i)}}validate(n,r){return r>=1&&r<=7}set(n,r,s){return n=$q(n,s),n.setHours(0,0,0,0),n}}class Hq extends ut{constructor(){super(...arguments);Y(this,"priority",80);Y(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(n,r,s){switch(r){case"a":case"aa":case"aaa":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"})||s.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaaa":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})||s.dayPeriod(n,{width:"abbreviated",context:"formatting"})||s.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,r,s){return n.setHours(Vw(s),0,0,0),n}}class qq extends ut{constructor(){super(...arguments);Y(this,"priority",80);Y(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(n,r,s){switch(r){case"b":case"bb":case"bbb":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"})||s.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbbb":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})||s.dayPeriod(n,{width:"abbreviated",context:"formatting"})||s.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,r,s){return n.setHours(Vw(s),0,0,0),n}}class Gq extends ut{constructor(){super(...arguments);Y(this,"priority",80);Y(this,"incompatibleTokens",["a","b","t","T"])}parse(n,r,s){switch(r){case"B":case"BB":case"BBB":return s.dayPeriod(n,{width:"abbreviated",context:"formatting"})||s.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBBB":return s.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(n,{width:"wide",context:"formatting"})||s.dayPeriod(n,{width:"abbreviated",context:"formatting"})||s.dayPeriod(n,{width:"narrow",context:"formatting"})}}set(n,r,s){return n.setHours(Vw(s),0,0,0),n}}class Kq extends ut{constructor(){super(...arguments);Y(this,"priority",70);Y(this,"incompatibleTokens",["H","K","k","t","T"])}parse(n,r,s){switch(r){case"h":return Ht(on.hour12h,n);case"ho":return s.ordinalNumber(n,{unit:"hour"});default:return tn(r.length,n)}}validate(n,r){return r>=1&&r<=12}set(n,r,s){const i=n.getHours()>=12;return i&&s<12?n.setHours(s+12,0,0,0):!i&&s===12?n.setHours(0,0,0,0):n.setHours(s,0,0,0),n}}class Yq extends ut{constructor(){super(...arguments);Y(this,"priority",70);Y(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(n,r,s){switch(r){case"H":return Ht(on.hour23h,n);case"Ho":return s.ordinalNumber(n,{unit:"hour"});default:return tn(r.length,n)}}validate(n,r){return r>=0&&r<=23}set(n,r,s){return n.setHours(s,0,0,0),n}}class Qq extends ut{constructor(){super(...arguments);Y(this,"priority",70);Y(this,"incompatibleTokens",["h","H","k","t","T"])}parse(n,r,s){switch(r){case"K":return Ht(on.hour11h,n);case"Ko":return s.ordinalNumber(n,{unit:"hour"});default:return tn(r.length,n)}}validate(n,r){return r>=0&&r<=11}set(n,r,s){return n.getHours()>=12&&s<12?n.setHours(s+12,0,0,0):n.setHours(s,0,0,0),n}}class Xq extends ut{constructor(){super(...arguments);Y(this,"priority",70);Y(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(n,r,s){switch(r){case"k":return Ht(on.hour24h,n);case"ko":return s.ordinalNumber(n,{unit:"hour"});default:return tn(r.length,n)}}validate(n,r){return r>=1&&r<=24}set(n,r,s){const i=s<=24?s%24:s;return n.setHours(i,0,0,0),n}}class Jq extends ut{constructor(){super(...arguments);Y(this,"priority",60);Y(this,"incompatibleTokens",["t","T"])}parse(n,r,s){switch(r){case"m":return Ht(on.minute,n);case"mo":return s.ordinalNumber(n,{unit:"minute"});default:return tn(r.length,n)}}validate(n,r){return r>=0&&r<=59}set(n,r,s){return n.setMinutes(s,0,0),n}}class Zq extends ut{constructor(){super(...arguments);Y(this,"priority",50);Y(this,"incompatibleTokens",["t","T"])}parse(n,r,s){switch(r){case"s":return Ht(on.second,n);case"so":return s.ordinalNumber(n,{unit:"second"});default:return tn(r.length,n)}}validate(n,r){return r>=0&&r<=59}set(n,r,s){return n.setSeconds(s,0),n}}class eG extends ut{constructor(){super(...arguments);Y(this,"priority",30);Y(this,"incompatibleTokens",["t","T"])}parse(n,r){const s=i=>Math.trunc(i*Math.pow(10,-r.length+3));return an(tn(r.length,n),s)}set(n,r,s){return n.setMilliseconds(s),n}}class tG extends ut{constructor(){super(...arguments);Y(this,"priority",10);Y(this,"incompatibleTokens",["t","T","x"])}parse(n,r){switch(r){case"X":return Xs(Qs.basicOptionalMinutes,n);case"XX":return Xs(Qs.basic,n);case"XXXX":return Xs(Qs.basicOptionalSeconds,n);case"XXXXX":return Xs(Qs.extendedOptionalSeconds,n);case"XXX":default:return Xs(Qs.extended,n)}}set(n,r,s){return r.timestampIsSet?n:en(n,n.getTime()-Ap(n)-s)}}class nG extends ut{constructor(){super(...arguments);Y(this,"priority",10);Y(this,"incompatibleTokens",["t","T","X"])}parse(n,r){switch(r){case"x":return Xs(Qs.basicOptionalMinutes,n);case"xx":return Xs(Qs.basic,n);case"xxxx":return Xs(Qs.basicOptionalSeconds,n);case"xxxxx":return Xs(Qs.extendedOptionalSeconds,n);case"xxx":default:return Xs(Qs.extended,n)}}set(n,r,s){return r.timestampIsSet?n:en(n,n.getTime()-Ap(n)-s)}}class rG extends ut{constructor(){super(...arguments);Y(this,"priority",40);Y(this,"incompatibleTokens","*")}parse(n){return jP(n)}set(n,r,s){return[en(n,s*1e3),{timestampIsSet:!0}]}}class sG extends ut{constructor(){super(...arguments);Y(this,"priority",20);Y(this,"incompatibleTokens","*")}parse(n){return jP(n)}set(n,r,s){return[en(n,s),{timestampIsSet:!0}]}}const iG={G:new Eq,y:new kq,Y:new Tq,R:new Sq,u:new Iq,Q:new Cq,q:new Aq,M:new Rq,L:new Nq,w:new jq,I:new Mq,d:new Fq,D:new Vq,E:new Uq,e:new Bq,c:new zq,i:new Wq,a:new Hq,b:new qq,B:new Gq,h:new Kq,H:new Yq,K:new Qq,k:new Xq,m:new Jq,s:new Zq,S:new eG,X:new tG,x:new nG,t:new rG,T:new sG},oG=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,aG=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,lG=/^'([^]*?)'?$/,cG=/''/g,uG=/\S/,dG=/[a-zA-Z]/;function hG(t,e,n,r){var y,_,v,k,A,D,O,I;const s=()=>en((r==null?void 0:r.in)||n,NaN),i=gq(),o=(r==null?void 0:r.locale)??i.locale??SP,a=(r==null?void 0:r.firstWeekContainsDate)??((_=(y=r==null?void 0:r.locale)==null?void 0:y.options)==null?void 0:_.firstWeekContainsDate)??i.firstWeekContainsDate??((k=(v=i.locale)==null?void 0:v.options)==null?void 0:k.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((D=(A=r==null?void 0:r.locale)==null?void 0:A.options)==null?void 0:D.weekStartsOn)??i.weekStartsOn??((I=(O=i.locale)==null?void 0:O.options)==null?void 0:I.weekStartsOn)??0;if(!e)return t?s():Pe(n,r==null?void 0:r.in);const c={firstWeekContainsDate:a,weekStartsOn:l,locale:o},d=[new bq(r==null?void 0:r.in,n)],f=e.match(aG).map(E=>{const S=E[0];if(S in $v){const C=$v[S];return C(E,o.formatLong)}return E}).join("").match(oG),p=[];for(let E of f){!(r!=null&&r.useAdditionalWeekYearTokens)&&NP(E)&&Wv(E,e,t),!(r!=null&&r.useAdditionalDayOfYearTokens)&&RP(E)&&Wv(E,e,t);const S=E[0],C=iG[S];if(C){const{incompatibleTokens:N}=C;if(Array.isArray(N)){const P=p.find(ne=>N.includes(ne.token)||ne.token===S);if(P)throw new RangeError(`The format string mustn't contain \`${P.fullToken}\` and \`${E}\` at the same time`)}else if(C.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${E}\` and any other token at the same time`);p.push({token:S,fullToken:E});const j=C.run(t,E,o.match,c);if(!j)return s();d.push(j.setter),t=j.rest}else{if(S.match(dG))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");if(E==="''"?E="'":S==="'"&&(E=fG(E)),t.indexOf(E)===0)t=t.slice(E.length);else return s()}}if(t.length>0&&uG.test(t))return s();const m=d.map(E=>E.priority).sort((E,S)=>S-E).filter((E,S,C)=>C.indexOf(E)===S).map(E=>d.filter(S=>S.priority===E).sort((S,C)=>C.subPriority-S.subPriority)).map(E=>E[0]);let x=Pe(n,r==null?void 0:r.in);if(isNaN(+x))return s();const w={};for(const E of m){if(!E.validate(x,c))return s();const S=E.set(x,w,c);Array.isArray(S)?(x=S[0],Object.assign(w,S[1])):x=S}return x}function fG(t){return t.match(lG)[1].replace(cG,"'")}function pG(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setMinutes(0,0,0),n}function mG(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setSeconds(0,0),n}function gG(t,e){const n=Pe(t,e==null?void 0:e.in);return n.setMilliseconds(0),n}function yG(t,e){const n=()=>en(e==null?void 0:e.in,NaN),r=(e==null?void 0:e.additionalDigits)??2,s=wG(t);let i;if(s.date){const c=bG(s.date,r);i=EG(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const o=+i;let a=0,l;if(s.time&&(a=kG(s.time),isNaN(a)))return n();if(s.timezone){if(l=TG(s.timezone),isNaN(l))return n()}else{const c=new Date(o+a),d=Pe(0,e==null?void 0:e.in);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return Pe(o+a+l,e==null?void 0:e.in)}const Gh={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},vG=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,_G=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,xG=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wG(t){const e={},n=t.split(Gh.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],Gh.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Gh.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const s=Gh.timezone.exec(r);s?(e.time=r.replace(s[1],""),e.timezone=s[1]):e.time=r}return e}function bG(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function EG(t,e){if(e===null)return new Date(NaN);const n=t.match(vG);if(!n)return new Date(NaN);const r=!!n[4],s=Yc(n[1]),i=Yc(n[2])-1,o=Yc(n[3]),a=Yc(n[4]),l=Yc(n[5])-1;if(r)return RG(e,a,l)?SG(e,a,l):new Date(NaN);{const c=new Date(0);return!CG(e,i,o)||!AG(e,s)?new Date(NaN):(c.setUTCFullYear(e,i,Math.max(s,o)),c)}}function Yc(t){return t?parseInt(t):1}function kG(t){const e=t.match(_G);if(!e)return NaN;const n=Zg(e[1]),r=Zg(e[2]),s=Zg(e[3]);return NG(n,r,s)?n*Hd+r*Wd+s*1e3:NaN}function Zg(t){return t&&parseFloat(t.replace(",","."))||0}function TG(t){if(t==="Z")return 0;const e=t.match(xG);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return PG(r,s)?n*(r*Hd+s*Wd):NaN}function SG(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const s=r.getUTCDay()||7,i=(e-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const IG=[31,null,31,30,31,30,31,31,30,31,30,31];function OP(t){return t%400===0||t%4===0&&t%100!==0}function CG(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(IG[e]||(OP(t)?29:28))}function AG(t,e){return e>=1&&e<=(OP(t)?366:365)}function RG(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function NG(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function PG(t,e){return e>=0&&e<=59}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const jG={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};WN._date.override({_id:"date-fns",formats:function(){return jG},parse:function(t,e){if(t===null||typeof t>"u")return null;const n=typeof t;return n==="number"||t instanceof Date?t=Pe(t):n==="string"&&(typeof e=="string"?t=hG(t,e,new Date,this.options):t=yG(t,this.options)),xP(t)?t.getTime():null},format:function(t,e){return pq(t,e,this.options)},add:function(t,e,n){switch(n){case"millisecond":return Ow(t,e);case"second":return r7(t,e);case"minute":return t7(t,e);case"hour":return J8(t,e);case"day":return jm(t,e);case"week":return s7(t,e);case"month":return Mw(t,e);case"quarter":return n7(t,e);case"year":return i7(t,e);default:return t}},diff:function(t,e,n){switch(n){case"millisecond":return Lw(t,e);case"second":return f7(t,e);case"minute":return u7(t,e);case"hour":return c7(t,e);case"day":return wP(t,e);case"week":return p7(t,e);case"month":return kP(t,e);case"quarter":return h7(t,e);case"year":return m7(t,e);default:return 0}},startOf:function(t,e,n){switch(e){case"second":return gG(t);case"minute":return mG(t);case"hour":return pG(t);case"day":return zv(t);case"week":return di(t);case"isoWeek":return di(t,{weekStartsOn:+n});case"month":return y7(t);case"quarter":return g7(t);case"year":return TP(t);default:return t}},endOf:function(t,e){switch(e){case"second":return E7(t);case"minute":return w7(t);case"hour":return _7(t);case"day":return bP(t);case"week":return x7(t);case"month":return EP(t);case"quarter":return b7(t);case"year":return v7(t);default:return t}}});Hi.register(zo,$o,za,Ca,ba,Tc,Rm,Pm);const Kh=(t,e)=>getComputedStyle(document.documentElement).getPropertyValue(t).trim()||e,DG=({data:t})=>{const e=Object.keys(t),n=[...new Set(e.flatMap(o=>Object.keys(t[o])))].sort(),r=[Kh("--accent-color","#60a5fa"),Kh("--approve-color","#34d399"),Kh("--edit-color","#fbbf24"),Kh("--reject-color","#f87171")],s={labels:n,datasets:e.map((o,a)=>({label:o,data:n.map(l=>t[o][l]||0),fill:!1,borderColor:r[a%r.length]}))},i={responsive:!0,maintainAspectRatio:!1,parsing:!1,plugins:{legend:{position:"bottom"},datalabels:{display:!1}},scales:{x:{type:"time",time:{unit:"day"}}}};return u.jsx("div",{className:"h-64 max-w-md mx-auto",children:u.jsx(jw,{data:s,options:i})})};Hi.register(zo,$o,za,Ca,ba,Tc,Rm);const ey=(t,e)=>getComputedStyle(document.documentElement).getPropertyValue(t).trim()||e,MG=({data:t})=>{const e=["Approved","Rejected","Edit Requested"],n=[...new Set(Object.keys(t))].sort(),r=[ey("--approve-color","#34d399"),ey("--reject-color","#f87171"),ey("--edit-color","#fbbf24")],s={labels:n,datasets:e.map((o,a)=>({label:o,data:n.map(l=>t[l]&&t[l][o]||0),borderColor:r[a],fill:!1}))},i={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}},scales:{x:{type:"time",time:{unit:"day"}}}};return u.jsx("div",{className:"h-64 max-w-md mx-auto",children:u.jsx(jw,{data:s,options:i})})};Hi.register(zo,$o,Aa,Tc,Pm);const OG=(t,e)=>getComputedStyle(document.documentElement).getPropertyValue(t).trim()||e,LG=t=>{let e=t.replace("#","");e.length===3&&(e=e.split("").map(o=>o+o).join(""));const n=parseInt(e,16),r=n>>16&255,s=n>>8&255,i=n&255;return`${r},${s},${i}`},FG=({data:t})=>{const e=Object.keys(t),n=[...new Set(e.flatMap(o=>Object.keys(t[o])))],r=OG("--accent-color","#3b82f6"),s={labels:e,datasets:n.map((o,a)=>({label:o,data:e.map(l=>t[l][o]||0),backgroundColor:`rgba(${LG(r)},${.3+a/n.length})`}))},i={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{color:"#fff"},legend:{position:"bottom"}},scales:{x:{stacked:!0},y:{stacked:!0}}};return u.jsx("div",{className:"h-64 max-w-md mx-auto",children:u.jsx(Dw,{data:s,options:i})})};Hi.register(zo,$o,za,Ca,ba,Tc);const VG=(t,e)=>getComputedStyle(document.documentElement).getPropertyValue(t).trim()||e,UG=({data:t})=>{const e=Object.keys(t).sort(),n={labels:e,datasets:[{label:"Unresolved Edit Requests",data:e.map(s=>t[s]),borderColor:VG("--edit-color","#fbbf24"),fill:!1}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{type:"time",time:{unit:"day"}}}};return u.jsx("div",{className:"h-64 max-w-md mx-auto",children:u.jsx(jw,{data:n,options:r})})},BG={statusByBrand:{},uploads:{},reviewOutcomes:{},comments:{},unresolved:{},reviewTimes:{},statusTotals:{pending:0,ready:0,approved:0,rejected:0,edit_requested:0}};function zG(t){const[e,n]=T.useState(BG);return T.useEffect(()=>{if(!(t!=null&&t.start)||!(t!=null&&t.end))return;(async()=>{var O,I;const s=new Date(t.start),i=new Date(t.end);i.setDate(i.getDate()+1);const o=cn.fromDate(s),a=cn.fromDate(i),l={},c={},d={},f={},p={},m={},x={pending:0,ready:0,approved:0,rejected:0,edit_requested:0},w=["pending","ready","approved","rejected","edit_requested"];await Promise.all(w.map(async E=>{const S=await r5(un(yf(H,"assets"),Nt("status","==",E),Nt("uploadedAt",">=",o),Nt("uploadedAt","<",a)));x[E]=S.data().count||0}));const y={},_={},v=await Le(un(yf(H,"assets"),Nt("uploadedAt",">=",o),Nt("uploadedAt","<",a)));for(const E of v.docs){const S=E.data();x[S.status]!==void 0&&(x[S.status]+=1);const C=S.brandCode||"Unknown",N=S.status==="edit_requested"?"edit requested":S.status;l[C]||(l[C]={ready:0,pending:0,approved:0,"edit requested":0}),l[C][N]=(l[C][N]||0)+1;const j=S.adGroupId||E.ref.parent.parent.id;if(!y[j]){const ae=await Qr(oe(H,"adGroups",j));y[j]=ae.exists()?ae.data():{}}const P=y[j],ne=P.uploadedBy||"unknown";if(c[ne]||(c[ne]={}),(O=S.uploadedAt)!=null&&O.toDate){const ae=S.uploadedAt.toDate().toISOString().slice(0,10);c[ne][ae]=(c[ne][ae]||0)+1}if(S.status==="edit_requested"&&!S.isResolved){const ae=(I=S.lastUpdatedAt)!=null&&I.toDate?S.lastUpdatedAt.toDate().toISOString().slice(0,10):null;ae&&(p[ae]=(p[ae]||0)+1)}if(S.uploadedAt&&S.lastUpdatedAt){const ae=(S.lastUpdatedAt.toDate()-S.uploadedAt.toDate())/36e5,F=P.name||j;m[F]||(m[F]={designer:ne,times:{},count:{}}),m[F].times[ne]=(m[F].times[ne]||0)+ae,m[F].count[ne]=(m[F].count[ne]||0)+1}}(await Le(un(yf(H,"responses"),Nt("timestamp",">=",o),Nt("timestamp","<",a)))).docs.forEach(E=>{var N;const S=E.data(),C=(N=S.timestamp)!=null&&N.toDate?S.timestamp.toDate().toISOString().slice(0,10):null;if(C){d[C]||(d[C]={Approved:0,Rejected:0,"Edit Requested":0});const j=S.response==="approve"?"Approved":S.response==="reject"?"Rejected":"Edit Requested";d[C][j]+=1}if(S.comment){const j=S.reviewerName||S.userEmail||S.userId||"Unknown",P=S.brandCode||"Unknown";f[j]||(f[j]={}),f[j][P]=(f[j][P]||0)+1}});const A=Object.keys(c);await Promise.all(A.map(async E=>{const S=await Qr(oe(H,"users",E));_[E]=S.exists()&&(S.data().fullName||S.data().email)||E}));const D={};A.forEach(E=>{const S=_[E]||E;D[S]=c[E]}),Object.keys(m).forEach(E=>{const S=m[E],C={};Object.keys(S.times).forEach(N=>{const j=_[N]||N,P=S.times[N]/S.count[N];C[j]=parseFloat(P.toFixed(2))}),m[E]={designer:_[S.designer]||S.designer,times:C}}),n({statusByBrand:l,uploads:D,reviewOutcomes:d,comments:f,unresolved:p,reviewTimes:m,statusTotals:x})})()},[t]),e}const $G=()=>{const[t,e]=T.useState(()=>{const a=new Date,l=new Date;return l.setDate(l.getDate()-30),{start:l.toISOString().slice(0,10),end:a.toISOString().slice(0,10)}}),[n,r]=T.useState("overview"),s=zG(t),i=()=>{const a=s.statusTotals||{};return u.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[u.jsxs("div",{className:"stat-card status-pending",children:[u.jsx("p",{className:"stat-card-title",children:"Pending"}),u.jsx("p",{className:"stat-card-value",children:a.pending||0})]}),u.jsxs("div",{className:"stat-card status-ready",children:[u.jsx("p",{className:"stat-card-title",children:"Ready"}),u.jsx("p",{className:"stat-card-value",children:a.ready||0})]}),u.jsxs("div",{className:"stat-card status-approved",children:[u.jsx("p",{className:"stat-card-title",children:"Approved"}),u.jsx("p",{className:"stat-card-value",children:a.approved||0})]}),u.jsxs("div",{className:"stat-card status-rejected",children:[u.jsx("p",{className:"stat-card-title",children:"Rejected"}),u.jsx("p",{className:"stat-card-value",children:a.rejected||0})]}),u.jsxs("div",{className:"stat-card status-edit_requested",children:[u.jsx("p",{className:"stat-card-title",children:"Edit"}),u.jsx("p",{className:"stat-card-value",children:a.edit_requested||0})]})]})},o=()=>u.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[u.jsx(K8,{data:s.statusByBrand}),u.jsx(DG,{data:s.uploads}),u.jsx(MG,{data:s.reviewOutcomes}),u.jsx(UG,{data:s.unresolved}),u.jsx(Y8,{data:s.reviewTimes}),u.jsx(FG,{data:s.comments})]});return u.jsxs("div",{className:"p-4 space-y-4",children:[u.jsx("h1",{children:"Admin Dashboard"}),u.jsx(uz,{startDate:t.start,endDate:t.end,onChange:a=>e(a)}),u.jsx("div",{className:"flex space-x-4 mb-4",children:["overview","brand","user"].map(a=>u.jsx("button",{onClick:()=>r(a),className:`px-3 py-1 rounded ${n===a?"bg-accent-10 text-accent":"border"}`,children:a==="overview"?"Overview":a==="brand"?"Brand":"User Management"},a))}),n==="overview"&&i(),n==="brand"&&o(),n==="user"&&u.jsx("p",{children:"User management coming soon."})]})},WG=({showSidebar:t=!0})=>{const[e,n]=T.useState(""),[r,s]=T.useState(""),[i,o]=T.useState([]),[a,l]=T.useState(""),[c,d]=T.useState(!1),f=hi();T.useEffect(()=>{(async()=>{var x;if(!((x=Me.currentUser)!=null&&x.uid)){o([]);return}try{const w=await Qr(oe(H,"users",Me.currentUser.uid)),y=w.exists()?w.data().brandCodes:[];Array.isArray(y)?o(y):o([])}catch(w){console.error("Failed to fetch brand codes",w),o([])}})()},[]);const p=async m=>{var w;m.preventDefault(),d(!0);const x=e.trim()||`Group ${Date.now()}`;try{const y=await Vr(be(H,"adGroups"),{name:x,brandCode:r.trim(),notes:a.trim(),uploadedBy:((w=Me.currentUser)==null?void 0:w.uid)||null,createdAt:mn(),status:"pending",reviewedCount:0,approvedCount:0,editCount:0,rejectedCount:0,thumbnailUrl:"",lastUpdated:mn(),visibility:"private",requireAuth:!1,requirePassword:!1,password:""});f(`/ad-group/${y.id}`)}catch(y){console.error("Failed to create ad group",y)}finally{d(!1)}};return u.jsxs("div",{className:"min-h-screen p-4 max-w-md mx-auto mt-10",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Create Ad Group"}),u.jsxs("form",{onSubmit:p,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Group Name"}),u.jsx("input",{type:"text",value:e,onChange:m=>n(m.target.value),className:"w-full p-2 border rounded",placeholder:"Optional"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Brand"}),i.length>0?u.jsxs("select",{value:r,onChange:m=>s(m.target.value),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"",children:"Select brand"}),i.map(m=>u.jsx("option",{value:m,children:m},m))]}):u.jsx("p",{className:"text-sm text-gray-500",children:"No brands assigned"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Notes"}),u.jsx("textarea",{value:a,onChange:m=>l(m.target.value),className:"w-full p-2 border rounded",rows:3,placeholder:"Optional"})]}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:c,children:c?"Creating...":"Create Group"})]})]})},HG=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState(null),[o,a]=T.useState(!1),l=Me.currentUser,{role:c}=Qa(l==null?void 0:l.uid),[d,f]=T.useState(null),p=async y=>{let _=`${window.location.origin}/review/${y}`;const v=new URLSearchParams;l!=null&&l.email&&v.set("email",l.email),c&&v.set("role",c);const k=v.toString();k&&(_+=`?${k}`);const A=Au();try{await nt(oe(H,"adGroups",y),{password:A})}catch(D){console.error("Failed to set password",D)}f({url:_,password:A})};T.useEffect(()=>{(async()=>{r(!0);try{const _=be(H,"adGroups"),v=o?_:un(_,Nt("status","not-in",["archived"])),k=await Le(v),A=await Promise.all(k.docs.map(async D=>{const O=D.data();let I=O.recipeCount,E=0,S=0;const C=new Set;try{const N=await Le(be(H,"adGroups",D.id,"assets"));E=N.docs.length,N.docs.forEach(j=>{const P=j.data();if(P.status==="ready"&&(S+=1),I===void 0){const ne=Qt(P.filename||"");ne.recipeCode&&C.add(ne.recipeCode)}}),I===void 0&&(I=C.size)}catch(N){console.error("Failed to load assets",N),I===void 0&&(I=0)}return{id:D.id,...O,recipeCount:I,assetCount:E,readyCount:S,counts:{approved:O.approvedCount||0,rejected:O.rejectedCount||0,edit:O.editCount||0}}}));e(A)}catch(_){console.error("Failed to fetch groups",_),e([])}finally{r(!1)}})()},[o]);const m=async(y,_,v)=>{if(window.confirm("Delete this group?"))try{await yN(y,_,v),e(k=>k.filter(A=>A.id!==y))}catch(k){console.error("Failed to delete group",k)}},x=async y=>{var _;if(window.confirm("Archive this group?"))try{await nt(oe(H,"adGroups",y),{status:"archived",archivedAt:mn(),archivedBy:((_=Me.currentUser)==null?void 0:_.uid)||null}),e(v=>v.map(k=>k.id===y?{...k,status:"archived"}:k))}catch(v){console.error("Failed to archive group",v)}},w=async y=>{try{await nt(oe(H,"adGroups",y),{status:"pending",archivedAt:null,archivedBy:null}),e(_=>_.map(v=>v.id===y?{...v,status:"pending"}:v))}catch(_){console.error("Failed to restore group",_)}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Admin Ad Groups"}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-xl mb-2",children:"All Ad Groups"}),u.jsxs("label",{className:"block mb-2 text-sm",children:[u.jsx("input",{type:"checkbox",className:"mr-1",checked:o,onChange:y=>a(y.target.checked)}),"Show archived"]}),n?u.jsx("p",{children:"Loading groups..."}):t.length===0?u.jsx("p",{children:"No ad groups found."}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"sm:hidden space-y-4",children:t.map(y=>u.jsxs(So,{to:`/ad-group/${y.id}`,className:"block border-2 border-gray-300 dark:border-gray-600 rounded-lg text-inherit",children:[u.jsxs("div",{className:"flex items-start px-3 py-2",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-bold text-[14px] text-black dark:text-black mb-0 line-clamp-2",children:y.name}),u.jsx("p",{className:"text-[12px] text-black dark:text-black mb-0",children:y.brandCode})]}),u.jsx(Ru,{status:y.status,className:"flex-shrink-0"})]}),u.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 px-3 py-2",children:u.jsxs("div",{className:"grid grid-cols-6 text-center text-sm",children:[u.jsxs("div",{className:"flex items-center justify-center gap-1 text-gray-600",children:[u.jsx(B9,{}),u.jsx("span",{children:y.recipeCount})]}),u.jsxs("div",{className:"flex items-center justify-center gap-1 text-gray-600",children:[u.jsx(OE,{}),u.jsx("span",{children:y.assetCount})]}),u.jsxs("div",{className:"flex items-center justify-center gap-1 text-accent",children:[u.jsx(yp,{}),u.jsx("span",{children:y.readyCount})]}),u.jsxs("div",{className:"flex items-center justify-center gap-1 text-approve",children:[u.jsx(UE,{}),u.jsx("span",{children:y.counts.approved})]}),u.jsxs("div",{className:"flex items-center justify-center gap-1 text-reject",children:[u.jsx(VE,{}),u.jsx("span",{children:y.counts.rejected})]}),u.jsxs("div",{className:"flex items-center justify-center gap-1 text-edit",children:[u.jsx(Rv,{}),u.jsx("span",{children:y.counts.edit})]})]})})]},y.id))}),u.jsx("div",{className:"overflow-x-auto table-container hidden sm:block",children:u.jsxs("table",{className:"ad-table min-w-max text-[14px]",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Group Name"}),u.jsx("th",{children:"Brand"}),u.jsx("th",{className:"text-center",children:u.jsx(OE,{"aria-label":"Recipes"})}),u.jsx("th",{children:"Status"}),u.jsx("th",{className:"text-center",children:u.jsx(UE,{"aria-label":"Approved"})}),u.jsx("th",{className:"text-center",children:u.jsx(VE,{"aria-label":"Rejected"})}),u.jsx("th",{className:"text-center",children:u.jsx(Rv,{"aria-label":"Edit Requested"})}),u.jsx("th",{children:"Note"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:t.map(y=>u.jsxs("tr",{children:[u.jsx("td",{children:y.name}),u.jsx("td",{children:y.brandCode}),u.jsx("td",{className:"text-center",children:y.recipeCount}),u.jsx("td",{className:"text-center",children:u.jsx("span",{className:`status-badge status-${y.status}`,children:y.status})}),u.jsx("td",{className:"text-center text-approve",children:y.counts.approved}),u.jsx("td",{className:"text-center text-reject",children:y.counts.rejected}),u.jsx("td",{className:"text-center text-edit",children:y.counts.edit}),u.jsx("td",{className:"text-center",children:y.clientNote?u.jsxs("button",{onClick:()=>i(y.clientNote),className:"flex items-center text-gray-700 underline","aria-label":"View Client Note",children:[u.jsx(A9,{className:"mr-1"}),"View Note"]}):"-"}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs(So,{to:`/ad-group/${y.id}`,className:"btn-secondary px-2 py-0.5 flex items-center gap-1","aria-label":"View Details",children:[u.jsx(Ud,{}),u.jsx("span",{className:"text-[14px]",children:"Details"})]}),u.jsxs(So,{to:y.status==="reviewed"?`/review/${y.id}?done=1`:`/review/${y.id}`,className:"btn-secondary px-2 py-0.5 flex items-center gap-1 ml-2","aria-label":"Review",children:[u.jsx(yp,{}),u.jsx("span",{className:"text-[14px]",children:"Review"})]}),u.jsxs("button",{onClick:()=>p(y.id),className:"btn-secondary px-2 py-0.5 flex items-center gap-1 ml-2","aria-label":"Share Link",children:[u.jsx(fN,{}),u.jsx("span",{className:"text-[14px]",children:"Share"})]}),y.status==="archived"?u.jsxs("button",{onClick:()=>w(y.id),className:"btn-secondary px-2 py-0.5 flex items-center gap-1 ml-2","aria-label":"Restore",children:[u.jsx(pN,{}),u.jsx("span",{className:"text-[14px]",children:"Restore"})]}):u.jsxs("button",{onClick:()=>x(y.id),className:"btn-secondary px-2 py-0.5 flex items-center gap-1 ml-2","aria-label":"Archive",children:[u.jsx(hN,{}),u.jsx("span",{className:"text-[14px]",children:"Archive"})]}),u.jsx("button",{onClick:()=>m(y.id,y.brandCode,y.name),className:"btn-secondary px-2 py-0.5 flex items-center gap-1 ml-2 btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},y.id))})]})})]})]}),u.jsx("h2",{className:"text-xl mb-2",children:"Administration Tools"}),u.jsx("p",{className:"mb-8 text-sm text-gray-600",children:"Additional admin features will appear here."}),u.jsx(WG,{showSidebar:!1}),s&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsx("p",{className:"mb-4 whitespace-pre-wrap",children:s}),u.jsx("button",{onClick:()=>i(null),className:"btn-primary px-3 py-1",children:"Close"})]})}),d&&u.jsx(Im,{url:d.url,password:d.password,onClose:()=>f(null)})]})};function qG(){const[t,e]=T.useState(null),n=new URLSearchParams(gs().search).get("agencyId");return T.useEffect(()=>{async function r(){if(!n)return;const s=oe(H,"agencies",n),i=await Qr(s);i.exists()&&e(i.data())}r()},[n]),u.jsx("div",{className:"p-4",style:{color:t==null?void 0:t.themeColor},children:t&&u.jsx(Zn,{pngUrl:t.logoUrl,alt:`${t.name} logo`,loading:"eager",cacheKey:t.logoUrl,className:"mb-4 max-h-16 w-auto"})})}const GG=()=>u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Request"}),u.jsx("p",{children:"Coming soon..."})]}),KG=()=>u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Brand Setup"}),u.jsx("p",{children:"Coming soon..."})]}),Dm=()=>{const t=Me.currentUser,[e,n]=T.useState((t==null?void 0:t.displayName)||""),[r,s]=T.useState((t==null?void 0:t.email)||""),[i,o]=T.useState(""),[a,l]=T.useState(""),[c,d]=T.useState(""),{theme:f,setTheme:p}=gw(),m=hi(),x=t?fa(t).enrolledFactors.length>0:!1,w=async y=>{if(y.preventDefault(),!!t){l(""),d("");try{e&&e!==t.displayName&&(await pF(t,{displayName:e}),await nt(oe(H,"users",t.uid),{fullName:e})),r&&r!==t.email&&(await mF(t,r),await nt(oe(H,"users",t.uid),{email:r})),i&&(await gF(t,i),o("")),d("Account updated")}catch(_){l(_.message)}}};return u.jsxs("div",{className:"min-h-screen p-4 space-y-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Account Settings"}),u.jsxs("form",{onSubmit:w,className:"space-y-4 max-w-md",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Name"}),u.jsx("input",{type:"text",value:e,onChange:y=>n(y.target.value),className:"w-full p-2 border rounded"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Email"}),u.jsx("input",{type:"email",value:r,onChange:y=>s(y.target.value),className:"w-full p-2 border rounded"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Theme"}),u.jsxs("select",{value:f,onChange:y=>p(y.target.value),className:"border rounded px-2 py-1",children:[u.jsx("option",{value:"system",children:"System"}),u.jsx("option",{value:"light",children:"Light"}),u.jsx("option",{value:"dark",children:"Dark"})]})]}),u.jsx("h2",{className:"text-xl mt-6",children:"Login & Security"}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"New Password"}),u.jsx("input",{type:"password",value:i,onChange:y=>o(y.target.value),className:"w-full p-2 border rounded"}),u.jsx("p",{className:"text-xs text-gray-500",children:"Leave blank to keep current password"})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-medium flex items-center",children:["Two-Factor Authentication",!x&&u.jsx("span",{className:"ml-2 text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded",children:"Recommended"})]}),u.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Add an extra layer of security to your account by requiring a code when you sign in."}),x&&(t==null?void 0:t.metadata.lastLoginAt)&&u.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Last MFA login: ",new Date(Number(t.metadata.lastLoginAt)).toLocaleString()]}),u.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>m("/mfa-settings"),children:x?"Manage MFA":"Set Up MFA"})]}),a&&u.jsx("p",{className:"text-red-500 text-sm",children:a}),c&&u.jsx("p",{className:"text-green-600 text-sm",children:c}),u.jsx("button",{type:"submit",className:"btn-primary",children:"Save Changes"})]})]})},YG=()=>u.jsx(Dm,{}),QG=()=>u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Notifications"}),u.jsx("p",{children:"Coming soon..."})]}),XG=()=>u.jsx(Dm,{}),JG=()=>u.jsx(Dm,{}),ZG=()=>u.jsx(Dm,{}),eK=()=>{const[t,e]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState("client"),[o,a]=T.useState([]),[l,c]=T.useState([]),[d,f]=T.useState(!1),[p,m]=T.useState([]),[x,w]=T.useState("");T.useEffect(()=>{(async()=>{try{const v=await Le(be(H,"brands"));c(v.docs.map(k=>k.data().code))}catch(v){console.error("Failed to fetch brands",v),c([])}})()},[]);const y=async _=>{_.preventDefault(),m([]),w(""),f(!0);try{const v=await tx(Me,t,n),k=o.filter(Boolean);await li(oe(H,"users",v.user.uid),{role:s,brandCodes:k}),await Zp(v.user),w("Account created. Ask the user to verify their email."),e(""),r(""),i("client"),a([])}catch(v){const k=((v==null?void 0:v.message)||"").replace("Firebase:","").replace(/\(auth.*\)/,"").trim();m([k])}finally{f(!1)}};return u.jsxs("div",{className:"min-h-screen p-4 max-w-md mx-auto mt-10",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Create Account"}),u.jsxs("form",{onSubmit:y,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Email"}),u.jsx("input",{type:"email",value:t,onChange:_=>e(_.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Password"}),u.jsx("input",{type:"password",value:n,onChange:_=>r(_.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Role"}),u.jsxs("select",{value:s,onChange:_=>i(_.target.value),className:"w-full p-2 border rounded",children:[u.jsx("option",{value:"client",children:"Client"}),u.jsx("option",{value:"designer",children:"Designer"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Brand Codes"}),u.jsx(Sm,{value:o,onChange:a,suggestions:l,id:"brand-code-input"})]}),u.jsx(vp,{messages:p}),x&&u.jsx("p",{className:"text-green-600 text-sm",children:x}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:d,children:d?"Creating...":"Create Account"})]})]})},tK=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState(null),[o,a]=T.useState({role:"client",brandCodes:[]}),[l,c]=T.useState([]),[d,f]=T.useState(null);T.useEffect(()=>{const _=async()=>{r(!0);try{const A=(await Le(be(H,"users"))).docs.map(D=>({id:D.id,...D.data()}));e(A)}catch(k){console.error("Failed to fetch accounts",k),e([])}finally{r(!1)}},v=async()=>{try{const k=await Le(be(H,"brands"));c(k.docs.map(A=>A.data().code))}catch(k){console.error("Failed to fetch brands",k),c([])}};_(),v()},[]);const p=_=>{i(_.id),a({role:_.role||"client",brandCodes:Array.isArray(_.brandCodes)?_.brandCodes:[]})},m=()=>i(null),x=async _=>{const v=o.brandCodes.filter(Boolean);try{await nt(oe(H,"users",_),{role:o.role,brandCodes:v}),e(k=>k.map(A=>A.id===_?{...A,role:o.role,brandCodes:v}:A)),i(null)}catch(k){console.error("Failed to update account",k)}},w=async _=>{if(window.confirm("Delete this account?"))try{await Dr(oe(H,"users",_)),e(v=>v.filter(k=>k.id!==_))}catch(v){console.error("Failed to delete account",v)}},y=async _=>{if(window.confirm("Sign this user out?"))try{await H6(E9,"signOutUser")({uid:_})}catch(v){console.error("Failed to sign out user",v)}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Accounts"}),u.jsx("a",{href:"/admin/accounts/new",className:"underline text-gray-700 block mb-2",children:"Add Account"}),n?u.jsx("p",{children:"Loading accounts..."}):t.length===0?u.jsx("p",{children:"No accounts found."}):u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsxs("table",{className:"ad-table min-w-max",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Name"}),u.jsx("th",{children:"Role"}),u.jsx("th",{children:"Brand Codes"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:t.map(_=>u.jsxs("tr",{children:[u.jsx("td",{children:_.fullName||_.email||_.id}),u.jsx("td",{children:s===_.id?u.jsxs("select",{value:o.role,onChange:v=>a(k=>({...k,role:v.target.value})),className:"w-full p-1 border rounded",children:[u.jsx("option",{value:"client",children:"Client"}),u.jsx("option",{value:"designer",children:"Designer"}),u.jsx("option",{value:"admin",children:"Admin"})]}):_.role||""}),u.jsx("td",{children:s===_.id?u.jsx(Sm,{value:o.brandCodes,onChange:v=>a(k=>({...k,brandCodes:v})),suggestions:l,id:`brand-${_.id}`}):Array.isArray(_.brandCodes)?_.brandCodes.join(", "):""}),u.jsx("td",{className:"text-center",children:s===_.id?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("button",{onClick:()=>x(_.id),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2",children:"Save"}),u.jsx("button",{onClick:m,className:"btn-secondary px-1.5 py-0.5 text-xs",children:"Cancel"})]}):u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs("button",{onClick:()=>f(_),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"View",children:[u.jsx(Ud,{}),u.jsx("span",{className:"ml-1",children:"View"})]}),u.jsxs("button",{onClick:()=>p(_),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"Edit",children:[u.jsx(Vd,{}),u.jsx("span",{className:"ml-1",children:"Edit"})]}),u.jsxs("button",{onClick:()=>y(_.id),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"Sign Out",children:[u.jsx(FE,{}),u.jsx("span",{className:"ml-1",children:"Sign Out"})]}),u.jsx("button",{onClick:()=>w(_.id),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},_.id))})]})}),d&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:u.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-sm dark:bg-[var(--dark-sidebar-bg)] dark:text-[var(--dark-text)]",children:[u.jsx("h3",{className:"mb-2 font-semibold",children:d.fullName||d.email||d.id}),u.jsxs("p",{className:"text-sm mb-1",children:["Email: ",d.email||"N/A"]}),u.jsxs("p",{className:"text-sm mb-1",children:["Role: ",d.role]}),Array.isArray(d.brandCodes)&&d.brandCodes.length>0&&u.jsxs("p",{className:"text-sm mb-1",children:["Brands: ",d.brandCodes.join(", ")]}),u.jsxs("div",{className:"flex gap-2 mt-2",children:[u.jsxs("button",{onClick:()=>y(d.id),className:"btn-secondary px-3 py-1 flex items-center gap-1",children:[u.jsx(FE,{}),u.jsx("span",{children:"Sign Out"})]}),u.jsx("button",{onClick:()=>f(null),className:"btn-primary px-3 py-1",children:"Close"})]})]})})]})},Ft=({loading:t,userRole:e,requiredRole:n,isAdmin:r=!1,children:s})=>{if(t)return u.jsx(Bd,{});const i=Array.isArray(n)?n:[n],o=e&&i.includes(e)||i.includes("admin")&&r;if(n&&!o){const a=e||(r?"admin":"");return u.jsx(at,{to:`/dashboard/${a}`,replace:!0})}return u.jsx(u.Fragment,{children:s})},nK=()=>{const[t,e]=T.useState(!1),[n,r]=T.useState(!0);return T.useEffect(()=>{const s=PC(Me,async i=>{if(i)try{const o=await uC(i);e(!!o.claims.admin)}catch(o){console.error("Failed to get token claims",o),e(!1)}else e(!1);r(!1)});return()=>{s()}},[]),{isAdmin:t,loading:n}},rK=()=>{const[t,e]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState(!1),[l,c]=T.useState(""),d=async f=>{if(f.preventDefault(),c(""),!!t.trim()){a(!0);try{await Vr(be(H,"brands"),{code:t.trim(),name:n.trim(),agencyId:s.trim(),createdAt:mn()}),e(""),r(""),i(""),c("Brand added")}catch(p){console.error("Failed to add brand",p),c("Failed to add brand")}finally{a(!1)}}};return u.jsxs("div",{className:"min-h-screen p-4 flex flex-col items-center",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Add Brand"}),u.jsxs("form",{onSubmit:d,className:"space-y-4 w-full max-w-sm",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Code"}),u.jsx("input",{type:"text",value:t,onChange:f=>e(f.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Name"}),u.jsx("input",{type:"text",value:n,onChange:f=>r(f.target.value),className:"w-full p-2 border rounded"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Agency ID"}),u.jsx("input",{type:"text",value:s,onChange:f=>i(f.target.value),className:"w-full p-2 border rounded"})]}),l&&u.jsx("p",{className:"text-sm text-center",children:l}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:o,children:o?"Saving...":"Add Brand"})]})]})},sK=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(!0),[s,i]=T.useState(null),[o,a]=T.useState({code:"",name:"",agencyId:""});T.useEffect(()=>{(async()=>{r(!0);try{const x=(await Le(be(H,"brands"))).docs.map(w=>({id:w.id,...w.data()}));e(x)}catch(m){console.error("Failed to fetch brands",m),e([])}finally{r(!1)}})()},[]);const l=p=>{i(p.id),a({code:p.code||"",name:p.name||"",agencyId:p.agencyId||""})},c=()=>i(null),d=async p=>{try{await nt(oe(H,"brands",p),{code:o.code,name:o.name,agencyId:o.agencyId}),e(m=>m.map(x=>x.id===p?{...x,code:o.code,name:o.name,agencyId:o.agencyId}:x)),i(null)}catch(m){console.error("Failed to update brand",m)}},f=async p=>{if(window.confirm("Delete this brand?"))try{await Dr(oe(H,"brands",p)),e(m=>m.filter(x=>x.id!==p))}catch(m){console.error("Failed to delete brand",m)}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Brands"}),u.jsx("a",{href:"/admin/brands/new",className:"underline text-gray-700 block mb-2",children:"Add Brand"}),n?u.jsx("p",{children:"Loading brands..."}):t.length===0?u.jsx("p",{children:"No brands found."}):u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsxs("table",{className:"ad-table min-w-max",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Code"}),u.jsx("th",{children:"Name"}),u.jsx("th",{children:"Agency ID"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:t.map(p=>u.jsxs("tr",{children:[u.jsx("td",{children:s===p.id?u.jsx("input",{type:"text",value:o.code,onChange:m=>a(x=>({...x,code:m.target.value})),className:"w-full p-1 border rounded"}):p.code}),u.jsx("td",{children:s===p.id?u.jsx("input",{type:"text",value:o.name,onChange:m=>a(x=>({...x,name:m.target.value})),className:"w-full p-1 border rounded"}):p.name}),u.jsx("td",{children:s===p.id?u.jsx("input",{type:"text",value:o.agencyId,onChange:m=>a(x=>({...x,agencyId:m.target.value})),className:"w-full p-1 border rounded"}):p.agencyId||""}),u.jsx("td",{className:"text-center",children:s===p.id?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>d(p.id),className:"underline text-gray-700 mr-2",children:"Save"}),u.jsx("button",{onClick:c,className:"underline",children:"Cancel"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>l(p),className:"underline text-gray-700 mr-2",children:"Edit"}),u.jsx("button",{onClick:()=>f(p.id),className:"underline btn-delete",children:"Delete"})]})})]},p.id))})]})})]})},mT=({value:t,onChange:e,placeholders:n=[],className:r=""})=>{const s=T.useRef(null),[i,o]=T.useState(!1),[a,l]=T.useState([]),[c,d]=T.useState(""),f=m=>{const x=m.target.value;e(x);const w=m.target.selectionStart,_=x.slice(0,w).match(/{{([^{}]*)$/);if(_){const v=_[1],k=n.filter(A=>A.startsWith(v));d(v),l(k),o(k.length>0)}else o(!1)},p=m=>{const x=s.current;if(!x)return;const w=x.selectionStart-c.length-2,y=t.slice(0,w),_=t.slice(x.selectionEnd),v=`{{${m}}}`,k=`${y}${v}${_}`;e(k),o(!1),setTimeout(()=>{x.focus();const A=y.length+v.length;x.selectionStart=x.selectionEnd=A},0)};return u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:s,className:`w-full p-2 border rounded ${r}`,value:t,onChange:f}),i&&u.jsx("ul",{className:"absolute z-10 bg-white border rounded shadow text-sm mt-1 max-h-40 overflow-auto",children:a.map(m=>u.jsx("li",{children:u.jsx("button",{type:"button",className:"block w-full text-left px-2 py-1 hover:bg-accent-10",onClick:()=>p(m),children:"{{"+m+"}}"})},m))})]})};function iK(){const[t,e]=T.useState([]);return T.useEffect(()=>{let n=!1;return(async()=>{try{const s=await Le(be(H,"componentTypes"));n||e(s.docs.map(i=>({id:i.id,...i.data()})))}catch(s){console.error("Failed to load component types",s),n||e([])}})(),()=>{n=!0}},[]),t}const Gr={TYPES:"types",COMPONENTS:"components",INSTANCES:"instances",PREVIEW:"preview"},oK=({view:t,setView:e})=>u.jsxs("div",{className:"flex space-x-4 mb-4",children:[u.jsxs("button",{className:`px-3 py-1 rounded flex items-center gap-1 ${t===Gr.TYPES?"bg-accent-10 text-accent":"border"}`,onClick:()=>e(Gr.TYPES),children:[u.jsx(N9,{})," ",u.jsx("span",{children:"Recipe Types"})]}),u.jsxs("button",{className:`px-3 py-1 rounded flex items-center gap-1 ${t===Gr.COMPONENTS?"bg-accent-10 text-accent":"border"}`,onClick:()=>e(Gr.COMPONENTS),children:[u.jsx(LE,{})," ",u.jsx("span",{children:"Components"})]}),u.jsxs("button",{className:`px-3 py-1 rounded flex items-center gap-1 ${t===Gr.INSTANCES?"bg-accent-10 text-accent":"border"}`,onClick:()=>e(Gr.INSTANCES),children:[u.jsx(LE,{})," ",u.jsx("span",{children:"Instances"})]}),u.jsxs("button",{className:`px-3 py-1 rounded flex items-center gap-1 ${t===Gr.PREVIEW?"bg-accent-10 text-accent":"border"}`,onClick:()=>e(Gr.PREVIEW),children:[u.jsx(Ud,{})," ",u.jsx("span",{children:"Preview"})]})]}),aK=()=>{const t=iK(),[e,n]=T.useState([]),[r,s]=T.useState(""),[i,o]=T.useState(""),[a,l]=T.useState(""),[c,d]=T.useState(""),[f,p]=T.useState([{label:"",key:"",inputType:"text"}]),[m,x]=T.useState(!1),[w,y]=T.useState([]),[_,v]=T.useState(""),[k,A]=T.useState(null);T.useEffect(()=>{(async()=>{try{const N=await Le(be(H,"recipeTypes"));n(N.docs.map(j=>({id:j.id,...j.data()})))}catch(N){console.error("Failed to fetch recipe types",N),n([])}})()},[]);const D=()=>{A(null),s(""),o(""),l(""),d(""),p([{label:"",key:"",inputType:"text"}]),x(!1),y([]),v("")},O=async C=>{C.preventDefault();const N=c.split(",").map(ne=>ne.trim()).filter(Boolean),j=_.split(",").map(ne=>ne.trim()).filter(Boolean),P=f.map(ne=>({label:ne.label.trim(),key:ne.key.trim(),inputType:ne.inputType||"text"})).filter(ne=>ne.label&&ne.key);try{if(k)await nt(oe(H,"recipeTypes",k),{name:r.trim(),gptPrompt:i,assetPrompt:a,enableAssetCsv:m,assetMatchFields:w,components:N,writeInFields:P,defaultColumns:j}),n(ne=>ne.map(ae=>ae.id===k?{...ae,name:r.trim(),gptPrompt:i,assetPrompt:a,enableAssetCsv:m,assetMatchFields:w,components:N,writeInFields:P,defaultColumns:j}:ae));else{const ne=await Vr(be(H,"recipeTypes"),{name:r.trim(),gptPrompt:i,assetPrompt:a,enableAssetCsv:m,assetMatchFields:w,components:N,writeInFields:P,defaultColumns:j});n(ae=>[...ae,{id:ne.id,name:r.trim(),gptPrompt:i,assetPrompt:a,enableAssetCsv:m,assetMatchFields:w,components:N,writeInFields:P,defaultColumns:j}])}D()}catch(ne){console.error("Failed to save recipe type",ne)}},I=C=>{A(C.id),s(C.name),o(C.gptPrompt||""),l(C.assetPrompt||""),x(!!C.enableAssetCsv),y(C.assetMatchFields||[]),d((C.components||[]).join(", ")),v((C.defaultColumns||[]).join(", ")),p(C.writeInFields&&C.writeInFields.length>0?C.writeInFields:[{label:"",key:"",inputType:"text"}])},E=async C=>{try{await Dr(oe(H,"recipeTypes",C)),n(N=>N.filter(j=>j.id!==C))}catch(N){console.error("Failed to delete recipe type",N)}},S=[];return t.forEach(C=>{var N;(N=C.attributes)==null||N.forEach(j=>{S.push(`${C.key}.${j.key}`)})}),f.forEach(C=>{C.key&&S.push(C.key)}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl mb-2",children:"Recipe Types"}),e.length===0?u.jsx("p",{children:"No recipe types found."}):u.jsx("div",{className:"overflow-x-auto table-container mb-4",children:u.jsxs("table",{className:"ad-table min-w-max text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Name"}),u.jsx("th",{children:"Components"}),u.jsx("th",{children:"Write-In Fields"}),u.jsx("th",{children:"Asset Prompt"}),u.jsx("th",{children:"Asset Fields"}),u.jsx("th",{children:"Default Columns"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:e.map(C=>u.jsxs("tr",{children:[u.jsx("td",{children:C.name}),u.jsx("td",{children:C.components&&C.components.length>0?C.components.join(", "):"-"}),u.jsx("td",{children:C.writeInFields&&C.writeInFields.length>0?C.writeInFields.map(N=>N.key).join(", "):"-"}),u.jsx("td",{children:C.assetPrompt||"-"}),u.jsx("td",{children:C.assetMatchFields&&C.assetMatchFields.length>0?C.assetMatchFields.join(", "):"-"}),u.jsx("td",{children:C.defaultColumns&&C.defaultColumns.length>0?C.defaultColumns.join(", "):"-"}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs("button",{onClick:()=>I(C),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"Edit",children:[u.jsx(Vd,{}),u.jsx("span",{className:"ml-1",children:"Edit"})]}),u.jsx("button",{onClick:()=>E(C.id),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},C.id))})]})}),u.jsxs("form",{onSubmit:O,className:"space-y-2 max-w-[50rem]",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Name"}),u.jsx("input",{className:"w-full p-2 border rounded",value:r,onChange:C=>s(C.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"GPT Prompt"}),u.jsx(mT,{value:i,onChange:o,placeholders:S})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Asset Prompt"}),u.jsx(mT,{value:a,onChange:l,placeholders:S})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm",children:[u.jsx("input",{type:"checkbox",className:"mr-1",checked:m,onChange:C=>x(C.target.checked)}),"Enable Asset CSV"]}),m&&u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{className:"block text-sm mb-1",children:"Asset Match Fields"}),u.jsx(Sm,{id:"asset-fields",value:w,onChange:y,suggestions:S})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Components (comma separated keys in order)"}),u.jsx("input",{className:"w-full p-2 border rounded",value:c,onChange:C=>d(C.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Default Visible Columns (comma separated keys)"}),u.jsx("input",{className:"w-full p-2 border rounded",value:_,onChange:C=>v(C.target.value)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm",children:"Write-In Fields"}),f.map((C,N)=>u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx("input",{className:"p-2 border rounded flex-1",placeholder:"Label",value:C.label,onChange:j=>{const P=[...f];P[N].label=j.target.value,p(P)}}),u.jsx("input",{className:"p-2 border rounded flex-1",placeholder:"Key",value:C.key,onChange:j=>{const P=[...f];P[N].key=j.target.value,p(P)}}),u.jsxs("select",{className:"p-2 border rounded",value:C.inputType,onChange:j=>{const P=[...f];P[N].inputType=j.target.value,p(P)},children:[u.jsx("option",{value:"text",children:"Text"}),u.jsx("option",{value:"number",children:"Number"}),u.jsx("option",{value:"textarea",children:"Textarea"}),u.jsx("option",{value:"image",children:"Image"}),u.jsx("option",{value:"list",children:"List"})]}),u.jsx("button",{type:"button",onClick:()=>p(f.filter((j,P)=>P!==N)),className:"btn-secondary px-2 py-0.5",children:u.jsx(Ms,{})})]},N)),u.jsx("button",{type:"button",onClick:()=>p([...f,{label:"",key:"",inputType:"text"}]),className:"btn-secondary px-2 py-0.5",children:"Add Field"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{type:"submit",className:"btn-primary",children:k?"Save Type":"Add Type"}),k&&u.jsx("button",{type:"button",onClick:D,className:"btn-secondary px-2 py-0.5",children:"Cancel"})]})]})]})},lK=()=>{const[t,e]=T.useState([]),[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState("dropdown"),[l,c]=T.useState([{label:"",key:"",inputType:"text"}]),[d,f]=T.useState(null);T.useEffect(()=>{(async()=>{try{const _=await Le(be(H,"componentTypes"));e(_.docs.map(v=>({id:v.id,...v.data()})))}catch(_){console.error("Failed to fetch components",_),e([])}})()},[]);const p=()=>{f(null),r(""),i(""),a("dropdown"),c([{label:"",key:"",inputType:"text"}])},m=async y=>{y.preventDefault();const _=l.map(v=>({label:v.label.trim(),key:v.key.trim(),inputType:v.inputType||"text"})).filter(v=>v.label&&v.key);try{if(d)await nt(oe(H,"componentTypes",d),{label:n.trim(),key:s.trim(),selectionMode:o,attributes:_}),e(v=>v.map(k=>k.id===d?{...k,label:n.trim(),key:s.trim(),selectionMode:o,attributes:_}:k));else{const v=await Vr(be(H,"componentTypes"),{label:n.trim(),key:s.trim(),selectionMode:o,attributes:_});e(k=>[...k,{id:v.id,label:n.trim(),key:s.trim(),selectionMode:o,attributes:_}])}p()}catch(v){console.error("Failed to save component type",v)}},x=y=>{f(y.id),r(y.label),i(y.key),a(y.selectionMode||"dropdown"),c(y.attributes&&y.attributes.length>0?y.attributes:[{label:"",key:"",inputType:"text"}])},w=async y=>{try{await Dr(oe(H,"componentTypes",y)),e(_=>_.filter(v=>v.id!==y))}catch(_){console.error("Failed to delete component type",_)}};return u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl mb-2",children:"Components"}),t.length===0?u.jsx("p",{children:"No components found."}):u.jsx("div",{className:"overflow-x-auto table-container mb-4",children:u.jsxs("table",{className:"ad-table min-w-max text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Label"}),u.jsx("th",{children:"Key"}),u.jsx("th",{children:"Mode"}),u.jsx("th",{children:"Attributes"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:t.map(y=>u.jsxs("tr",{children:[u.jsx("td",{children:y.label}),u.jsx("td",{children:y.key}),u.jsx("td",{children:y.selectionMode||"dropdown"}),u.jsx("td",{children:y.attributes?y.attributes.length:0}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs("button",{onClick:()=>x(y),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"Edit",children:[u.jsx(Vd,{}),u.jsx("span",{className:"ml-1",children:"Edit"})]}),u.jsx("button",{onClick:()=>w(y.id),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},y.id))})]})}),u.jsxs("form",{onSubmit:m,className:"space-y-2 max-w-[50rem]",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Label"}),u.jsx("input",{className:"w-full p-2 border rounded",value:n,onChange:y=>r(y.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Key"}),u.jsx("input",{className:"w-full p-2 border rounded",value:s,onChange:y=>i(y.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Selection Mode"}),u.jsxs("select",{className:"w-full p-2 border rounded",value:o,onChange:y=>a(y.target.value),children:[u.jsx("option",{value:"random",children:"random"}),u.jsx("option",{value:"dropdown",children:"dropdown"}),u.jsx("option",{value:"checklist",children:"checklist"})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm",children:"Attributes"}),l.map((y,_)=>u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx("input",{className:"p-2 border rounded flex-1",placeholder:"Label",value:y.label,onChange:v=>{const k=[...l];k[_].label=v.target.value,c(k)}}),u.jsx("input",{className:"p-2 border rounded flex-1",placeholder:"Key",value:y.key,onChange:v=>{const k=[...l];k[_].key=v.target.value,c(k)}}),u.jsxs("select",{className:"p-2 border rounded",value:y.inputType,onChange:v=>{const k=[...l];k[_].inputType=v.target.value,c(k)},children:[u.jsx("option",{value:"text",children:"Text"}),u.jsx("option",{value:"number",children:"Number"}),u.jsx("option",{value:"textarea",children:"Textarea"}),u.jsx("option",{value:"image",children:"Image"})]}),u.jsx("button",{type:"button",onClick:()=>c(l.filter((v,k)=>k!==_)),className:"btn-secondary px-2 py-0.5",children:u.jsx(Ms,{})})]},_)),u.jsx("button",{type:"button",onClick:()=>c([...l,{label:"",key:"",inputType:"text"}]),className:"btn-secondary px-2 py-0.5",children:"Add Attribute"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{type:"submit",className:"btn-primary",children:d?"Save Component":"Add Component"}),d&&u.jsx("button",{type:"button",onClick:p,className:"btn-secondary px-2 py-0.5",children:"Cancel"})]})]})]})},cK=()=>{var ae,F;const[t,e]=T.useState([]),[n,r]=T.useState([]),[s,i]=T.useState([]),[o,a]=T.useState(""),[l,c]=T.useState(""),[d,f]=T.useState({}),[p,m]=T.useState(""),[x,w]=T.useState(null),[y,_]=T.useState(null),[v,k]=T.useState([]),[A,D]=T.useState([]),[O,I]=T.useState({});T.useEffect(()=>{(async()=>{try{const V=await Le(be(H,"componentTypes"));e(V.docs.map(_e=>{const ke=_e.data();return{id:_e.id,...ke,selectionMode:ke.selectionMode||"dropdown"}}));const G=await Le(be(H,"componentInstances"));r(G.docs.map(_e=>({id:_e.id,..._e.data()})));const re=await Le(be(H,"brands"));i(re.docs.map(_e=>({id:_e.id,..._e.data()})))}catch(V){console.error("Failed to load component instances",V)}})()},[]);const E=()=>{w(null),a(""),c(""),f({}),m("")},S=async W=>{W.preventDefault();const V=t.find(G=>G.id===o);if(V)try{if(x)await nt(oe(H,"componentInstances",x),{componentKey:V.key,name:l.trim(),values:d,relationships:p?{brandCode:p}:{}}),r(G=>G.map(re=>re.id===x?{...re,componentKey:V.key,name:l.trim(),values:d,relationships:p?{brandCode:p}:{}}:re));else{const G=await Vr(be(H,"componentInstances"),{componentKey:V.key,name:l.trim(),values:d,relationships:p?{brandCode:p}:{}});r(re=>[...re,{id:G.id,componentKey:V.key,name:l.trim(),values:d,relationships:p?{brandCode:p}:{}}])}E()}catch(G){console.error("Failed to save instance",G)}},C=W=>{var G;w(W.id);const V=t.find(re=>re.key===W.componentKey);a(V?V.id:""),c(W.name),f(W.values||{}),m(((G=W.relationships)==null?void 0:G.brandCode)||"")},N=async W=>{try{await Dr(oe(H,"componentInstances",W)),r(V=>V.filter(G=>G.id!==W))}catch(V){console.error("Failed to delete instance",V)}},j=async W=>{var G;const V=(G=W.target.files)==null?void 0:G[0];if(_(V||null),k([]),D([]),I({}),V){const _e=(await V.text()).trim().split(/\r?\n/);if(_e.length>1){const ke=xp(_e[0]).map(Oe=>Oe.trim()),Ie=[];for(let Oe=1;Oe<_e.length;Oe+=1)_e[Oe]&&Ie.push(xp(_e[Oe]).map(Dt=>Dt.trim()));k(ke),D(Ie)}}},P=async()=>{var V;const W=t.find(G=>G.id===o);if(!(!W||A.length===0)){for(const G of A){const re=O.name,_e=re!==void 0&&re!==""?(G[re]||"").trim():"",ke={};(V=W.attributes)==null||V.forEach(Ie=>{const Oe=O[Ie.key];Oe!==void 0&&Oe!==""&&(ke[Ie.key]=G[Oe]||"")});try{const Ie=await Vr(be(H,"componentInstances"),{componentKey:W.key,name:_e,values:ke,relationships:p?{brandCode:p}:{}});r(Oe=>[...Oe,{id:Ie.id,componentKey:W.key,name:_e,values:ke,relationships:p?{brandCode:p}:{}}])}catch(Ie){console.error("Failed to save instance from CSV",Ie)}}_(null),k([]),D([]),I({})}},ne=t.find(W=>W.id===o);return u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl mb-2",children:"Component Instances"}),n.length===0?u.jsx("p",{children:"No instances found."}):u.jsx("div",{className:"overflow-x-auto table-container mb-4",children:u.jsxs("table",{className:"ad-table min-w-max text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Name"}),u.jsx("th",{children:"Component"}),u.jsx("th",{children:"Brand"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:n.map(W=>{var V;return u.jsxs("tr",{children:[u.jsx("td",{children:W.name}),u.jsx("td",{children:W.componentKey}),u.jsx("td",{children:((V=W.relationships)==null?void 0:V.brandCode)||""}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs("button",{onClick:()=>C(W),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 mr-2","aria-label":"Edit",children:[u.jsx(Vd,{}),u.jsx("span",{className:"ml-1",children:"Edit"})]}),u.jsx("button",{onClick:()=>N(W.id),className:"btn-secondary px-1.5 py-0.5 text-xs flex items-center gap-1 btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},W.id)})})]})}),u.jsxs("form",{onSubmit:S,className:"space-y-2 max-w-[50rem]",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Name"}),u.jsx("input",{className:"w-full p-2 border rounded",value:l,onChange:W=>c(W.target.value),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Component"}),u.jsxs("select",{className:"w-full p-2 border rounded",value:o,onChange:W=>a(W.target.value),children:[u.jsx("option",{value:"",children:"Select..."}),t.map(W=>u.jsx("option",{value:W.id,children:W.label},W.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Brand"}),u.jsxs("select",{className:"w-full p-2 border rounded",value:p,onChange:W=>m(W.target.value),children:[u.jsx("option",{value:"",children:"None"}),s.map(W=>u.jsxs("option",{value:W.code,children:[W.code," ",W.name?`- ${W.name}`:""]},W.id))]})]}),ne&&u.jsx("div",{className:"space-y-2",children:(ae=ne.attributes)==null?void 0:ae.map(W=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:W.label}),u.jsx("input",{className:"w-full p-2 border rounded",value:d[W.key]||"",onChange:V=>f({...d,[W.key]:V.target.value})})]},W.key))}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{type:"submit",className:"btn-primary",children:x?"Save Instance":"Add Instance"}),x&&u.jsx("button",{type:"button",onClick:E,className:"btn-secondary px-2 py-0.5",children:"Cancel"})]})]}),ne&&u.jsxs("div",{className:"mt-8 space-y-2 max-w-[50rem]",children:[u.jsx("h3",{className:"text-lg",children:"Bulk Add via CSV"}),u.jsx("input",{type:"file",accept:".csv",onChange:j}),v.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm mb-1",children:"Name Column"}),u.jsxs("select",{className:"w-full p-2 border rounded",value:O.name??"",onChange:W=>I({...O,name:W.target.value}),children:[u.jsx("option",{value:"",children:"Ignore"}),v.map((W,V)=>u.jsx("option",{value:V,children:W},V))]})]}),(F=ne.attributes)==null?void 0:F.map(W=>u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm mb-1",children:[W.label," Column"]}),u.jsxs("select",{className:"w-full p-2 border rounded",value:O[W.key]??"",onChange:V=>I({...O,[W.key]:V.target.value}),children:[u.jsx("option",{value:"",children:"Ignore"}),v.map((V,G)=>u.jsx("option",{value:G,children:V},G))]})]},W.key)),u.jsx("button",{type:"button",onClick:P,className:"btn-primary",children:"Add Instances"})]})]})]})},uK=()=>{const[t,e]=T.useState(Gr.TYPES);return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Ad Recipe Setup"}),u.jsx(oK,{view:t,setView:e}),t===Gr.TYPES&&u.jsx(aK,{}),t===Gr.COMPONENTS&&u.jsx(lK,{}),t===Gr.INSTANCES&&u.jsx(cK,{}),t===Gr.PREVIEW&&u.jsx(Pv,{})]})},gT={status:["pending","ready","approved","rejected","archived"],role:["client","designer","admin"]},dK=["client","designer","admin"],hK=()=>{const[t,e]=T.useState(""),[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState(""),[l,c]=T.useState(!1),[d,f]=T.useState([]),[p,m]=T.useState([]),[x,w]=T.useState(""),[y,_]=T.useState([{field:"",op:"==",value:""}]),[v,k]=T.useState("userType"),[A,D]=T.useState(""),[O,I]=T.useState(""),[E,S]=T.useState([]),C=async()=>{try{const F=await Le(un(be(H,"notifications"),bv("createdAt","desc")));f(F.docs.map(W=>({id:W.id,...W.data()})))}catch(F){console.error("Failed to load notifications",F),f([])}},N=async()=>{try{const F=await Le(be(H,"notificationRules"));m(F.docs.map(W=>({id:W.id,...W.data()})))}catch(F){console.error("Failed to load rules",F),m([])}},j=async()=>{try{const F=await Le(be(H,"users"));S(F.docs.map(W=>({id:W.id,label:W.data().fullName||W.data().email||W.id})))}catch(F){console.error("Failed to load users",F),S([])}};T.useEffect(()=>{C(),N(),j()},[]);const P=async F=>{F.preventDefault();const W=y.filter(V=>V.field&&V.value);try{await Vr(be(H,"notificationRules"),{trigger:x,conditions:W,action:{type:"sendNotification",recipientType:v,recipient:A,message:O},createdAt:mn()}),w(""),_([{field:"",op:"==",value:""}]),D(""),I(""),N()}catch(V){console.error("Failed to save rule",V)}},ne=async F=>{if(window.confirm("Delete this rule?"))try{await Dr(oe(H,"notificationRules",F)),m(W=>W.filter(V=>V.id!==F))}catch(W){console.error("Failed to delete rule",W)}},ae=async F=>{F.preventDefault(),c(!0);try{await Vr(be(H,"notifications"),{title:t,body:n,audience:s,sendNow:!o,triggerTime:o?new Date(o):null,createdAt:mn()}),e(""),r(""),i(""),a(""),C()}catch(W){console.error("Failed to save notification",W)}finally{c(!1)}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Notifications"}),u.jsx("h2",{className:"text-xl mb-2",children:"Notification Rules"}),p.length===0?u.jsx("p",{children:"No rules found."}):u.jsx("div",{className:"overflow-x-auto table-container mb-4",children:u.jsxs("table",{className:"ad-table min-w-max text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Trigger"}),u.jsx("th",{children:"Conditions"}),u.jsx("th",{children:"Action"}),u.jsx("th",{})]})}),u.jsx("tbody",{children:p.map(F=>{var W,V,G;return u.jsxs("tr",{children:[u.jsx("td",{children:F.trigger}),u.jsx("td",{children:Array.isArray(F.conditions)&&F.conditions.length>0?F.conditions.map(re=>`${re.field} ${re.op} ${re.value}`).join(" && "):"-"}),u.jsxs("td",{children:[(W=F.action)==null?void 0:W.recipientType," ",(V=F.action)==null?void 0:V.recipient," :"," ",(G=F.action)==null?void 0:G.message]}),u.jsx("td",{className:"text-center",children:u.jsx("button",{onClick:()=>ne(F.id),className:"underline btn-delete",type:"button",children:"Delete"})})]},F.id)})})]})}),u.jsxs("form",{onSubmit:P,className:"space-y-2 max-w-md mb-8",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Trigger Event"}),u.jsxs("select",{value:x,onChange:F=>w(F.target.value),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"",children:"Select trigger"}),u.jsx("option",{value:"adGroupStatusUpdated",children:"Ad Group Status Updated"}),u.jsx("option",{value:"reviewSubmitted",children:"Review Submitted"}),u.jsx("option",{value:"accountCreated",children:"Account Created"})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm",children:"Conditions"}),y.map((F,W)=>u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsxs("select",{className:"p-2 border rounded flex-1",value:F.field,onChange:V=>{const G=[...y];G[W].field=V.target.value,G[W].value="",_(G)},children:[u.jsx("option",{value:"",children:"Field"}),Object.keys(gT).map(V=>u.jsx("option",{value:V,children:V},V))]}),u.jsxs("select",{className:"p-2 border rounded",value:F.op,onChange:V=>{const G=[...y];G[W].op=V.target.value,_(G)},children:[u.jsx("option",{value:"==",children:"=="}),u.jsx("option",{value:"!=",children:"!="}),u.jsx("option",{value:"includes",children:"includes"})]}),u.jsxs("select",{className:"p-2 border rounded flex-1",value:F.value,onChange:V=>{const G=[...y];G[W].value=V.target.value,_(G)},children:[u.jsx("option",{value:"",children:"Value"}),(gT[F.field]||[]).map(V=>u.jsx("option",{value:V,children:V},V))]}),u.jsx("button",{type:"button",onClick:()=>_(y.filter((V,G)=>G!==W)),className:"btn-secondary px-2 py-0.5",children:"Remove"})]},W)),u.jsx("button",{type:"button",onClick:()=>_([...y,{field:"",op:"==",value:""}]),className:"btn-secondary px-2 py-0.5",children:"Add Condition"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Recipient Type"}),u.jsxs("select",{value:v,onChange:F=>{k(F.target.value),D("")},className:"w-full p-2 border rounded",children:[u.jsx("option",{value:"userType",children:"User Type"}),u.jsx("option",{value:"userId",children:"User ID"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Recipient"}),v==="userType"?u.jsxs("select",{value:A,onChange:F=>D(F.target.value),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"",children:"Select recipient"}),dK.map(F=>u.jsx("option",{value:F,children:F},F))]}):u.jsxs("select",{value:A,onChange:F=>D(F.target.value),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"",children:"Select recipient"}),E.map(F=>u.jsx("option",{value:F.id,children:F.label},F.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Message"}),u.jsx("textarea",{value:O,onChange:F=>I(F.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsx("button",{type:"submit",className:"btn-primary",children:"Save Rule"})]}),u.jsx("h2",{className:"text-xl mb-2",children:"Manual Notification"}),u.jsxs("form",{onSubmit:ae,className:"space-y-4 max-w-md",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Audience"}),u.jsx("input",{type:"text",value:s,onChange:F=>i(F.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Title"}),u.jsx("input",{type:"text",value:t,onChange:F=>e(F.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Body"}),u.jsx("textarea",{value:n,onChange:F=>r(F.target.value),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Trigger Time"}),u.jsx("input",{type:"datetime-local",value:o,onChange:F=>a(F.target.value),className:"w-full p-2 border rounded"}),u.jsx("p",{className:"text-xs text-gray-500",children:"Leave blank to send immediately."})]}),u.jsx("button",{type:"submit",className:"btn-primary",disabled:l,children:l?"Saving...":"Save Notification"})]}),u.jsx("h2",{className:"text-xl mt-8 mb-2",children:"History"}),d.length===0?u.jsx("p",{children:"No notifications found."}):u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsxs("table",{className:"ad-table min-w-max text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Title"}),u.jsx("th",{children:"Audience"}),u.jsx("th",{children:"Trigger"}),u.jsx("th",{children:"Sent At"})]})}),u.jsx("tbody",{children:d.map(F=>u.jsxs("tr",{children:[u.jsx("td",{children:F.title}),u.jsx("td",{children:F.audience}),u.jsx("td",{children:F.triggerTime?new Date(F.triggerTime.seconds*1e3).toLocaleString():"Now"}),u.jsx("td",{children:F.sentAt?new Date(F.sentAt.seconds*1e3).toLocaleString():""})]},F.id))})]})})]})},fK=({user:t,role:e})=>{const[n,r]=T.useState(""),[s,i]=T.useState(""),[o,a]=T.useState(""),[l,c]=T.useState(!1),[d,f]=T.useState(!1),[p,m]=T.useState("sms"),[x,w]=T.useState(""),[y,_]=T.useState(""),v=hi(),k=t&&fa(t).enrolledFactors.length>0,A=async()=>{if(!(!t||!k)&&window.confirm("Turning off MFA makes your account more vulnerable. Are you sure you want to continue?"))try{const E=fa(t).enrolledFactors[0];await fa(t).unenroll(E),_("MFA disabled")}catch(E){w(E.message)}},D=E=>{const S=E.replace(/\D/g,"");if(!S)return"";let C=S;return S[0]!=="1"&&S.length===10&&(C="1"+S),"+"+C};if(!t||!["admin","client","agency","designer"].includes(e))return u.jsx("p",{className:"p-4",children:"MFA enrollment not allowed for this account."});if(!t.emailVerified)return u.jsx("div",{className:"flex justify-center p-4",children:u.jsxs("div",{className:"w-80 space-y-2",children:[u.jsx("p",{children:"Please verify your email before enrolling MFA"}),u.jsx("button",{type:"button",className:"w-full btn-primary",onClick:()=>Zp(t),children:"Resend Verification Email"})]})});const O=async E=>{E.preventDefault(),w(""),_(""),c(!0);try{const S=await fa(Me.currentUser).getSession(),C=new ni(Me),N={phoneNumber:D(n),session:S},j=new BC(Me,"recaptcha-container",{size:"invisible",callback:()=>{}}),P=await C.verifyPhoneNumber(N,j);a(P),m("verify")}catch(S){S.code==="auth/requires-recent-login"?(_("Please sign in again to enroll MFA."),await jC(Me),v("/login")):w(S.message)}finally{c(!1)}},I=async E=>{E.preventDefault(),w(""),f(!0);try{const S=ni.credential(o,s),C=lx.assertion(S);await fa(Me.currentUser).enroll(C,"Phone"),_("Enrollment complete"),m("done")}catch(S){w(S.message)}finally{f(!1)}};return u.jsx("div",{className:"flex justify-center p-4",children:u.jsxs("div",{className:"w-80 space-y-4",children:[u.jsx("h1",{className:"text-2xl mb-2",children:"Two-Factor Authentication"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Add an extra layer of security to your account by requiring a code when you sign in."}),k&&(t==null?void 0:t.metadata.lastLoginAt)&&u.jsxs("p",{className:"text-xs text-gray-500",children:["Last MFA login: ",new Date(Number(t.metadata.lastLoginAt)).toLocaleString()]}),p==="sms"&&u.jsxs("form",{onSubmit:O,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Phone Number"}),u.jsx("input",{type:"tel",value:n,onChange:E=>r(D(E.target.value)),className:"w-full p-2 border rounded",required:!0})]}),x&&u.jsx("p",{className:"text-red-500 text-sm",children:x}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:l,children:l?"Sending...":"Send Code"})]}),p==="verify"&&u.jsxs("form",{onSubmit:I,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Verification Code"}),u.jsx("input",{type:"text",value:s,onChange:E=>i(E.target.value),className:"w-full p-2 border rounded",required:!0})]}),x&&u.jsx("p",{className:"text-red-500 text-sm",children:x}),u.jsx("button",{type:"submit",className:"w-full btn-primary",disabled:d,children:d?"Verifying...":"Verify"})]}),y&&u.jsx("p",{className:"text-green-600 mt-2 text-sm",children:y}),u.jsx("div",{id:"recaptcha-container"}),k&&u.jsx("button",{type:"button",onClick:A,className:"w-full btn-secondary",children:"Disable MFA"})]})})},pK=({user:t,role:e,children:n})=>{const r=hi(),s=gs();return Rn.useEffect(()=>{t&&["admin","client","agency","designer"].includes(e)&&fa(t).enrolledFactors.length===0&&s.pathname!=="/mfa-settings"&&r("/mfa-settings",{replace:!0})},[t,e,s.pathname,r]),u.jsx(u.Fragment,{children:n})},mK=localStorage.getItem("accentColor"),cl={logoUrl:"",iconUrl:"",accentColor:mK||ic},Bw=(t=!0)=>{const[e,n]=T.useState(cl),[r,s]=T.useState(!0);return T.useEffect(()=>{(async()=>{try{const a=await Qr(oe(H,"settings","site"));if(a.exists()){const l=a.data();n({...cl,...l});const c=l.accentColor||cl.accentColor;t&&(Sa(c),localStorage.setItem("accentColor",c))}else await li(oe(H,"settings","site"),cl),t&&(Sa(cl.accentColor),localStorage.setItem("accentColor",cl.accentColor))}catch(a){console.error("Failed to fetch site settings",a)}finally{s(!1)}})()},[]),T.useEffect(()=>{e.accentColor&&t&&(Sa(e.accentColor),localStorage.setItem("accentColor",e.accentColor))},[e.accentColor]),{settings:e,loading:r,saveSettings:async o=>{await li(oe(H,"settings","site"),o,{merge:!0}),n(a=>({...a,...o})),o.accentColor&&localStorage.setItem("accentColor",o.accentColor)}}},gK=Em(ea);async function LP(t){const e=`Campfire/site-logo/${t.name}`,n=nc(gK,e);return await ow(n,t,{cacheControl:"public,max-age=31536000,immutable"}),await aw(n)}const yK=Em(ea);async function vK(t){const e=`Campfire/site-icon/${t.name}`,n=nc(yK,e);return await ow(n,t,{cacheControl:"public,max-age=31536000,immutable"}),await aw(n)}const _K=()=>{const{settings:t,saveSettings:e}=Bw(),[n,r]=T.useState(""),[s,i]=T.useState(null),[o,a]=T.useState(""),[l,c]=T.useState(null),[d,f]=T.useState("#ea580c"),[p,m]=T.useState(!1),[x,w]=T.useState("");T.useEffect(()=>{r(t.logoUrl||""),i(null),a(t.iconUrl||""),c(null),f(t.accentColor||"#ea580c")},[t]);const y=k=>{const A=k.target.files[0];i(A||null),r(A?URL.createObjectURL(A):t.logoUrl||"")},_=k=>{const A=k.target.files[0];c(A||null),a(A?URL.createObjectURL(A):t.iconUrl||"")},v=async k=>{k.preventDefault(),m(!0),w("");try{let A=n;s&&(A=await LP(s));let D=o;l&&(D=await vK(l)),await e({logoUrl:A,iconUrl:D,accentColor:d}),r(A),i(null),a(D),c(null),w("Settings saved")}catch(A){console.error("Failed to save settings",A),w("Failed to save settings")}finally{m(!1)}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Site Settings"}),u.jsxs("form",{onSubmit:v,className:"space-y-4 max-w-sm",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Logo"}),u.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"w-full p-2 border rounded"}),n&&u.jsx(Zn,{pngUrl:n,alt:"Logo preview",loading:"eager",className:"mt-2 max-h-16 w-auto"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Site Icon"}),u.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"w-full p-2 border rounded"}),o&&u.jsx(Zn,{pngUrl:o,alt:"Icon preview",loading:"eager",className:"mt-2 max-h-16 w-auto"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Accent Color"}),u.jsx("input",{type:"color",value:d,onChange:k=>f(k.target.value),className:"w-full p-2 border rounded h-10"})]}),x&&u.jsx("p",{className:"text-sm",children:x}),u.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Saving...":"Save Settings"})]})]})},Mm=({tabs:t=[],logoUrl:e,logoAlt:n,applySiteAccent:r=!0})=>{const s=hi(),i=gs(),[o,a]=Rn.useState(!1),{settings:l}=Bw(r),c=p=>{sc("Navigate to",p.path),p.path&&s(p.path),a(!1)},d=()=>{jC(Me).catch(p=>console.error("Failed to sign out",p))},f=u.jsx(u.Fragment,{children:t.map(p=>{const m=i.pathname+i.search,w=(p.path&&m.startsWith(p.path)?"text-accent font-medium border border-accent bg-accent-10 ":"text-gray-700 dark:text-gray-200 hover:bg-accent-10 border border-transparent ")+"rounded-xl w-full text-center px-3 py-[0.9rem]";return u.jsx("button",{onClick:()=>c(p),className:w,children:p.label},p.label)})});return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"hidden md:flex fixed top-0 left-0 w-[250px] border-r bg-white dark:bg-[var(--dark-sidebar-bg)] dark:border-[var(--dark-sidebar-hover)] p-4 flex-col h-screen justify-between",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(Zn,{pngUrl:e||l.logoUrl||fr,alt:n||"Logo",loading:"eager",cacheKey:e||l.logoUrl||fr,className:"mx-auto mt-4 mb-4 max-h-16 w-auto"}),f]}),u.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[u.jsx("button",{onClick:d,className:"text-gray-700 dark:text-gray-200 hover:bg-accent-10 w-full text-center font-bold px-3 py-[0.9rem] rounded-xl",children:"Log Out"}),u.jsx("footer",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:"© 2025 Studio Tak. All rights reserved."})]})]}),u.jsx("button",{type:"button","aria-label":"Menu",className:"md:hidden fixed top-4 right-2 m-2 text-2xl z-40",onClick:()=>a(!0),children:"☰"}),o&&u.jsxs("div",{className:"fixed inset-0 bg-white dark:bg-[var(--dark-sidebar-bg)] p-4 flex flex-col h-full justify-between z-50",children:[u.jsx("button",{type:"button","aria-label":"Close menu",className:"absolute top-4 right-4 text-2xl",onClick:()=>a(!1),children:"×"}),u.jsxs("div",{className:"space-y-2 mt-8",children:[u.jsx(Zn,{pngUrl:e||l.logoUrl||fr,alt:n||"Logo",loading:"eager",cacheKey:e||l.logoUrl||fr,className:"mx-auto mt-4 mb-4 max-h-16 w-auto"}),f]}),u.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[u.jsx("button",{onClick:d,className:"text-gray-700 dark:text-gray-200 hover:bg-accent-10 w-full text-center font-bold px-3 py-[0.9rem] rounded-xl",children:"Log Out"}),u.jsx("footer",{className:"text-xs text-gray-400 dark:text-gray-500 text-center",children:"© 2025 Studio Tak. All rights reserved."})]})]})]})},xK=[{label:"Campfire",path:"/dashboard/client"},{label:"Request",path:"/request"},{label:"Brand Setup",path:"/brand-setup"},{label:"Account Settings",path:"/account-settings"}],wK=({agencyId:t})=>{const{agency:e}=zd(t);return u.jsx(Mm,{tabs:xK,logoUrl:t?e.logoUrl:void 0,logoAlt:t?`${e.name} logo`:void 0,applySiteAccent:!t})},bK=[{label:"Dashboard",path:"/dashboard/admin"},{label:"Ad Groups",path:"/admin/ad-groups"},{label:"Accounts",path:"/admin/accounts"},{label:"Brands",path:"/admin/brands"},{label:"Ad Recipes",path:"/admin/ad-recipes"},{label:"Notifications",path:"/admin/notifications"},{label:"Site Settings",path:"/admin/site-settings"},{label:"Account Settings",path:"/admin/account-settings"}],yT=()=>u.jsx(Mm,{tabs:bK}),EK=[{label:"Notifications",path:"/designer/notifications"},{label:"Ad Groups",path:"/dashboard/designer"},{label:"Account Settings",path:"/designer/account-settings"}],kK=()=>u.jsx(Mm,{tabs:EK}),TK=({agencyId:t})=>{const{agency:e}=zd(t),n=t?`?agencyId=${t}`:"",r=[{label:"Dashboard",path:`/agency/dashboard${n}`},{label:"Ad Groups",path:`/agency/ad-groups${n}`},{label:"Brands",path:`/agency/brands${n}`},{label:"Theme",path:`/agency/theme${n}`},{label:"Account Settings",path:`/agency/account-settings${n}`}];return u.jsx(Mm,{tabs:r,logoUrl:e.logoUrl,logoAlt:`${e.name} logo`,applySiteAccent:!1})},SK=({role:t,agencyId:e,isAdmin:n})=>n?u.jsx(yT,{}):t==="admin"?u.jsx(yT,{}):t==="designer"?u.jsx(kK,{}):t==="agency"?u.jsx(TK,{agencyId:e}):u.jsx(wK,{agencyId:e}),IK=()=>{const t=new URLSearchParams(gs().search).get("agencyId"),{agency:e,saveAgency:n}=zd(t),[r,s]=T.useState(""),[i,o]=T.useState(null),[a,l]=T.useState(ic),[c,d]=T.useState(!1),[f,p]=T.useState("");T.useEffect(()=>{s(e.logoUrl||""),l(e.themeColor||ic),o(null)},[e]);const m=w=>{const y=w.target.files[0];o(y||null),s(y?URL.createObjectURL(y):e.logoUrl||"")},x=async w=>{if(w.preventDefault(),!!t){d(!0),p("");try{let y=r;i&&(y=await LP(i)),await n({logoUrl:y,themeColor:a}),o(null),p("Settings saved")}catch(y){console.error("Failed to save settings",y),p("Failed to save settings")}finally{d(!1)}}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Agency Theme"}),u.jsxs("form",{onSubmit:x,className:"space-y-4 max-w-sm",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Logo"}),u.jsx("input",{type:"file",accept:"image/*",onChange:m,className:"w-full p-2 border rounded"}),r&&u.jsx(Zn,{pngUrl:r,alt:"Logo preview",loading:"eager",className:"mt-2 max-h-16 w-auto"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Theme Color"}),u.jsx("input",{type:"color",value:a,onChange:w=>l(w.target.value),className:"w-full p-2 border rounded h-10"})]}),f&&u.jsx("p",{className:"text-sm",children:f}),u.jsx("button",{type:"submit",className:"btn-primary",disabled:c,children:c?"Saving...":"Save Settings"})]})]})},CK=()=>{const t=new URLSearchParams(gs().search).get("agencyId"),[e,n]=T.useState([]),[r,s]=T.useState(!0),[i,o]=T.useState(null),[a,l]=T.useState({code:"",name:""}),[c,d]=T.useState("");T.useEffect(()=>{(async()=>{if(!t){n([]),s(!1);return}s(!0);try{const _=un(be(H,"brands"),Nt("agencyId","==",t)),k=(await Le(_)).docs.map(A=>({id:A.id,...A.data()}));n(k)}catch(_){console.error("Failed to fetch brands",_),n([])}finally{s(!1)}})()},[t]);const f=async y=>{if(y.preventDefault(),!(!t||!a.code.trim())){d("");try{const _=await Vr(be(H,"brands"),{code:a.code.trim(),name:a.name.trim(),agencyId:t,createdAt:mn()});n(v=>[...v,{id:_.id,code:a.code.trim(),name:a.name.trim(),agencyId:t}]),l({code:"",name:""}),d("Brand added")}catch(_){console.error("Failed to add brand",_),d("Failed to add brand")}}},p=y=>{o(y.id),l({code:y.code||"",name:y.name||""})},m=()=>o(null),x=async y=>{try{await nt(oe(H,"brands",y),{code:a.code,name:a.name}),n(_=>_.map(v=>v.id===y?{...v,code:a.code,name:a.name}:v)),o(null)}catch(_){console.error("Failed to update brand",_)}},w=async y=>{if(window.confirm("Delete this brand?"))try{await Dr(oe(H,"brands",y)),n(_=>_.filter(v=>v.id!==y))}catch(_){console.error("Failed to delete brand",_)}};return u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Brands"}),u.jsxs("form",{onSubmit:f,className:"space-y-2 max-w-sm mb-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Code"}),u.jsx("input",{type:"text",value:a.code,onChange:y=>l(_=>({..._,code:y.target.value})),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Name"}),u.jsx("input",{type:"text",value:a.name,onChange:y=>l(_=>({..._,name:y.target.value})),className:"w-full p-2 border rounded"})]}),c&&u.jsx("p",{className:"text-sm",children:c}),u.jsx("button",{type:"submit",className:"btn-primary",children:"Add Brand"})]}),r?u.jsx("p",{children:"Loading brands..."}):e.length===0?u.jsx("p",{children:"No brands found."}):u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsxs("table",{className:"ad-table min-w-max",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Code"}),u.jsx("th",{children:"Name"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:e.map(y=>u.jsxs("tr",{children:[u.jsx("td",{children:i===y.id?u.jsx("input",{type:"text",value:a.code,onChange:_=>l(v=>({...v,code:_.target.value})),className:"w-full p-1 border rounded"}):y.code}),u.jsx("td",{children:i===y.id?u.jsx("input",{type:"text",value:a.name,onChange:_=>l(v=>({...v,name:_.target.value})),className:"w-full p-1 border rounded"}):y.name}),u.jsx("td",{className:"text-center",children:i===y.id?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>x(y.id),className:"underline text-gray-700 mr-2",children:"Save"}),u.jsx("button",{onClick:m,className:"underline",children:"Cancel"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>p(y),className:"underline text-gray-700 mr-2",children:"Edit"}),u.jsx("button",{onClick:()=>w(y.id),className:"underline btn-delete",children:"Delete"})]})})]},y.id))})]})})]})},AK=()=>{const t=new URLSearchParams(gs().search).get("agencyId"),[e,n]=T.useState([]),[r,s]=T.useState(!0),i=Me.currentUser,{role:o}=Qa(i==null?void 0:i.uid),a=async(f,p,m)=>{if(window.confirm("Delete this group?"))try{await yN(f,p,m),n(x=>x.filter(w=>w.id!==f))}catch(x){console.error("Failed to delete group",x)}},[l,c]=T.useState(null),d=async(f,p)=>{let m=`${window.location.origin}/review/${f}${p?`?agency=${p}`:""}`;const x=new URLSearchParams;i!=null&&i.email&&x.set("email",i.email),o&&x.set("role",o);const w=x.toString();w&&(m+=(p?"&":"?")+w);const y=Au();try{await nt(oe(H,"adGroups",f),{password:y})}catch(_){console.error("Failed to set password",_)}c({url:m,password:y})};return T.useEffect(()=>{(async()=>{if(!t){n([]),s(!1);return}s(!0);try{const m=(await Le(un(be(H,"brands"),Nt("agencyId","==",t)))).docs.map(y=>y.data().code).filter(Boolean);if(m.length===0){n([]),s(!1);return}const w=(await Le(un(be(H,"adGroups"),Nt("brandCode","in",m)))).docs.map(y=>({id:y.id,...y.data()})).filter(y=>y.status!=="archived");n(w)}catch(p){console.error("Failed to fetch groups",p),n([])}finally{s(!1)}})()},[t]),u.jsxs("div",{className:"min-h-screen p-4",children:[u.jsx("h1",{className:"text-2xl mb-4",children:"Ad Groups"}),r?u.jsx("p",{children:"Loading groups..."}):e.length===0?u.jsx("p",{children:"No ad groups found."}):u.jsx("div",{className:"overflow-x-auto table-container",children:u.jsxs("table",{className:"ad-table min-w-max",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Group Name"}),u.jsx("th",{children:"Brand"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:e.map(f=>u.jsxs("tr",{children:[u.jsx("td",{children:f.name}),u.jsx("td",{children:f.brandCode}),u.jsx("td",{children:u.jsx("span",{className:`status-badge status-${f.status}`,children:f.status})}),u.jsx("td",{className:"text-center",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsxs(So,{to:`/ad-group/${f.id}`,className:"flex items-center text-gray-700 underline","aria-label":"View Details",children:[u.jsx(Ud,{}),u.jsx("span",{className:"ml-1 text-[14px]",children:"Details"})]}),u.jsxs(So,{to:`/review/${f.id}${t?`?agency=${t}`:""}`,className:"flex items-center ml-2 text-gray-700 underline","aria-label":"Review",children:[u.jsx(yp,{}),u.jsx("span",{className:"ml-1 text-[14px]",children:"Review"})]}),u.jsxs("button",{onClick:()=>d(f.id,t),className:"flex items-center ml-2 text-gray-700 underline","aria-label":"Share Link",children:[u.jsx(fN,{}),u.jsx("span",{className:"ml-1 text-[14px]",children:"Share"})]}),u.jsx("button",{onClick:()=>a(f.id,f.brandCode,f.name),className:"flex items-center ml-2 underline btn-delete","aria-label":"Delete",children:u.jsx(Ms,{})})]})})]},f.id))})]})}),l&&u.jsx(Im,{url:l.url,password:l.password,onClose:()=>c(null)})]})},RK=()=>u.jsx("div",{className:"full-screen-spinner","data-testid":"full-screen-spinner",children:u.jsx("div",{className:"loading-ring"})}),NK=t=>{T.useEffect(()=>t?((async()=>{try{const r=await navigator.serviceWorker.register("/firebase-messaging-sw.js"),s=await v9(CE,{vapidKey:void 0,serviceWorkerRegistration:r});s&&await li(oe(H,"users",t.uid),{fcmToken:s},{merge:!0})}catch(r){console.error("Failed to obtain FCM token",r)}})(),_9(CE,()=>{})):void 0,[t])},PK=()=>(gw(),null),jK=()=>{const[t,e]=Rn.useState(null),[n,r]=Rn.useState(!0);Rn.useEffect(()=>{const A=vF(Me,D=>{e(D),r(!1)});return()=>{A()}},[]);const{role:s,brandCodes:i,agencyId:o,loading:a}=Qa(t==null?void 0:t.uid),{isAdmin:l,loading:c}=nK(),{settings:d,loading:f}=Bw(!o),{agency:p,loading:m}=zd(o),[x,w]=Rn.useState(!1);NK(t),Rn.useEffect(()=>{const A=o?p.logoUrl||fr:d.logoUrl||fr;if(!A){w(!0);return}w(!1);const D=new Image;D.onload=()=>w(!0),D.onerror=()=>w(!0),D.src=A},[p.logoUrl,d.logoUrl,o]);const y=!n&&!a&&!c&&!f&&!m&&x;if(Rn.useEffect(()=>{y&&document.body.classList.remove("pre-theme")},[y]),!y)return u.jsx(RK,{});const _=t&&!t.isAnonymous,v=l?"admin":s,k=_?v==="agency"?`/agency/dashboard?agencyId=${o}`:`/dashboard/${v}`:"/login";return _&&!v?u.jsx("div",{className:"flex items-center justify-center min-h-screen text-center",children:"No role assigned to this account. Please contact support."}):u.jsxs(kM,{children:[u.jsx(PK,{}),u.jsx(pK,{user:t,role:v,children:u.jsxs("div",{className:"min-h-screen flex",children:[_&&u.jsx(SK,{role:v,isAdmin:l,agencyId:o}),u.jsx("div",{className:`flex flex-col flex-grow box-border min-w-0 max-w-full ${_?"md:pl-[250px]":""}`,children:u.jsx("div",{className:"flex-grow",children:u.jsxs(yM,{children:[u.jsx(lt,{path:"/login",element:t?u.jsx(at,{to:k,replace:!0}):u.jsx(k9,{onLogin:()=>e(Me.currentUser)})}),u.jsx(lt,{path:"/signup",element:t?u.jsx(at,{to:k,replace:!0}):u.jsx($9,{})}),u.jsx(lt,{path:"/signup/designer",element:t?u.jsx(at,{to:k,replace:!0}):u.jsx(H9,{})}),u.jsx(lt,{path:"/",element:t?u.jsx(at,{to:k,replace:!0}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/dashboard/designer",element:t?u.jsx(Ft,{requiredRole:"designer",userRole:v,isAdmin:l,loading:a,children:u.jsx(az,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/designer/notifications",element:t?u.jsx(Ft,{requiredRole:"designer",userRole:v,isAdmin:l,loading:a,children:u.jsx(QG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/designer/account-settings",element:t?u.jsx(Ft,{requiredRole:"designer",userRole:v,isAdmin:l,loading:a,children:u.jsx(XG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/accounts",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(tK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/accounts/new",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(eK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/dashboard/client",element:t?u.jsx(Ft,{requiredRole:"client",userRole:v,isAdmin:l,loading:a,children:u.jsx(cz,{user:t,brandCodes:i})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/dashboard/admin",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx($G,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/ad-groups",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(HG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/agency/dashboard",element:t?u.jsx(Ft,{requiredRole:"agency",userRole:v,isAdmin:l,loading:a,children:u.jsx(qG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/agency/theme",element:t?u.jsx(Ft,{requiredRole:"agency",userRole:v,isAdmin:l,loading:a,children:u.jsx(IK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/agency/brands",element:t?u.jsx(Ft,{requiredRole:"agency",userRole:v,isAdmin:l,loading:a,children:u.jsx(CK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/agency/account-settings",element:t?u.jsx(Ft,{requiredRole:"agency",userRole:v,isAdmin:l,loading:a,children:u.jsx(ZG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/agency/ad-groups",element:t?u.jsx(Ft,{requiredRole:"agency",userRole:v,isAdmin:l,loading:a,children:u.jsx(AK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/review/:groupId",element:u.jsx(J9,{})}),u.jsx(lt,{path:"/request",element:t?u.jsx(Ft,{requiredRole:"client",userRole:v,isAdmin:l,loading:a,children:u.jsx(GG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/brand-setup",element:t?u.jsx(Ft,{requiredRole:"client",userRole:v,isAdmin:l,loading:a,children:u.jsx(KG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/account-settings",element:t?u.jsx(Ft,{requiredRole:"client",userRole:v,isAdmin:l,loading:a,children:u.jsx(YG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/mfa-settings",element:t?u.jsx(Ft,{requiredRole:["admin","client","agency","designer"],userRole:v,isAdmin:l,loading:a,children:u.jsx(fK,{user:t,role:v})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/ad-group/:id",element:t?u.jsx(Ft,{requiredRole:["designer","admin","agency","client"],userRole:v,isAdmin:l,loading:a,children:u.jsx(oz,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/brands",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(sK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/ad-recipes",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(uK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/notifications",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(hK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/site-settings",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(_K,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/account-settings",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(JG,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"/admin/brands/new",element:t?u.jsx(Ft,{requiredRole:"admin",userRole:v,isAdmin:l,loading:a,children:u.jsx(rK,{})}):u.jsx(at,{to:"/login",replace:!0})}),u.jsx(lt,{path:"*",element:u.jsx(at,{to:"/",replace:!0})})]})})})]})})]})},DK=ty.createRoot(document.getElementById("root"));DK.render(u.jsx(jK,{}));
